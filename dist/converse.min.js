/*! For license information please see converse.min.js.LICENSE.txt */
(()=>{var e,t,s,n,r={"./node_modules/abab/index.js":(e,t,s)=>{"use strict";const n=s("./node_modules/abab/lib/atob.js"),r=s("./node_modules/abab/lib/btoa.js");e.exports={atob:n,btoa:r}},"./node_modules/abab/lib/atob.js":e=>{"use strict";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(e){const s=t.indexOf(e);return s<0?void 0:s}e.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");if((e=(e=`${e}`).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",n=0,r=0;for(let o=0;o<e.length;o++)n<<=6,n|=s(e[o]),r+=6,24===r&&(t+=String.fromCharCode((16711680&n)>>16),t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n),n=r=0);return 12===r?(n>>=4,t+=String.fromCharCode(n)):18===r&&(n>>=2,t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n)),t}},"./node_modules/abab/lib/btoa.js":e=>{"use strict";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(e){if(e>=0&&e<64)return t[e]}e.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let n="";for(t=0;t<e.length;t+=3){const r=[void 0,void 0,void 0,void 0];r[0]=e.charCodeAt(t)>>2,r[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(r[1]|=e.charCodeAt(t+1)>>4,r[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(r[2]|=e.charCodeAt(t+2)>>6,r[3]=63&e.charCodeAt(t+2));for(let e=0;e<r.length;e++)void 0===r[e]?n+="=":n+=s(r[e])}return n}},"./node_modules/@converse/localforage-getitems/dist/localforage-getitems.js":function(e,t,s){!function(e,t){"use strict";function s(e){return s.result?s.result:e&&"function"==typeof e.getSerializer?(s.result=e.getSerializer(),s.result):Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!"))}function n(e,t){return t&&e.then((function(e){t(null,e)}),(function(e){t(e)})),e}function r(e,t){var s=this.getItem(e).then((function(t){return{key:e,value:t}}));return n(s,t),s}function o(e){var t=this;return new Promise((function(s,n){for(var o=[],i=0,a=e.length;i<a;i++)o.push(r.call(t,e[i]));Promise.all(o).then((function(e){for(var t={},n=0,r=e.length;n<r;n++){var o=e[n];t[o.key]=o.value}s(t)})).catch(n)}))}function i(){var e={};return this.iterate((function(t,s){e[s]=t})).then((function(){return e}))}function a(){return"undefined"!=typeof IDBKeyRange?IDBKeyRange:"undefined"!=typeof webkitIDBKeyRange?webkitIDBKeyRange:"undefined"!=typeof mozIDBKeyRange?mozIDBKeyRange:void 0}t="default"in t?t.default:t;var l=a();function c(e){e=e.slice();var t=this;function s(e,t){return e<t?-1:e>t?1:0}return new Promise((function(n,r){t.ready().then((function(){var o,i=t._dbInfo,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),c=e.sort(s),d=l.bound(e[0],e[e.length-1],!1,!1);if("getAll"in a)(o=a.getAll(d)).onsuccess=function(){var e=o.result;void 0===e&&(e=null),n(e)};else{o=a.openCursor(d);var u={},h=0;o.onsuccess=function(){var e=o.result;if(e){for(var t=e.key;t>c[h];)if(++h===c.length)return void n(u);if(t===c[h]){var s=e.value;void 0===s&&(s=null),u[t]=s,e.continue()}else e.continue(c[h])}else n(u)}}o.onerror=function(){r(o.error)}})).catch(r)}))}function d(e){var t=this;return new Promise((function(n,r){t.ready().then((function(){return s(t)})).then((function(s){var o=t._dbInfo;o.db.transaction((function(t){for(var i=new Array(e.length),a=0,l=e.length;a<l;a++)i[a]="?";t.executeSql("SELECT * FROM "+o.storeName+" WHERE (key IN ("+i.join(",")+"))",e,(function(e,t){for(var r={},o=t.rows,i=0,a=o.length;i<a;i++){var l=o.item(i),c=l.value;c&&(c=s.deserialize(c)),r[l.key]=c}n(r)}),(function(e,t){r(t)}))}))})).catch(r)}))}function u(e,t){var s,r=this;if(arguments.length&&null!==e){var a=r.driver();s=a===r.INDEXEDDB?c.apply(r,arguments):a===r.WEBSQL?d.apply(r,arguments):o.apply(r,arguments)}else s=i.apply(r);return n(s,t),s}function h(e){var t=Object.getPrototypeOf(e);t&&(t.getItems=u,t.getItems.indexedDB=function(){return c.apply(this,arguments)},t.getItems.websql=function(){return d.apply(this,arguments)},t.getItems.generic=function(){return o.apply(this,arguments)})}var f=h(t);e.localforageGetItems=u,e.extendPrototype=h,e.extendPrototypeResult=f,e.getItemsGeneric=o,Object.defineProperty(e,"__esModule",{value:!0})}(t,s("./node_modules/localforage/dist/localforage.js"))},"./node_modules/@converse/openpromise/openpromise.js":(e,t,s)=>{"use strict";function n(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise(((t,s)=>{e.resolve=t,e.reject=s}));return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}s.r(t),s.d(t,{getOpenPromise:()=>n})},"./node_modules/@converse/skeletor/src/collection.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Collection:()=>S});var n=s("./node_modules/@converse/skeletor/src/helpers.js"),r=s("./node_modules/@converse/skeletor/src/events.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./node_modules/lodash-es/clone.js"),a=s("./node_modules/lodash-es/countBy.js"),l=s("./node_modules/lodash-es/difference.js"),c=s("./node_modules/lodash-es/every.js"),d=s("./node_modules/lodash-es/assignIn.js"),u=s("./node_modules/lodash-es/findIndex.js"),h=s("./node_modules/lodash-es/findLastIndex.js"),f=s("./node_modules/lodash-es/groupBy.js"),m=s("./node_modules/lodash-es/indexOf.js"),p=s("./node_modules/lodash-es/isEmpty.js"),g=s("./node_modules/lodash-es/isFunction.js"),_=s("./node_modules/lodash-es/isString.js"),v=s("./node_modules/lodash-es/keyBy.js"),y=s("./node_modules/lodash-es/lastIndexOf.js"),b=s("./node_modules/lodash-es/some.js"),j=s("./node_modules/lodash-es/sortBy.js");const w=Array.prototype.slice,S=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,(0,d.default)({silent:!0},t))};S.extend=n.inherits;const x={add:!0,remove:!0,merge:!0},E={add:!0,remove:!1},A=function(e,t,s){s=Math.min(Math.max(s,0),e.length);const n=Array(e.length-s),r=t.length;let o;for(o=0;o<n.length;o++)n[o]=e[o+s];for(o=0;o<r;o++)e[o+s]=t[o];for(o=0;o<n.length;o++)e[o+r+s]=n[o]};Object.assign(S.prototype,r.Events,{model:o.Model,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(e,t,s){return(0,n.getSyncMethod)(this)(e,t,s)},add:function(e,t){return this.set(e,(0,d.default)({merge:!1},t,E))},remove:function(e,t){t=(0,d.default)({},t);const s=!Array.isArray(e);e=s?[e]:e.slice();const n=this._removeModels(e,t);return!t.silent&&n.length&&(t.changes={added:[],merged:[],removed:n},this.trigger("update",this,t)),s?n[0]:n},set:function(e,t){if(null==e)return;(t=(0,d.default)({},x,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);const s=!Array.isArray(e);e=s?[e]:e.slice();let n=t.at;null!=n&&(n=+n),n>this.length&&(n=this.length),n<0&&(n+=this.length+1);const r=[],o=[],i=[],a=[],l={},c=t.add,u=t.merge,h=t.remove;let f=!1;const m=this.comparator&&null==n&&!1!==t.sort,p=(0,_.default)(this.comparator)?this.comparator:null;let g,v;for(v=0;v<e.length;v++){g=e[v];const s=this.get(g);if(s){if(u&&g!==s){let e=this._isModel(g)?g.attributes:g;t.parse&&(e=s.parse(e,t)),s.set(e,t),i.push(s),m&&!f&&(f=s.hasChanged(p))}l[s.cid]||(l[s.cid]=!0,r.push(s)),e[v]=s}else c&&(g=e[v]=this._prepareModel(g,t),g&&(o.push(g),this._addReference(g,t),l[g.cid]=!0,r.push(g)))}if(h){for(v=0;v<this.length;v++)g=this.models[v],l[g.cid]||a.push(g);a.length&&this._removeModels(a,t)}let y=!1;const j=!m&&c&&h;if(r.length&&j?(y=this.length!==r.length||(0,b.default)(this.models,((e,t)=>e!==r[t])),this.models.length=0,A(this.models,r,0),this.length=this.models.length):o.length&&(m&&(f=!0),A(this.models,o,null==n?this.length:n),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(v=0;v<o.length;v++)null!=n&&(t.index=n+v),g=o[v],g.trigger("add",g,this,t);(f||y)&&this.trigger("sort",this,t),(o.length||a.length||i.length)&&(t.changes={added:o,removed:a,merged:i},this.trigger("update",this,t))}return s?e[0]:e},clearStore:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;await Promise.all(this.models.filter(t).map((t=>new Promise((s=>{t.destroy(Object.assign(e,{success:s,error:(e,t)=>{console.error(t),s()}}))}))))),await this.browserStorage.clear(),this.reset()},reset:function(e,t){t=t?(0,i.default)(t):{};for(let e=0;e<this.models.length;e++)this._removeReference(this.models[e],t);return t.previousModels=this.models,this._reset(),e=this.add(e,(0,d.default)({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,(0,d.default)({at:this.length},t))},pop:function(e){const t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,(0,d.default)({at:0},t))},shift:function(e){const t=this.at(0);return this.remove(t,e)},slice:function(){return w.apply(this.models,arguments)},filter:function(e,t){return this.models.filter((0,g.default)(e)?e:t=>t.matches(e),t)},every:function(e){return(0,c.default)(this.models.map((e=>e.attributes)),e)},difference:function(e){return(0,l.default)(this.models,e)},max:function(){return Math.max.apply(Math,this.models)},min:function(){return Math.min.apply(Math,this.models)},drop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.models.slice(e)},some:function(e){return(0,b.default)(this.models.map((e=>e.attributes)),e)},sortBy:function(e){return(0,j.default)(this.models,(0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e))},isEmpty:function(){return(0,p.default)(this.models)},keyBy:function(e){return(0,v.default)(this.models,e)},each:function(e,t){return this.forEach(e,t)},forEach:function(e,t){return this.models.forEach(e,t)},includes:function(e){return this.models.includes(e)},size:function(){return this.models.length},countBy:function(e){return(0,a.default)(this.models,(0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e))},groupBy:function(e){return(0,f.default)(this.models,(0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e))},indexOf:function(e){return(0,m.default)(this.models,e)},findLastIndex:function(e,t){return(0,h.default)(this.models,(0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e),t)},lastIndexOf:function(e){return(0,y.default)(this.models,e)},findIndex:function(e){return(0,u.default)(this.models,(0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e))},last:function(){const e=null==this.models?0:this.models.length;return e?this.models[e-1]:void 0},head:function(){return this.models[0]},first:function(){return this.head()},map:function(e,t){return this.models.map((0,g.default)(e)?e:t=>(0,_.default)(e)?t.get(e):t.matches(e),t)},reduce:function(e,t){return this.models.reduce(e,t||this.models[0])},reduceRight:function(e,t){return this.models.reduceRight(e,t||this.models[0])},toArray:function(){return Array.from(this.models)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},find:function(e,t){const s=(0,g.default)(e)?e:t=>t.matches(e);return this.models.find(s,t)},sort:function(e){let t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});const s=t.length;return(0,g.default)(t)&&(t=t.bind(this)),1===s||(0,_.default)(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){const t=(e=(0,d.default)({parse:!0},e)).success,s=this,r=e.promise&&(0,n.getResolveablePromise)();return e.success=function(n){const o=e.reset?"reset":"set";s[o](n,e),t&&t.call(e.context,s,n,e),r&&r.resolve(),s.trigger("sync",s,n,e)},(0,n.wrapError)(this,e),r||this.sync("read",this,e)},create:function(e,t){const s=(t=t?(0,i.default)(t):{}).wait,r=t.promise,o=r&&(0,n.getResolveablePromise)();if(!(e=this._prepareModel(e,t)))return!1;s||this.add(e,t);const a=this,l=t.success,c=t.error;return t.success=function(e,t,n){s&&a.add(e,n),l&&l.call(n.context,e,t,n),r&&o.resolve(e)},t.error=function(e,t,s){c&&c.call(s.context,e,t,s),r&&o.reject(t)},e.save(null,Object.assign(t,{promise:!1})),r?o:e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype?.idAttribute||"id"]},values:function(){return new T(this,I)},keys:function(){return new T(this,k)},entries:function(){return new T(this,N)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?(0,i.default)(t):{}).collection=this;const s=new this.model(e,t);return s.validationError?(this.trigger("invalid",this,s.validationError,t),!1):s},_removeModels:function(e,t){const s=[];for(let n=0;n<e.length;n++){const r=this.get(e[n]);if(!r)continue;const o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];const i=this.modelId(r.attributes);null!=i&&delete this._byId[i],t.silent||(t.index=o,r.trigger("remove",r,this,t)),s.push(r),this._removeReference(r,t)}return s},_isModel:function(e){return e instanceof o.Model},_addReference:function(e,t){this._byId[e.cid]=e;const s=this.modelId(e.attributes);null!=s&&(this._byId[s]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];const s=this.modelId(e.attributes);null!=s&&delete this._byId[s],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,s,n){if(t){if(("add"===e||"remove"===e)&&s!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){const e=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);e!==s&&(null!=e&&delete this._byId[e],null!=s&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}});const C="function"==typeof Symbol&&Symbol.iterator;C&&(S.prototype[C]=S.prototype.values);const T=function(e,t){this._collection=e,this._kind=t,this._index=0},I=1,k=2,N=3;C&&(T.prototype[C]=function(){return this}),T.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){const e=this._collection.at(this._index);let t;if(this._index++,this._kind===I)t=e;else{const s=this._collection.modelId(e.attributes);t=this._kind===k?s:[s,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}}},"./node_modules/@converse/skeletor/src/drivers/sessionStorage.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/localforage/src/utils/executeCallback.js"),r=s("./node_modules/localforage/src/utils/getCallback.js"),o=s("./node_modules/localforage/src/utils/normalizeKey.js"),i=s("./node_modules/localforage/src/utils/serializer.js");function a(e,t){let s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}const l={serializer:{serialize:i.default.serialize,deserialize:i.default.deserialize}};const c={_driver:"sessionStorageWrapper",_initStorage:function(e){if(l.keyPrefix=a(e,this._defaultConfig),e)for(const t in e)l[t]=e[t]},_support:function(){try{if(sessionStorage&&"setItem"in sessionStorage)return!0}catch(e){console.log(e)}return!1}(),iterate:function(e,t){const s=this.ready().then((function(){const t=l.keyPrefix,s=t.length,n=sessionStorage.length;let r=1;for(let o=0;o<n;o++){const n=sessionStorage.key(o);if(0!==n.indexOf(t))continue;let i=sessionStorage.getItem(n);if(i&&(i=l.serializer.deserialize(i)),i=e(i,n.substring(s),r++),void 0!==i)return i}}));return(0,n.default)(s,t),s},getItem:function(e,t){e=(0,o.default)(e);const s=this.ready().then((function(){let t=sessionStorage.getItem(l.keyPrefix+e);return t&&(t=l.serializer.deserialize(t)),t}));return(0,n.default)(s,t),s},setItem:async function(e,t,s){e=(0,o.default)(e),await this.ready();const r=t=t??null;l.serializer.serialize(t,((t,o)=>{if(o)throw o;try{sessionStorage.setItem(l.keyPrefix+e,t),(0,n.default)(Promise.resolve(r),s)}catch(e){if("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)throw console.error("Your sesionStorage capacity is used up."),e;throw e}}))},removeItem:function(e,t){e=(0,o.default)(e);const s=this.ready().then((function(){sessionStorage.removeItem(l.keyPrefix+e)}));return(0,n.default)(s,t),s},clear:function(e){const t=this.ready().then((function(){const e=l.keyPrefix;for(let t=sessionStorage.length-1;t>=0;t--){const s=sessionStorage.key(t);0===s.indexOf(e)&&sessionStorage.removeItem(s)}}));return(0,n.default)(t,e),t},length:function(e){const t=this.keys().then((function(e){return e.length}));return(0,n.default)(t,e),t},key:function(e,t){const s=this.ready().then((function(){let t;try{t=sessionStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(l.keyPrefix.length)),t}));return(0,n.default)(s,t),s},keys:function(e){const t=this.ready().then((function(){const e=sessionStorage.length,t=[];for(let s=0;s<e;s++){const e=sessionStorage.key(s);0===e.indexOf(l.keyPrefix)&&t.push(e.substring(l.keyPrefix.length))}return t}));return(0,n.default)(t,e),t},dropInstance:function(e,t){if(t=r.default.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){const t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}const s=this;let o;return o=e.name?new Promise((function(t){e.storeName?t(a(e,s._defaultConfig)):t(`${e.name}/`)})).then((function(e){for(let t=sessionStorage.length-1;t>=0;t--){const s=sessionStorage.key(t);0===s.indexOf(e)&&sessionStorage.removeItem(s)}})):Promise.reject(new Error("Invalid arguments")),(0,n.default)(o,t),o}},d=c},"./node_modules/@converse/skeletor/src/element.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ElementView:()=>u});var n=s("./node_modules/lodash-es/assignIn.js"),r=s("./node_modules/lodash-es/isFunction.js"),o=s("./node_modules/lodash-es/pick.js"),i=s("./node_modules/lodash-es/uniqueId.js"),a=s("./node_modules/@converse/skeletor/src/events.js"),l=(s("./node_modules/@converse/skeletor/src/helpers.js"),s("./node_modules/lit-html/development/lit-html.js"));"undefined"!=typeof Element&&Element.prototype;const c=/^(\S+)\s*(.*)$/,d=["model","collection","events"];class u extends HTMLElement{events={};constructor(e){super(),this.cid=(0,i.default)("view"),this._domEvents=[],(0,n.default)(this,(0,o.default)(e,d))}createRenderRoot(){return this}connectedCallback(){this._initialized||(this.preinitialize.apply(this,arguments),this.initialize.apply(this,arguments),this._initialized=!0),this.delegateEvents()}disconnectedCallback(){this.undelegateEvents(),this.stopListening()}preinitialize(){}initialize(){}render(){return(0,r.default)(this.beforeRender)&&this.beforeRender(),(0,r.default)(this.toHTML)&&(0,l.render)(this.toHTML(),this),(0,r.default)(this.afterRender)&&this.afterRender(),this}delegateEvents(){if(!this.events)return this;this.undelegateEvents();for(const e in this.events){let t=this.events[e];if((0,r.default)(t)||(t=this[t]),!t)continue;const s=e.match(c);this.delegate(s[1],s[2],t.bind(this))}return this}delegate(e,t,s){const n=this;if(!n)return this;if("function"==typeof t&&(s=t,t=null),-1!==["focus","blur"].indexOf(e)){const n=this.querySelectorAll(t);for(let t=0,r=n.length;t<r;t++){const r=n[t];r.addEventListener(e,s,!1),this._domEvents.push({el:r,eventName:e,handler:s})}return s}const r=t?function(e){let r=e.target||e.srcElement;for(;r&&r!=n;r=r.parentNode)r.matches(t)&&(e.delegateTarget=r,s(e))}:s;return this.addEventListener(e,r,!1),this._domEvents.push({el:this,eventName:e,handler:r,listener:s,selector:t}),this}undelegateEvents(){if(this){for(let e=0,t=this._domEvents.length;e<t;e++){const t=this._domEvents[e];t.el.removeEventListener(t.eventName,t.handler,!1)}this._domEvents.length=0}return this}undelegate(e,t,s){if("function"==typeof t&&(s=t,t=null),this){const n=this._domEvents.slice();let r=n.length;for(;r--;){const o=n[r];!(o.eventName!==e||s&&o.listener!==s||t&&o.selector!==t)&&(o.el.removeEventListener(o.eventName,o.handler,!1),this._domEvents.splice(r,1))}}return this}}Object.assign(u.prototype,a.Events)},"./node_modules/@converse/skeletor/src/events.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Events:()=>a});var n=s("./node_modules/lodash-es/isEmpty.js"),r=s("./node_modules/lodash-es/keys.js"),o=s("./node_modules/lodash-es/once.js"),i=s("./node_modules/lodash-es/uniqueId.js");const a={},l=/\s+/;let c;const d=function(e,t,s,n,o){let i,a=0;if(s&&"object"==typeof s){void 0!==n&&"context"in o&&void 0===o.context&&(o.context=n);for(i=(0,r.default)(s);a<i.length;a++)t=d(e,t,i[a],s[i[a]],o)}else if(s&&l.test(s))for(i=s.split(l);a<i.length;a++)t=e(t,i[a],n,o);else t=e(t,s,n,o);return t};a.on=function(e,t,s){if(this._events=d(u,this._events||{},e,t,{context:s,ctx:this,listening:c}),c){(this._listeners||(this._listeners={}))[c.id]=c,c.interop=!1}return this},a.listenTo=function(e,t,s){if(!e)return this;const n=e._listenId||(e._listenId=(0,i.default)("l")),r=this._listeningTo||(this._listeningTo={});let o=c=r[n];o||(this._listenId||(this._listenId=(0,i.default)("l")),o=c=r[n]=new _(this,e));const a=h(e,t,s,this);if(c=void 0,a)throw a;return o.interop&&o.on(t,s),this};const u=function(e,t,s,n){if(s){const r=e[t]||(e[t]=[]),o=n.context,i=n.ctx,a=n.listening;a&&a.count++,r.push({callback:s,context:o,ctx:o||i,listening:a})}return e},h=function(e,t,s,n){try{e.on(t,s,n)}catch(e){return e}};a.off=function(e,t,s){return this._events?(this._events=d(f,this._events,e,t,{context:s,listeners:this._listeners}),this):this},a.stopListening=function(e,t,s){const o=this._listeningTo;if(!o)return this;const i=e?[e._listenId]:(0,r.default)(o);for(let e=0;e<i.length;e++){const n=o[i[e]];if(!n)break;n.obj.off(t,s,this),n.interop&&n.off(t,s)}return(0,n.default)(o)&&(this._listeningTo=void 0),this};const f=function(e,t,s,n){if(!e)return;const o=n.context,i=n.listeners;let a,l=0;if(t||o||s){for(a=t?[t]:(0,r.default)(e);l<a.length;l++){const n=e[t=a[l]];if(!n)break;const r=[];for(let e=0;e<n.length;e++){const i=n[e];if(s&&s!==i.callback&&s!==i.callback._callback||o&&o!==i.context)r.push(i);else{const e=i.listening;e&&e.off(t,s)}}r.length?e[t]=r:delete e[t]}return e}for(a=(0,r.default)(i);l<a.length;l++)i[a[l]].cleanup()};a.once=function(e,t,s){const n=d(m,{},e,t,this.off.bind(this));return"string"==typeof e&&null==s&&(t=void 0),this.on(n,t,s)},a.listenToOnce=function(e,t,s){const n=d(m,{},t,s,this.stopListening.bind(this,e));return this.listenTo(e,n)};const m=function(e,t,s,n){if(s){const r=e[t]=(0,o.default)((function(){n(t,r),s.apply(this,arguments)}));r._callback=s}return e};a.trigger=function(e){if(!this._events)return this;const t=Math.max(0,arguments.length-1),s=Array(t);for(let e=0;e<t;e++)s[e]=arguments[e+1];return d(p,this._events,e,void 0,s),this};const p=function(e,t,s,n){if(e){const s=e[t];let r=e.all;s&&r&&(r=r.slice()),s&&g(s,n),r&&g(r,[t].concat(n))}return e},g=function(e,t){let s,n=-1;const r=e.length,o=t[0],i=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(s=e[n]).callback.call(s.ctx);return;case 1:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o);return;case 2:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o,i);return;case 3:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o,i,a);return;default:for(;++n<r;)(s=e[n]).callback.apply(s.ctx,t);return}},_=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};_.prototype.on=a.on,_.prototype.off=function(e,t){let s;this.interop?(this._events=d(f,this._events,e,t,{context:void 0,listeners:void 0}),s=!this._events):(this.count--,s=0===this.count),s&&this.cleanup()},_.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off},"./node_modules/@converse/skeletor/src/helpers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{NotImplementedError:()=>a,ajax:()=>_,getResolveablePromise:()=>u,getSyncMethod:()=>p,guid:()=>c,inherits:()=>d,sync:()=>g,urlError:()=>h,wrapError:()=>f});var n=s("./node_modules/lodash-es/create.js"),r=s("./node_modules/lodash-es/assignIn.js"),o=s("./node_modules/lodash-es/has.js"),i=s("./node_modules/lodash-es/result.js");class a extends Error{}function l(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function c(){return l()+l()+"-"+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()}function d(e,t){const s=this;let i;return i=e&&(0,o.default)(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},(0,r.default)(i,s,t),i.prototype=(0,n.default)(s.prototype,e),i.prototype.constructor=i,i.__super__=s.prototype,i}function u(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise(((t,s)=>{e.resolve=t,e.reject=s}));return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}function h(){throw new Error('A "url" property or function must be specified')}function f(e,t){const s=t.error;t.error=function(n){s&&s.call(t.context,e,n,t),e.trigger("error",e,n,t)}}const m={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};function p(e){const t=(0,i.default)(e,"browserStorage")||(0,i.default)(e.collection,"browserStorage");return t?t.sync():g}function g(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={type:m[e],dataType:"json"};s.url||(n.url=(0,i.default)(t,"url")||h()),null!=s.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(n.contentType="application/json",n.data=JSON.stringify(s.attrs||t.toJSON(s))),"GET"!==n.type&&(n.processData=!1);const o=s.error;s.error=function(e,t,n){s.textStatus=t,s.errorThrown=n,o&&o.call(s.context,e,t,n)};const a=s.xhr=_((0,r.default)(n,s));return t.trigger("request",t,a,s),a}function _(){return fetch.apply(this,arguments)}},"./node_modules/@converse/skeletor/src/history.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/assignIn.js"),r=s("./node_modules/lodash-es/some.js"),o=s("./node_modules/@converse/skeletor/src/events.js"),i=s("./node_modules/@converse/skeletor/src/helpers.js");const a=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};a.extend=i.inherits;const l=/^[#\/]|\s+$/g,c=/^\/+|\/+$/g,d=/#.*$/;a.started=!1,Object.assign(a.prototype,o.Events,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){const e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){const t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){const e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(l,"")},start:function(e){if(a.started)throw new Error("history has already been started");if(a.started=!0,this.options=(0,n.default)({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(c,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){const e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;const e=document.body,t=e.insertBefore(this.iframe,e.firstChild).contentWindow;t.document.open(),t.document.close(),t.location.hash="#"+this.fragment}if(this._usePushState?addEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?addEventListener("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){this._usePushState?removeEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&removeEventListener("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),a.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){let t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),(0,r.default)(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!a.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");let s=this.root;""!==e&&"?"!==e.charAt(0)||(s=s.slice(0,-1)||"/");const n=s+e;e=e.replace(d,"");const r=this.decodeFragment(e);if(this.fragment!==r){if(this.fragment=r,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){const s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,s){if(s){const s=e.href.replace(/(javascript:|#).*$/,"");e.replace(s+"#"+t)}else e.hash="#"+t}});const u=a},"./node_modules/@converse/skeletor/src/model.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Model:()=>y});var n=s("./node_modules/@converse/skeletor/src/helpers.js"),r=s("./node_modules/@converse/skeletor/src/events.js"),o=s("./node_modules/lodash-es/clone.js"),i=s("./node_modules/lodash-es/defaults.js"),a=s("./node_modules/lodash-es/defer.js"),l=s("./node_modules/lodash-es/escape.js"),c=s("./node_modules/lodash-es/assignIn.js"),d=s("./node_modules/lodash-es/has.js"),u=s("./node_modules/lodash-es/invert.js"),h=s("./node_modules/lodash-es/isEmpty.js"),f=s("./node_modules/lodash-es/isEqual.js"),m=s("./node_modules/lodash-es/iteratee.js"),p=s("./node_modules/lodash-es/omit.js"),g=s("./node_modules/lodash-es/pick.js"),_=s("./node_modules/lodash-es/result.js"),v=s("./node_modules/lodash-es/uniqueId.js");const y=function(e,t){let s=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=(0,v.default)(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(s=this.parse(s,t)||{});const n=(0,_.default)(this,"defaults");s=(0,i.default)((0,c.default)({},n,s),n),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};y.extend=n.inherits,Object.assign(y.prototype,r.Events,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return(0,o.default)(this.attributes)},sync:function(e,t,s){return(0,n.getSyncMethod)(this)(e,t,s)},get:function(e){return this.attributes[e]},keys:function(){return Object.keys(this.attributes)},values:function(){return Object.values(this.attributes)},pairs:function(){return this.entries()},entries:function(){return Object.entries(this.attributes)},invert:function(){return(0,u.default)(this.attributes)},pick:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),(0,g.default)(this.attributes,t)},omit:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),(0,p.default)(this.attributes,t)},isEmpty:function(){return(0,h.default)(this.attributes)},escape:function(e){return(0,l.default)(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!(0,m.default)(e,this)(this.attributes)},set:function(e,t,s){if(null==e)return this;let n;if("object"==typeof e?(n=e,s=t):(n={})[e]=t,s||(s={}),!this._validate(n,s))return!1;const r=s.unset,i=s.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=(0,o.default)(this.attributes),this.changed={});const c=this.attributes,d=this.changed,u=this._previousAttributes;for(const e in n)t=n[e],(0,f.default)(c[e],t)||a.push(e),(0,f.default)(u[e],t)?delete d[e]:d[e]=t,r?delete c[e]:c[e]=t;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!i){a.length&&(this._pending=s);for(let e=0;e<a.length;e++)this.trigger("change:"+a[e],this,c[a[e]],s)}if(l)return this;if(!i)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,(0,c.default)({},t,{unset:!0}))},clear:function(e){const t={};for(const e in this.attributes)t[e]=void 0;return this.set(t,(0,c.default)({},e,{unset:!0}))},hasChanged:function(e){return null==e?!(0,h.default)(this.changed):(0,d.default)(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&(0,o.default)(this.changed);const t=this._changing?this._previousAttributes:this.attributes,s={};let n;for(const r in e){const o=e[r];(0,f.default)(t[r],o)||(s[r]=o,n=!0)}return!!n&&s},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return(0,o.default)(this._previousAttributes)},fetch:function(e){e=(0,c.default)({parse:!0},e);const t=this,s=e.success;return e.success=function(n){const r=e.parse?t.parse(n,e):n;if(!t.set(r,e))return!1;s&&s.call(e.context,t,n,e),t.trigger("sync",t,n,e)},(0,n.wrapError)(this,e),this.sync("read",this,e)},save:function(e,t,s){let r;null==e||"object"==typeof e?(r=e,s=t):(r={})[e]=t;const o=(s=(0,c.default)({validate:!0,parse:!0},s)).wait,i=s.promise,a=i&&(0,n.getResolveablePromise)();if(r&&!o){if(!this.set(r,s))return!1}else if(!this._validate(r,s))return!1;const l=this,d=s.success,u=s.error,h=this.attributes;s.success=function(e){l.attributes=h;let t=s.parse?l.parse(e,s):e;if(o&&(t=(0,c.default)({},r,t)),t&&!l.set(t,s))return!1;d&&d.call(s.context,l,e,s),l.trigger("sync",l,e,s),i&&a.resolve()},s.error=function(e,t,s){u&&u.call(s.context,e,t,s),i&&a.reject(t)},(0,n.wrapError)(this,s),r&&o&&(this.attributes=(0,c.default)({},h,r));const f=this.isNew()?"create":s.patch?"patch":"update";"patch"!==f||s.attrs||(s.attrs=r);const m=this.sync(f,this,s);return this.attributes=h,i?a:m},destroy:function(e){e=e?(0,o.default)(e):{};const t=this,s=e.success,r=e.wait,i=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(n){r&&i(),s&&s.call(e.context,t,n,e),t.isNew()||t.trigger("sync",t,n,e)};let l=!1;return this.isNew()?(0,a.default)(e.success):((0,n.wrapError)(this,e),l=this.sync("delete",this,e)),r||i(),l},url:function(){const e=(0,_.default)(this,"urlRoot")||(0,_.default)(this.collection,"url")||(0,n.urlError)();if(this.isNew())return e;const t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},(0,c.default)({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=(0,c.default)({},this.attributes,e);const s=this.validationError=this.validate(e,t)||null;return!s||(this.trigger("invalid",this,s,(0,c.default)(t,{validationError:s})),!1)}})},"./node_modules/@converse/skeletor/src/router.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Router:()=>d});var n=s("./node_modules/@converse/skeletor/src/history.js"),r=s("./node_modules/lodash-es/isFunction.js"),o=s("./node_modules/lodash-es/isRegExp.js"),i=s("./node_modules/lodash-es/keys.js"),a=s("./node_modules/lodash-es/result.js"),l=s("./node_modules/@converse/skeletor/src/events.js"),c=s("./node_modules/@converse/skeletor/src/helpers.js");const d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.history=e.history||new n.default,this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};d.extend=c.inherits;const u=/\((.*?)\)/g,h=/(\(\?)?:\w+/g,f=/\*\w+/g,m=/[\-{}\[\]+?.,\\\^$|#\s]/g;Object.assign(d.prototype,l.Events,{preinitialize:function(){},initialize:function(){},route:function(e,t,s){return(0,o.default)(e)||(e=this._routeToRegExp(e)),(0,r.default)(t)&&(s=t,t=""),s||(s=this[t]),this.history.route(e,(n=>{const r=this._extractParameters(e,n);!1!==this.execute(s,r,t)&&(this.trigger.apply(this,["route:"+t].concat(r)),this.trigger("route",t,r),this.history.trigger("route",this,t,r))})),this},execute:function(e,t,s){e&&e.apply(this,t)},navigate:function(e,t){return this.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;let e;this.routes=(0,a.default)(this,"routes");const t=(0,i.default)(this.routes);for(;null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(m,"\\$&").replace(u,"(?:$1)?").replace(h,(function(e,t){return t?e:"([^/?]+)"})).replace(f,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){const s=e.exec(t).slice(1);return s.map((function(e,t){return t===s.length-1?e||null:e?decodeURIComponent(e):null}))}})},"./node_modules/@converse/skeletor/src/storage.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var n=s("./node_modules/localforage-driver-memory/_bundle/umd.js"),r=s("./node_modules/lodash-es/cloneDeep.js"),o=s("./node_modules/lodash-es/isString.js"),i=s("./node_modules/localforage/src/localforage.js"),a=s("./node_modules/mergebounce/mergebounce.js"),l=s("./node_modules/@converse/skeletor/src/drivers/sessionStorage.js"),c=s("./node_modules/localforage-setitems/dist/localforage-setitems.js"),d=s("./node_modules/@converse/localforage-getitems/dist/localforage-getitems.js"),u=s("./node_modules/@converse/skeletor/src/helpers.js");const h=n._driver;i.default.defineDriver(n),(0,c.extendPrototype)(i.default),(0,d.extendPrototype)(i.default);class f{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("local"===t&&!window.localStorage)throw new Error("Skeletor.storage: Environment does not support localStorage.");if("session"===t&&!window.sessionStorage)throw new Error("Skeletor.storage: Environment does not support sessionStorage.");(0,o.default)(t)?this.storeInitialized=this.initStore(t,s):(this.store=t,s&&(this.store.debouncedSetItems=(0,a.default)((e=>this.store.setItems(e)),50,{promise:!0})),this.storeInitialized=Promise.resolve()),this.name=e}async initStore(e,t){if("session"===e)i.default.setDriver(l.default._driver);else if("local"===e)await i.default.config({driver:i.default.LOCALSTORAGE});else if("in_memory"===e)i.default.config({driver:h});else if("indexed"!==e)throw new Error("Skeletor.storage: No storage type was specified");this.store=i.default,t&&(this.store.debouncedSetItems=(0,a.default)((e=>this.store.setItems(e)),50,{promise:!0}))}flush(){return this.store.debouncedSetItems?.flush()}async clear(){await this.store.removeItem(this.name).catch((e=>console.error(e)));const e=new RegExp(`^${this.name}-`),t=(await this.store.keys()).filter((t=>e.test(t)));await Promise.all(t.map((e=>this.store.removeItem(e).catch((e=>console.error(e))))))}sync(){const e=this;async function t(t,s,n){let o,i,a,l;const c=s.collection;["patch","update"].includes(t)&&(l=(0,r.default)(s.attributes)),await e.storeInitialized;try{const r=s.attributes;switch(t){case"read":o=void 0!==s.id?await e.find(s):await e.findAll();break;case"create":o=await e.create(s,n);break;case"patch":case"update":n.wait&&(s.attributes=l),a=e.update(s,n),n.wait&&(s.attributes=r),o=await a;break;case"delete":o=await e.destroy(s,c)}}catch(t){i=22===t.code&&0===e.getStorageSize()?"Private browsing is unsupported":t.message}if(o){if(n&&n.success){const e="read"===t?o:null;n.success(e,n)}}else i=i||"Record Not Found",n&&n.error&&n.error(i)}return t.__name__="localSync",t}removeCollectionReference(e,t){if(!t)return;const s=t.filter((t=>t.id!==e.id)).map((e=>this.getItemName(e.id)));return this.store.setItem(this.name,s)}addCollectionReference(e,t){if(!t)return;const s=t.map((e=>this.getItemName(e.id))),n=this.getItemName(e.id);return s.includes(n)||s.push(n),this.store.setItem(this.name,s)}getCollectionReferenceData(e){if(!e.collection)return{};const t=e.collection.map((e=>this.getItemName(e.id))),s=this.getItemName(e.id);t.includes(s)||t.push(s);const n={};return n[this.name]=t,n}async save(e){if(this.store.setItems){const t={};return t[this.getItemName(e.id)]=e.toJSON(),Object.assign(t,this.getCollectionReferenceData(e)),this.store.debouncedSetItems?this.store.debouncedSetItems(t):this.store.setItems(t)}{const t=this.getItemName(e.id),s=await this.store.setItem(t,e.toJSON());return await this.addCollectionReference(e,e.collection),s}}create(e,t){return e.id||(e.id=(0,u.guid)(),e.set(e.idAttribute,e.id,t)),this.save(e)}update(e){return this.save(e)}find(e){return this.store.getItem(this.getItemName(e.id))}async findAll(){const e=await this.store.getItem(this.name);if(e?.length){const t=await this.store.getItems(e);return Object.values(t)}return[]}async destroy(e,t){return await this.flush(),await this.store.removeItem(this.getItemName(e.id)),await this.removeCollectionReference(e,t),e}getStorageSize(){return this.store.length}getItemName(e){return this.name+"-"+e}}f.sessionStorageInitialized=i.default.defineDriver(l.default),f.localForage=i.default;const m=f},"./node_modules/localforage/src/drivers/indexeddb.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var n=s("./node_modules/localforage/src/utils/isIndexedDBValid.js"),r=s("./node_modules/localforage/src/utils/createBlob.js"),o=s("./node_modules/localforage/src/utils/idb.js"),i=s("./node_modules/localforage/src/utils/promise.js"),a=s("./node_modules/localforage/src/utils/executeCallback.js"),l=s("./node_modules/localforage/src/utils/executeTwoCallbacks.js"),c=s("./node_modules/localforage/src/utils/normalizeKey.js"),d=s("./node_modules/localforage/src/utils/getCallback.js");const u="local-forage-detect-blob-support";let h;const f={},m=Object.prototype.toString,p="readonly",g="readwrite";function _(e){return"boolean"==typeof h?i.default.resolve(h):function(e){return new i.default((function(t){var s=e.transaction(u,g),n=(0,r.default)([""]);s.objectStore(u).put(n,"key"),s.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},s.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);t(s||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return h=e,h}))}function v(e){var t=f[e.name],s={};s.promise=new i.default((function(e,t){s.resolve=e,s.reject=t})),t.deferredOperations.push(s),t.dbReady?t.dbReady=t.dbReady.then((function(){return s.promise})):t.dbReady=s.promise}function y(e){var t=f[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function b(e,t){var s=f[e.name].deferredOperations.pop();if(s)return s.reject(t),s.promise}function j(e,t){return new i.default((function(s,n){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return s(e.db);v(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var i=o.default.open.apply(o.default,r);t&&(i.onupgradeneeded=function(t){var s=i.result;try{s.createObjectStore(e.storeName),t.oldVersion<=1&&s.createObjectStore(u)}catch(s){if("ConstraintError"!==s.name)throw s;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){var t=i.result;t.onversionchange=function(e){e.target.close()},s(t),y(e)}}))}function w(e){return j(e,!1)}function S(e){return j(e,!0)}function x(e,t){if(!e.db)return!0;var s=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||s){if(s){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function E(e){var t=function(e){for(var t=e.length,s=new ArrayBuffer(t),n=new Uint8Array(s),r=0;r<t;r++)n[r]=e.charCodeAt(r);return s}(atob(e.data));return(0,r.default)([t],{type:e.type})}function A(e){return e&&e.__local_forage_encoded_blob}function C(e){var t=this,s=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return(0,l.default)(s,e,e),s}function T(e,t,s,n){void 0===n&&(n=1);try{var r=e.db.transaction(e.storeName,t);s(null,r)}catch(r){if(n>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return i.default.resolve().then((()=>{if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),S(e)})).then((()=>function(e){v(e);for(var t=f[e.name],s=t.forages,n=0;n<s.length;n++){const e=s[n];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return e.db=null,w(e).then((t=>(e.db=t,x(e)?S(e):t))).then((n=>{e.db=t.db=n;for(var r=0;r<s.length;r++)s[r]._dbInfo.db=n})).catch((t=>{throw b(e,t),t}))}(e).then((function(){T(e,t,s,n-1)})))).catch(s);s(r)}}var I={_driver:"asyncStorage",_initStorage:function(e){var t=this,s={db:null};if(e)for(var n in e)s[n]=e[n];var r=f[s.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},f[s.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=C);var o=[];function a(){return i.default.resolve()}for(var l=0;l<r.forages.length;l++){var c=r.forages[l];c!==t&&o.push(c._initReady().catch(a))}var d=r.forages.slice(0);return i.default.all(o).then((function(){return s.db=r.db,w(s)})).then((function(e){return s.db=e,x(s,t._defaultConfig.version)?S(s):e})).then((function(e){s.db=r.db=e,t._dbInfo=s;for(var n=0;n<d.length;n++){var o=d[n];o!==t&&(o._dbInfo.db=s.db,o._dbInfo.version=s.version)}}))},_support:(0,n.default)(),iterate:function(e,t){var s=this,n=new i.default((function(t,n){s.ready().then((function(){T(s._dbInfo,p,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).openCursor(),a=1;i.onsuccess=function(){var s=i.result;if(s){var n=s.value;A(n)&&(n=E(n));var r=e(n,s.key,a++);void 0!==r?t(r):s.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return(0,a.default)(n,t),n},getItem:function(e,t){var s=this;e=(0,c.default)(e);var n=new i.default((function(t,n){s.ready().then((function(){T(s._dbInfo,p,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),A(e)&&(e=E(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return(0,a.default)(n,t),n},setItem:function(e,t,s){var n=this;e=(0,c.default)(e);var r=new i.default((function(s,r){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===m.call(t)?_(o.db).then((function(e){return e?t:(s=t,new i.default((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:s.type})},n.readAsBinaryString(s)})));var s})):t})).then((function(t){T(n._dbInfo,g,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),s(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return(0,a.default)(r,s),r},removeItem:function(e,t){var s=this;e=(0,c.default)(e);var n=new i.default((function(t,n){s.ready().then((function(){T(s._dbInfo,g,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return(0,a.default)(n,t),n},clear:function(e){var t=this,s=new i.default((function(e,s){t.ready().then((function(){T(t._dbInfo,g,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;s(e)}}catch(e){s(e)}}))})).catch(s)}));return(0,a.default)(s,e),s},length:function(e){var t=this,s=new i.default((function(e,s){t.ready().then((function(){T(t._dbInfo,p,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return(0,a.default)(s,e),s},key:function(e,t){var s=this,n=new i.default((function(t,n){e<0?t(null):s.ready().then((function(){T(s._dbInfo,p,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName),a=!1,l=i.openKeyCursor();l.onsuccess=function(){var s=l.result;s?0===e||a?t(s.key):(a=!0,s.advance(e)):t(null)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return(0,a.default)(n,t),n},keys:function(e){var t=this,s=new i.default((function(e,s){t.ready().then((function(){T(t._dbInfo,p,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return(0,a.default)(s,e),s},dropInstance:function(e,t){t=d.default.apply(this,arguments);var s,n=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName),e.name){const t=e.name===n.name&&this._dbInfo.db?i.default.resolve(this._dbInfo.db):w(e).then((t=>{const s=f[e.name],n=s.forages;s.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}));s=e.storeName?t.then((t=>{if(!t.objectStoreNames.contains(e.storeName))return;const s=t.version+1;v(e);const n=f[e.name],r=n.forages;t.close();for(let e=0;e<r.length;e++){const t=r[e];t._dbInfo.db=null,t._dbInfo.version=s}const a=new i.default(((t,n)=>{const r=o.default.open(e.name,s);r.onerror=e=>{r.result.close(),n(e)},r.onupgradeneeded=()=>{r.result.deleteObjectStore(e.storeName)},r.onsuccess=()=>{const e=r.result;e.close(),t(e)}}));return a.then((e=>{n.db=e;for(let t=0;t<r.length;t++){const s=r[t];s._dbInfo.db=e,y(s._dbInfo)}})).catch((t=>{throw(b(e,t)||i.default.resolve()).catch((()=>{})),t}))})):t.then((t=>{v(e);const s=f[e.name],n=s.forages;t.close();for(var r=0;r<n.length;r++){n[r]._dbInfo.db=null}const a=new i.default(((t,s)=>{var n=o.default.deleteDatabase(e.name);n.onerror=()=>{const e=n.result;e&&e.close(),s(n.error)},n.onblocked=()=>{console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=()=>{const e=n.result;e&&e.close(),t(e)}}));return a.then((e=>{s.db=e;for(var t=0;t<n.length;t++){y(n[t]._dbInfo)}})).catch((t=>{throw(b(e,t)||i.default.resolve()).catch((()=>{})),t}))}))}else s=i.default.reject("Invalid arguments");return(0,a.default)(s,t),s}};const k=I},"./node_modules/localforage/src/drivers/localstorage.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s("./node_modules/localforage/src/utils/isLocalStorageValid.js"),r=s("./node_modules/localforage/src/utils/serializer.js"),o=s("./node_modules/localforage/src/utils/promise.js"),i=s("./node_modules/localforage/src/utils/executeCallback.js"),a=s("./node_modules/localforage/src/utils/normalizeKey.js"),l=s("./node_modules/localforage/src/utils/getCallback.js");function c(e,t){var s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}function d(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0}var u={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var s in e)t[s]=e[s];return t.keyPrefix=c(e,this._defaultConfig),d()?(this._dbInfo=t,t.serializer=r.default,o.default.resolve()):o.default.reject()},_support:(0,n.default)(),iterate:function(e,t){var s=this,n=s.ready().then((function(){for(var t=s._dbInfo,n=t.keyPrefix,r=n.length,o=localStorage.length,i=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(n)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(r),i++)))return c}}}));return(0,i.default)(n,t),n},getItem:function(e,t){var s=this;e=(0,a.default)(e);var n=s.ready().then((function(){var t=s._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return(0,i.default)(n,t),n},setItem:function(e,t,s){var n=this;e=(0,a.default)(e);var r=n.ready().then((function(){void 0===t&&(t=null);var s=t;return new o.default((function(r,o){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(i.keyPrefix+e,t),r(s)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return(0,i.default)(r,s),r},removeItem:function(e,t){var s=this;e=(0,a.default)(e);var n=s.ready().then((function(){var t=s._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return(0,i.default)(n,t),n},clear:function(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var n=localStorage.key(s);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return(0,i.default)(s,e),s},length:function(e){var t=this.keys().then((function(e){return e.length}));return(0,i.default)(t,e),t},key:function(e,t){var s=this,n=s.ready().then((function(){var t,n=s._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return(0,i.default)(n,t),n},keys:function(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo,s=localStorage.length,n=[],r=0;r<s;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return(0,i.default)(s,e),s},dropInstance:function(e,t){if(t=l.default.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var s=this.config();e.name=e.name||s.name,e.storeName=e.storeName||s.storeName}var n,r=this;return n=e.name?new o.default((function(t){e.storeName?t(c(e,r._defaultConfig)):t(`${e.name}/`)})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var s=localStorage.key(t);0===s.indexOf(e)&&localStorage.removeItem(s)}})):o.default.reject("Invalid arguments"),(0,i.default)(n,t),n}};const h=u},"./node_modules/localforage/src/drivers/websql.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./node_modules/localforage/src/utils/isWebSQLValid.js"),r=s("./node_modules/localforage/src/utils/serializer.js"),o=s("./node_modules/localforage/src/utils/promise.js"),i=s("./node_modules/localforage/src/utils/executeCallback.js"),a=s("./node_modules/localforage/src/utils/normalizeKey.js"),l=s("./node_modules/localforage/src/utils/getCallback.js");function c(e,t,s,n){e.executeSql(`CREATE TABLE IF NOT EXISTS ${t.storeName} (id INTEGER PRIMARY KEY, key unique, value)`,[],s,n)}function d(e,t,s,n,r,o){e.executeSql(s,n,r,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,i):c(e,t,(function(){e.executeSql(s,n,r,o)}),o)}),o):o(e,i)}),o)}function u(e,t,s,n){var r=this;e=(0,a.default)(e);var l=new o.default((function(o,i){r.ready().then((function(){void 0===t&&(t=null);var a=t,l=r._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(s){d(s,l,`INSERT OR REPLACE INTO ${l.storeName} (key, value) VALUES (?, ?)`,[e,t],(function(){o(a)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(u.apply(r,[e,a,s,n-1]));i(t)}}))}))})).catch(i)}));return(0,i.default)(l,s),l}var h={_driver:"webSQLStorage",_initStorage:function(e){var t=this,s={db:null};if(e)for(var n in e)s[n]="string"!=typeof e[n]?e[n].toString():e[n];var i=new o.default((function(e,n){try{s.db=openDatabase(s.name,String(s.version),s.description,s.size)}catch(e){return n(e)}s.db.transaction((function(r){c(r,s,(function(){t._dbInfo=s,e()}),(function(e,t){n(t)}))}),n)}));return s.serializer=r.default,i},_support:(0,n.default)(),iterate:function(e,t){var s=this,n=new o.default((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){d(s,r,`SELECT * FROM ${r.storeName}`,[],(function(s,n){for(var o=n.rows,i=o.length,a=0;a<i;a++){var l=o.item(a),c=l.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return(0,i.default)(n,t),n},getItem:function(e,t){var s=this;e=(0,a.default)(e);var n=new o.default((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){d(s,r,`SELECT * FROM ${r.storeName} WHERE key = ? LIMIT 1`,[e],(function(e,s){var n=s.rows.length?s.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return(0,i.default)(n,t),n},setItem:function(e,t,s){return u.apply(this,[e,t,s,1])},removeItem:function(e,t){var s=this;e=(0,a.default)(e);var n=new o.default((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){d(s,r,`DELETE FROM ${r.storeName} WHERE key = ?`,[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return(0,i.default)(n,t),n},clear:function(e){var t=this,s=new o.default((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){d(t,n,`DELETE FROM ${n.storeName}`,[],(function(){e()}),(function(e,t){s(t)}))}))})).catch(s)}));return(0,i.default)(s,e),s},length:function(e){var t=this,s=new o.default((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){d(t,n,`SELECT COUNT(key) as c FROM ${n.storeName}`,[],(function(t,s){var n=s.rows.item(0).c;e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return(0,i.default)(s,e),s},key:function(e,t){var s=this,n=new o.default((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){d(s,r,`SELECT key FROM ${r.storeName} WHERE id = ? LIMIT 1`,[e+1],(function(e,s){var n=s.rows.length?s.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return(0,i.default)(n,t),n},keys:function(e){var t=this,s=new o.default((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){d(t,n,`SELECT key FROM ${n.storeName}`,[],(function(t,s){for(var n=[],r=0;r<s.rows.length;r++)n.push(s.rows.item(r).key);e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return(0,i.default)(s,e),s},dropInstance:function(e,t){t=l.default.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;return n=e.name?new o.default((function(t){var n;n=e.name===s.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(function(e){return new o.default((function(t,s){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(s,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).name);t({db:e,storeNames:r})}),(function(e,t){s(t)}))}),(function(e){s(e)}))}))}(n))})).then((function(e){return new o.default((function(t,s){e.db.transaction((function(n){function r(e){return new o.default((function(t,s){n.executeSql(`DROP TABLE IF EXISTS ${e}`,[],(function(){t()}),(function(e,t){s(t)}))}))}for(var i=[],a=0,l=e.storeNames.length;a<l;a++)i.push(r(e.storeNames[a]));o.default.all(i).then((function(){t()})).catch((function(e){s(e)}))}),(function(e){s(e)}))}))})):o.default.reject("Invalid arguments"),(0,i.default)(n,t),n}};const f=h},"./node_modules/localforage/src/localforage.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var n=s("./node_modules/localforage/src/drivers/indexeddb.js"),r=s("./node_modules/localforage/src/drivers/websql.js"),o=s("./node_modules/localforage/src/drivers/localstorage.js"),i=s("./node_modules/localforage/src/utils/serializer.js"),a=s("./node_modules/localforage/src/utils/promise.js"),l=s("./node_modules/localforage/src/utils/executeCallback.js"),c=s("./node_modules/localforage/src/utils/executeTwoCallbacks.js"),d=s("./node_modules/localforage/src/utils/includes.js"),u=s("./node_modules/localforage/src/utils/isArray.js");const h={},f={},m={INDEXEDDB:n.default,WEBSQL:r.default,LOCALSTORAGE:o.default},p=[m.INDEXEDDB._driver,m.WEBSQL._driver,m.LOCALSTORAGE._driver],g=["dropInstance"],_=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(g),v={description:"",driver:p.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function y(e,t){e[t]=function(){const s=arguments;return e.ready().then((function(){return e[t].apply(e,s)}))}}function b(){for(let e=1;e<arguments.length;e++){const t=arguments[e];if(t)for(let e in t)t.hasOwnProperty(e)&&((0,u.default)(t[e])?arguments[0][e]=t[e].slice():arguments[0][e]=t[e])}return arguments[0]}class j{constructor(e){for(let e in m)if(m.hasOwnProperty(e)){const t=m[e],s=t._driver;this[e]=s,h[s]||this.defineDriver(t)}this._defaultConfig=b({},v),this._config=b({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((()=>{}))}config(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(let t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config}defineDriver(e,t,s){const n=new a.default((function(t,s){try{const n=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void s(r);const o=_.concat("_initStorage");for(let t=0,n=o.length;t<n;t++){const n=o[t];if((!(0,d.default)(g,n)||e[n])&&"function"!=typeof e[n])return void s(r)}const i=function(){const t=function(e){return function(){const t=new Error(`Method ${e} is not implemented by the current driver`),s=a.default.reject(t);return(0,l.default)(s,arguments[arguments.length-1]),s}};for(let s=0,n=g.length;s<n;s++){const n=g[s];e[n]||(e[n]=t(n))}};i();const c=function(s){h[n]&&console.info(`Redefining LocalForage driver: ${n}`),h[n]=e,f[n]=s,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(c,s):c(!!e._support):c(!0)}catch(e){s(e)}}));return(0,c.default)(n,t,s),n}driver(){return this._driver||null}getDriver(e,t,s){const n=h[e]?a.default.resolve(h[e]):a.default.reject(new Error("Driver not found."));return(0,c.default)(n,t,s),n}getSerializer(e){const t=a.default.resolve(i.default);return(0,c.default)(t,e),t}ready(e){const t=this,s=t._driverSet.then((()=>(null===t._ready&&(t._ready=t._initDriver()),t._ready)));return(0,c.default)(s,e,e),s}setDriver(e,t,s){const n=this;(0,u.default)(e)||(e=[e]);const r=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function i(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}const l=null!==this._driverSet?this._driverSet.catch((()=>a.default.resolve())):a.default.resolve();return this._driverSet=l.then((()=>{const e=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((e=>{n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){let t=0;return function s(){for(;t<e.length;){let r=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(i).catch(s)}o();const r=new Error("No available storage method found.");return n._driverSet=a.default.reject(r),n._driverSet}()}}(r)}))})).catch((()=>{o();const e=new Error("No available storage method found.");return n._driverSet=a.default.reject(e),n._driverSet})),(0,c.default)(this._driverSet,t,s),this._driverSet}supports(e){return!!f[e]}_extend(e){b(this,e)}_getSupportedDrivers(e){const t=[];for(let s=0,n=e.length;s<n;s++){const n=e[s];this.supports(n)&&t.push(n)}return t}_wrapLibraryMethodsWithReady(){for(let e=0,t=_.length;e<t;e++)y(this,_[e])}createInstance(e){return new j(e)}}const w=new j},"./node_modules/localforage/src/utils/createBlob.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}}},"./node_modules/localforage/src/utils/executeCallback.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}},"./node_modules/localforage/src/utils/executeTwoCallbacks.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){"function"==typeof t&&e.then(t),"function"==typeof s&&e.catch(s)}},"./node_modules/localforage/src/utils/getCallback.js":(e,t,s)=>{"use strict";function n(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}s.r(t),s.d(t,{default:()=>n})},"./node_modules/localforage/src/utils/idb.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}()},"./node_modules/localforage/src/utils/includes.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(e,t)=>{const s=e.length;let n=0;for(;n<s;){if((r=e[n])===(o=t)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;n++}var r,o;return!1}},"./node_modules/localforage/src/utils/isArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"./node_modules/localforage/src/utils/isIndexedDBValid.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/localforage/src/utils/idb.js");const r=function(){try{if(!n.default||!n.default.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}},"./node_modules/localforage/src/utils/isLocalStorageValid.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}},"./node_modules/localforage/src/utils/isWebSQLValid.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){return"function"==typeof openDatabase}},"./node_modules/localforage/src/utils/normalizeKey.js":(e,t,s)=>{"use strict";function n(e){return"string"!=typeof e&&(console.warn(`${e} used as a key, but it is not a string.`),e=String(e)),e}s.r(t),s.d(t,{default:()=>n})},"./node_modules/localforage/src/utils/promise.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n}),"undefined"==typeof Promise&&s("./node_modules/lie/polyfill.js");const n=Promise},"./node_modules/localforage/src/utils/serializer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var n=s("./node_modules/localforage/src/utils/createBlob.js"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=/^~~local_forage_type~([^~]+)~/,i="__lfsc__:",a="arbf",l="blob",c="si08",d="ui08",u="uic8",h="si16",f="si32",m="ur16",p="ui32",g="fl32",_="fl64",v=Object.prototype.toString;function y(e){var t,s,n,o,i,a=.75*e.length,l=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var d=new ArrayBuffer(a),u=new Uint8Array(d);for(t=0;t<l;t+=4)s=r.indexOf(e[t]),n=r.indexOf(e[t+1]),o=r.indexOf(e[t+2]),i=r.indexOf(e[t+3]),u[c++]=s<<2|n>>4,u[c++]=(15&n)<<4|o>>2,u[c++]=(3&o)<<6|63&i;return d}function b(e){var t,s=new Uint8Array(e),n="";for(t=0;t<s.length;t+=3)n+=r[s[t]>>2],n+=r[(3&s[t])<<4|s[t+1]>>4],n+=r[(15&s[t+1])<<2|s[t+2]>>6],n+=r[63&s[t+2]];return s.length%3==2?n=n.substring(0,n.length-1)+"=":s.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}const j={serialize:function(e,t){var s="";if(e&&(s=v.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===v.call(e.buffer))){var n,r=i;e instanceof ArrayBuffer?(n=e,r+=a):(n=e.buffer,"[object Int8Array]"===s?r+=c:"[object Uint8Array]"===s?r+=d:"[object Uint8ClampedArray]"===s?r+=u:"[object Int16Array]"===s?r+=h:"[object Uint16Array]"===s?r+=m:"[object Int32Array]"===s?r+=f:"[object Uint32Array]"===s?r+=p:"[object Float32Array]"===s?r+=g:"[object Float64Array]"===s?r+=_:t(new Error("Failed to get type for BinaryArray"))),t(r+b(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s="~~local_forage_type~"+e.type+"~"+b(this.result);t(i+l+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}},deserialize:function(e){if(e.substring(0,9)!==i)return JSON.parse(e);var t,s=e.substring(13),r=e.substring(9,13);if(r===l&&o.test(s)){var v=s.match(o);t=v[1],s=s.substring(v[0].length)}var b=y(s);switch(r){case a:return b;case l:return(0,n.default)([b],{type:t});case c:return new Int8Array(b);case d:return new Uint8Array(b);case u:return new Uint8ClampedArray(b);case h:return new Int16Array(b);case m:return new Uint16Array(b);case f:return new Int32Array(b);case p:return new Uint32Array(b);case g:return new Float32Array(b);case _:return new Float64Array(b);default:throw new Error("Unkown type: "+r)}},stringToBuffer:y,bufferToString:b}},"./node_modules/mergebounce/mergebounce.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/isObject.js"),r=s("./node_modules/lodash-es/merge.js"),o=s("./node_modules/lodash-es/mergeWith.js"),i=s("./node_modules/lodash-es/now.js"),a=s("./node_modules/lodash-es/toNumber.js"),l=s("./node_modules/@converse/openpromise/openpromise.js");const c=Math.max,d=Math.min;const u=function(e,t){let s,u,h,f,m,p,g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=0,v=!1,y=g.promise?(0,l.getOpenPromise)():null;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){const n=s,r=u,o=y;return s=u=void 0,_=t,f=e.apply(r,n),g.promise&&(o.resolve(f),y=(0,l.getOpenPromise)()),g.promise?o:f}function j(e){const s=e-p;return void 0===p||s>=t||s<0||v&&e-_>=h}function w(){const e=(0,i.default)();if(j(e))return S(e);m=setTimeout(w,function(e){const s=t-(e-p);return v?d(s,h-(e-_)):s}(e))}function S(e){return m=void 0,s?b(e):(s=u=void 0,g.promise?y:f)}function x(e,t){if(Array.isArray(e)&&Array.isArray(t))return g?.dedupeArrays?e.concat(t.filter((t=>-1===e.indexOf(t)))):e.concat(t)}function E(){const e=(0,i.default)(),n=j(e);var a;if(a=Array.from(arguments),s=s?.length?a.length?g?.concatArrays||g?.dedupeArrays?(0,o.default)(s,a,x):(0,r.default)(s,a):s:a||[],u=this,p=e,n){if(void 0===m)return function(e){return _=e,m=setTimeout(w,t),g.promise?y:f}(p);if(v)return clearTimeout(m),m=setTimeout(w,t),b(p)}return void 0===m&&(m=setTimeout(w,t)),g.promise?y:f}return t=(0,a.default)(t)||0,(0,n.default)(g)&&(v="maxWait"in g,h=v?c((0,a.default)(g.maxWait)||0,t):h),E.cancel=function(){void 0!==m&&clearTimeout(m),_=0,s=p=u=m=void 0},E.flush=function(){return void 0===m?f:S((0,i.default)())},E}},"./node_modules/pluggable.js/src/pluggable.js":(e,t,s)=>{"use strict";function n(e,t,s,n){"function"==typeof s&&(void 0===this.__super__&&(this.__super__=n),this.__super__[e]=s.bind(this));for(var r=arguments.length,o=new Array(r>4?r-4:0),i=4;i<r;i++)o[i-4]=arguments[i];return t.apply(this,o)}s.r(t),s.d(t,{default:()=>i,enable:()=>o});class r{constructor(e,t){this.name=t,this.plugged=e,void 0===this.plugged.__super__?this.plugged.__super__={}:"string"==typeof this.plugged.__super__&&(this.plugged.__super__={__string__:this.plugged.__super__}),this.plugged.__super__[t]=this.plugged,this.plugins={},this.initialized_plugins=[]}_overrideAttribute(e,t){const s=t.overrides[e];if("function"==typeof s){const t={};t[this.name]=this.plugged;const r=this.plugged[e];this.plugged[e]=function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.apply(this,[e,s,r,t,...i])}}else this.plugged[e]=s}_extendObject(e,t){e.prototype.__super__||(e.prototype.__super__={},e.prototype.__super__[this.name]=this.plugged);for(const[s,r]of Object.entries(t))if("events"===s)e.prototype[s]=Object.assign(r,e.prototype[s]);else if("function"==typeof r){const t={};t[this.name]=this.plugged;const o=e.prototype[s];e.prototype[s]=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n.apply(this,[s,r,o,t,...i])}}else e.prototype[s]=r}loadPluginDependencies(e){e.dependencies?.forEach((t=>{const s=this.plugins[t];if(s){if(s.dependencies?.includes(e.__name__))throw'Found a circular dependency between the plugins "'+e.__name__+'" and "'+t+'"';this.initializePlugin(s)}else this.throwUndefinedDependencyError('Could not find dependency "'+t+'" for the plugin "'+e.__name__+"\". If it's needed, make sure it's loaded by require.js")}))}throwUndefinedDependencyError(e){if(this.plugged.strict_plugin_dependencies)throw e;console.warn?console.warn(e):console.log(e)}applyOverrides(e){Object.keys(e.overrides||{}).forEach((t=>{const s=e.overrides[t];"object"==typeof s?void 0===this.plugged[t]?this.throwUndefinedDependencyError(`Plugin "${e.__name__}" tried to override "${t}" but it's not found.`):this._extendObject(this.plugged[t],s):this._overrideAttribute(t,e)}))}initializePlugin(e){Object.keys(this.allowed_plugins).includes(e.__name__)&&(this.initialized_plugins.includes(e.__name__)||("boolean"==typeof e.enabled&&e.enabled||e.enabled?.(this.plugged)||null==e.enabled)&&(Object.assign(e,this.properties),e.dependencies&&this.loadPluginDependencies(e),this.applyOverrides(e),"function"==typeof e.initialize&&e.initialize.bind(e)(this),this.initialized_plugins.push(e.__name__)))}registerPlugin(e,t){if(e in this.plugins)throw new Error("Error: Plugin name "+e+" is already taken");t.__name__=e,this.plugins[e]=t}initializePlugins(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Object.keys(this.plugins).length){this.properties=e,this.allowed_plugins={};for(const[e,n]of Object.entries(this.plugins))t.length&&!t.includes(e)||s.includes(e)||(this.allowed_plugins[e]=n);Object.values(this.allowed_plugins).forEach((e=>this.initializePlugin(e)))}}}function o(e,t,s){return void 0===s&&(s="pluginSocket"),void 0===t&&(t="plugged"),e[s]=new r(e,t),e}const i={enable:o}},"./node_modules/sprintf-js/src/sprintf.js":(e,t,s)=>{var n;!function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return function(e,t){var s,n,i,a,l,c,d,u,h,f=1,m=e.length,p="";for(n=0;n<m;n++)if("string"==typeof e[n])p+=e[n];else if("object"==typeof e[n]){if((a=e[n]).keys)for(s=t[f],i=0;i<a.keys.length;i++){if(null==s)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[i],a.keys[i-1]));s=s[a.keys[i]]}else s=a.param_no?t[a.param_no]:t[f++];if(r.not_type.test(a.type)&&r.not_primitive.test(a.type)&&s instanceof Function&&(s=s()),r.numeric_arg.test(a.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(o("[sprintf] expecting number but found %T",s));switch(r.number.test(a.type)&&(u=s>=0),a.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,a.width?parseInt(a.width):0);break;case"e":s=a.precision?parseFloat(s).toExponential(a.precision):parseFloat(s).toExponential();break;case"f":s=a.precision?parseFloat(s).toFixed(a.precision):parseFloat(s);break;case"g":s=a.precision?String(Number(s.toPrecision(a.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=a.precision?s.substring(0,a.precision):s;break;case"t":s=String(!!s),s=a.precision?s.substring(0,a.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=a.precision?s.substring(0,a.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=a.precision?s.substring(0,a.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}r.json.test(a.type)?p+=s:(!r.number.test(a.type)||u&&!a.sign?h="":(h=u?"+":"-",s=s.toString().replace(r.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",d=a.width-(h+s).length,l=a.width&&d>0?c.repeat(d):"",p+=a.align?h+s+l:"0"===c?h+l+s:l+h+s)}return p}(function(e){if(a[e])return a[e];var t,s=e,n=[],o=0;for(;s;){if(null!==(t=r.text.exec(s)))n.push(t[0]);else if(null!==(t=r.modulo.exec(s)))n.push("%");else{if(null===(t=r.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var i=[],l=t[2],c=[];if(null===(c=r.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(i.push(c[1]);""!==(l=l.substring(c[0].length));)if(null!==(c=r.key_access.exec(l)))i.push(c[1]);else{if(null===(c=r.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");i.push(c[1])}t[2]=i}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}s=s.substring(t[0].length)}return a[e]=n}(e),arguments)}function i(e,t){return o.apply(null,[e].concat(t||[]))}var a=Object.create(null);t.sprintf=o,t.vsprintf=i,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=i,void 0===(n=function(){return{sprintf:o,vsprintf:i}}.call(t,s,t,e))||(e.exports=n))}()},"./node_modules/strophe.js/src/bosh.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/core.js"),r=s("./node_modules/strophe.js/src/builder.js");class o{constructor(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.strip=o.prototype.strip??!1,this.lastResponseHeaders=null,this._requests=[]}_buildBody(){const e=(0,r.$build)("body",{rid:this.rid++,xmlns:n.default.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e}_reset(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_connect(e,t,s){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":n.default.NS.BOSH});s&&r.attrs({route:s});const o=this._conn._connect_cb;this._requests.push(new n.default.Request(r.tree(),this._onRequestStateChange.bind(this,o.bind(this._conn)),Number(r.tree().getAttribute("rid")))),this._throttledRequestHandler()}_attach(e,t,s,r,o,i,a){this._conn.jid=e,this.sid=t,this.rid=s,this._conn.connect_callback=r,this._conn.domain=n.default.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=i||this.hold,this.window=a||this.window,this._conn._changeConnectStatus(n.default.Status.ATTACHED,null)}_restore(e,t,s,r,o){const i=JSON.parse(sessionStorage.getItem("strophe-bosh-session"));if(!(null!=i&&i.rid&&i.sid&&i.jid&&(null==e||n.default.getBareJidFromJid(i.jid)===n.default.getBareJidFromJid(e)||null===n.default.getNodeFromJid(e)&&n.default.getDomainFromJid(i.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(i.jid,i.sid,i.rid,t,s,r,o)}_cacheSession(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):sessionStorage.removeItem("strophe-bosh-session")}_connect_cb(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");n.default.error("BOSH-Connection failed: "+t);const s=e.getElementsByTagName("conflict");return null!==t?("remote-stream-error"===t&&s.length>0&&(t="conflict"),this._conn._changeConnectStatus(n.default.Status.CONNFAIL,t)):this._conn._changeConnectStatus(n.default.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(t),n.default.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const s=e.getAttribute("requests");s&&(this.window=parseInt(s,10));const r=e.getAttribute("hold");r&&(this.hold=parseInt(r,10));const o=e.getAttribute("wait");o&&(this.wait=parseInt(o,10));const i=e.getAttribute("inactivity");i&&(this.inactivity=parseInt(i,10))}_disconnect(e){this._sendTerminate(e)}_doDisconnect(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_emptyQueue(){return 0===this._requests.length}_callProtocolErrorHandlers(e){const t=o._getRequestStatus(e),s=this._conn.protocolErrorHandlers.HTTP[t];s&&s.call(this,t)}_hitError(e){this.errors++,n.default.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()}_no_auth_received(e){n.default.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new n.default.Request(t.tree(),this._onRequestStateChange.bind(this,e),Number(t.tree().getAttribute("rid")))),this._throttledRequestHandler()}_onDisconnectTimeout(){this._abortAllRequests()}_abortAllRequests(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}}_onIdle(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(n.default.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const t=this._buildBody();for(let s=0;s<e.length;s++)null!==e[s]&&("restart"===e[s]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":n.default.NS.BOSH}):t.cnode(e[s]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new n.default.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),Number(t.tree().getAttribute("rid")))),this._throttledRequestHandler()}if(this._requests.length>0){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(n.default.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>Math.floor(n.default.TIMEOUT*this.wait)&&(n.default.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(n.default.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}}static _getRequestStatus(e,t){let s;if(4===e.xhr.readyState)try{s=e.xhr.status}catch(e){n.default.error("Caught an error while retrieving a request's status, reqStatus: "+s)}return void 0===s&&(s="number"==typeof t?t:0),s}_onRequestStateChange(e,t){if(n.default.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)return void(t.abort=!1);if(4!==t.xhr.readyState)return;const s=o._getRequestStatus(t);if(this.lastResponseHeaders=t.xhr.getAllResponseHeaders(),this._conn.disconnecting&&s>=400)return this._hitError(s),void this._callProtocolErrorHandlers(t);const r=this._requests[0]===t,i=this._requests[1]===t,a=s>0&&s<500,l=t.sends>this._conn.maxRetries;(a||l)&&(this._removeRequest(t),n.default.debug("request id "+t.id+" should now be removed")),200===s?((i||r&&this._requests.length>0&&this._requests[0].age()>Math.floor(n.default.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(t.rid+1),n.default.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0):0===s||s>=400&&s<600||s>=12e3?(n.default.error("request id "+t.id+"."+t.sends+" error "+s+" happened"),this._hitError(s),this._callProtocolErrorHandlers(t),s>=400&&s<500&&(this._conn._changeConnectStatus(n.default.Status.DISCONNECTING,null),this._conn._doDisconnect())):n.default.error("request id "+t.id+"."+t.sends+" error "+s+" happened"),a||l?l&&!this._conn.connected&&this._conn._changeConnectStatus(n.default.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}_processRequest(e){let t=this._requests[e];const s=o._getRequestStatus(t,-1);if(t.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const r=t.age(),i=!isNaN(r)&&r>Math.floor(n.default.TIMEOUT*this.wait),a=null!==t.dead&&t.timeDead()>Math.floor(n.default.SECONDARY_TIMEOUT*this.wait),l=4===t.xhr.readyState&&(s<1||s>=500);if((i||a||l)&&(a&&n.default.error(`Request ${this._requests[e].id} timed out (secondary), restarting`),t.abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){},this._requests[e]=new n.default.Request(t.xmlData,t.origFunc,t.rid,t.sends),t=this._requests[e]),0===t.xhr.readyState){n.default.debug("request id "+t.id+"."+t.sends+" posting");try{const e=this._conn.options.contentType||"text/xml; charset=utf-8";t.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==t.xhr.setRequestHeader&&t.xhr.setRequestHeader("Content-Type",e),this._conn.options.withCredentials&&(t.xhr.withCredentials=!0)}catch(e){return n.default.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(n.default.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const e=()=>{if(t.date=(new Date).valueOf(),this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.xhr.setRequestHeader(s,e[s])}t.xhr.send(t.data)};if(t.sends>1){const s=1e3*Math.min(Math.floor(n.default.TIMEOUT*this.wait),Math.pow(t.sends,3));setTimeout((function(){e()}),s)}else e();t.sends++,this.strip&&"body"===t.xmlData.nodeName&&t.xmlData.childNodes.length?this._conn.xmlOutput?.(t.xmlData.children[0]):this._conn.xmlOutput?.(t.xmlData),this._conn.rawOutput?.(t.data)}else n.default.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+t.xhr.readyState)}_removeRequest(e){n.default.debug("removing request");for(let t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()}_restartRequest(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)}_reqToData(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}}_sendTerminate(e){n.default.debug("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"}),s=e instanceof r.default?e.tree():e;e&&t.cnode(s);const o=new n.default.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),Number(t.tree().getAttribute("rid")));this._requests.push(o),this._throttledRequestHandler()}_send(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout((()=>this._conn._onIdle()),100)}_sendRestart(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)}_throttledRequestHandler(){this._requests?n.default.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):n.default.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}}const i=o},"./node_modules/strophe.js/src/builder.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{$build:()=>o,$iq:()=>a,$msg:()=>i,$pres:()=>l,default:()=>d});var n=s("./node_modules/strophe.js/src/constants.js"),r=s("./node_modules/strophe.js/src/utils.js");function o(e,t){return new c(e,t)}function i(e){return new c("message",e)}function a(e){return new c("iq",e)}function l(e){return new c("presence",e)}class c{constructor(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=n.NS.CLIENT:t||(t={xmlns:n.NS.CLIENT})),this.nodeTree=(0,r.xmlElement)(e,t),this.node=this.nodeTree}tree(){return this.nodeTree}toString(){return(0,r.serialize)(this.nodeTree)}up(){return this.node=this.node.parentElement,this}root(){return this.node=this.nodeTree,this}attrs(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(null!=e[t]?this.node.setAttribute(t,e[t].toString()):this.node.removeAttribute(t));return this}c(e,t,s){const n=(0,r.xmlElement)(e,t,s);return this.node.appendChild(n),"string"!=typeof s&&"number"!=typeof s&&(this.node=n),this}cnode(e){let t;const s=(0,r.xmlGenerator)();try{t=void 0!==s.importNode}catch(e){t=!1}const n=t?s.importNode(e,!0):(0,r.copyElement)(e);return this.node.appendChild(n),this.node=n,this}t(e){const t=(0,r.xmlTextNode)(e);return this.node.appendChild(t),this}h(e){const t=(0,r.xmlGenerator)().createElement("body");t.innerHTML=e;const s=(0,r.createHtml)(t);for(;s.childNodes.length>0;)this.node.appendChild(s.childNodes[0]);return this}}const d=c},"./node_modules/strophe.js/src/connection.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/strophe.js/src/handler.js"),r=s("./node_modules/strophe.js/src/timed-handler.js"),o=s("./node_modules/strophe.js/src/builder.js"),i=s("./node_modules/strophe.js/src/constants.js"),a=s("./node_modules/strophe.js/src/core.js"),l=s("./node_modules/strophe.js/src/utils.js"),c=s("./node_modules/abab/index.js"),d=s("./node_modules/strophe.js/src/errors.js");const u=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.service=e,this.options=t,this.setProtocol(),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_bind=!1,this.do_session=!1,this.mechanisms={},this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout((()=>this._onIdle()),100),(0,l.addCookies)(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),this.iqFallbackHandler=new n.default((e=>this.send((0,o.$iq)({type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("service-unavailable",{xmlns:a.default.NS.STANZAS}))),null,"iq",["get","set"]);for(const e in a.default._connectionPlugins)if(Object.prototype.hasOwnProperty.call(a.default._connectionPlugins,e)){const t=function(){};t.prototype=a.default._connectionPlugins[e],this[e]=new t,this[e].init(this)}}setProtocol(){const e=this.options.protocol||"";this.options.worker?this._proto=new a.default.WorkerWebsocket(this):0===this.service.indexOf("ws:")||0===this.service.indexOf("wss:")||0===e.indexOf("ws")?this._proto=new a.default.Websocket(this):this._proto=new a.default.Bosh(this)}reset(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0}pause(){this.paused=!0}resume(){this.paused=!1}getUniqueId(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t+""}addProtocolErrorHandler(e,t,s){this.protocolErrorHandlers[e][t]=s}connect(e,t,s,n,r,o,l){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3e3;this.jid=e,this.authzid=a.default.getBareJidFromJid(this.jid),this.authcid=l||a.default.getNodeFromJid(this.jid),this.pass=t,this.scram_keys=null,this.connect_callback=s,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.disconnection_timeout=c,this.domain=a.default.getDomainFromJid(this.jid),this._changeConnectStatus(i.Status.CONNECTING,null),this._proto._connect(n,r,o)}attach(e,t,s,n,r,o,i){if(this._proto instanceof a.default.Bosh)return this._proto._attach(e,t,s,n,r,o,i);throw new d.SessionError('The "attach" method is not available for your connection protocol')}restore(e,t,s,n,r){if(!(this._proto instanceof a.default.Bosh&&this._sessionCachingSupported()))throw new d.SessionError('The "restore" method can only be used with a BOSH connection.');this._sessionCachingSupported()&&this._proto._restore(e,t,s,n,r)}_sessionCachingSupported(){if(this._proto instanceof a.default.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1}xmlInput(e){}xmlOutput(e){}rawInput(e){}rawOutput(e){}nextValidRid(e){}send(e){if(null!==e){if(Array.isArray(e))e.forEach((e=>this._queueData(e instanceof o.default?e.tree():e)));else{const t=e instanceof o.default?e.tree():e;this._queueData(t)}this._proto._send()}}flush(){clearTimeout(this._idleTimeout),this._onIdle()}sendPresence(e,t,s,n){let r=null;const i=e instanceof o.default?e.tree():e;let a=i.getAttribute("id");if(a||(a=this.getUniqueId("sendPresence"),i.setAttribute("id",a)),"function"==typeof t||"function"==typeof s){const e=this.addHandler((e=>{r&&this.deleteTimedHandler(r),"error"===e.getAttribute("type")?s&&s(e):t&&t(e)}),null,"presence",null,a);n&&(r=this.addTimedHandler(n,(()=>(this.deleteHandler(e),s&&s(null),!1))))}return this.send(i),a}sendIQ(e,t,s,n){let r=null;const i=e instanceof o.default?e.tree():e;let a=i.getAttribute("id");if(a||(a=this.getUniqueId("sendIQ"),i.setAttribute("id",a)),"function"==typeof t||"function"==typeof s){const e=this.addHandler((e=>{r&&this.deleteTimedHandler(r);const n=e.getAttribute("type");if("result"===n)t&&t(e);else{if("error"!==n){const e=new Error(`Got bad IQ type of ${n}`);throw e.name="StropheError",e}s&&s(e)}}),null,"iq",["error","result"],a);n&&(r=this.addTimedHandler(n,(()=>(this.deleteHandler(e),s&&s(null),!1))))}return this.send(i),a}_queueData(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)}_sendRestart(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout((()=>this._onIdle()),100)}addTimedHandler(e,t){const s=new a.default.TimedHandler(e,t);return this.addTimeds.push(s),s}deleteTimedHandler(e){this.removeTimeds.push(e)}addHandler(e,t,s,r,o,i,a){const l=new n.default(e,t,s,r,o,i,a);return this.addHandlers.push(l),l}deleteHandler(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)}registerSASLMechanisms(e){this.mechanisms={},(e||[a.default.SASLAnonymous,a.default.SASLExternal,a.default.SASLOAuthBearer,a.default.SASLXOAuth2,a.default.SASLPlain,a.default.SASLSHA1,a.default.SASLSHA256,a.default.SASLSHA384,a.default.SASLSHA512]).forEach((e=>this.registerSASLMechanism(e)))}registerSASLMechanism(e){const t=new e;this.mechanisms[t.mechname]=t}disconnect(e){if(this._changeConnectStatus(i.Status.DISCONNECTING,e),e?a.default.warn("Disconnect was called because: "+e):a.default.info("Disconnect was called"),this.connected){let e=null;this.disconnecting=!0,this.authenticated&&(e=(0,o.$pres)({xmlns:a.default.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(this.disconnection_timeout,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else a.default.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()}_changeConnectStatus(e,t,s){for(const s in a.default._connectionPlugins)if(Object.prototype.hasOwnProperty.call(a.default._connectionPlugins,s)){const n=this[s];if(n.statusChanged)try{n.statusChanged(e,t)}catch(e){a.default.error(`${s} plugin caused an exception changing status: ${e}`)}}if(this.connect_callback)try{this.connect_callback(e,t,s)}catch(e){a.default._handleError(e),a.default.error(`User connection callback caused an exception: ${e}`)}}_doDisconnect(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),a.default.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(i.Status.DISCONNECTED,e),this.connected=!1}_dataRecv(e,t){const s="_reqToData"in this._proto?this._proto._reqToData(e):e;if(null===s)return;for(this.xmlInput!==a.default.Connection.prototype.xmlInput&&(s.nodeName===this._proto.strip&&s.childNodes.length?this.xmlInput(s.childNodes[0]):this.xmlInput(s)),this.rawInput!==a.default.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(a.default.serialize(s)));this.removeHandlers.length>0;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const n=s.getAttribute("type");if(null!==n&&"terminate"===n){if(this.disconnecting)return;let e=s.getAttribute("condition");const t=s.getElementsByTagName("conflict");return null!==e?("remote-stream-error"===e&&t.length>0&&(e="conflict"),this._changeConnectStatus(i.Status.CONNFAIL,e)):this._changeConnectStatus(i.Status.CONNFAIL,a.default.ErrorCondition.UNKNOWN_REASON),void this._doDisconnect(e)}a.default.forEachChild(s,null,(e=>{const t=[];this.handlers=this.handlers.reduce(((s,n)=>{try{!n.isMatch(e)||!this.authenticated&&n.user?s.push(n):(n.run(e)&&s.push(n),t.push(n))}catch(e){a.default.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}return s}),[]),!t.length&&this.iqFallbackHandler.isMatch(e)&&this.iqFallbackHandler.run(e)}))}_connect_cb(e,t,s){let n;a.default.debug("_connect_cb was called"),this.connected=!0;try{n="_reqToData"in this._proto?this._proto._reqToData(e):e}catch(e){if(e.name!==a.default.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(i.Status.CONNFAIL,a.default.ErrorCondition.BAD_FORMAT),this._doDisconnect(a.default.ErrorCondition.BAD_FORMAT)}if(!n)return;this.xmlInput!==a.default.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==a.default.Connection.prototype.rawInput&&(s?this.rawInput(s):this.rawInput(a.default.serialize(n)));if(this._proto._connect_cb(n)===i.Status.CONNFAIL)return;let r;if(r=n.getElementsByTagNameNS?n.getElementsByTagNameNS(a.default.NS.STREAM,"features").length>0:n.getElementsByTagName("stream:features").length>0||n.getElementsByTagName("features").length>0,!r)return void this._proto._no_auth_received(t);const o=Array.from(n.getElementsByTagName("mechanism")).map((e=>this.mechanisms[e.textContent])).filter((e=>e));0!==o.length||0!==n.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(o):this._proto._no_auth_received(t)}sortMechanismsByPriority(e){for(let t=0;t<e.length-1;++t){let s=t;for(let n=t+1;n<e.length;++n)e[n].priority>e[s].priority&&(s=n);if(s!==t){const n=e[t];e[t]=e[s],e[s]=n}}return e}authenticate(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()}_attemptSASLAuth(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let s=0;s<e.length;++s){if(!e[s].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=e[s],this._sasl_mechanism.onStart(this);const n=(0,o.$build)("auth",{xmlns:a.default.NS.SASL,mechanism:this._sasl_mechanism.mechname});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.clientChallenge(this);n.t((0,c.btoa)(e))}this.send(n.tree()),t=!0;break}return t}async _sasl_challenge_cb(e){const t=(0,c.atob)((0,l.getText)(e)),s=await this._sasl_mechanism.onChallenge(this,t),n=(0,o.$build)("response",{xmlns:a.default.NS.SASL});return s&&n.t((0,c.btoa)(s)),this.send(n.tree()),!0}_attemptLegacyAuth(){null===a.default.getNodeFromJid(this.jid)?(this._changeConnectStatus(i.Status.CONNFAIL,a.default.ErrorCondition.MISSING_JID_NODE),this.disconnect(a.default.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(i.Status.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send((0,o.$iq)({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:a.default.NS.AUTH}).c("username",{}).t(a.default.getNodeFromJid(this.jid)).tree()))}_onLegacyAuthIQResult(){const e="string"==typeof this.pass?this.pass:"",t=(0,o.$iq)({type:"set",id:"_auth_2"}).c("query",{xmlns:a.default.NS.AUTH}).c("username",{}).t(a.default.getNodeFromJid(this.jid)).up().c("password").t(e);return a.default.getResourceFromJid(this.jid)||(this.jid=a.default.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(a.default.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1}_sasl_success_cb(e){if(this._sasl_data["server-signature"]){let t;const s=/([a-z]+)=([^,]+)(,|$)/,n=(0,c.atob)((0,l.getText)(e)).match(s);if("v"===n[1]&&(t=n[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}a.default.info("SASL authentication succeeded."),this._sasl_data.keys&&(this.scram_keys=this._sasl_data.keys),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],s=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._onStreamFeaturesAfterSASL(t),!1};return t.push(this._addSysHandler((e=>s(t,e)),null,"stream:features",null,null)),t.push(this._addSysHandler((e=>s(t,e)),a.default.NS.STREAM,"features",null,null)),this._sendRestart(),!1}_onStreamFeaturesAfterSASL(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const s=e.childNodes[t];"bind"===s.nodeName&&(this.do_bind=!0),"session"===s.nodeName&&(this.do_session=!0)}return this.do_bind?(this.options.explicitResourceBinding?this._changeConnectStatus(i.Status.BINDREQUIRED,null):this.bind(),!1):(this._changeConnectStatus(i.Status.AUTHFAIL,null),!1)}bind(){if(!this.do_bind)return void a.default.log(a.default.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=a.default.getResourceFromJid(this.jid);e?this.send((0,o.$iq)({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:a.default.NS.BIND}).c("resource",{}).t(e).tree()):this.send((0,o.$iq)({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:a.default.NS.BIND}).tree())}_onResourceBindResultIQ(e){if("error"===e.getAttribute("type")){a.default.warn("Resource binding failed.");let t;return e.getElementsByTagName("conflict").length>0&&(t=a.default.ErrorCondition.CONFLICT),this._changeConnectStatus(i.Status.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(t.length>0))return a.default.warn("Resource binding failed."),this._changeConnectStatus(i.Status.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");e.length>0&&(this.authenticated=!0,this.jid=(0,l.getText)(e[0]),this.do_session?this._establishSession():this._changeConnectStatus(i.Status.CONNECTED,null))}}_establishSession(){if(!this.do_session)throw new Error(`Strophe.Connection.prototype._establishSession called but apparently ${a.default.NS.SESSION} wasn't advertised by the server`);this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send((0,o.$iq)({type:"set",id:"_session_auth_2"}).c("session",{xmlns:a.default.NS.SESSION}).tree())}_onSessionResultIQ(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(i.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return this.authenticated=!1,a.default.warn("Session creation failed."),this._changeConnectStatus(i.Status.AUTHFAIL,null,e),!1;return!1}_sasl_failure_cb(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(i.Status.AUTHFAIL,null,e),!1}_auth2_cb(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(i.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(i.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1}_addSysTimedHandler(e,t){const s=new r.default(e,t);return s.user=!1,this.addTimeds.push(s),s}_addSysHandler(e,t,s,r,o){const i=new n.default(e,t,s,r,o);return i.user=!1,this.addHandlers.push(i),i}_onDisconnectTimeout(){return a.default.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(i.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1}_onIdle(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);t>=0&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let s=0;s<this.timedHandlers.length;s++){const n=this.timedHandlers[s];if(this.authenticated||!n.user){n.lastCalled+n.period-e<=0?n.run()&&t.push(n):t.push(n)}}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout((()=>this._onIdle()),100))}}},"./node_modules/strophe.js/src/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ElementType:()=>l,ErrorCondition:()=>i,LogLevel:()=>a,NS:()=>n,Status:()=>o,XHTML:()=>r});const n={HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},r={tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"]},o={ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11,ATTACHFAIL:12,RECONNECTING:13},i={BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},a={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},l={NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11}},"./node_modules/strophe.js/src/core.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var n=s("./node_modules/strophe.js/src/utils.js"),r=s("./node_modules/strophe.js/src/builder.js"),o=s("./src/strophe-shims.js"),i=s("./node_modules/strophe.js/src/connection.js"),a=s("./node_modules/strophe.js/src/handler.js"),l=s("./node_modules/strophe.js/src/sasl-anon.js"),c=s("./node_modules/strophe.js/src/sasl-external.js"),d=s("./node_modules/strophe.js/src/sasl.js"),u=s("./node_modules/strophe.js/src/sasl-oauthbearer.js"),h=s("./node_modules/strophe.js/src/sasl-plain.js"),f=s("./node_modules/strophe.js/src/sasl-sha1.js"),m=s("./node_modules/strophe.js/src/sasl-sha256.js"),p=s("./node_modules/strophe.js/src/sasl-sha384.js"),g=s("./node_modules/strophe.js/src/sasl-sha512.js"),_=s("./node_modules/strophe.js/src/sasl-xoauth2.js"),v=s("./node_modules/strophe.js/src/timed-handler.js"),y=s("./node_modules/strophe.js/src/constants.js"),b=s("./node_modules/strophe.js/src/request.js"),j=s("./node_modules/strophe.js/src/bosh.js"),w=s("./node_modules/strophe.js/src/websocket.js"),S=s("./node_modules/strophe.js/src/worker-websocket.js");const x={VERSION:"1.6.1",TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,shims:o,Request:b.default,Bosh:j.default,Websocket:w.default,WorkerWebsocket:S.default,SASLAnonymous:l.default,SASLPlain:h.default,SASLSHA1:f.default,SASLSHA256:m.default,SASLSHA384:p.default,SASLSHA512:g.default,SASLOAuthBearer:u.default,SASLExternal:c.default,SASLXOAuth2:_.default,Builder:r.default,Connection:i.default,ElementType:y.ElementType,ErrorCondition:y.ErrorCondition,Handler:a.default,LogLevel:y.LogLevel,NS:y.NS,SASLMechanism:d.default,Status:y.Status,TimedHandler:v.default,...n,XHTML:{...y.XHTML,validTag:n.validTag,validCSS:n.validCSS,validAttribute:n.validAttribute},addNamespace(e,t){x.NS[e]=t},_handleError(e){void 0!==e.stack&&x.fatal(e.stack),x.fatal("error: "+e.message)},log(e,t){e===this.LogLevel.FATAL&&console?.error(t)},debug(e){this.log(this.LogLevel.DEBUG,e)},info(e){this.log(this.LogLevel.INFO,e)},warn(e){this.log(this.LogLevel.WARN,e)},error(e){this.log(this.LogLevel.ERROR,e)},fatal(e){this.log(this.LogLevel.FATAL,e)},_requestId:0,_connectionPlugins:{},addConnectionPlugin(e,t){x._connectionPlugins[e]=t}},E=x},"./node_modules/strophe.js/src/errors.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{SessionError:()=>n});class n extends Error{constructor(e){super(e),this.name="StropheSessionError"}}},"./node_modules/strophe.js/src/handler.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/strophe.js/src/core.js"),r=s("./node_modules/strophe.js/src/utils.js");const o=class{constructor(e,t,s,n,o,i,a){this.handler=e,this.ns=t,this.name=s,this.type=n,this.id=o,this.options=a||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBareFromJid?this.from=i?(0,r.getBareJidFromJid)(i):null:this.from=i,this.user=!0}getNamespace(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t}namespaceMatch(e){let t=!1;return!this.ns||((0,r.forEachChild)(e,null,(e=>{this.getNamespace(e)===this.ns&&(t=!0)})),t||this.getNamespace(e)===this.ns)}isMatch(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=(0,r.getBareJidFromJid)(t));const s=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!n.default.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(s):s!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)}run(e){let t=null;try{t=this.handler(e)}catch(e){throw n.default._handleError(e),e}return t}toString(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}}},"./node_modules/strophe.js/src/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{$build:()=>r.$build,$iq:()=>r.$iq,$msg:()=>r.$msg,$pres:()=>r.$pres,Strophe:()=>n.default});var n=s("./node_modules/strophe.js/src/core.js"),r=s("./node_modules/strophe.js/src/builder.js");globalThis.$build=r.$build,globalThis.$iq=r.$iq,globalThis.$msg=r.$msg,globalThis.$pres=r.$pres,globalThis.Strophe=n.default},"./node_modules/strophe.js/src/request.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/strophe-shims.js"),r=s("./node_modules/strophe.js/src/core.js");const o=class{constructor(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.id=++r.default._requestId,this.xmlData=e,this.data=r.default.serialize(e),this.origFunc=t,this.func=t,this.rid=s,this.date=NaN,this.sends=n,this.abort=!1,this.dead=null,this.age=()=>this.date?((new Date).valueOf()-this.date.valueOf())/1e3:0,this.timeDead=()=>this.dead?((new Date).valueOf()-this.dead.valueOf())/1e3:0,this.xhr=this._newXHR()}getResponse(){let e=this.xhr.responseXML?.documentElement;if(e){if("parsererror"===e.tagName)throw r.default.error("invalid response received"),r.default.error("responseText: "+this.xhr.responseText),r.default.error("responseXML: "+r.default.serialize(e)),new Error("parsererror")}else if(this.xhr.responseText){r.default.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),e=(new n.DOMParser).parseFromString(this.xhr.responseText,"application/xml").documentElement;const t=e?.querySelector("parsererror");if(!e||t){t&&(r.default.error("invalid response received: "+t.textContent),r.default.error("responseText: "+this.xhr.responseText));const e=new Error;throw e.name=r.default.ErrorCondition.BAD_FORMAT,e}}return e}_newXHR(){const e=new XMLHttpRequest;return e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"),e.onreadystatechange=this.func.bind(null,this),e}}},"./node_modules/strophe.js/src/sasl-anon.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/strophe.js/src/sasl.js");class r extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ANONYMOUS",arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:20)}test(e){return null===e.authcid}}const o=r},"./node_modules/strophe.js/src/sasl-external.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/strophe.js/src/sasl.js");class r extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EXTERNAL",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:10)}onChallenge(e){return e.authcid===e.authzid?"":e.authzid}}const o=r},"./node_modules/strophe.js/src/sasl-oauthbearer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/utils.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"OAUTHBEARER",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:40)}test(e){return null!==e.pass}onChallenge(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",t+="",r.default.utf16to8(t)}}const i=o},"./node_modules/strophe.js/src/sasl-plain.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/utils.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PLAIN",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:50)}test(e){return null!==e.authcid}onChallenge(e){const{authcid:t,authzid:s,domain:n,pass:o}=e;if(!n)throw new Error("SASLPlain onChallenge: domain is not defined!");let i=s!==`${t}@${n}`?s:"";return i+="\0",i+=t,i+="\0",i+=o,r.default.utf16to8(i)}}const i=o},"./node_modules/strophe.js/src/sasl-sha1.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/scram.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-1",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:60)}test(e){return null!==e.authcid}async onChallenge(e,t){return await r.default.scramResponse(e,t,"SHA-1",160)}clientChallenge(e,t){return r.default.clientChallenge(e,t)}}const i=o},"./node_modules/strophe.js/src/sasl-sha256.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/scram.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-256",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:70)}test(e){return null!==e.authcid}async onChallenge(e,t){return await r.default.scramResponse(e,t,"SHA-256",256)}clientChallenge(e,t){return r.default.clientChallenge(e,t)}}const i=o},"./node_modules/strophe.js/src/sasl-sha384.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/scram.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-384",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:71)}test(e){return null!==e.authcid}async onChallenge(e,t){return await r.default.scramResponse(e,t,"SHA-384",384)}clientChallenge(e,t){return r.default.clientChallenge(e,t)}}const i=o},"./node_modules/strophe.js/src/sasl-sha512.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/scram.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-512",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:72)}test(e){return null!==e.authcid}async onChallenge(e,t){return await r.default.scramResponse(e,t,"SHA-512",512)}clientChallenge(e,t){return r.default.clientChallenge(e,t)}}const i=o},"./node_modules/strophe.js/src/sasl-xoauth2.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/strophe.js/src/sasl.js"),r=s("./node_modules/strophe.js/src/utils.js");class o extends n.default{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"X-OAUTH2",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:30)}test(e){return null!==e.pass}onChallenge(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,r.default.utf16to8(t)}}const i=o},"./node_modules/strophe.js/src/sasl.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=class{constructor(e,t,s){this.mechname=e,this.isClientFirst=t,this.priority=s}test(e){return!0}onStart(e){this._connection=e}onChallenge(e,t){throw new Error("You should implement challenge handling!")}clientChallenge(e){if(!this.isClientFirst)throw new Error("clientChallenge should not be called if isClientFirst is false!");return this.onChallenge(e)}onFailure(){this._connection=null}onSuccess(){this._connection=null}}},"./node_modules/strophe.js/src/scram.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/strophe.js/src/utils.js"),r=s("./node_modules/strophe.js/src/core.js");const o={async scramResponse(e,t,s,o){const i=e._sasl_data.cnonce,a=function(e){let t,s,o;const i=/([a-z]+)=([^,]+)(,|$)/;for(;e.match(i);){const r=e.match(i);switch(e=e.replace(r[0],""),r[1]){case"r":t=r[2];break;case"s":s=n.default.base64ToArrayBuf(r[2]);break;case"i":o=parseInt(r[2],10);break;default:return}}if(isNaN(o)||o<4096)r.default.warn("Failing SCRAM authentication because server supplied iteration count < 4096.");else{if(s)return{nonce:t,salt:s,iter:o};r.default.warn("Failing SCRAM authentication because server supplied incorrect salt.")}}(t);if(!a&&a?.nonce.slice(0,i.length)!==i)return r.default.warn("Failing SCRAM authentication because server supplied incorrect nonce."),e._sasl_data={},e._sasl_failure_cb();let l,c;const{pass:d}=e;if("string"==typeof e.pass||e.pass instanceof String){const e=await async function(e,t,s,r,o){const i=await crypto.subtle.deriveBits({name:"PBKDF2",salt:t,iterations:s,hash:{name:r}},await crypto.subtle.importKey("raw",n.default.stringToArrayBuf(e),"PBKDF2",!1,["deriveBits"]),o),a=await crypto.subtle.importKey("raw",i,{name:"HMAC",hash:r},!1,["sign"]);return{ck:await crypto.subtle.sign("HMAC",a,n.default.stringToArrayBuf("Client Key")),sk:await crypto.subtle.sign("HMAC",a,n.default.stringToArrayBuf("Server Key"))}}(d,a.salt,a.iter,s,o);l=e.ck,c=e.sk}else{if(d?.name!==s||d?.salt!==n.default.arrayBufToBase64(a.salt)||d?.iter!==a.iter)return e._sasl_failure_cb();{const{ck:e,sk:t}=d;l=n.default.base64ToArrayBuf(e),c=n.default.base64ToArrayBuf(t)}}const u=e._sasl_data["client-first-message-bare"],h=t,f=`c=biws,r=${a.nonce}`,m=`${u},${h},${f}`,p=await async function(e,t,s){const r=await crypto.subtle.importKey("raw",await crypto.subtle.digest(s,t),{name:"HMAC",hash:s},!1,["sign"]),o=await crypto.subtle.sign("HMAC",r,n.default.stringToArrayBuf(e));return n.default.xorArrayBuffers(t,o)}(m,l,s),g=await async function(e,t,s){const r=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:s},!1,["sign"]);return crypto.subtle.sign("HMAC",r,n.default.stringToArrayBuf(e))}(m,c,s);return e._sasl_data["server-signature"]=n.default.arrayBufToBase64(g),e._sasl_data.keys={name:s,iter:a.iter,salt:n.default.arrayBufToBase64(a.salt),ck:n.default.arrayBufToBase64(l),sk:n.default.arrayBufToBase64(c)},`${f},p=${n.default.arrayBufToBase64(p)}`},clientChallenge(e,t){const s=t||function(){const e=new Uint8Array(16);return n.default.arrayBufToBase64(crypto.getRandomValues(e).buffer)}(),r=`n=${e.authcid},r=${s}`;return e._sasl_data.cnonce=s,e._sasl_data["client-first-message-bare"]=r,`n,,${r}`}}},"./node_modules/strophe.js/src/timed-handler.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=class{constructor(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0}run(){return this.lastCalled=(new Date).getTime(),this.handler()}reset(){this.lastCalled=(new Date).getTime()}toString(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}}},"./node_modules/strophe.js/src/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addCookies:()=>h,arrayBufToBase64:()=>c,base64ToArrayBuf:()=>d,copyElement:()=>w,createHtml:()=>j,default:()=>R,escapeNode:()=>I,forEachChild:()=>A,getBareJidFromJid:()=>$,getDomainFromJid:()=>O,getNodeFromJid:()=>N,getResourceFromJid:()=>M,getText:()=>T,isTagEqual:()=>C,serialize:()=>E,stringToArrayBuf:()=>u,unescapeNode:()=>k,utf16to8:()=>a,validAttribute:()=>y,validCSS:()=>b,validTag:()=>v,xmlElement:()=>_,xmlGenerator:()=>m,xmlHtmlNode:()=>g,xmlTextNode:()=>p,xmlescape:()=>S,xmlunescape:()=>x,xorArrayBuffers:()=>l});var n=s("./node_modules/strophe.js/src/core.js"),r=s("./src/strophe-shims.js"),o=s("./node_modules/strophe.js/src/constants.js"),i=s("./node_modules/strophe.js/src/builder.js");function a(e){let t="";const s=e.length;for(let n=0;n<s;n++){const s=e.charCodeAt(n);s>=0&&s<=127?t+=e.charAt(n):s>2047?(t+=String.fromCharCode(224|s>>12&15),t+=String.fromCharCode(128|s>>6&63),t+=String.fromCharCode(128|s>>0&63)):(t+=String.fromCharCode(192|s>>6&31),t+=String.fromCharCode(128|s>>0&63))}return t}function l(e,t){const s=new Uint8Array(e),n=new Uint8Array(t),r=new Uint8Array(e.byteLength);for(let t=0;t<e.byteLength;t++)r[t]=s[t]^n[t];return r.buffer}function c(e){let t="";const s=new Uint8Array(e),n=s.byteLength;for(let e=0;e<n;e++)t+=String.fromCharCode(s[e]);return btoa(t)}function d(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))?.buffer}function u(e){return(new TextEncoder).encode(e).buffer}function h(e){"undefined"==typeof document&&n.default.log(n.default.LogLevel.ERROR,"addCookies: not adding any cookies, since there's no document object"),e=e||{};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let s="",n="",r="";const o=e[t],i="object"==typeof o,a=escape(unescape(i?o.value:o));i&&(s=o.expires?";expires="+o.expires:"",n=o.domain?";domain="+o.domain:"",r=o.path?";path="+o.path:""),document.cookie=t+"="+a+s+n+r}}let f=null;function m(){return f||(f=r.getDummyXMLDOMDocument()),f}function p(e){return m().createTextNode(e)}function g(e){return(new r.DOMParser).parseFromString(e,"text/xml")}function _(e,t,s){if(!e)return null;const n=m().createElement(e);if(!s||"string"!=typeof s&&"number"!=typeof s){if("string"==typeof t||"number"==typeof t)return n.appendChild(p(t.toString())),n;if(!t)return n}else n.appendChild(p(s.toString()));if(Array.isArray(t))for(const e of t)Array.isArray(e)&&null!=e[0]&&null!=e[1]&&n.setAttribute(e[0],e[1]);else for(const e of Object.keys(t))e&&null!=t[e]&&n.setAttribute(e,t[e].toString());return n}function v(e){for(let t=0;t<o.XHTML.tags.length;t++)if(e===o.XHTML.tags[t])return!0;return!1}function y(e,t){const s=o.XHTML.attributes[e];if(s?.length>0)for(let e=0;e<s.length;e++)if(t===s[e])return!0;return!1}function b(e){for(let t=0;t<o.XHTML.css.length;t++)if(e===o.XHTML.css[t])return!0;return!1}function j(e){if(e.nodeType===o.ElementType.NORMAL)return function(e){let t;const s=e.nodeName.toLowerCase();if(v(s))try{if(t=_(s),s in o.XHTML.attributes){const n=o.XHTML.attributes[s];for(let s=0;s<n.length;s++){const r=n[s];let o=e.getAttribute(r);if(null!=o&&""!==o)if("style"===r&&"object"==typeof o&&(o=o.cssText??o),"style"===r){const e=[],s=o.split(";");for(let t=0;t<s.length;t++){const n=s[t].split(":"),r=n[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(b(r)){const t=n[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(r+": "+t)}}e.length>0&&(o=e.join("; "),t.setAttribute(r,o))}else t.setAttribute(r,o)}for(let s=0;s<e.childNodes.length;s++)t.appendChild(j(e.childNodes[s]))}}catch(e){t=p("")}else{t=m().createDocumentFragment();for(let s=0;s<e.childNodes.length;s++)t.appendChild(j(e.childNodes[s]))}return t}(e);if(e.nodeType===o.ElementType.FRAGMENT){const t=m().createDocumentFragment();for(let s=0;s<e.childNodes.length;s++)t.appendChild(j(e.childNodes[s]));return t}return e.nodeType===o.ElementType.TEXT?p(e.nodeValue):void 0}function w(e){let t;if(e.nodeType===o.ElementType.NORMAL){const s=e;t=_(s.tagName);for(let e=0;e<s.attributes.length;e++)t.setAttribute(s.attributes[e].nodeName,s.attributes[e].value);for(let e=0;e<s.childNodes.length;e++)t.appendChild(w(s.childNodes[e]))}else e.nodeType===o.ElementType.TEXT&&(t=m().createTextNode(e.nodeValue));return t}function S(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")}function x(e){return e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')}function E(e){if(!e)return null;const t=e instanceof i.default?e.tree():e,s=[...Array(t.attributes.length).keys()].map((e=>t.attributes[e].nodeName));s.sort();let n=s.reduce(((e,s)=>`${e} ${s}="${S(t.attributes.getNamedItem(s).value)}"`),`<${t.nodeName}`);if(t.childNodes.length>0){n+=">";for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];switch(s.nodeType){case o.ElementType.NORMAL:n+=E(s);break;case o.ElementType.TEXT:n+=S(s.nodeValue);break;case o.ElementType.CDATA:n+="<![CDATA["+s.nodeValue+"]]>"}}n+="</"+t.nodeName+">"}else n+="/>";return n}function A(e,t,s){for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n];r.nodeType!==o.ElementType.NORMAL||t&&!this.isTagEqual(r,t)||s(r)}}function C(e,t){return e.tagName===t}function T(e){if(!e)return null;let t="";e.childNodes?.length||e.nodeType!==o.ElementType.TEXT||(t+=e.nodeValue);for(let s=0;s<e.childNodes?.length;s++)e.childNodes[s].nodeType===o.ElementType.TEXT&&(t+=e.childNodes[s].nodeValue);return S(t)}function I(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")}function k(e){return"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")}function N(e){return e.indexOf("@")<0?null:e.split("@")[0]}function O(e){const t=$(e);if(t.indexOf("@")<0)return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}}function M(e){if(!e)return null;const t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))}function $(e){return e?e.split("/")[0]:null}const R={utf16to8:a,xorArrayBuffers:l,arrayBufToBase64:c,base64ToArrayBuf:d,stringToArrayBuf:u,addCookies:h}},"./node_modules/strophe.js/src/websocket.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/strophe-shims.js"),r=s("./node_modules/strophe.js/src/builder.js"),o=s("./node_modules/strophe.js/src/core.js");const i=class{constructor(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let s="";"ws"===e.options.protocol&&"https:"!==location.protocol?s+="ws":s+="wss",s+="://"+location.host,0!==t.indexOf("/")?s+=location.pathname+t:s+=t,e.service=s}}_buildStream(){return(0,r.$build)("open",{xmlns:o.default.NS.FRAMING,to:this._conn.domain,version:"1.0"})}_checkStreamError(e,t){let s;if(s=e.getElementsByTagNameNS?e.getElementsByTagNameNS(o.default.NS.STREAM,"error"):e.getElementsByTagName("stream:error"),0===s.length)return!1;const n=s[0];let r="",i="";for(let e=0;e<n.childNodes.length;e++){const t=n.children[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?i=t.textContent:r=t.nodeName}let a="WebSocket stream error: ";return a+=r||"unknown",i&&(a+=" - "+i),o.default.error(a),this._conn._changeConnectStatus(t,r),this._conn._doDisconnect(),!0}_reset(){}_connect(){this._closeSocket(),this.socket=new n.WebSocket(this._conn.service,"xmpp"),this.socket.onopen=()=>this._onOpen(),this.socket.onerror=e=>this._onError(e),this.socket.onclose=e=>this._onClose(e),this.socket.onmessage=e=>this._onInitialMessage(e)}_connect_cb(e){if(this._checkStreamError(e,o.default.Status.CONNFAIL))return o.default.Status.CONNFAIL}_handleStreamStart(e){let t=null;const s=e.getAttribute("xmlns");"string"!=typeof s?t="Missing xmlns in <open />":s!==o.default.NS.FRAMING&&(t="Wrong xmlns in <open />: "+s);const n=e.getAttribute("version");return"string"!=typeof n?t="Missing version in <open />":"1.0"!==n&&(t="Wrong version in <open />: "+n),!t||(this._conn._changeConnectStatus(o.default.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)}_onInitialMessage(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const s=(new n.DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(s),this._conn.rawInput(e.data),this._handleStreamStart(s)&&this._connect_cb(s)}else if(0===e.data.indexOf("<close ")){const t=(new n.DOMParser).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const s=t.getAttribute("see-other-uri");if(s){const e=this._conn.service;(e.indexOf("wss:")>=0&&s.indexOf("wss:")>=0||e.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(o.default.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=s,this._connect())}else this._conn._changeConnectStatus(o.default.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{this._replaceMessageHandler();const t=this._streamWrap(e.data),s=(new n.DOMParser).parseFromString(t,"text/xml").documentElement;this._conn._connect_cb(s,null,e.data)}}_replaceMessageHandler(){this.socket.onmessage=e=>this._onMessage(e)}_disconnect(e){if(this.socket&&this.socket.readyState!==n.WebSocket.CLOSED){e&&this._conn.send(e);const t=(0,r.$build)("close",{xmlns:o.default.NS.FRAMING});this._conn.xmlOutput(t.tree());const s=o.default.serialize(t);this._conn.rawOutput(s);try{this.socket.send(s)}catch(e){o.default.warn("Couldn't send <close /> tag.")}}setTimeout((()=>this._conn._doDisconnect()),0)}_doDisconnect(){o.default.debug("WebSockets _doDisconnect was called"),this._closeSocket()}_streamWrap(e){return"<wrapper>"+e+"</wrapper>"}_closeSocket(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){o.default.debug(e.message)}this.socket=null}_emptyQueue(){return!0}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(o.default.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(o.default.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(o.default.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):o.default.debug("Websocket closed")}_no_auth_received(e){o.default.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(o.default.Status.CONNFAIL,o.default.ErrorCondition.NO_AUTH_MECH),e?.call(this._conn),this._conn._doDisconnect()}_onDisconnectTimeout(){}_abortAllRequests(){}_onError(e){o.default.error("Websocket error "+JSON.stringify(e)),this._conn._changeConnectStatus(o.default.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()}_onIdle(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){const s="restart"===e[t]?this._buildStream().tree():e[t];if("restart"===s)throw new Error("Wrong type for stanza");const n=o.default.serialize(s);this._conn.xmlOutput(s),this._conn.rawOutput(n),this.socket.send(n)}this._conn._data=[]}}_onMessage(e){let t;const s='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===s)return this._conn.rawInput(s),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new n.DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{const s=this._streamWrap(e.data);t=(new n.DOMParser).parseFromString(s,"text/xml").documentElement}return this._checkStreamError(t,o.default.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstElementChild.nodeName&&"unavailable"===t.firstElementChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(o.default.serialize(t))):void this._conn._dataRecv(t,e.data)}_onOpen(){o.default.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=o.default.serialize(e);this._conn.rawOutput(t),this.socket.send(t)}_send(){this._conn.flush()}_sendRestart(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}}},"./node_modules/strophe.js/src/worker-websocket.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/strophe.js/src/websocket.js"),r=s("./node_modules/strophe.js/src/builder.js"),o=s("./node_modules/strophe.js/src/core.js");class i extends n.default{constructor(e){super(e),this._conn=e,this.worker=new SharedWorker(this._conn.options.worker,"Strophe XMPP Connection"),this.worker.onerror=e=>{console?.error(e),o.default.log(o.default.LogLevel.ERROR,`Shared Worker Error: ${e}`)}}_setSocket(){this.socket={send:e=>this.worker.port.postMessage(["send",e]),close:()=>this.worker.port.postMessage(["_closeSocket"]),onopen:()=>{},onerror:e=>this._onError(e),onclose:e=>this._onClose(e),onmessage:()=>{},readyState:null}}_connect(){this._setSocket(),this._messageHandler=e=>this._onInitialMessage(e),this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_connect",this._conn.service,this._conn.jid])}_attach(e){this._setSocket(),this._messageHandler=e=>this._onMessage(e),this._conn.connect_callback=e,this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_attach",this._conn.service])}_attachCallback(e,t){e===o.default.Status.ATTACHED?(this._conn.jid=t,this._conn.authenticated=!0,this._conn.connected=!0,this._conn.restored=!0,this._conn._changeConnectStatus(o.default.Status.ATTACHED)):e===o.default.Status.ATTACHFAIL&&(this._conn.authenticated=!1,this._conn.connected=!1,this._conn.restored=!1,this._conn._changeConnectStatus(o.default.Status.ATTACHFAIL))}_disconnect(e){e&&this._conn.send(e);const t=(0,r.$build)("close",{xmlns:o.default.NS.FRAMING});this._conn.xmlOutput(t.tree());const s=o.default.serialize(t);this._conn.rawOutput(s),this.worker.port.postMessage(["send",s]),this._conn._doDisconnect()}_closeSocket(){this.socket.close()}_replaceMessageHandler(){this._messageHandler=e=>this._onMessage(e)}_onWorkerMessage(e){const t={};t.debug=o.default.LogLevel.DEBUG,t.info=o.default.LogLevel.INFO,t.warn=o.default.LogLevel.WARN,t.error=o.default.LogLevel.ERROR,t.fatal=o.default.LogLevel.FATAL;const{data:s}=e,n=s[0];if("_onMessage"===n)this._messageHandler(s[1]);else if(n in this)try{this[n].apply(this,e.data.slice(1))}catch(e){o.default.log(o.default.LogLevel.ERROR,e)}else if("log"===n){const e=s[1],n=s[2];o.default.log(t[e],n)}else o.default.log(o.default.LogLevel.ERROR,`Found unhandled service worker message: ${s}`)}}const a=i},"./node_modules/urijs/src/IPv6.js":function(e,t,s){var n,r;!function(o,i){"use strict";e.exports?e.exports=i():void 0===(r="function"==typeof(n=i)?n.call(t,s,t,e):n)||(e.exports=r)}(0,(function(e){"use strict";var t=e&&e.IPv6;return{best:function(e){var t,s,n=e.toLowerCase().split(":"),r=n.length,o=8;for(""===n[0]&&""===n[1]&&""===n[2]?(n.shift(),n.shift()):""===n[0]&&""===n[1]?n.shift():""===n[r-1]&&""===n[r-2]&&n.pop(),-1!==n[(r=n.length)-1].indexOf(".")&&(o=7),t=0;t<r&&""!==n[t];t++);if(t<o)for(n.splice(t,1,"0000");n.length<o;)n.splice(t,0,"0000");for(var i=0;i<o;i++){s=n[i].split("");for(var a=0;a<3&&("0"===s[0]&&s.length>1);a++)s.splice(0,1);n[i]=s.join("")}var l=-1,c=0,d=0,u=-1,h=!1;for(i=0;i<o;i++)h?"0"===n[i]?d+=1:(h=!1,d>c&&(l=u,c=d)):"0"===n[i]&&(h=!0,u=i,d=1);d>c&&(l=u,c=d),c>1&&n.splice(l,c,""),r=n.length;var f="";for(""===n[0]&&(f=":"),i=0;i<r&&(f+=n[i],i!==r-1);i++)f+=":";return""===n[r-1]&&(f+=":"),f},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}}))},"./node_modules/urijs/src/SecondLevelDomains.js":function(e,t,s){var n,r;!function(o,i){"use strict";e.exports?e.exports=i():void 0===(r="function"==typeof(n=i)?n.call(t,s,t,e):n)||(e.exports=r)}(0,(function(e){"use strict";var t=e&&e.SecondLevelDomains,s={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return!1;var r=s.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(n+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var n=s.list[e.slice(t+1)];return!!n&&n.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return null;var r=s.list[e.slice(t+1)];return r?r.indexOf(" "+e.slice(n+1,t)+" ")<0?null:e.slice(n+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return s}))},"./node_modules/urijs/src/URI.js":function(e,t,s){var n,r,o;!function(i,a){"use strict";e.exports?e.exports=a(s("./node_modules/urijs/src/punycode.js"),s("./node_modules/urijs/src/IPv6.js"),s("./node_modules/urijs/src/SecondLevelDomains.js")):(r=[s("./node_modules/urijs/src/punycode.js"),s("./node_modules/urijs/src/IPv6.js"),s("./node_modules/urijs/src/SecondLevelDomains.js")],void 0===(o="function"==typeof(n=a)?n.apply(t,r):n)||(e.exports=o))}(0,(function(e,t,s,n){"use strict";var r=n&&n.URI;function o(e,t){var s=arguments.length>=1;if(!(this instanceof o))return s?arguments.length>=2?new o(e,t):new o(e):new o;if(void 0===e){if(s)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&s)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}o.version="1.19.11";var i=o.prototype,a=Object.prototype.hasOwnProperty;function l(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function d(e){return"Array"===c(e)}function u(e,t){var s,n,r={};if("RegExp"===c(t))r=null;else if(d(t))for(s=0,n=t.length;s<n;s++)r[t[s]]=!0;else r[t]=!0;for(s=0,n=e.length;s<n;s++){(r&&void 0!==r[e[s]]||!r&&t.test(e[s]))&&(e.splice(s,1),n--,s--)}return e}function h(e,t){var s,n;if(d(t)){for(s=0,n=t.length;s<n;s++)if(!h(e,t[s]))return!1;return!0}var r=c(t);for(s=0,n=e.length;s<n;s++)if("RegExp"===r){if("string"==typeof e[s]&&e[s].match(t))return!0}else if(e[s]===t)return!0;return!1}function f(e,t){if(!d(e)||!d(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var s=0,n=e.length;s<n;s++)if(e[s]!==t[s])return!1;return!0}function m(e){return e.replace(/^\/+|\/+$/g,"")}function p(e){return escape(e)}function g(e){return encodeURIComponent(e).replace(/[!'()*]/g,p).replace(/\*/g,"%2A")}o._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:o.preventInvalidHostname,duplicateQueryParameters:o.duplicateQueryParameters,escapeQuerySpace:o.escapeQuerySpace}},o.preventInvalidHostname=!1,o.duplicateQueryParameters=!1,o.escapeQuerySpace=!0,o.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,o.idn_expression=/[^a-z0-9\._-]/i,o.punycode_expression=/(xn--)/i,o.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,o.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,o.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},o.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,o.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},o.hostProtocols=["http","https"],o.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,o.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},o.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return o.domAttributes[t]}},o.encode=g,o.decode=decodeURIComponent,o.iso8859=function(){o.encode=escape,o.decode=unescape},o.unicode=function(){o.encode=g,o.decode=decodeURIComponent},o.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},o.encodeQuery=function(e,t){var s=o.encode(e+"");return void 0===t&&(t=o.escapeQuerySpace),t?s.replace(/%20/g,"+"):s},o.decodeQuery=function(e,t){e+="",void 0===t&&(t=o.escapeQuerySpace);try{return o.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,v={encode:"encode",decode:"decode"},y=function(e,t){return function(s){try{return o[t](s+"").replace(o.characters[e][t].expression,(function(s){return o.characters[e][t].map[s]}))}catch(e){return s}}};for(_ in v)o[_+"PathSegment"]=y("pathname",v[_]),o[_+"UrnPathSegment"]=y("urnpath",v[_]);var b=function(e,t,s){return function(n){var r;r=s?function(e){return o[t](o[s](e))}:o[t];for(var i=(n+"").split(e),a=0,l=i.length;a<l;a++)i[a]=r(i[a]);return i.join(e)}};function j(e){return function(t,s){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!s),this)}}function w(e,t){return function(s,n){return void 0===s?this._parts[e]||"":(null!==s&&(s+="").charAt(0)===t&&(s=s.substring(1)),this._parts[e]=s,this.build(!n),this)}}o.decodePath=b("/","decodePathSegment"),o.decodeUrnPath=b(":","decodeUrnPathSegment"),o.recodePath=b("/","encodePathSegment","decode"),o.recodeUrnPath=b(":","encodeUrnPathSegment","decode"),o.encodeReserved=y("reserved","encode"),o.parse=function(e,t){var s;return t||(t={preventInvalidHostname:o.preventInvalidHostname}),(s=(e=(e=e.replace(o.leading_whitespace_expression,"")).replace(o.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(s+1)||null,e=e.substring(0,s)),(s=e.indexOf("?"))>-1&&(t.query=e.substring(s+1)||null,e=e.substring(0,s)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=o.parseAuthority(e,t)):(s=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,s)||null,t.protocol&&!t.protocol.match(o.protocol_expression)?t.protocol=void 0:"//"===e.substring(s+1,s+3).replace(/\\/g,"/")?(e=e.substring(s+3),e=o.parseAuthority(e,t)):(e=e.substring(s+1),t.urn=!0)),t.path=e,t},o.parseHost=function(e,t){e||(e="");var s,n,r=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===r&&(r=e.length),"["===e.charAt(0))s=e.indexOf("]"),t.hostname=e.substring(1,s)||null,t.port=e.substring(s+2,r)||null,"/"===t.port&&(t.port=null);else{var i=e.indexOf(":"),a=e.indexOf("/"),l=e.indexOf(":",i+1);-1!==l&&(-1===a||l<a)?(t.hostname=e.substring(0,r)||null,t.port=null):(n=e.substring(0,r).split(":"),t.hostname=n[0]||null,t.port=n[1]||null)}return t.hostname&&"/"!==e.substring(r).charAt(0)&&(r++,e="/"+e),t.preventInvalidHostname&&o.ensureValidHostname(t.hostname,t.protocol),t.port&&o.ensureValidPort(t.port),e.substring(r)||"/"},o.parseAuthority=function(e,t){return e=o.parseUserinfo(e,t),o.parseHost(e,t)},o.parseUserinfo=function(e,t){var s=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var n,r=e.indexOf("/"),i=e.lastIndexOf("@",r>-1?r:e.length-1);return i>-1&&(-1===r||i<r)?(n=e.substring(0,i).split(":"),t.username=n[0]?o.decode(n[0]):null,n.shift(),t.password=n[0]?o.decode(n.join(":")):null,e=s.substring(i+1)):(t.username=null,t.password=null),e},o.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var s,n,r,i={},l=e.split("&"),c=l.length,d=0;d<c;d++)s=l[d].split("="),n=o.decodeQuery(s.shift(),t),r=s.length?o.decodeQuery(s.join("="),t):null,"__proto__"!==n&&(a.call(i,n)?("string"!=typeof i[n]&&null!==i[n]||(i[n]=[i[n]]),i[n].push(r)):i[n]=r);return i},o.build=function(e){var t="",s=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",s=!0),t+=o.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&s&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},o.buildHost=function(e){var t="";return e.hostname?(o.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},o.buildAuthority=function(e){return o.buildUserinfo(e)+o.buildHost(e)},o.buildUserinfo=function(e){var t="";return e.username&&(t+=o.encode(e.username)),e.password&&(t+=":"+o.encode(e.password)),t&&(t+="@"),t},o.buildQuery=function(e,t,s){var n,r,i,l,c="";for(r in e)if("__proto__"!==r&&a.call(e,r))if(d(e[r]))for(n={},i=0,l=e[r].length;i<l;i++)void 0!==e[r][i]&&void 0===n[e[r][i]+""]&&(c+="&"+o.buildQueryParameter(r,e[r][i],s),!0!==t&&(n[e[r][i]+""]=!0));else void 0!==e[r]&&(c+="&"+o.buildQueryParameter(r,e[r],s));return c.substring(1)},o.buildQueryParameter=function(e,t,s){return o.encodeQuery(e,s)+(null!==t?"="+o.encodeQuery(t,s):"")},o.addQuery=function(e,t,s){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.addQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=s);"string"==typeof e[t]&&(e[t]=[e[t]]),d(s)||(s=[s]),e[t]=(e[t]||[]).concat(s)}},o.setQuery=function(e,t,s){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.setQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===s?null:s}},o.removeQuery=function(e,t,s){var n,r,i;if(d(t))for(n=0,r=t.length;n<r;n++)e[t[n]]=void 0;else if("RegExp"===c(t))for(i in e)t.test(i)&&(e[i]=void 0);else if("object"==typeof t)for(i in t)a.call(t,i)&&o.removeQuery(e,i,t[i]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==s?"RegExp"===c(s)?!d(e[t])&&s.test(e[t])?e[t]=void 0:e[t]=u(e[t],s):e[t]!==String(s)||d(s)&&1!==s.length?d(e[t])&&(e[t]=u(e[t],s)):e[t]=void 0:e[t]=void 0}},o.hasQuery=function(e,t,s,n){switch(c(t)){case"String":break;case"RegExp":for(var r in e)if(a.call(e,r)&&t.test(r)&&(void 0===s||o.hasQuery(e,r,s)))return!0;return!1;case"Object":for(var i in t)if(a.call(t,i)&&!o.hasQuery(e,i,t[i]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(s)){case"Undefined":return t in e;case"Boolean":return s===Boolean(d(e[t])?e[t].length:e[t]);case"Function":return!!s(e[t],t,e);case"Array":return!!d(e[t])&&(n?h:f)(e[t],s);case"RegExp":return d(e[t])?!!n&&h(e[t],s):Boolean(e[t]&&e[t].match(s));case"Number":s=String(s);case"String":return d(e[t])?!!n&&h(e[t],s):e[t]===s;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},o.joinPaths=function(){for(var e=[],t=[],s=0,n=0;n<arguments.length;n++){var r=new o(arguments[n]);e.push(r);for(var i=r.segment(),a=0;a<i.length;a++)"string"==typeof i[a]&&t.push(i[a]),i[a]&&s++}if(!t.length||!s)return new o("");var l=new o("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||l.path("/"+l.path()),l.normalize()},o.commonPath=function(e,t){var s,n=Math.min(e.length,t.length);for(s=0;s<n;s++)if(e.charAt(s)!==t.charAt(s)){s--;break}return s<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(s)&&"/"===t.charAt(s)||(s=e.substring(0,s).lastIndexOf("/")),e.substring(0,s+1))},o.withinString=function(e,t,s){s||(s={});var n=s.start||o.findUri.start,r=s.end||o.findUri.end,i=s.trim||o.findUri.trim,a=s.parens||o.findUri.parens,l=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var c=n.exec(e);if(!c)break;var d=c.index;if(s.ignoreHtml){var u=e.slice(Math.max(d-3,0),d);if(u&&l.test(u))continue}for(var h=d+e.slice(d).search(r),f=e.slice(d,h),m=-1;;){var p=a.exec(f);if(!p)break;var g=p.index+p[0].length;m=Math.max(m,g)}if(!((f=m>-1?f.slice(0,m)+f.slice(m).replace(i,""):f.replace(i,"")).length<=c[0].length||s.ignore&&s.ignore.test(f))){var _=t(f,d,h=d+f.length,e);void 0!==_?(_=String(_),e=e.slice(0,d)+_+e.slice(h),n.lastIndex=d+_.length):n.lastIndex=h}}return n.lastIndex=0,e},o.ensureValidHostname=function(t,s){var n=!!t,r=!1;if(!!s&&(r=h(o.hostProtocols,s)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+s);if(t&&t.match(o.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(o.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},o.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},o.noConflict=function(e){if(e){var t={URI:this.noConflict()};return n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t}return n.URI===this&&(n.URI=r),this},i.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=o.build(this._parts),this._deferred_build=!1),this},i.clone=function(){return new o(this)},i.valueOf=i.toString=function(){return this.build(!1)._string},i.protocol=j("protocol"),i.username=j("username"),i.password=j("password"),i.hostname=j("hostname"),i.port=j("port"),i.query=w("query","?"),i.fragment=w("fragment","#"),i.search=function(e,t){var s=this.query(e,t);return"string"==typeof s&&s.length?"?"+s:s},i.hash=function(e,t){var s=this.fragment(e,t);return"string"==typeof s&&s.length?"#"+s:s},i.pathname=function(e,t){if(void 0===e||!0===e){var s=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?o.decodeUrnPath:o.decodePath)(s):s}return this._parts.urn?this._parts.path=e?o.recodeUrnPath(e):"":this._parts.path=e?o.recodePath(e):"/",this.build(!t),this},i.path=i.pathname,i.href=function(e,t){var s;if(void 0===e)return this.toString();this._string="",this._parts=o._parts();var n=e instanceof o,r="object"==typeof e&&(e.hostname||e.path||e.pathname);e.nodeName&&(e=e[o.getDomAttribute(e)]||"",r=!1);if(!n&&r&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=o.parse(String(e),this._parts);else{if(!n&&!r)throw new TypeError("invalid input");var i=n?e._parts:e;for(s in i)"query"!==s&&a.call(this._parts,s)&&(this._parts[s]=i[s]);i.query&&this.query(i.query,!1)}return this.build(!t),this},i.is=function(e){var t=!1,n=!1,r=!1,i=!1,a=!1,l=!1,c=!1,d=!this._parts.urn;switch(this._parts.hostname&&(d=!1,n=o.ip4_expression.test(this._parts.hostname),r=o.ip6_expression.test(this._parts.hostname),a=(i=!(t=n||r))&&s&&s.has(this._parts.hostname),l=i&&o.idn_expression.test(this._parts.hostname),c=i&&o.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return d;case"absolute":return!d;case"domain":case"name":return i;case"sld":return a;case"ip":return t;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return l;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var S=i.protocol,x=i.port,E=i.hostname;i.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(o.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return S.call(this,e,t)},i.scheme=i.protocol,i.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),o.ensureValidPort(e))),x.call(this,e,t))},i.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var s={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==o.parseHost(e,s))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=s.hostname,this._parts.preventInvalidHostname&&o.ensureValidHostname(e,this._parts.protocol)}return E.call(this,e,t)},i.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var s=this.protocol();return this.authority()?(s?s+"://":"")+this.authority():""}var n=o(e);return this.protocol(n.protocol()).authority(n.authority()).build(!t),this},i.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildHost(this._parts):"";if("/"!==o.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},i.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildAuthority(this._parts):"";if("/"!==o.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},i.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var s=o.buildUserinfo(this._parts);return s?s.substring(0,s.length-1):s}return"@"!==e[e.length-1]&&(e+="@"),o.parseUserinfo(e,this._parts),this.build(!t),this},i.resource=function(e,t){var s;return void 0===e?this.path()+this.search()+this.hash():(s=o.parse(e),this._parts.path=s.path,this._parts.query=s.query,this._parts.fragment=s.fragment,this.build(!t),this)},i.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var s=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,s)||""}var n=this._parts.hostname.length-this.domain().length,r=this._parts.hostname.substring(0,n),i=new RegExp("^"+l(r));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&o.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(i,e),this.build(!t),this},i.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var s=this._parts.hostname.match(/\./g);if(s&&s.length<2)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(t).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(o.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var r=new RegExp(l(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(r,e)}return this.build(!t),this},i.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),r=this._parts.hostname.substring(n+1);return!0!==t&&s&&s.list[r.toLowerCase()]&&s.get(this._parts.hostname)||r}var o;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!s||!s.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},i.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var s=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,s)||(this._parts.hostname?"/":"");return e?o.decodePath(n):n}var r=this._parts.path.length-this.filename().length,i=this._parts.path.substring(0,r),a=new RegExp("^"+l(i));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e),this.build(!t),this},i.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var s=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(s+1);return e?o.decodePathSegment(n):n}var r=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(r=!0);var i=new RegExp(l(this.filename())+"$");return e=o.recodePath(e),this._parts.path=this._parts.path.replace(i,e),r?this.normalizePath(t):this.build(!t),this},i.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var s,n,r=this.filename(),i=r.lastIndexOf(".");return-1===i?"":(s=r.substring(i+1),n=/^[a-z0-9%]+$/i.test(s)?s:"",e?o.decodePathSegment(n):n)}"."===e.charAt(0)&&(e=e.substring(1));var a,c=this.suffix();if(c)a=e?new RegExp(l(c)+"$"):new RegExp(l("."+c)+"$");else{if(!e)return this;this._parts.path+="."+o.recodePath(e)}return a&&(e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e)),this.build(!t),this},i.segment=function(e,t,s){var n=this._parts.urn?":":"/",r=this.path(),o="/"===r.substring(0,1),i=r.split(n);if(void 0!==e&&"number"!=typeof e&&(s=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(o&&i.shift(),e<0&&(e=Math.max(i.length+e,0)),void 0===t)return void 0===e?i:i[e];if(null===e||void 0===i[e])if(d(t)){i=[];for(var a=0,l=t.length;a<l;a++)(t[a].length||i.length&&i[i.length-1].length)&&(i.length&&!i[i.length-1].length&&i.pop(),i.push(m(t[a])))}else(t||"string"==typeof t)&&(t=m(t),""===i[i.length-1]?i[i.length-1]=t:i.push(t));else t?i[e]=m(t):i.splice(e,1);return o&&i.unshift(""),this.path(i.join(n),s)},i.segmentCoded=function(e,t,s){var n,r,i;if("number"!=typeof e&&(s=t,t=e,e=void 0),void 0===t){if(d(n=this.segment(e,t,s)))for(r=0,i=n.length;r<i;r++)n[r]=o.decode(n[r]);else n=void 0!==n?o.decode(n):void 0;return n}if(d(t))for(r=0,i=t.length;r<i;r++)t[r]=o.encode(t[r]);else t="string"==typeof t||t instanceof String?o.encode(t):t;return this.segment(e,t,s)};var A=i.query;return i.query=function(e,t){if(!0===e)return o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var s=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=e.call(this,s);return this._parts.query=o.buildQuery(n||s,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=o.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):A.call(this,e,t)},i.setQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)n[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var r in e)a.call(e,r)&&(n[r]=e[r])}return this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.addQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.addQuery(n,e,void 0===t?null:t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.removeQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.removeQuery(n,e,t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.hasQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.hasQuery(n,e,t,s)},i.setSearch=i.setQuery,i.addSearch=i.addQuery,i.removeSearch=i.removeQuery,i.hasSearch=i.hasQuery,i.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},i.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},i.normalizeHostname=function(s){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!s)),this},i.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===o.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},i.normalizePath=function(e){var t,s=this._parts.path;if(!s)return this;if(this._parts.urn)return this._parts.path=o.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var n,r,i="";for("/"!==(s=o.recodePath(s)).charAt(0)&&(t=!0,s="/"+s),"/.."!==s.slice(-3)&&"/."!==s.slice(-2)||(s+="/"),s=s.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(i=s.substring(1).match(/^(\.\.\/)+/)||"")&&(i=i[0]);-1!==(n=s.search(/\/\.\.(\/|$)/));)0!==n?(-1===(r=s.substring(0,n).lastIndexOf("/"))&&(r=n),s=s.substring(0,r)+s.substring(n+3)):s=s.substring(3);return t&&this.is("relative")&&(s=i+s.substring(1)),this._parts.path=s,this.build(!e),this},i.normalizePathname=i.normalizePath,i.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},i.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},i.normalizeSearch=i.normalizeQuery,i.normalizeHash=i.normalizeFragment,i.iso8859=function(){var e=o.encode,t=o.decode;o.encode=escape,o.decode=decodeURIComponent;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},i.unicode=function(){var e=o.encode,t=o.decode;o.encode=g,o.decode=unescape;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},i.readable=function(){var t=this.clone();t.username("").password("").normalize();var s="";if(t._parts.protocol&&(s+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(s+=e.toUnicode(t._parts.hostname),t._parts.port&&(s+=":"+t._parts.port)):s+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(s+="/"),s+=t.path(!0),t._parts.query){for(var n="",r=0,i=t._parts.query.split("&"),a=i.length;r<a;r++){var l=(i[r]||"").split("=");n+="&"+o.decodeQuery(l[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==l[1]&&(n+="="+o.decodeQuery(l[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}s+="?"+n.substring(1)}return s+=o.decodeQuery(t.hash(),!0)},i.absoluteTo=function(e){var t,s,n,r=this.clone(),i=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof o||(e=new o(e)),r._parts.protocol)return r;if(r._parts.protocol=e._parts.protocol,this._parts.hostname)return r;for(s=0;n=i[s];s++)r._parts[n]=e._parts[n];return r._parts.path?(".."===r._parts.path.substring(-2)&&(r._parts.path+="/"),"/"!==r.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),r._parts.path=(t?t+"/":"")+r._parts.path,r.normalizePath())):(r._parts.path=e._parts.path,r._parts.query||(r._parts.query=e._parts.query)),r.build(),r},i.relativeTo=function(e){var t,s,n,r,i,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new o(e).normalize(),t=a._parts,s=e._parts,r=a.path(),i=e.path(),"/"!==r.charAt(0))throw new Error("URI is already relative");if("/"!==i.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===s.protocol&&(t.protocol=null),t.username!==s.username||t.password!==s.password)return a.build();if(null!==t.protocol||null!==t.username||null!==t.password)return a.build();if(t.hostname!==s.hostname||t.port!==s.port)return a.build();if(t.hostname=null,t.port=null,r===i)return t.path="",a.build();if(!(n=o.commonPath(r,i)))return a.build();var l=s.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=l+t.path.substring(n.length)||"./",a.build()},i.equals=function(e){var t,s,n,r,i,l=this.clone(),c=new o(e),u={};if(l.normalize(),c.normalize(),l.toString()===c.toString())return!0;if(n=l.query(),r=c.query(),l.query(""),c.query(""),l.toString()!==c.toString())return!1;if(n.length!==r.length)return!1;for(i in t=o.parseQuery(n,this._parts.escapeQuerySpace),s=o.parseQuery(r,this._parts.escapeQuerySpace),t)if(a.call(t,i)){if(d(t[i])){if(!f(t[i],s[i]))return!1}else if(t[i]!==s[i])return!1;u[i]=!0}for(i in s)if(a.call(s,i)&&!u[i])return!1;return!0},i.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},i.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},i.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},o}))},"./node_modules/urijs/src/punycode.js":function(e,t,s){var n;e=s.nmd(e),function(r){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof s.g&&s.g;o.global!==o&&o.window!==o&&o.self;var i,a=2147483647,l=36,c=1,d=26,u=38,h=700,f=72,m=128,p="-",g=/^xn--/,_=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=l-c,j=Math.floor,w=String.fromCharCode;function S(e){throw new RangeError(y[e])}function x(e,t){for(var s=e.length,n=[];s--;)n[s]=t(e[s]);return n}function E(e,t){var s=e.split("@"),n="";return s.length>1&&(n=s[0]+"@",e=s[1]),n+x((e=e.replace(v,".")).split("."),t).join(".")}function A(e){for(var t,s,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(s=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&s)+65536):(n.push(t),r--):n.push(t);return n}function C(e){return x(e,(function(e){var t="";return e>65535&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=w(e)})).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,s){var n=0;for(e=s?j(e/h):e>>1,e+=j(e/t);e>b*d>>1;n+=l)e=j(e/b);return j(n+(b+1)*e/(e+u))}function k(e){var t,s,n,r,o,i,u,h,g,_,v,y=[],b=e.length,w=0,x=m,E=f;for((s=e.lastIndexOf(p))<0&&(s=0),n=0;n<s;++n)e.charCodeAt(n)>=128&&S("not-basic"),y.push(e.charCodeAt(n));for(r=s>0?s+1:0;r<b;){for(o=w,i=1,u=l;r>=b&&S("invalid-input"),((h=(v=e.charCodeAt(r++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:l)>=l||h>j((a-w)/i))&&S("overflow"),w+=h*i,!(h<(g=u<=E?c:u>=E+d?d:u-E));u+=l)i>j(a/(_=l-g))&&S("overflow"),i*=_;E=I(w-o,t=y.length+1,0==o),j(w/t)>a-x&&S("overflow"),x+=j(w/t),w%=t,y.splice(w++,0,x)}return C(y)}function N(e){var t,s,n,r,o,i,u,h,g,_,v,y,b,x,E,C=[];for(y=(e=A(e)).length,t=m,s=0,o=f,i=0;i<y;++i)(v=e[i])<128&&C.push(w(v));for(n=r=C.length,r&&C.push(p);n<y;){for(u=a,i=0;i<y;++i)(v=e[i])>=t&&v<u&&(u=v);for(u-t>j((a-s)/(b=n+1))&&S("overflow"),s+=(u-t)*b,t=u,i=0;i<y;++i)if((v=e[i])<t&&++s>a&&S("overflow"),v==t){for(h=s,g=l;!(h<(_=g<=o?c:g>=o+d?d:g-o));g+=l)E=h-_,x=l-_,C.push(w(T(_+E%x,0))),h=j(E/x);C.push(w(T(h,0))),o=I(s,b,n==r),s=0,++n}++s,++t}return C.join("")}i={version:"1.3.2",ucs2:{decode:A,encode:C},decode:k,encode:N,toASCII:function(e){return E(e,(function(e){return _.test(e)?"xn--"+N(e):e}))},toUnicode:function(e){return E(e,(function(e){return g.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return i}.call(t,s,t,e))||(e.exports=n)}()},"./src/headless/dist/converse-headless.js":function(e,t,s){var n;e=s.nmd(e),n=()=>(()=>{var n,r,o,i,a={494:(e,t,s)=>{"use strict";const n=s(672),r=s(817);e.exports={atob:n,btoa:r}},672:e=>{"use strict";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(e){const s=t.indexOf(e);return s<0?void 0:s}e.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");if((e=(e=`${e}`).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",n=0,r=0;for(let o=0;o<e.length;o++)n<<=6,n|=s(e[o]),r+=6,24===r&&(t+=String.fromCharCode((16711680&n)>>16),t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n),n=r=0);return 12===r?(n>>=4,t+=String.fromCharCode(n)):18===r&&(n>>=2,t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n)),t}},817:e=>{"use strict";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(e){if(e>=0&&e<64)return t[e]}e.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let n="";for(t=0;t<e.length;t+=3){const r=[void 0,void 0,void 0,void 0];r[0]=e.charCodeAt(t)>>2,r[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(r[1]|=e.charCodeAt(t+1)>>4,r[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(r[2]|=e.charCodeAt(t+2)>>6,r[3]=63&e.charCodeAt(t+2));for(let e=0;e<r.length;e++)void 0===r[e]?n+="=":n+=s(r[e])}return n}},487:function(e,t,s){!function(e,t){"use strict";function s(e){return s.result?s.result:e&&"function"==typeof e.getSerializer?(s.result=e.getSerializer(),s.result):Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!"))}function n(e,t){return t&&e.then((function(e){t(null,e)}),(function(e){t(e)})),e}function r(e,t){var s=this.getItem(e).then((function(t){return{key:e,value:t}}));return n(s,t),s}function o(e){var t=this;return new Promise((function(s,n){for(var o=[],i=0,a=e.length;i<a;i++)o.push(r.call(t,e[i]));Promise.all(o).then((function(e){for(var t={},n=0,r=e.length;n<r;n++){var o=e[n];t[o.key]=o.value}s(t)})).catch(n)}))}function i(){var e={};return this.iterate((function(t,s){e[s]=t})).then((function(){return e}))}function a(){return"undefined"!=typeof IDBKeyRange?IDBKeyRange:"undefined"!=typeof webkitIDBKeyRange?webkitIDBKeyRange:"undefined"!=typeof mozIDBKeyRange?mozIDBKeyRange:void 0}t="default"in t?t.default:t;var l=a();function c(e){e=e.slice();var t=this;function s(e,t){return e<t?-1:e>t?1:0}return new Promise((function(n,r){t.ready().then((function(){var o,i=t._dbInfo,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),c=e.sort(s),d=l.bound(e[0],e[e.length-1],!1,!1);if("getAll"in a)(o=a.getAll(d)).onsuccess=function(){var e=o.result;void 0===e&&(e=null),n(e)};else{o=a.openCursor(d);var u={},h=0;o.onsuccess=function(){var e=o.result;if(e){for(var t=e.key;t>c[h];)if(++h===c.length)return void n(u);if(t===c[h]){var s=e.value;void 0===s&&(s=null),u[t]=s,e.continue()}else e.continue(c[h])}else n(u)}}o.onerror=function(){r(o.error)}})).catch(r)}))}function d(e){var t=this;return new Promise((function(n,r){t.ready().then((function(){return s(t)})).then((function(s){var o=t._dbInfo;o.db.transaction((function(t){for(var i=new Array(e.length),a=0,l=e.length;a<l;a++)i[a]="?";t.executeSql("SELECT * FROM "+o.storeName+" WHERE (key IN ("+i.join(",")+"))",e,(function(e,t){for(var r={},o=t.rows,i=0,a=o.length;i<a;i++){var l=o.item(i),c=l.value;c&&(c=s.deserialize(c)),r[l.key]=c}n(r)}),(function(e,t){r(t)}))}))})).catch(r)}))}function u(e,t){var s,r=this;if(arguments.length&&null!==e){var a=r.driver();s=a===r.INDEXEDDB?c.apply(r,arguments):a===r.WEBSQL?d.apply(r,arguments):o.apply(r,arguments)}else s=i.apply(r);return n(s,t),s}function h(e){var t=Object.getPrototypeOf(e);t&&(t.getItems=u,t.getItems.indexedDB=function(){return c.apply(this,arguments)},t.getItems.websql=function(){return d.apply(this,arguments)},t.getItems.generic=function(){return o.apply(this,arguments)})}var f=h(t);e.localforageGetItems=u,e.extendPrototype=h,e.extendPrototypeResult=f,e.getItemsGeneric=o,Object.defineProperty(e,"__esModule",{value:!0})}(t,s(483))},293:(e,t,s)=>{var n;!function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return function(e,t){var s,n,i,a,l,c,d,u,h,f=1,m=e.length,p="";for(n=0;n<m;n++)if("string"==typeof e[n])p+=e[n];else if("object"==typeof e[n]){if((a=e[n]).keys)for(s=t[f],i=0;i<a.keys.length;i++){if(null==s)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[i],a.keys[i-1]));s=s[a.keys[i]]}else s=a.param_no?t[a.param_no]:t[f++];if(r.not_type.test(a.type)&&r.not_primitive.test(a.type)&&s instanceof Function&&(s=s()),r.numeric_arg.test(a.type)&&"number"!=typeof s&&isNaN(s))throw new TypeError(o("[sprintf] expecting number but found %T",s));switch(r.number.test(a.type)&&(u=s>=0),a.type){case"b":s=parseInt(s,10).toString(2);break;case"c":s=String.fromCharCode(parseInt(s,10));break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,a.width?parseInt(a.width):0);break;case"e":s=a.precision?parseFloat(s).toExponential(a.precision):parseFloat(s).toExponential();break;case"f":s=a.precision?parseFloat(s).toFixed(a.precision):parseFloat(s);break;case"g":s=a.precision?String(Number(s.toPrecision(a.precision))):parseFloat(s);break;case"o":s=(parseInt(s,10)>>>0).toString(8);break;case"s":s=String(s),s=a.precision?s.substring(0,a.precision):s;break;case"t":s=String(!!s),s=a.precision?s.substring(0,a.precision):s;break;case"T":s=Object.prototype.toString.call(s).slice(8,-1).toLowerCase(),s=a.precision?s.substring(0,a.precision):s;break;case"u":s=parseInt(s,10)>>>0;break;case"v":s=s.valueOf(),s=a.precision?s.substring(0,a.precision):s;break;case"x":s=(parseInt(s,10)>>>0).toString(16);break;case"X":s=(parseInt(s,10)>>>0).toString(16).toUpperCase()}r.json.test(a.type)?p+=s:(!r.number.test(a.type)||u&&!a.sign?h="":(h=u?"+":"-",s=s.toString().replace(r.sign,"")),c=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",d=a.width-(h+s).length,l=a.width&&d>0?c.repeat(d):"",p+=a.align?h+s+l:"0"===c?h+l+s:l+h+s)}return p}(function(e){if(a[e])return a[e];for(var t,s=e,n=[],o=0;s;){if(null!==(t=r.text.exec(s)))n.push(t[0]);else if(null!==(t=r.modulo.exec(s)))n.push("%");else{if(null===(t=r.placeholder.exec(s)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var i=[],l=t[2],c=[];if(null===(c=r.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(i.push(c[1]);""!==(l=l.substring(c[0].length));)if(null!==(c=r.key_access.exec(l)))i.push(c[1]);else{if(null===(c=r.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");i.push(c[1])}t[2]=i}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}s=s.substring(t[0].length)}return a[e]=n}(e),arguments)}function i(e,t){return o.apply(null,[e].concat(t||[]))}var a=Object.create(null);t.sprintf=o,t.vsprintf=i,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=i,void 0===(n=function(){return{sprintf:o,vsprintf:i}}.call(t,s,t,e))||(e.exports=n))}()},939:function(e,t,s){var n,r;!function(o,i){"use strict";e.exports?e.exports=i():void 0===(r="function"==typeof(n=i)?n.call(t,s,t,e):n)||(e.exports=r)}(0,(function(e){"use strict";var t=e&&e.IPv6;return{best:function(e){var t,s,n=e.toLowerCase().split(":"),r=n.length,o=8;for(""===n[0]&&""===n[1]&&""===n[2]?(n.shift(),n.shift()):""===n[0]&&""===n[1]?n.shift():""===n[r-1]&&""===n[r-2]&&n.pop(),-1!==n[(r=n.length)-1].indexOf(".")&&(o=7),t=0;t<r&&""!==n[t];t++);if(t<o)for(n.splice(t,1,"0000");n.length<o;)n.splice(t,0,"0000");for(var i=0;i<o;i++){s=n[i].split("");for(var a=0;a<3&&"0"===s[0]&&s.length>1;a++)s.splice(0,1);n[i]=s.join("")}var l=-1,c=0,d=0,u=-1,h=!1;for(i=0;i<o;i++)h?"0"===n[i]?d+=1:(h=!1,d>c&&(l=u,c=d)):"0"===n[i]&&(h=!0,u=i,d=1);d>c&&(l=u,c=d),c>1&&n.splice(l,c,""),r=n.length;var f="";for(""===n[0]&&(f=":"),i=0;i<r&&(f+=n[i],i!==r-1);i++)f+=":";return""===n[r-1]&&(f+=":"),f},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}}))},338:function(e,t,s){var n,r;!function(o,i){"use strict";e.exports?e.exports=i():void 0===(r="function"==typeof(n=i)?n.call(t,s,t,e):n)||(e.exports=r)}(0,(function(e){"use strict";var t=e&&e.SecondLevelDomains,s={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return!1;var r=s.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(n+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var n=s.list[e.slice(t+1)];return!!n&&n.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return null;var r=s.list[e.slice(t+1)];return r?r.indexOf(" "+e.slice(n+1,t)+" ")<0?null:e.slice(n+1):null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return s}))},988:function(e,t,s){var n,r,o;!function(i,a){"use strict";e.exports?e.exports=a(s(562),s(939),s(338)):(r=[s(562),s(939),s(338)],void 0===(o="function"==typeof(n=a)?n.apply(t,r):n)||(e.exports=o))}(0,(function(e,t,s,n){"use strict";var r=n&&n.URI;function o(e,t){var s=arguments.length>=1;if(!(this instanceof o))return s?arguments.length>=2?new o(e,t):new o(e):new o;if(void 0===e){if(s)throw new TypeError("undefined is not a valid argument for URI");e="undefined"!=typeof location?location.href+"":""}if(null===e&&s)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}o.version="1.19.11";var i=o.prototype,a=Object.prototype.hasOwnProperty;function l(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function d(e){return"Array"===c(e)}function u(e,t){var s,n,r={};if("RegExp"===c(t))r=null;else if(d(t))for(s=0,n=t.length;s<n;s++)r[t[s]]=!0;else r[t]=!0;for(s=0,n=e.length;s<n;s++)(r&&void 0!==r[e[s]]||!r&&t.test(e[s]))&&(e.splice(s,1),n--,s--);return e}function h(e,t){var s,n;if(d(t)){for(s=0,n=t.length;s<n;s++)if(!h(e,t[s]))return!1;return!0}var r=c(t);for(s=0,n=e.length;s<n;s++)if("RegExp"===r){if("string"==typeof e[s]&&e[s].match(t))return!0}else if(e[s]===t)return!0;return!1}function f(e,t){if(!d(e)||!d(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var s=0,n=e.length;s<n;s++)if(e[s]!==t[s])return!1;return!0}function m(e){return e.replace(/^\/+|\/+$/g,"")}function p(e){return escape(e)}function g(e){return encodeURIComponent(e).replace(/[!'()*]/g,p).replace(/\*/g,"%2A")}o._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:o.preventInvalidHostname,duplicateQueryParameters:o.duplicateQueryParameters,escapeQuerySpace:o.escapeQuerySpace}},o.preventInvalidHostname=!1,o.duplicateQueryParameters=!1,o.escapeQuerySpace=!0,o.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,o.idn_expression=/[^a-z0-9\._-]/i,o.punycode_expression=/(xn--)/i,o.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,o.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,o.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},o.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,o.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},o.hostProtocols=["http","https"],o.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,o.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},o.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return o.domAttributes[t]}},o.encode=g,o.decode=decodeURIComponent,o.iso8859=function(){o.encode=escape,o.decode=unescape},o.unicode=function(){o.encode=g,o.decode=decodeURIComponent},o.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},o.encodeQuery=function(e,t){var s=o.encode(e+"");return void 0===t&&(t=o.escapeQuerySpace),t?s.replace(/%20/g,"+"):s},o.decodeQuery=function(e,t){e+="",void 0===t&&(t=o.escapeQuerySpace);try{return o.decode(t?e.replace(/\+/g,"%20"):e)}catch(t){return e}};var _,v={encode:"encode",decode:"decode"},y=function(e,t){return function(s){try{return o[t](s+"").replace(o.characters[e][t].expression,(function(s){return o.characters[e][t].map[s]}))}catch(e){return s}}};for(_ in v)o[_+"PathSegment"]=y("pathname",v[_]),o[_+"UrnPathSegment"]=y("urnpath",v[_]);var b=function(e,t,s){return function(n){var r;r=s?function(e){return o[t](o[s](e))}:o[t];for(var i=(n+"").split(e),a=0,l=i.length;a<l;a++)i[a]=r(i[a]);return i.join(e)}};function j(e){return function(t,s){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!s),this)}}function w(e,t){return function(s,n){return void 0===s?this._parts[e]||"":(null!==s&&(s+="").charAt(0)===t&&(s=s.substring(1)),this._parts[e]=s,this.build(!n),this)}}o.decodePath=b("/","decodePathSegment"),o.decodeUrnPath=b(":","decodeUrnPathSegment"),o.recodePath=b("/","encodePathSegment","decode"),o.recodeUrnPath=b(":","encodeUrnPathSegment","decode"),o.encodeReserved=y("reserved","encode"),o.parse=function(e,t){var s;return t||(t={preventInvalidHostname:o.preventInvalidHostname}),(s=(e=(e=e.replace(o.leading_whitespace_expression,"")).replace(o.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(s+1)||null,e=e.substring(0,s)),(s=e.indexOf("?"))>-1&&(t.query=e.substring(s+1)||null,e=e.substring(0,s)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=o.parseAuthority(e,t)):(s=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,s)||null,t.protocol&&!t.protocol.match(o.protocol_expression)?t.protocol=void 0:"//"===e.substring(s+1,s+3).replace(/\\/g,"/")?(e=e.substring(s+3),e=o.parseAuthority(e,t)):(e=e.substring(s+1),t.urn=!0)),t.path=e,t},o.parseHost=function(e,t){e||(e="");var s,n,r=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===r&&(r=e.length),"["===e.charAt(0))s=e.indexOf("]"),t.hostname=e.substring(1,s)||null,t.port=e.substring(s+2,r)||null,"/"===t.port&&(t.port=null);else{var i=e.indexOf(":"),a=e.indexOf("/"),l=e.indexOf(":",i+1);-1!==l&&(-1===a||l<a)?(t.hostname=e.substring(0,r)||null,t.port=null):(n=e.substring(0,r).split(":"),t.hostname=n[0]||null,t.port=n[1]||null)}return t.hostname&&"/"!==e.substring(r).charAt(0)&&(r++,e="/"+e),t.preventInvalidHostname&&o.ensureValidHostname(t.hostname,t.protocol),t.port&&o.ensureValidPort(t.port),e.substring(r)||"/"},o.parseAuthority=function(e,t){return e=o.parseUserinfo(e,t),o.parseHost(e,t)},o.parseUserinfo=function(e,t){var s=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var n,r=e.indexOf("/"),i=e.lastIndexOf("@",r>-1?r:e.length-1);return i>-1&&(-1===r||i<r)?(n=e.substring(0,i).split(":"),t.username=n[0]?o.decode(n[0]):null,n.shift(),t.password=n[0]?o.decode(n.join(":")):null,e=s.substring(i+1)):(t.username=null,t.password=null),e},o.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var s,n,r,i={},l=e.split("&"),c=l.length,d=0;d<c;d++)s=l[d].split("="),n=o.decodeQuery(s.shift(),t),r=s.length?o.decodeQuery(s.join("="),t):null,"__proto__"!==n&&(a.call(i,n)?("string"!=typeof i[n]&&null!==i[n]||(i[n]=[i[n]]),i[n].push(r)):i[n]=r);return i},o.build=function(e){var t="",s=!1;return e.protocol&&(t+=e.protocol+":"),e.urn||!t&&!e.hostname||(t+="//",s=!0),t+=o.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&s&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},o.buildHost=function(e){var t="";return e.hostname?(o.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},o.buildAuthority=function(e){return o.buildUserinfo(e)+o.buildHost(e)},o.buildUserinfo=function(e){var t="";return e.username&&(t+=o.encode(e.username)),e.password&&(t+=":"+o.encode(e.password)),t&&(t+="@"),t},o.buildQuery=function(e,t,s){var n,r,i,l,c="";for(r in e)if("__proto__"!==r&&a.call(e,r))if(d(e[r]))for(n={},i=0,l=e[r].length;i<l;i++)void 0!==e[r][i]&&void 0===n[e[r][i]+""]&&(c+="&"+o.buildQueryParameter(r,e[r][i],s),!0!==t&&(n[e[r][i]+""]=!0));else void 0!==e[r]&&(c+="&"+o.buildQueryParameter(r,e[r],s));return c.substring(1)},o.buildQueryParameter=function(e,t,s){return o.encodeQuery(e,s)+(null!==t?"="+o.encodeQuery(t,s):"")},o.addQuery=function(e,t,s){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.addQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=s);"string"==typeof e[t]&&(e[t]=[e[t]]),d(s)||(s=[s]),e[t]=(e[t]||[]).concat(s)}},o.setQuery=function(e,t,s){if("object"==typeof t)for(var n in t)a.call(t,n)&&o.setQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===s?null:s}},o.removeQuery=function(e,t,s){var n,r,i;if(d(t))for(n=0,r=t.length;n<r;n++)e[t[n]]=void 0;else if("RegExp"===c(t))for(i in e)t.test(i)&&(e[i]=void 0);else if("object"==typeof t)for(i in t)a.call(t,i)&&o.removeQuery(e,i,t[i]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==s?"RegExp"===c(s)?!d(e[t])&&s.test(e[t])?e[t]=void 0:e[t]=u(e[t],s):e[t]!==String(s)||d(s)&&1!==s.length?d(e[t])&&(e[t]=u(e[t],s)):e[t]=void 0:e[t]=void 0}},o.hasQuery=function(e,t,s,n){switch(c(t)){case"String":break;case"RegExp":for(var r in e)if(a.call(e,r)&&t.test(r)&&(void 0===s||o.hasQuery(e,r,s)))return!0;return!1;case"Object":for(var i in t)if(a.call(t,i)&&!o.hasQuery(e,i,t[i]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(c(s)){case"Undefined":return t in e;case"Boolean":return s===Boolean(d(e[t])?e[t].length:e[t]);case"Function":return!!s(e[t],t,e);case"Array":return!!d(e[t])&&(n?h:f)(e[t],s);case"RegExp":return d(e[t])?!!n&&h(e[t],s):Boolean(e[t]&&e[t].match(s));case"Number":s=String(s);case"String":return d(e[t])?!!n&&h(e[t],s):e[t]===s;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},o.joinPaths=function(){for(var e=[],t=[],s=0,n=0;n<arguments.length;n++){var r=new o(arguments[n]);e.push(r);for(var i=r.segment(),a=0;a<i.length;a++)"string"==typeof i[a]&&t.push(i[a]),i[a]&&s++}if(!t.length||!s)return new o("");var l=new o("").segment(t);return""!==e[0].path()&&"/"!==e[0].path().slice(0,1)||l.path("/"+l.path()),l.normalize()},o.commonPath=function(e,t){var s,n=Math.min(e.length,t.length);for(s=0;s<n;s++)if(e.charAt(s)!==t.charAt(s)){s--;break}return s<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":("/"===e.charAt(s)&&"/"===t.charAt(s)||(s=e.substring(0,s).lastIndexOf("/")),e.substring(0,s+1))},o.withinString=function(e,t,s){s||(s={});var n=s.start||o.findUri.start,r=s.end||o.findUri.end,i=s.trim||o.findUri.trim,a=s.parens||o.findUri.parens,l=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var c=n.exec(e);if(!c)break;var d=c.index;if(s.ignoreHtml){var u=e.slice(Math.max(d-3,0),d);if(u&&l.test(u))continue}for(var h=d+e.slice(d).search(r),f=e.slice(d,h),m=-1;;){var p=a.exec(f);if(!p)break;var g=p.index+p[0].length;m=Math.max(m,g)}if(!((f=m>-1?f.slice(0,m)+f.slice(m).replace(i,""):f.replace(i,"")).length<=c[0].length||s.ignore&&s.ignore.test(f))){var _=t(f,d,h=d+f.length,e);void 0!==_?(_=String(_),e=e.slice(0,d)+_+e.slice(h),n.lastIndex=d+_.length):n.lastIndex=h}}return n.lastIndex=0,e},o.ensureValidHostname=function(t,s){var n=!!t,r=!1;if(!!s&&(r=h(o.hostProtocols,s)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+s);if(t&&t.match(o.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(o.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},o.ensureValidPort=function(e){if(e){var t=Number(e);if(!(/^[0-9]+$/.test(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},o.noConflict=function(e){if(e){var t={URI:this.noConflict()};return n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t}return n.URI===this&&(n.URI=r),this},i.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=o.build(this._parts),this._deferred_build=!1),this},i.clone=function(){return new o(this)},i.valueOf=i.toString=function(){return this.build(!1)._string},i.protocol=j("protocol"),i.username=j("username"),i.password=j("password"),i.hostname=j("hostname"),i.port=j("port"),i.query=w("query","?"),i.fragment=w("fragment","#"),i.search=function(e,t){var s=this.query(e,t);return"string"==typeof s&&s.length?"?"+s:s},i.hash=function(e,t){var s=this.fragment(e,t);return"string"==typeof s&&s.length?"#"+s:s},i.pathname=function(e,t){if(void 0===e||!0===e){var s=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?o.decodeUrnPath:o.decodePath)(s):s}return this._parts.urn?this._parts.path=e?o.recodeUrnPath(e):"":this._parts.path=e?o.recodePath(e):"/",this.build(!t),this},i.path=i.pathname,i.href=function(e,t){var s;if(void 0===e)return this.toString();this._string="",this._parts=o._parts();var n=e instanceof o,r="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[o.getDomAttribute(e)]||"",r=!1),!n&&r&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=o.parse(String(e),this._parts);else{if(!n&&!r)throw new TypeError("invalid input");var i=n?e._parts:e;for(s in i)"query"!==s&&a.call(this._parts,s)&&(this._parts[s]=i[s]);i.query&&this.query(i.query,!1)}return this.build(!t),this},i.is=function(e){var t=!1,n=!1,r=!1,i=!1,a=!1,l=!1,c=!1,d=!this._parts.urn;switch(this._parts.hostname&&(d=!1,n=o.ip4_expression.test(this._parts.hostname),r=o.ip6_expression.test(this._parts.hostname),a=(i=!(t=n||r))&&s&&s.has(this._parts.hostname),l=i&&o.idn_expression.test(this._parts.hostname),c=i&&o.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return d;case"absolute":return!d;case"domain":case"name":return i;case"sld":return a;case"ip":return t;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return l;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return c}return null};var S=i.protocol,x=i.port,E=i.hostname;i.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(o.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return S.call(this,e,t)},i.scheme=i.protocol,i.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),o.ensureValidPort(e))),x.call(this,e,t))},i.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var s={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==o.parseHost(e,s))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=s.hostname,this._parts.preventInvalidHostname&&o.ensureValidHostname(e,this._parts.protocol)}return E.call(this,e,t)},i.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var s=this.protocol();return this.authority()?(s?s+"://":"")+this.authority():""}var n=o(e);return this.protocol(n.protocol()).authority(n.authority()).build(!t),this},i.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildHost(this._parts):"";if("/"!==o.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},i.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildAuthority(this._parts):"";if("/"!==o.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},i.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var s=o.buildUserinfo(this._parts);return s?s.substring(0,s.length-1):s}return"@"!==e[e.length-1]&&(e+="@"),o.parseUserinfo(e,this._parts),this.build(!t),this},i.resource=function(e,t){var s;return void 0===e?this.path()+this.search()+this.hash():(s=o.parse(e),this._parts.path=s.path,this._parts.query=s.query,this._parts.fragment=s.fragment,this.build(!t),this)},i.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var s=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,s)||""}var n=this._parts.hostname.length-this.domain().length,r=this._parts.hostname.substring(0,n),i=new RegExp("^"+l(r));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&o.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(i,e),this.build(!t),this},i.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var s=this._parts.hostname.match(/\./g);if(s&&s.length<2)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(t).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(o.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var r=new RegExp(l(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(r,e)}return this.build(!t),this},i.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),r=this._parts.hostname.substring(n+1);return!0!==t&&s&&s.list[r.toLowerCase()]&&s.get(this._parts.hostname)||r}var o;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!s||!s.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},i.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var s=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,s)||(this._parts.hostname?"/":"");return e?o.decodePath(n):n}var r=this._parts.path.length-this.filename().length,i=this._parts.path.substring(0,r),a=new RegExp("^"+l(i));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e),this.build(!t),this},i.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var s=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(s+1);return e?o.decodePathSegment(n):n}var r=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(r=!0);var i=new RegExp(l(this.filename())+"$");return e=o.recodePath(e),this._parts.path=this._parts.path.replace(i,e),r?this.normalizePath(t):this.build(!t),this},i.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var s,n,r=this.filename(),i=r.lastIndexOf(".");return-1===i?"":(s=r.substring(i+1),n=/^[a-z0-9%]+$/i.test(s)?s:"",e?o.decodePathSegment(n):n)}"."===e.charAt(0)&&(e=e.substring(1));var a,c=this.suffix();if(c)a=e?new RegExp(l(c)+"$"):new RegExp(l("."+c)+"$");else{if(!e)return this;this._parts.path+="."+o.recodePath(e)}return a&&(e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e)),this.build(!t),this},i.segment=function(e,t,s){var n=this._parts.urn?":":"/",r=this.path(),o="/"===r.substring(0,1),i=r.split(n);if(void 0!==e&&"number"!=typeof e&&(s=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(o&&i.shift(),e<0&&(e=Math.max(i.length+e,0)),void 0===t)return void 0===e?i:i[e];if(null===e||void 0===i[e])if(d(t)){i=[];for(var a=0,l=t.length;a<l;a++)(t[a].length||i.length&&i[i.length-1].length)&&(i.length&&!i[i.length-1].length&&i.pop(),i.push(m(t[a])))}else(t||"string"==typeof t)&&(t=m(t),""===i[i.length-1]?i[i.length-1]=t:i.push(t));else t?i[e]=m(t):i.splice(e,1);return o&&i.unshift(""),this.path(i.join(n),s)},i.segmentCoded=function(e,t,s){var n,r,i;if("number"!=typeof e&&(s=t,t=e,e=void 0),void 0===t){if(d(n=this.segment(e,t,s)))for(r=0,i=n.length;r<i;r++)n[r]=o.decode(n[r]);else n=void 0!==n?o.decode(n):void 0;return n}if(d(t))for(r=0,i=t.length;r<i;r++)t[r]=o.encode(t[r]);else t="string"==typeof t||t instanceof String?o.encode(t):t;return this.segment(e,t,s)};var A=i.query;return i.query=function(e,t){if(!0===e)return o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var s=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=e.call(this,s);return this._parts.query=o.buildQuery(n||s,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=o.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):A.call(this,e,t)},i.setQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)n[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var r in e)a.call(e,r)&&(n[r]=e[r])}return this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.addQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.addQuery(n,e,void 0===t?null:t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.removeQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.removeQuery(n,e,t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(s=t),this.build(!s),this},i.hasQuery=function(e,t,s){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.hasQuery(n,e,t,s)},i.setSearch=i.setQuery,i.addSearch=i.addQuery,i.removeSearch=i.removeQuery,i.hasSearch=i.hasQuery,i.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},i.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},i.normalizeHostname=function(s){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!s)),this},i.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===o.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},i.normalizePath=function(e){var t,s=this._parts.path;if(!s)return this;if(this._parts.urn)return this._parts.path=o.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var n,r,i="";for("/"!==(s=o.recodePath(s)).charAt(0)&&(t=!0,s="/"+s),"/.."!==s.slice(-3)&&"/."!==s.slice(-2)||(s+="/"),s=s.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),t&&(i=s.substring(1).match(/^(\.\.\/)+/)||"")&&(i=i[0]);-1!==(n=s.search(/\/\.\.(\/|$)/));)0!==n?(-1===(r=s.substring(0,n).lastIndexOf("/"))&&(r=n),s=s.substring(0,r)+s.substring(n+3)):s=s.substring(3);return t&&this.is("relative")&&(s=i+s.substring(1)),this._parts.path=s,this.build(!e),this},i.normalizePathname=i.normalizePath,i.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},i.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},i.normalizeSearch=i.normalizeQuery,i.normalizeHash=i.normalizeFragment,i.iso8859=function(){var e=o.encode,t=o.decode;o.encode=escape,o.decode=decodeURIComponent;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},i.unicode=function(){var e=o.encode,t=o.decode;o.encode=g,o.decode=unescape;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},i.readable=function(){var t=this.clone();t.username("").password("").normalize();var s="";if(t._parts.protocol&&(s+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(s+=e.toUnicode(t._parts.hostname),t._parts.port&&(s+=":"+t._parts.port)):s+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(s+="/"),s+=t.path(!0),t._parts.query){for(var n="",r=0,i=t._parts.query.split("&"),a=i.length;r<a;r++){var l=(i[r]||"").split("=");n+="&"+o.decodeQuery(l[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==l[1]&&(n+="="+o.decodeQuery(l[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}s+="?"+n.substring(1)}return s+=o.decodeQuery(t.hash(),!0)},i.absoluteTo=function(e){var t,s,n,r=this.clone(),i=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof o||(e=new o(e)),r._parts.protocol)return r;if(r._parts.protocol=e._parts.protocol,this._parts.hostname)return r;for(s=0;n=i[s];s++)r._parts[n]=e._parts[n];return r._parts.path?(".."===r._parts.path.substring(-2)&&(r._parts.path+="/"),"/"!==r.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),r._parts.path=(t?t+"/":"")+r._parts.path,r.normalizePath())):(r._parts.path=e._parts.path,r._parts.query||(r._parts.query=e._parts.query)),r.build(),r},i.relativeTo=function(e){var t,s,n,r,i,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new o(e).normalize(),t=a._parts,s=e._parts,r=a.path(),i=e.path(),"/"!==r.charAt(0))throw new Error("URI is already relative");if("/"!==i.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===s.protocol&&(t.protocol=null),t.username!==s.username||t.password!==s.password)return a.build();if(null!==t.protocol||null!==t.username||null!==t.password)return a.build();if(t.hostname!==s.hostname||t.port!==s.port)return a.build();if(t.hostname=null,t.port=null,r===i)return t.path="",a.build();if(!(n=o.commonPath(r,i)))return a.build();var l=s.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=l+t.path.substring(n.length)||"./",a.build()},i.equals=function(e){var t,s,n,r,i,l=this.clone(),c=new o(e),u={};if(l.normalize(),c.normalize(),l.toString()===c.toString())return!0;if(n=l.query(),r=c.query(),l.query(""),c.query(""),l.toString()!==c.toString())return!1;if(n.length!==r.length)return!1;for(i in t=o.parseQuery(n,this._parts.escapeQuerySpace),s=o.parseQuery(r,this._parts.escapeQuerySpace),t)if(a.call(t,i)){if(d(t[i])){if(!f(t[i],s[i]))return!1}else if(t[i]!==s[i])return!1;u[i]=!0}for(i in s)if(a.call(s,i)&&!u[i])return!1;return!0},i.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},i.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},i.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},o}))},562:function(e,t,s){var n;e=s.nmd(e),function(r){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof s.g&&s.g;o.global!==o&&o.window!==o&&o.self;var i,a=2147483647,l=36,c=1,d=26,u=38,h=700,f=72,m=128,p="-",g=/^xn--/,_=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=l-c,j=Math.floor,w=String.fromCharCode;function S(e){throw new RangeError(y[e])}function x(e,t){for(var s=e.length,n=[];s--;)n[s]=t(e[s]);return n}function E(e,t){var s=e.split("@"),n="";return s.length>1&&(n=s[0]+"@",e=s[1]),n+x((e=e.replace(v,".")).split("."),t).join(".")}function A(e){for(var t,s,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(s=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&s)+65536):(n.push(t),r--):n.push(t);return n}function C(e){return x(e,(function(e){var t="";return e>65535&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=w(e)})).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,s){var n=0;for(e=s?j(e/h):e>>1,e+=j(e/t);e>b*d>>1;n+=l)e=j(e/b);return j(n+(b+1)*e/(e+u))}function k(e){var t,s,n,r,o,i,u,h,g,_,v,y=[],b=e.length,w=0,x=m,E=f;for((s=e.lastIndexOf(p))<0&&(s=0),n=0;n<s;++n)e.charCodeAt(n)>=128&&S("not-basic"),y.push(e.charCodeAt(n));for(r=s>0?s+1:0;r<b;){for(o=w,i=1,u=l;r>=b&&S("invalid-input"),((h=(v=e.charCodeAt(r++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:l)>=l||h>j((a-w)/i))&&S("overflow"),w+=h*i,!(h<(g=u<=E?c:u>=E+d?d:u-E));u+=l)i>j(a/(_=l-g))&&S("overflow"),i*=_;E=I(w-o,t=y.length+1,0==o),j(w/t)>a-x&&S("overflow"),x+=j(w/t),w%=t,y.splice(w++,0,x)}return C(y)}function N(e){var t,s,n,r,o,i,u,h,g,_,v,y,b,x,E,C=[];for(y=(e=A(e)).length,t=m,s=0,o=f,i=0;i<y;++i)(v=e[i])<128&&C.push(w(v));for(n=r=C.length,r&&C.push(p);n<y;){for(u=a,i=0;i<y;++i)(v=e[i])>=t&&v<u&&(u=v);for(u-t>j((a-s)/(b=n+1))&&S("overflow"),s+=(u-t)*b,t=u,i=0;i<y;++i)if((v=e[i])<t&&++s>a&&S("overflow"),v==t){for(h=s,g=l;!(h<(_=g<=o?c:g>=o+d?d:g-o));g+=l)E=h-_,x=l-_,C.push(w(T(_+E%x,0))),h=j(E/x);C.push(w(T(h,0))),o=I(s,b,n==r),s=0,++n}++s,++t}return C.join("")}i={version:"1.3.2",ucs2:{decode:A,encode:C},decode:k,encode:N,toASCII:function(e){return E(e,(function(e){return _.test(e)?"xn--"+N(e):e}))},toUnicode:function(e){return E(e,(function(e){return g.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return i}.call(t,s,t,e))||(e.exports=n)}()},484:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,s=36e5,n="millisecond",r="second",o="minute",i="hour",a="day",l="week",c="month",d="quarter",u="year",h="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],s=e%100;return"["+e+(t[(s-20)%10]||t[s]||t[0])+"]"}},_=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},v={s:_,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),r=s%60;return(t<=0?"+":"-")+_(n,2,"0")+":"+_(r,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),r=t.clone().add(n,c),o=s-r<0,i=t.clone().add(n+(o?-1:1),c);return+(-(n+(s-r)/(o?r-i:i-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:a,D:h,h:i,m:o,s:r,ms:n,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=g;var j=function(e){return e instanceof E},w=function e(t,s,n){var r;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(r=o),s&&(b[o]=s,r=o);var i=t.split("-");if(!r&&i.length>1)return e(i[0])}else{var a=t.name;b[a]=t,r=a}return!n&&r&&(y=r),r||!n&&y},S=function(e,t){if(j(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new E(s)},x=v;x.l=w,x.i=j,x.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var _=g.prototype;return _.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(x.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(m);if(n){var r=n[2]-1||0,o=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},_.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},_.$utils=function(){return x},_.isValid=function(){return!(this.$d.toString()===f)},_.isSame=function(e,t){var s=S(e);return this.startOf(t)<=s&&s<=this.endOf(t)},_.isAfter=function(e,t){return S(e)<this.startOf(t)},_.isBefore=function(e,t){return this.endOf(t)<S(e)},_.$g=function(e,t,s){return x.u(e)?this[t]:this.set(s,e)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(e,t){var s=this,n=!!x.u(t)||t,d=x.p(e),f=function(e,t){var r=x.w(s.$u?Date.UTC(s.$y,t,e):new Date(s.$y,t,e),s);return n?r:r.endOf(a)},m=function(e,t){return x.w(s.toDate()[e].apply(s.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},p=this.$W,g=this.$M,_=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case u:return n?f(1,0):f(31,11);case c:return n?f(1,g):f(0,g+1);case l:var y=this.$locale().weekStart||0,b=(p<y?p+7:p)-y;return f(n?_-b:_+(6-b),g);case a:case h:return m(v+"Hours",0);case i:return m(v+"Minutes",1);case o:return m(v+"Seconds",2);case r:return m(v+"Milliseconds",3);default:return this.clone()}},_.endOf=function(e){return this.startOf(e,!1)},_.$set=function(e,t){var s,l=x.p(e),d="set"+(this.$u?"UTC":""),f=(s={},s[a]=d+"Date",s[h]=d+"Date",s[c]=d+"Month",s[u]=d+"FullYear",s[i]=d+"Hours",s[o]=d+"Minutes",s[r]=d+"Seconds",s[n]=d+"Milliseconds",s)[l],m=l===a?this.$D+(t-this.$W):t;if(l===c||l===u){var p=this.clone().set(h,1);p.$d[f](m),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},_.set=function(e,t){return this.clone().$set(e,t)},_.get=function(e){return this[x.p(e)]()},_.add=function(n,d){var h,f=this;n=Number(n);var m=x.p(d),p=function(e){var t=S(f);return x.w(t.date(t.date()+Math.round(e*n)),f)};if(m===c)return this.set(c,this.$M+n);if(m===u)return this.set(u,this.$y+n);if(m===a)return p(1);if(m===l)return p(7);var g=(h={},h[o]=t,h[i]=s,h[r]=e,h)[m]||1,_=this.$d.getTime()+n*g;return x.w(_,this)},_.subtract=function(e,t){return this.add(-1*e,t)},_.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=x.z(this),o=this.$H,i=this.$m,a=this.$M,l=s.weekdays,c=s.months,d=function(e,s,r,o){return e&&(e[s]||e(t,n))||r[s].slice(0,o)},u=function(e){return x.s(o%12||12,e,"0")},h=s.meridiem||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n},m={YY:String(this.$y).slice(-2),YYYY:x.s(this.$y,4,"0"),M:a+1,MM:x.s(a+1,2,"0"),MMM:d(s.monthsShort,a,c,3),MMMM:d(c,a),D:this.$D,DD:x.s(this.$D,2,"0"),d:String(this.$W),dd:d(s.weekdaysMin,this.$W,l,2),ddd:d(s.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:x.s(o,2,"0"),h:u(1),hh:u(2),a:h(o,i,!0),A:h(o,i,!1),m:String(i),mm:x.s(i,2,"0"),s:String(this.$s),ss:x.s(this.$s,2,"0"),SSS:x.s(this.$ms,3,"0"),Z:r};return n.replace(p,(function(e,t){return t||m[e]||r.replace(":","")}))},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(n,h,f){var m,p=x.p(h),g=S(n),_=(g.utcOffset()-this.utcOffset())*t,v=this-g,y=x.m(this,g);return y=(m={},m[u]=y/12,m[c]=y,m[d]=y/3,m[l]=(v-_)/6048e5,m[a]=(v-_)/864e5,m[i]=v/s,m[o]=v/t,m[r]=v/e,m)[p]||v,f?y:x.a(y)},_.daysInMonth=function(){return this.endOf(c).$D},_.$locale=function(){return b[this.$L]},_.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=w(e,t,!0);return n&&(s.$L=n),s},_.clone=function(){return x.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},g}(),A=E.prototype;return S.prototype=A,[["$ms",n],["$s",r],["$m",o],["$H",i],["$W",a],["$M",c],["$y",u],["$D",h]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,E,S),e.$i=!0),S},S.locale=w,S.isDayjs=j,S.unix=function(e){return S(1e3*e)},S.en=b[y],S.Ls=b,S.p={},S}()},734:function(e){e.exports=function(){"use strict";return function(e,t){var s=t.prototype,n=s.format;s.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return n.bind(this)(e);var r=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return s.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return s.ordinal(t.week(),"W");case"w":case"ww":return r.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return r.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return n.bind(this)(o)}}}()},856:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,s){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,s)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function n(e,r,o){return n=s()?Reflect.construct:function(e,s,n){var r=[null];r.push.apply(r,s);var o=new(Function.bind.apply(e,r));return n&&t(o,n.prototype),o},n.apply(null,arguments)}function r(e){return o(e)||i(e)||a(e)||c()}function o(e){if(Array.isArray(e))return l(e)}function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function a(e,t){if(e){if("string"==typeof e)return l(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d=Object.hasOwnProperty,u=Object.setPrototypeOf,h=Object.isFrozen,f=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,p=Object.freeze,g=Object.seal,_=Object.create,v="undefined"!=typeof Reflect&&Reflect,y=v.apply,b=v.construct;y||(y=function(e,t,s){return e.apply(t,s)}),p||(p=function(e){return e}),g||(g=function(e){return e}),b||(b=function(e,t){return n(e,r(t))});var j=O(Array.prototype.forEach),w=O(Array.prototype.pop),S=O(Array.prototype.push),x=O(String.prototype.toLowerCase),E=O(String.prototype.toString),A=O(String.prototype.match),C=O(String.prototype.replace),T=O(String.prototype.indexOf),I=O(String.prototype.trim),k=O(RegExp.prototype.test),N=M(TypeError);function O(e){return function(t){for(var s=arguments.length,n=new Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];return y(e,t,n)}}function M(e){return function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return b(e,s)}}function $(e,t,s){s=s||x,u&&u(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var o=s(r);o!==r&&(h(t)||(t[n]=o),r=o)}e[r]=!0}return e}function R(e){var t,s=_(null);for(t in e)!0===y(d,e,[t])&&(s[t]=e[t]);return s}function D(e,t){for(;null!==e;){var s=m(e,t);if(s){if(s.get)return O(s.get);if("function"==typeof s.value)return O(s.value)}e=f(e)}function n(e){return console.warn("fallback value for",e),null}return n}var P=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),z=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),q=p(["#text"]),H=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),G=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),V=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=g(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Q=g(/<%[\w\W]*|[\w\W]*%>/gm),Y=g(/\${[\w\W]*}/gm),K=g(/^data-[\-\w.\u00B7-\uFFFF]/),X=g(/^aria-[\-\w]+$/),Z=g(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=g(/^(?:\w+script|data):/i),te=g(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),se=g(/^html$/i),ne=function(){return"undefined"==typeof window?null:window},re=function(t,s){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var n=null,r="data-tt-policy-suffix";s.currentScript&&s.currentScript.hasAttribute(r)&&(n=s.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function oe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne(),s=function(e){return oe(e)};if(s.version="2.4.5",s.removed=[],!t||!t.document||9!==t.document.nodeType)return s.isSupported=!1,s;var n=t.document,o=t.document,i=t.DocumentFragment,a=t.HTMLTemplateElement,l=t.Node,c=t.Element,d=t.NodeFilter,u=t.NamedNodeMap,h=void 0===u?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,m=t.DOMParser,g=t.trustedTypes,_=c.prototype,v=D(_,"cloneNode"),y=D(_,"nextSibling"),b=D(_,"childNodes"),O=D(_,"parentNode");if("function"==typeof a){var M=o.createElement("template");M.content&&M.content.ownerDocument&&(o=M.content.ownerDocument)}var ie=re(g,n),ae=ie?ie.createHTML(""):"",le=o,ce=le.implementation,de=le.createNodeIterator,ue=le.createDocumentFragment,he=le.getElementsByTagName,fe=n.importNode,me={};try{me=R(o).documentMode?o.documentMode:{}}catch(e){}var pe={};s.isSupported="function"==typeof O&&ce&&void 0!==ce.createHTMLDocument&&9!==me;var ge,_e,ve=J,ye=Q,be=Y,je=K,we=X,Se=ee,xe=te,Ee=Z,Ae=null,Ce=$({},[].concat(r(P),r(L),r(z),r(U),r(q))),Te=null,Ie=$({},[].concat(r(H),r(G),r(W),r(V))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,Oe=null,Me=!0,$e=!0,Re=!1,De=!0,Pe=!1,Le=!1,ze=!1,Fe=!1,Ue=!1,Be=!1,qe=!1,He=!0,Ge=!1,We="user-content-",Ve=!0,Je=!1,Qe={},Ye=null,Ke=$({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xe=null,Ze=$({},["audio","video","img","source","image","track"]),et=null,tt=$({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),st="http://www.w3.org/1998/Math/MathML",nt="http://www.w3.org/2000/svg",rt="http://www.w3.org/1999/xhtml",ot=rt,it=!1,at=null,lt=$({},[st,nt,rt],E),ct=["application/xhtml+xml","text/html"],dt="text/html",ut=null,ht=o.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},mt=function(t){ut&&ut===t||(t&&"object"===e(t)||(t={}),t=R(t),ge=ge=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?dt:t.PARSER_MEDIA_TYPE,_e="application/xhtml+xml"===ge?E:x,Ae="ALLOWED_TAGS"in t?$({},t.ALLOWED_TAGS,_e):Ce,Te="ALLOWED_ATTR"in t?$({},t.ALLOWED_ATTR,_e):Ie,at="ALLOWED_NAMESPACES"in t?$({},t.ALLOWED_NAMESPACES,E):lt,et="ADD_URI_SAFE_ATTR"in t?$(R(tt),t.ADD_URI_SAFE_ATTR,_e):tt,Xe="ADD_DATA_URI_TAGS"in t?$(R(Ze),t.ADD_DATA_URI_TAGS,_e):Ze,Ye="FORBID_CONTENTS"in t?$({},t.FORBID_CONTENTS,_e):Ke,Ne="FORBID_TAGS"in t?$({},t.FORBID_TAGS,_e):{},Oe="FORBID_ATTR"in t?$({},t.FORBID_ATTR,_e):{},Qe="USE_PROFILES"in t&&t.USE_PROFILES,Me=!1!==t.ALLOW_ARIA_ATTR,$e=!1!==t.ALLOW_DATA_ATTR,Re=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pe=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,Ue=t.RETURN_DOM||!1,Be=t.RETURN_DOM_FRAGMENT||!1,qe=t.RETURN_TRUSTED_TYPE||!1,Fe=t.FORCE_BODY||!1,He=!1!==t.SANITIZE_DOM,Ge=t.SANITIZE_NAMED_PROPS||!1,Ve=!1!==t.KEEP_CONTENT,Je=t.IN_PLACE||!1,Ee=t.ALLOWED_URI_REGEXP||Ee,ot=t.NAMESPACE||rt,ke=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&($e=!1),Be&&(Ue=!0),Qe&&(Ae=$({},r(q)),Te=[],!0===Qe.html&&($(Ae,P),$(Te,H)),!0===Qe.svg&&($(Ae,L),$(Te,G),$(Te,V)),!0===Qe.svgFilters&&($(Ae,z),$(Te,G),$(Te,V)),!0===Qe.mathMl&&($(Ae,U),$(Te,W),$(Te,V))),t.ADD_TAGS&&(Ae===Ce&&(Ae=R(Ae)),$(Ae,t.ADD_TAGS,_e)),t.ADD_ATTR&&(Te===Ie&&(Te=R(Te)),$(Te,t.ADD_ATTR,_e)),t.ADD_URI_SAFE_ATTR&&$(et,t.ADD_URI_SAFE_ATTR,_e),t.FORBID_CONTENTS&&(Ye===Ke&&(Ye=R(Ye)),$(Ye,t.FORBID_CONTENTS,_e)),Ve&&(Ae["#text"]=!0),Le&&$(Ae,["html","head","body"]),Ae.table&&($(Ae,["tbody"]),delete Ne.tbody),p&&p(t),ut=t)},pt=$({},["mi","mo","mn","ms","mtext"]),gt=$({},["foreignobject","desc","title","annotation-xml"]),_t=$({},["title","style","font","a","script"]),vt=$({},L);$(vt,z),$(vt,F);var yt=$({},U);$(yt,B);var bt=function(e){var t=O(e);t&&t.tagName||(t={namespaceURI:ot,tagName:"template"});var s=x(e.tagName),n=x(t.tagName);return!!at[e.namespaceURI]&&(e.namespaceURI===nt?t.namespaceURI===rt?"svg"===s:t.namespaceURI===st?"svg"===s&&("annotation-xml"===n||pt[n]):Boolean(vt[s]):e.namespaceURI===st?t.namespaceURI===rt?"math"===s:t.namespaceURI===nt?"math"===s&&gt[n]:Boolean(yt[s]):e.namespaceURI===rt?!(t.namespaceURI===nt&&!gt[n])&&!(t.namespaceURI===st&&!pt[n])&&!yt[s]&&(_t[s]||!vt[s]):!("application/xhtml+xml"!==ge||!at[e.namespaceURI]))},jt=function(e){S(s.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ae}catch(t){e.remove()}}},wt=function(e,t){try{S(s.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){S(s.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Ue||Be)try{jt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},St=function(e){var t,s;if(Fe)e="<remove></remove>"+e;else{var n=A(e,/^[\r\n\t ]+/);s=n&&n[0]}"application/xhtml+xml"===ge&&ot===rt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var r=ie?ie.createHTML(e):e;if(ot===rt)try{t=(new m).parseFromString(r,ge)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(ot,"template",null);try{t.documentElement.innerHTML=it?ae:r}catch(e){}}var i=t.body||t.documentElement;return e&&s&&i.insertBefore(o.createTextNode(s),i.childNodes[0]||null),ot===rt?he.call(t,Le?"html":"body")[0]:Le?t.documentElement:i},xt=function(e){return de.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Et=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},At=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Ct=function(e,t,n){pe[e]&&j(pe[e],(function(e){e.call(s,t,n,ut)}))},Tt=function(e){var t;if(Ct("beforeSanitizeElements",e,null),Et(e))return jt(e),!0;if(k(/[\u0080-\uFFFF]/,e.nodeName))return jt(e),!0;var n=_e(e.nodeName);if(Ct("uponSanitizeElement",e,{tagName:n,allowedTags:Ae}),e.hasChildNodes()&&!At(e.firstElementChild)&&(!At(e.content)||!At(e.content.firstElementChild))&&k(/<[/\w]/g,e.innerHTML)&&k(/<[/\w]/g,e.textContent))return jt(e),!0;if("select"===n&&k(/<template/i,e.innerHTML))return jt(e),!0;if(!Ae[n]||Ne[n]){if(!Ne[n]&&kt(n)){if(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,n))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(n))return!1}if(Ve&&!Ye[n]){var r=O(e)||e.parentNode,o=b(e)||e.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(v(o[i],!0),y(e))}return jt(e),!0}return e instanceof c&&!bt(e)?(jt(e),!0):"noscript"!==n&&"noembed"!==n||!k(/<\/no(script|embed)/i,e.innerHTML)?(Pe&&3===e.nodeType&&(t=e.textContent,t=C(t,ve," "),t=C(t,ye," "),t=C(t,be," "),e.textContent!==t&&(S(s.removed,{element:e.cloneNode()}),e.textContent=t)),Ct("afterSanitizeElements",e,null),!1):(jt(e),!0)},It=function(e,t,s){if(He&&("id"===t||"name"===t)&&(s in o||s in ht))return!1;if($e&&!Oe[t]&&k(je,t));else if(Me&&k(we,t));else if(!Te[t]||Oe[t]){if(!(kt(e)&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&k(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,s)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(s))))return!1}else if(et[t]);else if(k(Ee,C(s,xe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==T(s,"data:")||!Xe[e])if(Re&&!k(Se,C(s,xe,"")));else if(s)return!1;return!0},kt=function(e){return e.indexOf("-")>0},Nt=function(t){var n,r,o,i;Ct("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(i=a.length;i--;){var c=n=a[i],d=c.name,u=c.namespaceURI;if(r="value"===d?n.value:I(n.value),o=_e(d),l.attrName=o,l.attrValue=r,l.keepAttr=!0,l.forceKeepAttr=void 0,Ct("uponSanitizeAttribute",t,l),r=l.attrValue,!l.forceKeepAttr&&(wt(d,t),l.keepAttr))if(De||!k(/\/>/i,r)){Pe&&(r=C(r,ve," "),r=C(r,ye," "),r=C(r,be," "));var h=_e(t.nodeName);if(It(h,o,r)){if(!Ge||"id"!==o&&"name"!==o||(wt(d,t),r=We+r),ie&&"object"===e(g)&&"function"==typeof g.getAttributeType)if(u);else switch(g.getAttributeType(h,o)){case"TrustedHTML":r=ie.createHTML(r);break;case"TrustedScriptURL":r=ie.createScriptURL(r)}try{u?t.setAttributeNS(u,d,r):t.setAttribute(d,r),w(s.removed)}catch(e){}}}else wt(d,t)}Ct("afterSanitizeAttributes",t,null)}},Ot=function e(t){var s,n=xt(t);for(Ct("beforeSanitizeShadowDOM",t,null);s=n.nextNode();)Ct("uponSanitizeShadowNode",s,null),Tt(s)||(s.content instanceof i&&e(s.content),Nt(s));Ct("afterSanitizeShadowDOM",t,null)};return s.sanitize=function(r){var o,a,c,d,u,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!r)&&(r="\x3c!--\x3e"),"string"!=typeof r&&!At(r)){if("function"!=typeof r.toString)throw N("toString is not a function");if("string"!=typeof(r=r.toString()))throw N("dirty is not a string, aborting")}if(!s.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof r)return t.toStaticHTML(r);if(At(r))return t.toStaticHTML(r.outerHTML)}return r}if(ze||mt(h),s.removed=[],"string"==typeof r&&(Je=!1),Je){if(r.nodeName){var f=_e(r.nodeName);if(!Ae[f]||Ne[f])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof l)1===(a=(o=St("\x3c!----\x3e")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!Ue&&!Pe&&!Le&&-1===r.indexOf("<"))return ie&&qe?ie.createHTML(r):r;if(!(o=St(r)))return Ue?null:qe?ae:""}o&&Fe&&jt(o.firstChild);for(var m=xt(Je?r:o);c=m.nextNode();)3===c.nodeType&&c===d||Tt(c)||(c.content instanceof i&&Ot(c.content),Nt(c),d=c);if(d=null,Je)return r;if(Ue){if(Be)for(u=ue.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(Te.shadowroot||Te.shadowrootmod)&&(u=fe.call(n,u,!0)),u}var p=Le?o.outerHTML:o.innerHTML;return Le&&Ae["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&k(se,o.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+p),Pe&&(p=C(p,ve," "),p=C(p,ye," "),p=C(p,be," ")),ie&&qe?ie.createHTML(p):p},s.setConfig=function(e){mt(e),ze=!0},s.clearConfig=function(){ut=null,ze=!1},s.isValidAttribute=function(e,t,s){ut||mt({});var n=_e(e),r=_e(t);return It(n,r,s)},s.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],S(pe[e],t))},s.removeHook=function(e){if(pe[e])return w(pe[e])},s.removeHooks=function(e){pe[e]&&(pe[e]=[])},s.removeAllHooks=function(){pe={}},s}return oe()}()},705:(e,t,s)=>{"use strict";var n,r,o=s.g.MutationObserver||s.g.WebKitMutationObserver;if(o){var i=0,a=new o(u),l=s.g.document.createTextNode("");a.observe(l,{characterData:!0}),n=function(){l.data=i=++i%2}}else if(s.g.setImmediate||void 0===s.g.MessageChannel)n="document"in s.g&&"onreadystatechange"in s.g.document.createElement("script")?function(){var e=s.g.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},s.g.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new s.g.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var d=[];function u(){var e,t;r=!0;for(var s=d.length;s;){for(t=d,d=[],e=-1;++e<s;)t[e]();s=d.length}r=!1}e.exports=function(e){1!==d.push(e)||r||n()}},389:(e,t,s)=>{"use strict";var n=s(705);function r(){}var o={},i=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function d(e,t,s){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof s&&(this.onRejected=s,this.callRejected=this.otherCallRejected)}function u(e,t,s){n((function(){var n;try{n=t(s)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var s=!1;function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}var i=m((function(){t(r,n)}));"error"===i.status&&n(i.value)}function m(e,t){var s={};try{s.value=e(t),s.status="success"}catch(e){s.status="error",s.value=e}return s}e.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var s=new this.constructor(r);return this.state!==l?u(s,this.state===a?e:t,this.outcome):this.queue.push(new d(s,e,t)),s},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},o.resolve=function(e,t){var s=m(h,t);if("error"===s.status)return o.reject(e,s.value);var n=s.value;if(n)f(e,n);else{e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var s=-1,n=e.queue.length;++s<n;)e.queue[s].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i=new Array(s),a=0,l=-1,c=new this(r);++l<s;)d(e[l],l);return c;function d(e,r){t.resolve(e).then((function(e){i[r]=e,++a!==s||n||(n=!0,o.resolve(c,i))}),(function(e){n||(n=!0,o.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i,a=-1,l=new this(r);++a<s;)i=e[a],t.resolve(i).then((function(e){n||(n=!0,o.resolve(l,e))}),(function(e){n||(n=!0,o.reject(l,e))}));return l}},236:(e,t,s)=>{"use strict";"function"!=typeof s.g.Promise&&(s.g.Promise=s(389))},245:function(e,t){"undefined"!=typeof self&&self,function(e){"use strict";var t="localforage-driver-memory";function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],s=0;return t?t.call(e):{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}}}function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}}var r=/^~~local_forage_type~([^~]+)~/,o=9,i=o+4,a=Object.prototype.toString;function l(e){var t=.75*e.length,s=e.length;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);for(var n=new ArrayBuffer(t),r=new Uint8Array(n),o=0,i=0;o<s;o+=4){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o]),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+1]),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+2]),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+3]);r[i++]=a<<2|l>>4,r[i++]=(15&l)<<4|c>>2,r[i++]=(3&c)<<6|63&d}return n}function c(e){for(var t=new Uint8Array(e),s="",n=0;n<t.length;n+=3)s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t[n]>>2],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&t[n])<<4|t[n+1]>>4],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&t[n+1])<<2|t[n+2]>>6],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&t[n+2]];return t.length%3==2?s=s.substring(0,s.length-1)+"=":t.length%3==1&&(s=s.substring(0,s.length-2)+"=="),s}function d(e,t){var s="";if(e&&(s=a.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===a.call(e.buffer))){var n=void 0,r="__lfsc__:";e instanceof ArrayBuffer?(n=e,r+="arbf"):(n=e.buffer,"[object Int8Array]"===s?r+="si08":"[object Uint8Array]"===s?r+="ui08":"[object Uint8ClampedArray]"===s?r+="uic8":"[object Int16Array]"===s?r+="si16":"[object Uint16Array]"===s?r+="ur16":"[object Int32Array]"===s?r+="si32":"[object Uint32Array]"===s?r+="ui32":"[object Float32Array]"===s?r+="fl32":"[object Float64Array]"===s?r+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(r+c(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s="~~local_forage_type~"+e.type+"~"+c(this.result);t("__lfsc__:blob"+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function u(e){if("__lfsc__:"!==e.substring(0,o))return JSON.parse(e);var t,s=e.substring(i),a=e.substring(o,i);if("blob"===a&&r.test(s)){var c=s.match(r);t=c[1],s=s.substring(c[0].length)}var d=l(s);switch(a){case"arbf":return d;case"blob":return n([d],{type:t});case"si08":return new Int8Array(d);case"ui08":return new Uint8Array(d);case"uic8":return new Uint8ClampedArray(d);case"si16":return new Int16Array(d);case"ur16":return new Uint16Array(d);case"si32":return new Int32Array(d);case"ui32":return new Uint32Array(d);case"fl32":return new Float32Array(d);case"fl64":return new Float64Array(d);default:throw new Error("Unkown type: "+a)}}function h(e){var t,n;if(null===e||"object"!=typeof e||"isActiveClone"in e)return e;var r=e instanceof Date?new Date(e):e.constructor();try{for(var o=s(Object.keys(e)),i=o.next();!i.done;i=o.next()){var a=i.value;Object.prototype.hasOwnProperty.call(e,a)&&(e.isActiveClone=null,r[a]=h(e[a]),delete e.isActiveClone)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function f(e,t){return(e.name||t.name)+"/"+(e.storeName||t.storeName)+"/"}function m(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function g(e,t){var s=this;if(t=p.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}return{promise:e.name?new Promise((function(t){e.storeName?t(f(e,s._defaultConfig)):t(e.name+"/")})):Promise.reject("Invalid arguments"),callback:t}}function _(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}var v={bufferToString:c,deserialize:u,serialize:d,stringToBuffer:l},y={},b=function(){function e(e){this.kp=e,this.data={}}return e.resolve=function(t){return y[t]||(y[t]=new e(t)),y[t]},e.prototype.clear=function(){this.data={}},e.prototype.drop=function(){this.clear(),delete y[this.kp]},e.prototype.get=function(e){return this.data[e]},e.prototype.key=function(e){return this.keys()[e]},e.prototype.keys=function(){return Object.keys(this.data)},e.prototype.rm=function(e){delete this.data[e]},e.prototype.set=function(e,t){this.data[e]=t},e}();function j(e){var t=e?h(e):{},s=f(t,this._defaultConfig),n=b.resolve(s);return this._dbInfo=t,this._dbInfo.serializer=v,this._dbInfo.keyPrefix=s,this._dbInfo.mStore=n,Promise.resolve()}function w(e){var t=this,s=this.ready().then((function(){t._dbInfo.mStore.clear()}));return m(s,e),s}function S(e,t){var s=g.apply(this,arguments),n=s.promise,r=s.callback;return m(n.then((function(e){b.resolve(e).drop()})),r),n}function x(e,t){var s=this;e=_(e);var n=this.ready().then((function(){var t=s._dbInfo.mStore.get(e);return null==t?null:s._dbInfo.serializer.deserialize(t)}));return m(n,t),n}function E(e,t){var s=this,n=this.ready().then((function(){for(var t=s._dbInfo.mStore,n=t.keys(),r=0;r<n.length;r++){var o=t.get(n[r]);if(o&&(o=s._dbInfo.serializer.deserialize(o)),void 0!==(o=e(o,n[r],r+1)))return o}}));return m(n,t),n}function A(e,t){var s=this,n=this.ready().then((function(){var t;try{void 0===(t=s._dbInfo.mStore.key(e))&&(t=null)}catch(e){t=null}return t}));return m(n,t),n}function C(e){var t=this,s=this.ready().then((function(){return t._dbInfo.mStore.keys()}));return m(s,e),s}function T(e){var t=this.keys().then((function(e){return e.length}));return m(t,e),t}function I(e,t){var s=this;e=_(e);var n=this.ready().then((function(){s._dbInfo.mStore.rm(e)}));return m(n,t),n}function k(e,t,s){var n=this;e=_(e);var r=this.ready().then((function(){void 0===t&&(t=null);var s=t;return new Promise((function(r,o){n._dbInfo.serializer.serialize(t,(function(t,i){if(i)o(i);else try{n._dbInfo.mStore.set(e,t),r(s)}catch(e){o(e)}}))}))}));return m(r,s),r}var N=!0;e._support=N,e._driver=t,e._initStorage=j,e.clear=w,e.dropInstance=S,e.getItem=x,e.iterate=E,e.key=A,e.keys=C,e.length=T,e.removeItem=I,e.setItem=k,Object.defineProperty(e,"__esModule",{value:!0})}(t)},459:function(e,t,s){!function(e,t){"use strict";function s(e){return s.result?s.result:e&&"function"==typeof e.getSerializer?(s.result=e.getSerializer(),s.result):Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!"))}function n(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function r(e,t,s,n){function r(e,t){var s=e||t;return e&&"function"==typeof e||"string"!=typeof s||(e=function(e){return e[s]}),e}var o=[];if("[object Array]"===Object.prototype.toString.call(e)){t=r(t,"key"),s=r(s,"value");for(var i=0,a=e.length;i<a;i++){var l=e[i];o.push(n(t(l),s(l)))}}else for(var c in e)e.hasOwnProperty(c)&&o.push(n(c,e[c]));return o}function o(e,t,s,o){var i=this,a=i.ready().then((function(){return new Promise((function(n,o){var a,l=i._dbInfo,c=l.db.transaction(l.storeName,"readwrite"),d=c.objectStore(l.storeName);function u(e){var t=e.target||this;a=t.error||t.transaction.error,o(a)}c.oncomplete=function(){n(e)},c.onabort=c.onerror=function(e){o(a||e.target)},r(e,t,s,(function(e,t){null===t&&(t=void 0),d.put(t,e).onerror=u}))}))}));return n(a,o),a}function i(e,t,o,i){var a=this,l=new Promise((function(n,i){a.ready().then((function(){return s(a)})).then((function(s){var l=a._dbInfo;l.db.transaction((function(a){var c="INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",d=r(e,t,o,(function(e,t){return new Promise((function(n,r){s.serialize(t,(function(t,s){s?r(s):a.executeSql(c,[e,t],(function(){n()}),(function(e,t){r(t)}))}))}))}));Promise.all(d).then((function(){n(e)}),i)}),(function(e){i(e)}))})).catch(i)}));return n(l,i),l}function a(e,t,s,o){var i=this,a=r(e,t,s,(function(e,t){return i.setItem(e,t)})),l=Promise.all(a);return n(l,o),l}function l(e,t,s,n){var r=this,l=r.driver();return l===r.INDEXEDDB?o.call(r,e,t,s,n):l===r.WEBSQL?i.call(r,e,t,s,n):a.call(r,e,t,s,n)}function c(e){var t=Object.getPrototypeOf(e);t&&(t.setItems=l,t.setItems.indexedDB=function(){return o.apply(this,arguments)},t.setItems.websql=function(){return i.apply(this,arguments)},t.setItems.generic=function(){return a.apply(this,arguments)})}var d=c(t="default"in t?t.default:t);e.setItemsGeneric=a,e.localforageSetItems=l,e.extendPrototype=c,e.extendPrototypeResult=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,s(483))},715:(e,t,s)=>{"use strict";var n=s(836);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s=(0,a.getStorage)(),n=!(!s||!s[t]),l=n?s[t]:{clear:function(){},get:function(){},remove:function(){},set:function(){}},c=l.clear.bind(l),d=l.get.bind(l),u=l.remove.bind(l),h=l.set.bind(l);return{_driver:e,_support:n,_initStorage:function(){return Promise.resolve()},clear:function(e){return(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(),e&&e();case 2:case"end":return t.stop()}}),t)})))()},iterate:function(e,t){return(0,i.default)(r.default.mark((function s(){var n;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(d,null);case 2:n=s.sent,Object.keys(n).forEach((function(t,s){return e(n[t],t,s)})),t&&t();case 6:case"end":return s.stop()}}),s)})))()},getItem:function(e,t){return(0,i.default)(r.default.mark((function s(){var n;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,a.usePromise)(d,e);case 3:return n=s.sent,n=void 0===(n="string"==typeof e?n[e]:n)?null:n,t&&t(null,n),s.abrupt("return",n);case 10:throw s.prev=10,s.t0=s.catch(0),t&&t(s.t0),s.t0;case 14:case"end":return s.stop()}}),s,null,[[0,10]])})))()},key:function(e,t){return(0,i.default)(r.default.mark((function s(){var n,o;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(d,null);case 2:return n=s.sent,o=Object.keys(n)[e],t&&t(o),s.abrupt("return",o);case 6:case"end":return s.stop()}}),s)})))()},keys:function(e){return(0,i.default)(r.default.mark((function t(){var s,n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.usePromise)(d,null);case 2:return s=t.sent,n=Object.keys(s),e&&e(n),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))()},length:function(e){return(0,i.default)(r.default.mark((function t(){var s,n,o;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.usePromise)(d,null);case 2:return s=t.sent,n=Object.keys(s),o=n.length,e&&e(o),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))()},removeItem:function(e,t){return(0,i.default)(r.default.mark((function s(){return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(u,e);case 2:t&&t();case 3:case"end":return s.stop()}}),s)})))()},setItem:function(e,t,s){return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,a.usePromise)(h,(0,o.default)({},e,t));case 2:s&&s();case 3:case"end":return n.stop()}}),n)})))()}}};var r=n(s(687)),o=n(s(416)),i=n(s(156)),a=s(639)},2:(e,t,s)=>{"use strict";var n=s(836);t.Z=void 0;var r=(0,n(s(715)).default)("webExtensionLocalStorage","local");t.Z=r},63:(e,t,s)=>{"use strict";var n=s(836);t.Z=void 0;var r=(0,n(s(715)).default)("webExtensionSyncStorage","sync");t.Z=r},639:(e,t)=>{"use strict";function s(){return"undefined"!=typeof browser&&browser.storage||"undefined"!=typeof chrome&&chrome.storage}Object.defineProperty(t,"__esModule",{value:!0}),t.getStorage=s,t.usePromise=function(e,t){return function(){var e=s();try{return e&&e.local.get&&e.local.get()&&"function"==typeof e.local.get().then}catch(e){return!1}}()?e(t):new Promise((function(s){e(t,(function(){s.apply(void 0,arguments)}))}))}},483:(e,t,s)=>{e.exports=function e(t,s,n){function r(i,a){if(!s[i]){if(!t[i]){if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=s[i]={exports:{}};t[i][0].call(c.exports,(function(e){var s=t[i][1][e];return r(s||e)}),c,c.exports,e,t,s,n)}return s[i].exports}for(var o=void 0,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){(function(e){"use strict";var s,n,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var o=0,i=new r(d),a=e.document.createTextNode("");i.observe(a,{characterData:!0}),s=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)s="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,s=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;n=!0;for(var s=c.length;s;){for(t=c,c=[],e=-1;++e<s;)t[e]();s=c.length}n=!1}function u(e){1!==c.push(e)||n||s()}t.exports=u}).call(this,void 0!==s.g?s.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,s){"use strict";var n=e(1);function r(){}var o={},i=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function d(e,t,s){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof s&&(this.onRejected=s,this.callRejected=this.otherCallRejected)}function u(e,t,s){n((function(){var n;try{n=t(s)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var s=!1;function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}function i(){t(r,n)}var a=m(i);"error"===a.status&&n(a.value)}function m(e,t){var s={};try{s.value=e(t),s.status="success"}catch(e){s.status="error",s.value=e}return s}function p(e){return e instanceof this?e:o.resolve(new this(r),e)}function g(e){var t=new this(r);return o.reject(t,e)}function _(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i=new Array(s),a=0,l=-1,c=new this(r);++l<s;)d(e[l],l);return c;function d(e,r){function l(e){i[r]=e,++a!==s||n||(n=!0,o.resolve(c,i))}t.resolve(e).then(l,(function(e){n||(n=!0,o.reject(c,e))}))}}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i=-1,a=new this(r);++i<s;)l(e[i]);return a;function l(e){t.resolve(e).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var s=new this.constructor(r);return this.state!==l?u(s,this.state===a?e:t,this.outcome):this.queue.push(new d(s,e,t)),s},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},o.resolve=function(e,t){var s=m(h,t);if("error"===s.status)return o.reject(e,s.value);var n=s.value;if(n)f(e,n);else{e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var s=-1,n=e.queue.length;++s<n;)e.queue[s].callRejected(t);return e},c.resolve=p,c.reject=g,c.all=_,c.race=v},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==s.g?s.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,s){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=o();function a(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function d(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function u(e,t,s){"function"==typeof t&&e.then(t),"function"==typeof s&&e.catch(s)}function h(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",p=void 0,g={},_=Object.prototype.toString,v="readonly",y="readwrite";function b(e){for(var t=e.length,s=new ArrayBuffer(t),n=new Uint8Array(s),r=0;r<t;r++)n[r]=e.charCodeAt(r);return s}function j(e){return new c((function(t){var s=e.transaction(m,y),n=l([""]);s.objectStore(m).put(n,"key"),s.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},s.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);t(s||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function w(e){return"boolean"==typeof p?c.resolve(p):j(e).then((function(e){return p=e}))}function S(e){var t=g[e.name],s={};s.promise=new c((function(e,t){s.resolve=e,s.reject=t})),t.deferredOperations.push(s),t.dbReady?t.dbReady=t.dbReady.then((function(){return s.promise})):t.dbReady=s.promise}function x(e){var t=g[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function E(e,t){var s=g[e.name].deferredOperations.pop();if(s)return s.reject(t),s.promise}function A(e,t){return new c((function(s,n){if(g[e.name]=g[e.name]||D(),e.db){if(!t)return s(e.db);S(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var o=i.open.apply(i,r);t&&(o.onupgradeneeded=function(t){var s=o.result;try{s.createObjectStore(e.storeName),t.oldVersion<=1&&s.createObjectStore(m)}catch(s){if("ConstraintError"!==s.name)throw s;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},s(t),x(e)}}))}function C(e){return A(e,!1)}function T(e){return A(e,!0)}function I(e,t){if(!e.db)return!0;var s=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||s){if(s){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function k(e){return new c((function(t,s){var n=new FileReader;n.onerror=s,n.onloadend=function(s){var n=btoa(s.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)}))}function N(e){return l([b(atob(e.data))],{type:e.type})}function O(e){return e&&e.__local_forage_encoded_blob}function M(e){var t=this,s=t._initReady().then((function(){var e=g[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return u(s,e,e),s}function $(e){S(e);for(var t=g[e.name],s=t.forages,n=0;n<s.length;n++){var r=s[n];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,C(e).then((function(t){return e.db=t,I(e)?T(e):t})).then((function(n){e.db=t.db=n;for(var r=0;r<s.length;r++)s[r]._dbInfo.db=n})).catch((function(t){throw E(e,t),t}))}function R(e,t,s,n){void 0===n&&(n=1);try{var r=e.db.transaction(e.storeName,t);s(null,r)}catch(r){if(n>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return $(e).then((function(){R(e,t,s,n-1)}))})).catch(s);s(r)}}function D(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function P(e){var t=this,s={db:null};if(e)for(var n in e)s[n]=e[n];var r=g[s.name];r||(r=D(),g[s.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=M);var o=[];function i(){return c.resolve()}for(var a=0;a<r.forages.length;a++){var l=r.forages[a];l!==t&&o.push(l._initReady().catch(i))}var d=r.forages.slice(0);return c.all(o).then((function(){return s.db=r.db,C(s)})).then((function(e){return s.db=e,I(s,t._defaultConfig.version)?T(s):e})).then((function(e){s.db=r.db=e,t._dbInfo=s;for(var n=0;n<d.length;n++){var o=d[n];o!==t&&(o._dbInfo.db=s.db,o._dbInfo.version=s.version)}}))}function L(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),O(e)&&(e=N(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function z(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).openCursor(),a=1;i.onsuccess=function(){var s=i.result;if(s){var n=s.value;O(n)&&(n=N(n));var r=e(n,s.key,a++);void 0!==r?t(r):s.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function F(e,t,s){var n=this;e=h(e);var r=new c((function(s,r){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===_.call(t)?w(o.db).then((function(e){return e?t:k(t)})):t})).then((function(t){R(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),s(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return d(r,s),r}function U(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,y,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function B(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,y,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;s(e)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function q(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,v,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function H(e,t){var s=this,n=new c((function(t,n){e<0?t(null):s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName),a=!1,l=i.openKeyCursor();l.onsuccess=function(){var s=l.result;s?0===e||a?t(s.key):(a=!0,s.advance(e)):t(null)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function G(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,v,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function W(e,t){t=f.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;if(e.name){var o=e.name===s.name&&r._dbInfo.db?c.resolve(r._dbInfo.db):C(e).then((function(t){var s=g[e.name],n=s.forages;s.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}));n=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var s=t.version+1;S(e);var n=g[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++){var a=r[o];a._dbInfo.db=null,a._dbInfo.version=s}var l=new c((function(t,n){var r=i.open(e.name,s);r.onerror=function(e){r.result.close(),n(e)},r.onupgradeneeded=function(){r.result.deleteObjectStore(e.storeName)},r.onsuccess=function(){var e=r.result;e.close(),t(e)}}));return l.then((function(e){n.db=e;for(var t=0;t<r.length;t++){var s=r[t];s._dbInfo.db=e,x(s._dbInfo)}})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){S(e);var s=g[e.name],n=s.forages;t.close();for(var r=0;r<n.length;r++)n[r]._dbInfo.db=null;var o=new c((function(t,s){var n=i.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),s(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}));return o.then((function(e){s.db=e;for(var t=0;t<n.length;t++)x(n[t]._dbInfo)})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}))}else n=c.reject("Invalid arguments");return d(n,t),n}var V={_driver:"asyncStorage",_initStorage:P,_support:a(),iterate:z,getItem:L,setItem:F,removeItem:U,clear:B,length:q,key:H,keys:G,dropInstance:W};function J(){return"function"==typeof openDatabase}var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="~~local_forage_type~",K=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",Z=X.length,ee="arbf",te="blob",se="si08",ne="ui08",re="uic8",oe="si16",ie="si32",ae="ur16",le="ui32",ce="fl32",de="fl64",ue=Z+ee.length,he=Object.prototype.toString;function fe(e){var t,s,n,r,o,i=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),d=new Uint8Array(c);for(t=0;t<a;t+=4)s=Q.indexOf(e[t]),n=Q.indexOf(e[t+1]),r=Q.indexOf(e[t+2]),o=Q.indexOf(e[t+3]),d[l++]=s<<2|n>>4,d[l++]=(15&n)<<4|r>>2,d[l++]=(3&r)<<6|63&o;return c}function me(e){var t,s=new Uint8Array(e),n="";for(t=0;t<s.length;t+=3)n+=Q[s[t]>>2],n+=Q[(3&s[t])<<4|s[t+1]>>4],n+=Q[(15&s[t+1])<<2|s[t+2]>>6],n+=Q[63&s[t+2]];return s.length%3==2?n=n.substring(0,n.length-1)+"=":s.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function pe(e,t){var s="";if(e&&(s=he.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===he.call(e.buffer))){var n,r=X;e instanceof ArrayBuffer?(n=e,r+=ee):(n=e.buffer,"[object Int8Array]"===s?r+=se:"[object Uint8Array]"===s?r+=ne:"[object Uint8ClampedArray]"===s?r+=re:"[object Int16Array]"===s?r+=oe:"[object Uint16Array]"===s?r+=ae:"[object Int32Array]"===s?r+=ie:"[object Uint32Array]"===s?r+=le:"[object Float32Array]"===s?r+=ce:"[object Float64Array]"===s?r+=de:t(new Error("Failed to get type for BinaryArray"))),t(r+me(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s=Y+e.type+"~"+me(this.result);t(X+te+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function ge(e){if(e.substring(0,Z)!==X)return JSON.parse(e);var t,s=e.substring(ue),n=e.substring(Z,ue);if(n===te&&K.test(s)){var r=s.match(K);t=r[1],s=s.substring(r[0].length)}var o=fe(s);switch(n){case ee:return o;case te:return l([o],{type:t});case se:return new Int8Array(o);case ne:return new Uint8Array(o);case re:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case ae:return new Uint16Array(o);case ie:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case de:return new Float64Array(o);default:throw new Error("Unkown type: "+n)}}var _e={serialize:pe,deserialize:ge,stringToBuffer:fe,bufferToString:me};function ve(e,t,s,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],s,n)}function ye(e){var t=this,s={db:null};if(e)for(var n in e)s[n]="string"!=typeof e[n]?e[n].toString():e[n];var r=new c((function(e,n){try{s.db=openDatabase(s.name,String(s.version),s.description,s.size)}catch(e){return n(e)}s.db.transaction((function(r){ve(r,s,(function(){t._dbInfo=s,e()}),(function(e,t){n(t)}))}),n)}));return s.serializer=_e,r}function be(e,t,s,n,r,o){e.executeSql(s,n,r,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,i):ve(e,t,(function(){e.executeSql(s,n,r,o)}),o)}),o):o(e,i)}),o)}function je(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,s){var n=s.rows.length?s.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function we(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT * FROM "+r.storeName,[],(function(s,n){for(var o=n.rows,i=o.length,a=0;a<i;a++){var l=o.item(a),c=l.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Se(e,t,s,n){var r=this;e=h(e);var o=new c((function(o,i){r.ready().then((function(){void 0===t&&(t=null);var a=t,l=r._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(s){be(s,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(Se.apply(r,[e,a,s,n-1]));i(t)}}))}))})).catch(i)}));return d(o,s),o}function xe(e,t,s){return Se.apply(this,[e,t,s,1])}function Ee(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Ae(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function Ce(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,s){var n=s.rows.item(0).c;e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function Te(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,s){var n=s.rows.length?s.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Ie(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"SELECT key FROM "+n.storeName,[],(function(t,s){for(var n=[],r=0;r<s.rows.length;r++)n.push(s.rows.item(r).key);e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function ke(e){return new c((function(t,s){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(s,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).name);t({db:e,storeNames:r})}),(function(e,t){s(t)}))}),(function(e){s(e)}))}))}function Ne(e,t){t=f.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;return d(n=e.name?new c((function(t){var n;n=e.name===s.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(ke(n))})).then((function(e){return new c((function(t,s){e.db.transaction((function(n){function r(e){return new c((function(t,s){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){s(t)}))}))}for(var o=[],i=0,a=e.storeNames.length;i<a;i++)o.push(r(e.storeNames[i]));c.all(o).then((function(){t()})).catch((function(e){s(e)}))}),(function(e){s(e)}))}))})):c.reject("Invalid arguments"),t),n}var Oe={_driver:"webSQLStorage",_initStorage:ye,_support:J(),iterate:we,getItem:je,setItem:xe,removeItem:Ee,clear:Ae,length:Ce,key:Te,keys:Ie,dropInstance:Ne};function Me(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function $e(e,t){var s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}function Re(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function De(){return!Re()||localStorage.length>0}function Pe(e){var t=this,s={};if(e)for(var n in e)s[n]=e[n];return s.keyPrefix=$e(e,t._defaultConfig),De()?(t._dbInfo=s,s.serializer=_e,c.resolve()):c.reject()}function Le(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var n=localStorage.key(s);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return d(s,e),s}function ze(e,t){var s=this;e=h(e);var n=s.ready().then((function(){var t=s._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return d(n,t),n}function Fe(e,t){var s=this,n=s.ready().then((function(){for(var t=s._dbInfo,n=t.keyPrefix,r=n.length,o=localStorage.length,i=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(n)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(r),i++)))return c}}}));return d(n,t),n}function Ue(e,t){var s=this,n=s.ready().then((function(){var t,n=s._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return d(n,t),n}function Be(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo,s=localStorage.length,n=[],r=0;r<s;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return d(s,e),s}function qe(e){var t=this.keys().then((function(e){return e.length}));return d(t,e),t}function He(e,t){var s=this;e=h(e);var n=s.ready().then((function(){var t=s._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return d(n,t),n}function Ge(e,t,s){var n=this;e=h(e);var r=n.ready().then((function(){void 0===t&&(t=null);var s=t;return new c((function(r,o){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(i.keyPrefix+e,t),r(s)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return d(r,s),r}function We(e,t){if(t=f.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var s=this.config();e.name=e.name||s.name,e.storeName=e.storeName||s.storeName}var n,r=this;return n=e.name?new c((function(t){e.storeName?t($e(e,r._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var s=localStorage.key(t);0===s.indexOf(e)&&localStorage.removeItem(s)}})):c.reject("Invalid arguments"),d(n,t),n}var Ve={_driver:"localStorageWrapper",_initStorage:Pe,_support:Me(),iterate:Fe,getItem:ze,setItem:Ge,removeItem:He,clear:Le,length:qe,key:Ue,keys:Be,dropInstance:We},Je=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Qe=function(e,t){for(var s=e.length,n=0;n<s;){if(Je(e[n],t))return!0;n++}return!1},Ye=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ke={},Xe={},Ze={INDEXEDDB:V,WEBSQL:Oe,LOCALSTORAGE:Ve},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],st=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),nt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rt(e,t){e[t]=function(){var s=arguments;return e.ready().then((function(){return e[t].apply(e,s)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var s in t)t.hasOwnProperty(s)&&(Ye(t[s])?arguments[0][s]=t[s].slice():arguments[0][s]=t[s])}return arguments[0]}var it=function(){function e(t){for(var s in r(this,e),Ze)if(Ze.hasOwnProperty(s)){var n=Ze[s],o=n._driver;this[s]=o,Ke[o]||this.defineDriver(n)}this._defaultConfig=ot({},nt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,s){var n=new c((function(t,s){try{var n=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void s(r);for(var o=st.concat("_initStorage"),i=0,a=o.length;i<a;i++){var l=o[i];if((!Qe(tt,l)||e[l])&&"function"!=typeof e[l])return void s(r)}var u=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),s=c.reject(t);return d(s,arguments[arguments.length-1]),s}},s=0,n=tt.length;s<n;s++){var r=tt[s];e[r]||(e[r]=t(r))}};u();var h=function(s){Ke[n]&&console.info("Redefining LocalForage driver: "+n),Ke[n]=e,Xe[n]=s,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,s):h(!!e._support):h(!0)}catch(e){s(e)}}));return u(n,t,s),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,s){var n=Ke[e]?c.resolve(Ke[e]):c.reject(new Error("Driver not found."));return u(n,t,s),n},e.prototype.getSerializer=function(e){var t=c.resolve(_e);return u(t,e),t},e.prototype.ready=function(e){var t=this,s=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return u(s,e,e),s},e.prototype.setDriver=function(e,t,s){var n=this;Ye(e)||(e=[e]);var r=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function i(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}function a(e){return function(){var t=0;function s(){for(;t<e.length;){var r=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(i).catch(s)}o();var a=new Error("No available storage method found.");return n._driverSet=c.reject(a),n._driverSet}return s()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=a(r)}))})).catch((function(){o();var e=new Error("No available storage method found.");return n._driverSet=c.reject(e),n._driverSet})),u(this._driverSet,t,s),this._driverSet},e.prototype.supports=function(e){return!!Xe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],s=0,n=e.length;s<n;s++){var r=e[s];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=st.length;e<t;e++)rt(this,st[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),at=new it;t.exports=at},{3:3}]},{},[4])(4)},271:(e,t,s)=>{var n;!function(r){var o,i,a,l,c,d,u,h,f,m,p,g,_,v,y,b,j,w,S,x="sizzle"+1*new Date,E=r.document,A=0,C=0,T=he(),I=he(),k=he(),N=he(),O=function(e,t){return e===t&&(p=!0),0},M={}.hasOwnProperty,$=[],R=$.pop,D=$.push,P=$.push,L=$.slice,z=function(e,t){for(var s=0,n=e.length;s<n;s++)if(e[s]===t)return s;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",U="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+U+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",q="\\["+U+"*("+B+")(?:"+U+"*([*^$|!~]?=)"+U+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+U+"*\\]",H=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",G=new RegExp(U+"+","g"),W=new RegExp("^"+U+"+|((?:^|[^\\\\])(?:\\\\.)*)"+U+"+$","g"),V=new RegExp("^"+U+"*,"+U+"*"),J=new RegExp("^"+U+"*([>+~]|"+U+")"+U+"*"),Q=new RegExp(U+"|>"),Y=new RegExp(H),K=new RegExp("^"+B+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+U+"*(even|odd|(([+-]|)(\\d*)n|)"+U+"*(?:([+-]|)"+U+"*(\\d+)|))"+U+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+U+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+U+"*((?:-\\d)?\\d*)"+U+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,ee=/^(?:input|select|textarea|button)$/i,te=/^h\d$/i,se=/^[^{]+\{\s*\[native \w/,ne=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,re=/[+~]/,oe=new RegExp("\\\\[\\da-fA-F]{1,6}"+U+"?|\\\\([^\\r\\n\\f])","g"),ie=function(e,t){var s="0x"+e.slice(1)-65536;return t||(s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320))},ae=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,le=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ce=function(){g()},de=xe((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{P.apply($=L.call(E.childNodes),E.childNodes),$[E.childNodes.length].nodeType}catch(e){P={apply:$.length?function(e,t){D.apply(e,L.call(t))}:function(e,t){for(var s=e.length,n=0;e[s++]=t[n++];);e.length=s-1}}}function ue(e,t,s,n){var r,o,a,l,c,u,f,m=t&&t.ownerDocument,p=t?t.nodeType:9;if(s=s||[],"string"!=typeof e||!e||1!==p&&9!==p&&11!==p)return s;if(!n&&(g(t),t=t||_,y)){if(11!==p&&(c=ne.exec(e)))if(r=c[1]){if(9===p){if(!(a=t.getElementById(r)))return s;if(a.id===r)return s.push(a),s}else if(m&&(a=m.getElementById(r))&&S(t,a)&&a.id===r)return s.push(a),s}else{if(c[2])return P.apply(s,t.getElementsByTagName(e)),s;if((r=c[3])&&i.getElementsByClassName&&t.getElementsByClassName)return P.apply(s,t.getElementsByClassName(r)),s}if(i.qsa&&!N[e+" "]&&(!b||!b.test(e))&&(1!==p||"object"!==t.nodeName.toLowerCase())){if(f=e,m=t,1===p&&(Q.test(e)||J.test(e))){for((m=re.test(e)&&je(t.parentNode)||t)===t&&i.scope||((l=t.getAttribute("id"))?l=l.replace(ae,le):t.setAttribute("id",l=x)),o=(u=d(e)).length;o--;)u[o]=(l?"#"+l:":scope")+" "+Se(u[o]);f=u.join(",")}try{return P.apply(s,m.querySelectorAll(f)),s}catch(t){N(e,!0)}finally{l===x&&t.removeAttribute("id")}}}return h(e.replace(W,"$1"),t,s,n)}function he(){var e=[];return function t(s,n){return e.push(s+" ")>a.cacheLength&&delete t[e.shift()],t[s+" "]=n}}function fe(e){return e[x]=!0,e}function me(e){var t=_.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function pe(e,t){for(var s=e.split("|"),n=s.length;n--;)a.attrHandle[s[n]]=t}function ge(e,t){var s=t&&e,n=s&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(s)for(;s=s.nextSibling;)if(s===t)return-1;return e?1:-1}function _e(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ve(e){return function(t){var s=t.nodeName.toLowerCase();return("input"===s||"button"===s)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&de(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function be(e){return fe((function(t){return t=+t,fe((function(s,n){for(var r,o=e([],s.length,t),i=o.length;i--;)s[r=o[i]]&&(s[r]=!(n[r]=s[r]))}))}))}function je(e){return e&&void 0!==e.getElementsByTagName&&e}for(o in i=ue.support={},c=ue.isXML=function(e){var t=e&&e.namespaceURI,s=e&&(e.ownerDocument||e).documentElement;return!Z.test(t||s&&s.nodeName||"HTML")},g=ue.setDocument=function(e){var t,s,n=e?e.ownerDocument||e:E;return n!=_&&9===n.nodeType&&n.documentElement?(v=(_=n).documentElement,y=!c(_),E!=_&&(s=_.defaultView)&&s.top!==s&&(s.addEventListener?s.addEventListener("unload",ce,!1):s.attachEvent&&s.attachEvent("onunload",ce)),i.scope=me((function(e){return v.appendChild(e).appendChild(_.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),i.cssHas=me((function(){try{return _.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),i.attributes=me((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=me((function(e){return e.appendChild(_.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=se.test(_.getElementsByClassName),i.getById=me((function(e){return v.appendChild(e).id=x,!_.getElementsByName||!_.getElementsByName(x).length})),i.getById?(a.filter.ID=function(e){var t=e.replace(oe,ie);return function(e){return e.getAttribute("id")===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var s=t.getElementById(e);return s?[s]:[]}}):(a.filter.ID=function(e){var t=e.replace(oe,ie);return function(e){var s=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return s&&s.value===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var s,n,r,o=t.getElementById(e);if(o){if((s=o.getAttributeNode("id"))&&s.value===e)return[o];for(r=t.getElementsByName(e),n=0;o=r[n++];)if((s=o.getAttributeNode("id"))&&s.value===e)return[o]}return[]}}),a.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var s,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;s=o[r++];)1===s.nodeType&&n.push(s);return n}return o},a.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},j=[],b=[],(i.qsa=se.test(_.querySelectorAll))&&(me((function(e){var t;v.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&b.push("[*^$]="+U+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||b.push("\\["+U+"*(?:value|"+F+")"),e.querySelectorAll("[id~="+x+"-]").length||b.push("~="),(t=_.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||b.push("\\["+U+"*name"+U+"*="+U+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||b.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||b.push(".#.+[+~]"),e.querySelectorAll("\\\f"),b.push("[\\r\\n\\f]")})),me((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=_.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&b.push("name"+U+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&b.push(":enabled",":disabled"),v.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&b.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),b.push(",.*:")}))),(i.matchesSelector=se.test(w=v.matches||v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&me((function(e){i.disconnectedMatch=w.call(e,"*"),w.call(e,"[s!='']:x"),j.push("!=",H)})),i.cssHas||b.push(":has"),b=b.length&&new RegExp(b.join("|")),j=j.length&&new RegExp(j.join("|")),t=se.test(v.compareDocumentPosition),S=t||se.test(v.contains)?function(e,t){var s=9===e.nodeType&&e.documentElement||e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(s.contains?s.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},O=t?function(e,t){if(e===t)return p=!0,0;var s=!e.compareDocumentPosition-!t.compareDocumentPosition;return s||(1&(s=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===s?e==_||e.ownerDocument==E&&S(E,e)?-1:t==_||t.ownerDocument==E&&S(E,t)?1:m?z(m,e)-z(m,t):0:4&s?-1:1)}:function(e,t){if(e===t)return p=!0,0;var s,n=0,r=e.parentNode,o=t.parentNode,i=[e],a=[t];if(!r||!o)return e==_?-1:t==_?1:r?-1:o?1:m?z(m,e)-z(m,t):0;if(r===o)return ge(e,t);for(s=e;s=s.parentNode;)i.unshift(s);for(s=t;s=s.parentNode;)a.unshift(s);for(;i[n]===a[n];)n++;return n?ge(i[n],a[n]):i[n]==E?-1:a[n]==E?1:0},_):_},ue.matches=function(e,t){return ue(e,null,null,t)},ue.matchesSelector=function(e,t){if(g(e),i.matchesSelector&&y&&!N[t+" "]&&(!j||!j.test(t))&&(!b||!b.test(t)))try{var s=w.call(e,t);if(s||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(e){N(t,!0)}return ue(t,_,null,[e]).length>0},ue.contains=function(e,t){return(e.ownerDocument||e)!=_&&g(e),S(e,t)},ue.attr=function(e,t){(e.ownerDocument||e)!=_&&g(e);var s=a.attrHandle[t.toLowerCase()],n=s&&M.call(a.attrHandle,t.toLowerCase())?s(e,t,!y):void 0;return void 0!==n?n:i.attributes||!y?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ue.escape=function(e){return(e+"").replace(ae,le)},ue.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ue.uniqueSort=function(e){var t,s=[],n=0,r=0;if(p=!i.detectDuplicates,m=!i.sortStable&&e.slice(0),e.sort(O),p){for(;t=e[r++];)t===e[r]&&(n=s.push(r));for(;n--;)e.splice(s[n],1)}return m=null,e},l=ue.getText=function(e){var t,s="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)s+=l(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)s+=l(t);return s},a=ue.selectors={cacheLength:50,createPseudo:fe,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(oe,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(oe,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ue.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ue.error(e[0]),e},PSEUDO:function(e){var t,s=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":s&&Y.test(s)&&(t=d(s,!0))&&(t=s.indexOf(")",s.length-t)-s.length)&&(e[0]=e[0].slice(0,t),e[2]=s.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(oe,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+U+")"+e+"("+U+"|$)"))&&T(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,s){return function(n){var r=ue.attr(n,e);return null==r?"!="===t:!t||(r+="","="===t?r===s:"!="===t?r!==s:"^="===t?s&&0===r.indexOf(s):"*="===t?s&&r.indexOf(s)>-1:"$="===t?s&&r.slice(-s.length)===s:"~="===t?(" "+r.replace(G," ")+" ").indexOf(s)>-1:"|="===t&&(r===s||r.slice(0,s.length+1)===s+"-"))}},CHILD:function(e,t,s,n,r){var o="nth"!==e.slice(0,3),i="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,s,l){var c,d,u,h,f,m,p=o!==i?"nextSibling":"previousSibling",g=t.parentNode,_=a&&t.nodeName.toLowerCase(),v=!l&&!a,y=!1;if(g){if(o){for(;p;){for(h=t;h=h[p];)if(a?h.nodeName.toLowerCase()===_:1===h.nodeType)return!1;m=p="only"===e&&!m&&"nextSibling"}return!0}if(m=[i?g.firstChild:g.lastChild],i&&v){for(y=(f=(c=(d=(u=(h=g)[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===A&&c[1])&&c[2],h=f&&g.childNodes[f];h=++f&&h&&h[p]||(y=f=0)||m.pop();)if(1===h.nodeType&&++y&&h===t){d[e]=[A,f,y];break}}else if(v&&(y=f=(c=(d=(u=(h=t)[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===A&&c[1]),!1===y)for(;(h=++f&&h&&h[p]||(y=f=0)||m.pop())&&((a?h.nodeName.toLowerCase()!==_:1!==h.nodeType)||!++y||(v&&((d=(u=h[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]=[A,y]),h!==t)););return(y-=r)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,t){var s,n=a.pseudos[e]||a.setFilters[e.toLowerCase()]||ue.error("unsupported pseudo: "+e);return n[x]?n(t):n.length>1?(s=[e,e,"",t],a.setFilters.hasOwnProperty(e.toLowerCase())?fe((function(e,s){for(var r,o=n(e,t),i=o.length;i--;)e[r=z(e,o[i])]=!(s[r]=o[i])})):function(e){return n(e,0,s)}):n}},pseudos:{not:fe((function(e){var t=[],s=[],n=u(e.replace(W,"$1"));return n[x]?fe((function(e,t,s,r){for(var o,i=n(e,null,r,[]),a=e.length;a--;)(o=i[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,n(t,null,o,s),t[0]=null,!s.pop()}})),has:fe((function(e){return function(t){return ue(e,t).length>0}})),contains:fe((function(e){return e=e.replace(oe,ie),function(t){return(t.textContent||l(t)).indexOf(e)>-1}})),lang:fe((function(e){return K.test(e||"")||ue.error("unsupported lang: "+e),e=e.replace(oe,ie).toLowerCase(),function(t){var s;do{if(s=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(s=s.toLowerCase())===e||0===s.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===v},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!a.pseudos.empty(e)},header:function(e){return te.test(e.nodeName)},input:function(e){return ee.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:be((function(){return[0]})),last:be((function(e,t){return[t-1]})),eq:be((function(e,t,s){return[s<0?s+t:s]})),even:be((function(e,t){for(var s=0;s<t;s+=2)e.push(s);return e})),odd:be((function(e,t){for(var s=1;s<t;s+=2)e.push(s);return e})),lt:be((function(e,t,s){for(var n=s<0?s+t:s>t?t:s;--n>=0;)e.push(n);return e})),gt:be((function(e,t,s){for(var n=s<0?s+t:s;++n<t;)e.push(n);return e}))}},a.pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[o]=_e(o);for(o in{submit:!0,reset:!0})a.pseudos[o]=ve(o);function we(){}function Se(e){for(var t=0,s=e.length,n="";t<s;t++)n+=e[t].value;return n}function xe(e,t,s){var n=t.dir,r=t.next,o=r||n,i=s&&"parentNode"===o,a=C++;return t.first?function(t,s,r){for(;t=t[n];)if(1===t.nodeType||i)return e(t,s,r);return!1}:function(t,s,l){var c,d,u,h=[A,a];if(l){for(;t=t[n];)if((1===t.nodeType||i)&&e(t,s,l))return!0}else for(;t=t[n];)if(1===t.nodeType||i)if(d=(u=t[x]||(t[x]={}))[t.uniqueID]||(u[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((c=d[o])&&c[0]===A&&c[1]===a)return h[2]=c[2];if(d[o]=h,h[2]=e(t,s,l))return!0}return!1}}function Ee(e){return e.length>1?function(t,s,n){for(var r=e.length;r--;)if(!e[r](t,s,n))return!1;return!0}:e[0]}function Ae(e,t,s,n,r){for(var o,i=[],a=0,l=e.length,c=null!=t;a<l;a++)(o=e[a])&&(s&&!s(o,n,r)||(i.push(o),c&&t.push(a)));return i}function Ce(e,t,s,n,r,o){return n&&!n[x]&&(n=Ce(n)),r&&!r[x]&&(r=Ce(r,o)),fe((function(o,i,a,l){var c,d,u,h=[],f=[],m=i.length,p=o||function(e,t,s){for(var n=0,r=t.length;n<r;n++)ue(e,t[n],s);return s}(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?p:Ae(p,h,e,a,l),_=s?r||(o?e:m||n)?[]:i:g;if(s&&s(g,_,a,l),n)for(c=Ae(_,f),n(c,[],a,l),d=c.length;d--;)(u=c[d])&&(_[f[d]]=!(g[f[d]]=u));if(o){if(r||e){if(r){for(c=[],d=_.length;d--;)(u=_[d])&&c.push(g[d]=u);r(null,_=[],c,l)}for(d=_.length;d--;)(u=_[d])&&(c=r?z(o,u):h[d])>-1&&(o[c]=!(i[c]=u))}}else _=Ae(_===i?_.splice(m,_.length):_),r?r(null,i,_,l):P.apply(i,_)}))}function Te(e){for(var t,s,n,r=e.length,o=a.relative[e[0].type],i=o||a.relative[" "],l=o?1:0,c=xe((function(e){return e===t}),i,!0),d=xe((function(e){return z(t,e)>-1}),i,!0),u=[function(e,s,n){var r=!o&&(n||s!==f)||((t=s).nodeType?c(e,s,n):d(e,s,n));return t=null,r}];l<r;l++)if(s=a.relative[e[l].type])u=[xe(Ee(u),s)];else{if((s=a.filter[e[l].type].apply(null,e[l].matches))[x]){for(n=++l;n<r&&!a.relative[e[n].type];n++);return Ce(l>1&&Ee(u),l>1&&Se(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(W,"$1"),s,l<n&&Te(e.slice(l,n)),n<r&&Te(e=e.slice(n)),n<r&&Se(e))}u.push(s)}return Ee(u)}we.prototype=a.filters=a.pseudos,a.setFilters=new we,d=ue.tokenize=function(e,t){var s,n,r,o,i,l,c,d=I[e+" "];if(d)return t?0:d.slice(0);for(i=e,l=[],c=a.preFilter;i;){for(o in s&&!(n=V.exec(i))||(n&&(i=i.slice(n[0].length)||i),l.push(r=[])),s=!1,(n=J.exec(i))&&(s=n.shift(),r.push({value:s,type:n[0].replace(W," ")}),i=i.slice(s.length)),a.filter)!(n=X[o].exec(i))||c[o]&&!(n=c[o](n))||(s=n.shift(),r.push({value:s,type:o,matches:n}),i=i.slice(s.length));if(!s)break}return t?i.length:i?ue.error(e):I(e,l).slice(0)},u=ue.compile=function(e,t){var s,n=[],r=[],o=k[e+" "];if(!o){for(t||(t=d(e)),s=t.length;s--;)(o=Te(t[s]))[x]?n.push(o):r.push(o);o=k(e,function(e,t){var s=t.length>0,n=e.length>0,r=function(r,o,i,l,c){var d,u,h,m=0,p="0",v=r&&[],b=[],j=f,w=r||n&&a.find.TAG("*",c),S=A+=null==j?1:Math.random()||.1,x=w.length;for(c&&(f=o==_||o||c);p!==x&&null!=(d=w[p]);p++){if(n&&d){for(u=0,o||d.ownerDocument==_||(g(d),i=!y);h=e[u++];)if(h(d,o||_,i)){l.push(d);break}c&&(A=S)}s&&((d=!h&&d)&&m--,r&&v.push(d))}if(m+=p,s&&p!==m){for(u=0;h=t[u++];)h(v,b,o,i);if(r){if(m>0)for(;p--;)v[p]||b[p]||(b[p]=R.call(l));b=Ae(b)}P.apply(l,b),c&&!r&&b.length>0&&m+t.length>1&&ue.uniqueSort(l)}return c&&(A=S,f=j),v};return s?fe(r):r}(r,n)),o.selector=e}return o},h=ue.select=function(e,t,s,n){var r,o,i,l,c,h="function"==typeof e&&e,f=!n&&d(e=h.selector||e);if(s=s||[],1===f.length){if((o=f[0]=f[0].slice(0)).length>2&&"ID"===(i=o[0]).type&&9===t.nodeType&&y&&a.relative[o[1].type]){if(!(t=(a.find.ID(i.matches[0].replace(oe,ie),t)||[])[0]))return s;h&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=X.needsContext.test(e)?0:o.length;r--&&(i=o[r],!a.relative[l=i.type]);)if((c=a.find[l])&&(n=c(i.matches[0].replace(oe,ie),re.test(o[0].type)&&je(t.parentNode)||t))){if(o.splice(r,1),!(e=n.length&&Se(o)))return P.apply(s,n),s;break}}return(h||u(e,f))(n,t,!y,s,!t||re.test(e)&&je(t.parentNode)||t),s},i.sortStable=x.split("").sort(O).join("")===x,i.detectDuplicates=!!p,g(),i.sortDetached=me((function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))})),me((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||pe("type|href|height|width",(function(e,t,s){if(!s)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&me((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||pe("value",(function(e,t,s){if(!s&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),me((function(e){return null==e.getAttribute("disabled")}))||pe(F,(function(e,t,s){var n;if(!s)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}));var Ie=r.Sizzle;ue.noConflict=function(){return r.Sizzle===ue&&(r.Sizzle=Ie),ue},void 0===(n=function(){return ue}.call(t,s,t,e))||(e.exports=n)}(window)},156:e=>{function t(e,t,s,n,r,o,i){try{var a=e[o](i),l=a.value}catch(e){return void s(e)}a.done?t(l):Promise.resolve(l).then(n,r)}e.exports=function(e){return function(){var s=this,n=arguments;return new Promise((function(r,o){var i=e.apply(s,n);function a(e){t(i,r,o,a,l,"next",e)}function l(e){t(i,r,o,a,l,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},416:(e,t,s)=>{var n=s(62);e.exports=function(e,t,s){return(t=n(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e},e.exports.__esModule=!0,e.exports.default=e.exports},836:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},61:(e,t,s)=>{var n=s(698).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},s=Object.prototype,o=s.hasOwnProperty,i=Object.defineProperty||function(e,t,s){e[t]=s.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function u(e,t,s){return Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,s){return e[t]=s}}function h(e,t,s,n){var r=t&&t.prototype instanceof p?t:p,o=Object.create(r.prototype),a=new T(n||[]);return i(o,"_invoke",{value:x(e,s,a)}),o}function f(e,t,s){try{return{type:"normal",arg:e.call(t,s)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var m={};function p(){}function g(){}function _(){}var v={};u(v,l,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(I([])));b&&b!==s&&o.call(b,l)&&(v=b);var j=_.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function s(r,i,a,l){var c=f(e[r],e,i);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==n(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){s("next",e,a,l)}),(function(e){s("throw",e,a,l)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return s("throw",e,a,l)}))}l(c.arg)}var r;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,r){s(e,n,t,r)}))}return r=r?r.then(o,o):o()}})}function x(e,t,s){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return{value:void 0,done:!0}}for(s.method=r,s.arg=o;;){var i=s.delegate;if(i){var a=E(i,s);if(a){if(a===m)continue;return a}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===n)throw n="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);n="executing";var l=f(e,t,s);if("normal"===l.type){if(n=s.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(n="completed",s.method="throw",s.arg=l.arg)}}}function E(e,t){var s=t.method,n=e.iterator[s];if(void 0===n)return t.delegate=null,"throw"===s&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==s&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+s+"' method")),m;var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(e){if(e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function t(){for(;++s<e.length;)if(o.call(e,s))return t.value=e[s],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return g.prototype=_,i(j,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,d,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,d,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},w(S.prototype),u(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,s,n,r,o){void 0===o&&(o=Promise);var i=new S(h(e,s,n,r),o);return t.isGeneratorFunction(s)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(j),u(j,d,"Generator"),u(j,l,(function(){return this})),u(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),s=[];for(var n in t)s.push(n);return s.reverse(),function e(){for(;s.length;){var n=s.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function s(s,n){return i.type="throw",i.arg=e,t.next=s,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],i=r.completion;if("root"===r.tryLoc)return s("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(a&&l){if(this.prev<r.catchLoc)return s(r.catchLoc,!0);if(this.prev<r.finallyLoc)return s(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return s(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return s(r.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),C(s),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===e){var n=s.completion;if("throw"===n.type){var r=n.arg;C(s)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,s){return this.delegate={iterator:I(e),resultName:t,nextLoc:s},"next"===this.method&&(this.arg=void 0),m}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},36:(e,t,s)=>{var n=s(698).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},62:(e,t,s)=>{var n=s(698).default,r=s(36);e.exports=function(e){var t=r(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(s){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(s)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:(e,t,s)=>{var n=s(61)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},l={};function c(e){var t=l[e];if(void 0!==t)return t.exports;var s=l[e]={id:e,loaded:!1,exports:{}};return a[e].call(s.exports,s,s.exports,c),s.loaded=!0,s.exports}c.m=a,c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var s=Object.create(null);c.r(s);var o={};n=n||[null,r({}),r([]),r(r)];for(var i=2&t&&e;"object"==typeof i&&!~n.indexOf(i);i=r(i))Object.getOwnPropertyNames(i).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,c.d(s,o),s},c.d=(e,t)=>{for(var s in t)c.o(t,s)&&!c.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,s)=>(c.f[s](e,t),t)),[])),c.u=e=>"emojis.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="converse:",c.l=(e,t,s,n)=>{if(o[e])o[e].push(t);else{var r,a;if(void 0!==s)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==i+s){r=u;break}}r||(a=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,c.nc&&r.setAttribute("nonce",c.nc),r.setAttribute("data-webpack",i+s),r.src=e),o[e]=[t];var h=(t,s)=>{r.onerror=r.onload=null,clearTimeout(f);var n=o[e];if(delete o[e],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((e=>e(s))),t)return t(s)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=h.bind(null,r.onerror),r.onload=h.bind(null,r.onload),a&&document.head.appendChild(r)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),c.p="",(()=>{var e={729:0,267:0};c.f.j=(t,s)=>{var n=c.o(e,t)?e[t]:void 0;if(0!==n)if(n)s.push(n[2]);else{var r=new Promise(((s,r)=>n=e[t]=[s,r]));s.push(n[2]=r);var o=c.p+c.u(t),i=new Error;c.l(o,(s=>{if(c.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",i.name="ChunkLoadError",i.type=r,i.request=o,n[1](i)}}),"chunk-"+t,t)}};var t=(t,s)=>{var n,r,[o,i,a]=s,l=0;if(o.some((t=>0!==e[t]))){for(n in i)c.o(i,n)&&(c.m[n]=i[n]);a&&a(c)}for(t&&t(s);l<o.length;l++)r=o[l],c.o(e,r)&&e[r]&&e[r][0](),e[r]=0},s=this.webpackChunkconverse=this.webpackChunkconverse||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var d={};return(()=>{"use strict";c.r(d),c.d(d,{_converse:()=>td,api:()=>ef,converse:()=>Zh,default:()=>jv,i18n:()=>Oe,log:()=>De});var n={};c.r(n),c.d(n,{DOMParser:()=>i,WebSocket:()=>o,getDummyXMLDOMDocument:()=>a});var r={};c.r(r),c.d(r,{addCookies:()=>E,arrayBufToBase64:()=>w,base64ToArrayBuf:()=>S,copyElement:()=>R,createHtml:()=>$,default:()=>J,escapeNode:()=>B,forEachChild:()=>z,getBareJidFromJid:()=>V,getDomainFromJid:()=>G,getNodeFromJid:()=>H,getResourceFromJid:()=>W,getText:()=>U,isTagEqual:()=>F,serialize:()=>L,stringToArrayBuf:()=>x,unescapeNode:()=>q,utf16to8:()=>b,validAttribute:()=>O,validCSS:()=>M,validTag:()=>N,xmlElement:()=>k,xmlGenerator:()=>C,xmlHtmlNode:()=>I,xmlTextNode:()=>T,xmlescape:()=>D,xmlunescape:()=>P,xorArrayBuffers:()=>j});const o=window.WebSocket,i=window.DOMParser;function a(){return document.implementation.createDocument("jabber:client","strophe",null)}const l={HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},u={tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"]},h={ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11,ATTACHFAIL:12,RECONNECTING:13},f={NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11};function m(e,t){return new v(e,t)}function p(e){return new v("message",e)}function g(e){return new v("iq",e)}function _(e){return new v("presence",e)}class v{constructor(e,t){"presence"!==e&&"message"!==e&&"iq"!==e||(t&&!t.xmlns?t.xmlns=l.CLIENT:t||(t={xmlns:l.CLIENT})),this.nodeTree=k(e,t),this.node=this.nodeTree}tree(){return this.nodeTree}toString(){return L(this.nodeTree)}up(){return this.node=this.node.parentElement,this}root(){return this.node=this.nodeTree,this}attrs(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(null!=e[t]?this.node.setAttribute(t,e[t].toString()):this.node.removeAttribute(t));return this}c(e,t,s){const n=k(e,t,s);return this.node.appendChild(n),"string"!=typeof s&&"number"!=typeof s&&(this.node=n),this}cnode(e){let t;const s=C();try{t=void 0!==s.importNode}catch(e){t=!1}const n=t?s.importNode(e,!0):R(e);return this.node.appendChild(n),this.node=n,this}t(e){const t=T(e);return this.node.appendChild(t),this}h(e){const t=C().createElement("body");t.innerHTML=e;const s=$(t);for(;s.childNodes.length>0;)this.node.appendChild(s.childNodes[0]);return this}}const y=v;function b(e){let t="";const s=e.length;for(let n=0;n<s;n++){const s=e.charCodeAt(n);s>=0&&s<=127?t+=e.charAt(n):s>2047?(t+=String.fromCharCode(224|s>>12&15),t+=String.fromCharCode(128|s>>6&63),t+=String.fromCharCode(128|s>>0&63)):(t+=String.fromCharCode(192|s>>6&31),t+=String.fromCharCode(128|s>>0&63))}return t}function j(e,t){const s=new Uint8Array(e),n=new Uint8Array(t),r=new Uint8Array(e.byteLength);for(let t=0;t<e.byteLength;t++)r[t]=s[t]^n[t];return r.buffer}function w(e){let t="";const s=new Uint8Array(e),n=s.byteLength;for(let e=0;e<n;e++)t+=String.fromCharCode(s[e]);return btoa(t)}function S(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))?.buffer}function x(e){return(new TextEncoder).encode(e).buffer}function E(e){"undefined"==typeof document&&_e.log(_e.LogLevel.ERROR,"addCookies: not adding any cookies, since there's no document object"),e=e||{};for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let s="",n="",r="";const o=e[t],i="object"==typeof o,a=escape(unescape(i?o.value:o));i&&(s=o.expires?";expires="+o.expires:"",n=o.domain?";domain="+o.domain:"",r=o.path?";path="+o.path:""),document.cookie=t+"="+a+s+n+r}}let A=null;function C(){return A||(A=a()),A}function T(e){return C().createTextNode(e)}function I(e){return(new i).parseFromString(e,"text/xml")}function k(e,t,s){if(!e)return null;const n=C().createElement(e);if(!s||"string"!=typeof s&&"number"!=typeof s){if("string"==typeof t||"number"==typeof t)return n.appendChild(T(t.toString())),n;if(!t)return n}else n.appendChild(T(s.toString()));if(Array.isArray(t))for(const e of t)Array.isArray(e)&&null!=e[0]&&null!=e[1]&&n.setAttribute(e[0],e[1]);else for(const e of Object.keys(t))e&&null!=t[e]&&n.setAttribute(e,t[e].toString());return n}function N(e){for(let t=0;t<u.tags.length;t++)if(e===u.tags[t])return!0;return!1}function O(e,t){const s=u.attributes[e];if(s?.length>0)for(let e=0;e<s.length;e++)if(t===s[e])return!0;return!1}function M(e){for(let t=0;t<u.css.length;t++)if(e===u.css[t])return!0;return!1}function $(e){if(e.nodeType===f.NORMAL)return function(e){let t;const s=e.nodeName.toLowerCase();if(N(s))try{if(t=k(s),s in u.attributes){const n=u.attributes[s];for(let s=0;s<n.length;s++){const r=n[s];let o=e.getAttribute(r);if(null!=o&&""!==o)if("style"===r&&"object"==typeof o&&(o=o.cssText??o),"style"===r){const e=[],s=o.split(";");for(let t=0;t<s.length;t++){const n=s[t].split(":"),r=n[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(M(r)){const t=n[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(r+": "+t)}}e.length>0&&(o=e.join("; "),t.setAttribute(r,o))}else t.setAttribute(r,o)}for(let s=0;s<e.childNodes.length;s++)t.appendChild($(e.childNodes[s]))}}catch(e){t=T("")}else{t=C().createDocumentFragment();for(let s=0;s<e.childNodes.length;s++)t.appendChild($(e.childNodes[s]))}return t}(e);if(e.nodeType===f.FRAGMENT){const t=C().createDocumentFragment();for(let s=0;s<e.childNodes.length;s++)t.appendChild($(e.childNodes[s]));return t}return e.nodeType===f.TEXT?T(e.nodeValue):void 0}function R(e){let t;if(e.nodeType===f.NORMAL){const s=e;t=k(s.tagName);for(let e=0;e<s.attributes.length;e++)t.setAttribute(s.attributes[e].nodeName,s.attributes[e].value);for(let e=0;e<s.childNodes.length;e++)t.appendChild(R(s.childNodes[e]))}else e.nodeType===f.TEXT&&(t=C().createTextNode(e.nodeValue));return t}function D(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")}function P(e){return e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')}function L(e){if(!e)return null;const t=e instanceof y?e.tree():e,s=[...Array(t.attributes.length).keys()].map((e=>t.attributes[e].nodeName));s.sort();let n=s.reduce(((e,s)=>`${e} ${s}="${D(t.attributes.getNamedItem(s).value)}"`),`<${t.nodeName}`);if(t.childNodes.length>0){n+=">";for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];switch(s.nodeType){case f.NORMAL:n+=L(s);break;case f.TEXT:n+=D(s.nodeValue);break;case f.CDATA:n+="<![CDATA["+s.nodeValue+"]]>"}}n+="</"+t.nodeName+">"}else n+="/>";return n}function z(e,t,s){for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n];r.nodeType!==f.NORMAL||t&&!this.isTagEqual(r,t)||s(r)}}function F(e,t){return e.tagName===t}function U(e){if(!e)return null;let t="";e.childNodes?.length||e.nodeType!==f.TEXT||(t+=e.nodeValue);for(let s=0;s<e.childNodes?.length;s++)e.childNodes[s].nodeType===f.TEXT&&(t+=e.childNodes[s].nodeValue);return D(t)}function B(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")}function q(e){return"string"!=typeof e?e:e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")}function H(e){return e.indexOf("@")<0?null:e.split("@")[0]}function G(e){const t=V(e);if(t.indexOf("@")<0)return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}}function W(e){if(!e)return null;const t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))}function V(e){return e?e.split("/")[0]:null}const J={utf16to8:b,xorArrayBuffers:j,arrayBufToBase64:w,base64ToArrayBuf:S,stringToArrayBuf:x,addCookies:E},Q=class{constructor(e,t,s,n,r,o,i){this.handler=e,this.ns=t,this.name=s,this.type=n,this.id=r,this.options=i||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBareFromJid?this.from=o?V(o):null:this.from=o,this.user=!0}getNamespace(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t}namespaceMatch(e){let t=!1;return!this.ns||(z(e,null,(e=>{this.getNamespace(e)===this.ns&&(t=!0)})),t||this.getNamespace(e)===this.ns)}isMatch(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=V(t));const s=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!_e.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(s):s!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)}run(e){let t=null;try{t=this.handler(e)}catch(e){throw _e._handleError(e),e}return t}toString(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},Y=class{constructor(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0}run(){return this.lastCalled=(new Date).getTime(),this.handler()}reset(){this.lastCalled=(new Date).getTime()}toString(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}};var K=c(494);class X extends Error{constructor(e){super(e),this.name="StropheSessionError"}}const Z=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.service=e,this.options=t,this.setProtocol(),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_bind=!1,this.do_session=!1,this.mechanisms={},this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout((()=>this._onIdle()),100),E(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),this.iqFallbackHandler=new Q((e=>this.send(g({type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("service-unavailable",{xmlns:_e.NS.STANZAS}))),null,"iq",["get","set"]);for(const e in _e._connectionPlugins)if(Object.prototype.hasOwnProperty.call(_e._connectionPlugins,e)){const t=function(){};t.prototype=_e._connectionPlugins[e],this[e]=new t,this[e].init(this)}}setProtocol(){const e=this.options.protocol||"";this.options.worker?this._proto=new _e.WorkerWebsocket(this):0===this.service.indexOf("ws:")||0===this.service.indexOf("wss:")||0===e.indexOf("ws")?this._proto=new _e.Websocket(this):this._proto=new _e.Bosh(this)}reset(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0}pause(){this.paused=!0}resume(){this.paused=!1}getUniqueId(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t+""}addProtocolErrorHandler(e,t,s){this.protocolErrorHandlers[e][t]=s}connect(e,t,s,n,r,o,i){let a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3e3;this.jid=e,this.authzid=_e.getBareJidFromJid(this.jid),this.authcid=i||_e.getNodeFromJid(this.jid),this.pass=t,this.scram_keys=null,this.connect_callback=s,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.disconnection_timeout=a,this.domain=_e.getDomainFromJid(this.jid),this._changeConnectStatus(h.CONNECTING,null),this._proto._connect(n,r,o)}attach(e,t,s,n,r,o,i){if(this._proto instanceof _e.Bosh)return this._proto._attach(e,t,s,n,r,o,i);throw new X('The "attach" method is not available for your connection protocol')}restore(e,t,s,n,r){if(!(this._proto instanceof _e.Bosh&&this._sessionCachingSupported()))throw new X('The "restore" method can only be used with a BOSH connection.');this._sessionCachingSupported()&&this._proto._restore(e,t,s,n,r)}_sessionCachingSupported(){if(this._proto instanceof _e.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1}xmlInput(e){}xmlOutput(e){}rawInput(e){}rawOutput(e){}nextValidRid(e){}send(e){if(null!==e){if(Array.isArray(e))e.forEach((e=>this._queueData(e instanceof y?e.tree():e)));else{const t=e instanceof y?e.tree():e;this._queueData(t)}this._proto._send()}}flush(){clearTimeout(this._idleTimeout),this._onIdle()}sendPresence(e,t,s,n){let r=null;const o=e instanceof y?e.tree():e;let i=o.getAttribute("id");if(i||(i=this.getUniqueId("sendPresence"),o.setAttribute("id",i)),"function"==typeof t||"function"==typeof s){const e=this.addHandler((e=>{r&&this.deleteTimedHandler(r),"error"===e.getAttribute("type")?s&&s(e):t&&t(e)}),null,"presence",null,i);n&&(r=this.addTimedHandler(n,(()=>(this.deleteHandler(e),s&&s(null),!1))))}return this.send(o),i}sendIQ(e,t,s,n){let r=null;const o=e instanceof y?e.tree():e;let i=o.getAttribute("id");if(i||(i=this.getUniqueId("sendIQ"),o.setAttribute("id",i)),"function"==typeof t||"function"==typeof s){const e=this.addHandler((e=>{r&&this.deleteTimedHandler(r);const n=e.getAttribute("type");if("result"===n)t&&t(e);else{if("error"!==n){const e=new Error(`Got bad IQ type of ${n}`);throw e.name="StropheError",e}s&&s(e)}}),null,"iq",["error","result"],i);n&&(r=this.addTimedHandler(n,(()=>(this.deleteHandler(e),s&&s(null),!1))))}return this.send(o),i}_queueData(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)}_sendRestart(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout((()=>this._onIdle()),100)}addTimedHandler(e,t){const s=new _e.TimedHandler(e,t);return this.addTimeds.push(s),s}deleteTimedHandler(e){this.removeTimeds.push(e)}addHandler(e,t,s,n,r,o,i){const a=new Q(e,t,s,n,r,o,i);return this.addHandlers.push(a),a}deleteHandler(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);t>=0&&this.addHandlers.splice(t,1)}registerSASLMechanisms(e){this.mechanisms={},(e||[_e.SASLAnonymous,_e.SASLExternal,_e.SASLOAuthBearer,_e.SASLXOAuth2,_e.SASLPlain,_e.SASLSHA1,_e.SASLSHA256,_e.SASLSHA384,_e.SASLSHA512]).forEach((e=>this.registerSASLMechanism(e)))}registerSASLMechanism(e){const t=new e;this.mechanisms[t.mechname]=t}disconnect(e){if(this._changeConnectStatus(h.DISCONNECTING,e),e?_e.warn("Disconnect was called because: "+e):_e.info("Disconnect was called"),this.connected){let e=null;this.disconnecting=!0,this.authenticated&&(e=_({xmlns:_e.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(this.disconnection_timeout,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else _e.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()}_changeConnectStatus(e,t,s){for(const s in _e._connectionPlugins)if(Object.prototype.hasOwnProperty.call(_e._connectionPlugins,s)){const n=this[s];if(n.statusChanged)try{n.statusChanged(e,t)}catch(e){_e.error(`${s} plugin caused an exception changing status: ${e}`)}}if(this.connect_callback)try{this.connect_callback(e,t,s)}catch(e){_e._handleError(e),_e.error(`User connection callback caused an exception: ${e}`)}}_doDisconnect(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),_e.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(h.DISCONNECTED,e),this.connected=!1}_dataRecv(e,t){const s="_reqToData"in this._proto?this._proto._reqToData(e):e;if(null===s)return;for(this.xmlInput!==_e.Connection.prototype.xmlInput&&(s.nodeName===this._proto.strip&&s.childNodes.length?this.xmlInput(s.childNodes[0]):this.xmlInput(s)),this.rawInput!==_e.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(_e.serialize(s)));this.removeHandlers.length>0;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);t>=0&&this.handlers.splice(t,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const n=s.getAttribute("type");if(null!==n&&"terminate"===n){if(this.disconnecting)return;let e=s.getAttribute("condition");const t=s.getElementsByTagName("conflict");return null!==e?("remote-stream-error"===e&&t.length>0&&(e="conflict"),this._changeConnectStatus(h.CONNFAIL,e)):this._changeConnectStatus(h.CONNFAIL,_e.ErrorCondition.UNKNOWN_REASON),void this._doDisconnect(e)}_e.forEachChild(s,null,(e=>{const t=[];this.handlers=this.handlers.reduce(((s,n)=>{try{!n.isMatch(e)||!this.authenticated&&n.user?s.push(n):(n.run(e)&&s.push(n),t.push(n))}catch(e){_e.warn("Removing Strophe handlers due to uncaught exception: "+e.message)}return s}),[]),!t.length&&this.iqFallbackHandler.isMatch(e)&&this.iqFallbackHandler.run(e)}))}_connect_cb(e,t,s){let n,r;_e.debug("_connect_cb was called"),this.connected=!0;try{n="_reqToData"in this._proto?this._proto._reqToData(e):e}catch(e){if(e.name!==_e.ErrorCondition.BAD_FORMAT)throw e;this._changeConnectStatus(h.CONNFAIL,_e.ErrorCondition.BAD_FORMAT),this._doDisconnect(_e.ErrorCondition.BAD_FORMAT)}if(!n)return;if(this.xmlInput!==_e.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==_e.Connection.prototype.rawInput&&(s?this.rawInput(s):this.rawInput(_e.serialize(n))),this._proto._connect_cb(n)===h.CONNFAIL)return;if(r=n.getElementsByTagNameNS?n.getElementsByTagNameNS(_e.NS.STREAM,"features").length>0:n.getElementsByTagName("stream:features").length>0||n.getElementsByTagName("features").length>0,!r)return void this._proto._no_auth_received(t);const o=Array.from(n.getElementsByTagName("mechanism")).map((e=>this.mechanisms[e.textContent])).filter((e=>e));0!==o.length||0!==n.getElementsByTagName("auth").length?!1!==this.do_authentication&&this.authenticate(o):this._proto._no_auth_received(t)}sortMechanismsByPriority(e){for(let t=0;t<e.length-1;++t){let s=t;for(let n=t+1;n<e.length;++n)e[n].priority>e[s].priority&&(s=n);if(s!==t){const n=e[t];e[t]=e[s],e[s]=n}}return e}authenticate(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()}_attemptSASLAuth(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let s=0;s<e.length;++s){if(!e[s].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=e[s],this._sasl_mechanism.onStart(this);const n=m("auth",{xmlns:_e.NS.SASL,mechanism:this._sasl_mechanism.mechname});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.clientChallenge(this);n.t((0,K.btoa)(e))}this.send(n.tree()),t=!0;break}return t}async _sasl_challenge_cb(e){const t=(0,K.atob)(U(e)),s=await this._sasl_mechanism.onChallenge(this,t),n=m("response",{xmlns:_e.NS.SASL});return s&&n.t((0,K.btoa)(s)),this.send(n.tree()),!0}_attemptLegacyAuth(){null===_e.getNodeFromJid(this.jid)?(this._changeConnectStatus(h.CONNFAIL,_e.ErrorCondition.MISSING_JID_NODE),this.disconnect(_e.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(h.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send(g({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:_e.NS.AUTH}).c("username",{}).t(_e.getNodeFromJid(this.jid)).tree()))}_onLegacyAuthIQResult(){const e="string"==typeof this.pass?this.pass:"",t=g({type:"set",id:"_auth_2"}).c("query",{xmlns:_e.NS.AUTH}).c("username",{}).t(_e.getNodeFromJid(this.jid)).up().c("password").t(e);return _e.getResourceFromJid(this.jid)||(this.jid=_e.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(_e.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1}_sasl_success_cb(e){if(this._sasl_data["server-signature"]){let t;const s=/([a-z]+)=([^,]+)(,|$)/,n=(0,K.atob)(U(e)).match(s);if("v"===n[1]&&(t=n[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}_e.info("SASL authentication succeeded."),this._sasl_data.keys&&(this.scram_keys=this._sasl_data.keys),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],s=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._onStreamFeaturesAfterSASL(t),!1};return t.push(this._addSysHandler((e=>s(t,e)),null,"stream:features",null,null)),t.push(this._addSysHandler((e=>s(t,e)),_e.NS.STREAM,"features",null,null)),this._sendRestart(),!1}_onStreamFeaturesAfterSASL(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const s=e.childNodes[t];"bind"===s.nodeName&&(this.do_bind=!0),"session"===s.nodeName&&(this.do_session=!0)}return this.do_bind?(this.options.explicitResourceBinding?this._changeConnectStatus(h.BINDREQUIRED,null):this.bind(),!1):(this._changeConnectStatus(h.AUTHFAIL,null),!1)}bind(){if(!this.do_bind)return void _e.log(_e.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=_e.getResourceFromJid(this.jid);e?this.send(g({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:_e.NS.BIND}).c("resource",{}).t(e).tree()):this.send(g({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:_e.NS.BIND}).tree())}_onResourceBindResultIQ(e){if("error"===e.getAttribute("type")){let t;return _e.warn("Resource binding failed."),e.getElementsByTagName("conflict").length>0&&(t=_e.ErrorCondition.CONFLICT),this._changeConnectStatus(h.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(t.length>0))return _e.warn("Resource binding failed."),this._changeConnectStatus(h.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");e.length>0&&(this.authenticated=!0,this.jid=U(e[0]),this.do_session?this._establishSession():this._changeConnectStatus(h.CONNECTED,null))}}_establishSession(){if(!this.do_session)throw new Error(`Strophe.Connection.prototype._establishSession called but apparently ${_e.NS.SESSION} wasn't advertised by the server`);this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send(g({type:"set",id:"_session_auth_2"}).c("session",{xmlns:_e.NS.SESSION}).tree())}_onSessionResultIQ(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(h.CONNECTED,null);else if("error"===e.getAttribute("type"))return this.authenticated=!1,_e.warn("Session creation failed."),this._changeConnectStatus(h.AUTHFAIL,null,e),!1;return!1}_sasl_failure_cb(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(h.AUTHFAIL,null,e),!1}_auth2_cb(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(h.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(h.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1}_addSysTimedHandler(e,t){const s=new Y(e,t);return s.user=!1,this.addTimeds.push(s),s}_addSysHandler(e,t,s,n,r){const o=new Q(e,t,s,n,r);return o.user=!1,this.addHandlers.push(o),o}_onDisconnectTimeout(){return _e.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(h.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1}_onIdle(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);t>=0&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let s=0;s<this.timedHandlers.length;s++){const n=this.timedHandlers[s];!this.authenticated&&n.user||(n.lastCalled+n.period-e<=0?n.run()&&t.push(n):t.push(n))}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout((()=>this._onIdle()),100))}},ee=class{constructor(e,t,s){this.mechname=e,this.isClientFirst=t,this.priority=s}test(e){return!0}onStart(e){this._connection=e}onChallenge(e,t){throw new Error("You should implement challenge handling!")}clientChallenge(e){if(!this.isClientFirst)throw new Error("clientChallenge should not be called if isClientFirst is false!");return this.onChallenge(e)}onFailure(){this._connection=null}onSuccess(){this._connection=null}},te=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ANONYMOUS",arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:20)}test(e){return null===e.authcid}},se=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"EXTERNAL",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:10)}onChallenge(e){return e.authcid===e.authzid?"":e.authzid}},ne=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"OAUTHBEARER",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:40)}test(e){return null!==e.pass}onChallenge(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",t+="",J.utf16to8(t)}},re=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"PLAIN",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:50)}test(e){return null!==e.authcid}onChallenge(e){const{authcid:t,authzid:s,domain:n,pass:r}=e;if(!n)throw new Error("SASLPlain onChallenge: domain is not defined!");let o=s!==`${t}@${n}`?s:"";return o+="\0",o+=t,o+="\0",o+=r,J.utf16to8(o)}},oe={async scramResponse(e,t,s,n){const r=e._sasl_data.cnonce,o=function(e){let t,s,n;const r=/([a-z]+)=([^,]+)(,|$)/;for(;e.match(r);){const o=e.match(r);switch(e=e.replace(o[0],""),o[1]){case"r":t=o[2];break;case"s":s=J.base64ToArrayBuf(o[2]);break;case"i":n=parseInt(o[2],10);break;default:return}}if(isNaN(n)||n<4096)_e.warn("Failing SCRAM authentication because server supplied iteration count < 4096.");else{if(s)return{nonce:t,salt:s,iter:n};_e.warn("Failing SCRAM authentication because server supplied incorrect salt.")}}(t);if(!o&&o?.nonce.slice(0,r.length)!==r)return _e.warn("Failing SCRAM authentication because server supplied incorrect nonce."),e._sasl_data={},e._sasl_failure_cb();let i,a;const{pass:l}=e;if("string"==typeof e.pass||e.pass instanceof String){const e=await async function(e,t,s,n,r){const o=await crypto.subtle.deriveBits({name:"PBKDF2",salt:t,iterations:s,hash:{name:n}},await crypto.subtle.importKey("raw",J.stringToArrayBuf(e),"PBKDF2",!1,["deriveBits"]),r),i=await crypto.subtle.importKey("raw",o,{name:"HMAC",hash:n},!1,["sign"]);return{ck:await crypto.subtle.sign("HMAC",i,J.stringToArrayBuf("Client Key")),sk:await crypto.subtle.sign("HMAC",i,J.stringToArrayBuf("Server Key"))}}(l,o.salt,o.iter,s,n);i=e.ck,a=e.sk}else{if(l?.name!==s||l?.salt!==J.arrayBufToBase64(o.salt)||l?.iter!==o.iter)return e._sasl_failure_cb();{const{ck:e,sk:t}=l;i=J.base64ToArrayBuf(e),a=J.base64ToArrayBuf(t)}}const c=e._sasl_data["client-first-message-bare"],d=t,u=`c=biws,r=${o.nonce}`,h=`${c},${d},${u}`,f=await async function(e,t,s){const n=await crypto.subtle.importKey("raw",await crypto.subtle.digest(s,t),{name:"HMAC",hash:s},!1,["sign"]),r=await crypto.subtle.sign("HMAC",n,J.stringToArrayBuf(e));return J.xorArrayBuffers(t,r)}(h,i,s),m=await async function(e,t,s){const n=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:s},!1,["sign"]);return crypto.subtle.sign("HMAC",n,J.stringToArrayBuf(e))}(h,a,s);return e._sasl_data["server-signature"]=J.arrayBufToBase64(m),e._sasl_data.keys={name:s,iter:o.iter,salt:J.arrayBufToBase64(o.salt),ck:J.arrayBufToBase64(i),sk:J.arrayBufToBase64(a)},`${u},p=${J.arrayBufToBase64(f)}`},clientChallenge(e,t){const s=t||function(){const e=new Uint8Array(16);return J.arrayBufToBase64(crypto.getRandomValues(e).buffer)}(),n=`n=${e.authcid},r=${s}`;return e._sasl_data.cnonce=s,e._sasl_data["client-first-message-bare"]=n,`n,,${n}`}},ie=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-1",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:60)}test(e){return null!==e.authcid}async onChallenge(e,t){return await oe.scramResponse(e,t,"SHA-1",160)}clientChallenge(e,t){return oe.clientChallenge(e,t)}},ae=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-256",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:70)}test(e){return null!==e.authcid}async onChallenge(e,t){return await oe.scramResponse(e,t,"SHA-256",256)}clientChallenge(e,t){return oe.clientChallenge(e,t)}},le=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-384",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:71)}test(e){return null!==e.authcid}async onChallenge(e,t){return await oe.scramResponse(e,t,"SHA-384",384)}clientChallenge(e,t){return oe.clientChallenge(e,t)}},ce=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SCRAM-SHA-512",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:72)}test(e){return null!==e.authcid}async onChallenge(e,t){return await oe.scramResponse(e,t,"SHA-512",512)}clientChallenge(e,t){return oe.clientChallenge(e,t)}},de=class extends ee{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"X-OAUTH2",!(arguments.length>1&&void 0!==arguments[1])||arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:30)}test(e){return null!==e.pass}onChallenge(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,J.utf16to8(t)}},ue=class{constructor(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.id=++_e._requestId,this.xmlData=e,this.data=_e.serialize(e),this.origFunc=t,this.func=t,this.rid=s,this.date=NaN,this.sends=n,this.abort=!1,this.dead=null,this.age=()=>this.date?((new Date).valueOf()-this.date.valueOf())/1e3:0,this.timeDead=()=>this.dead?((new Date).valueOf()-this.dead.valueOf())/1e3:0,this.xhr=this._newXHR()}getResponse(){let e=this.xhr.responseXML?.documentElement;if(e){if("parsererror"===e.tagName)throw _e.error("invalid response received"),_e.error("responseText: "+this.xhr.responseText),_e.error("responseXML: "+_e.serialize(e)),new Error("parsererror")}else if(this.xhr.responseText){_e.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),e=(new i).parseFromString(this.xhr.responseText,"application/xml").documentElement;const t=e?.querySelector("parsererror");if(!e||t){t&&(_e.error("invalid response received: "+t.textContent),_e.error("responseText: "+this.xhr.responseText));const e=new Error;throw e.name=_e.ErrorCondition.BAD_FORMAT,e}}return e}_newXHR(){const e=new XMLHttpRequest;return e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"),e.onreadystatechange=this.func.bind(null,this),e}};class he{constructor(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.strip=he.prototype.strip??!1,this.lastResponseHeaders=null,this._requests=[]}_buildBody(){const e=m("body",{rid:this.rid++,xmlns:_e.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e}_reset(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_connect(e,t,s){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const n=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":_e.NS.BOSH});s&&n.attrs({route:s});const r=this._conn._connect_cb;this._requests.push(new _e.Request(n.tree(),this._onRequestStateChange.bind(this,r.bind(this._conn)),Number(n.tree().getAttribute("rid")))),this._throttledRequestHandler()}_attach(e,t,s,n,r,o,i){this._conn.jid=e,this.sid=t,this.rid=s,this._conn.connect_callback=n,this._conn.domain=_e.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=r||this.wait,this.hold=o||this.hold,this.window=i||this.window,this._conn._changeConnectStatus(_e.Status.ATTACHED,null)}_restore(e,t,s,n,r){const o=JSON.parse(sessionStorage.getItem("strophe-bosh-session"));if(!(null!=o&&o.rid&&o.sid&&o.jid&&(null==e||_e.getBareJidFromJid(o.jid)===_e.getBareJidFromJid(e)||null===_e.getNodeFromJid(e)&&_e.getDomainFromJid(o.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(o.jid,o.sid,o.rid,t,s,n,r)}_cacheSession(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):sessionStorage.removeItem("strophe-bosh-session")}_connect_cb(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");_e.error("BOSH-Connection failed: "+t);const s=e.getElementsByTagName("conflict");return null!==t?("remote-stream-error"===t&&s.length>0&&(t="conflict"),this._conn._changeConnectStatus(_e.Status.CONNFAIL,t)):this._conn._changeConnectStatus(_e.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(t),_e.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const s=e.getAttribute("requests");s&&(this.window=parseInt(s,10));const n=e.getAttribute("hold");n&&(this.hold=parseInt(n,10));const r=e.getAttribute("wait");r&&(this.wait=parseInt(r,10));const o=e.getAttribute("inactivity");o&&(this.inactivity=parseInt(o,10))}_disconnect(e){this._sendTerminate(e)}_doDisconnect(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_emptyQueue(){return 0===this._requests.length}_callProtocolErrorHandlers(e){const t=he._getRequestStatus(e),s=this._conn.protocolErrorHandlers.HTTP[t];s&&s.call(this,t)}_hitError(e){this.errors++,_e.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()}_no_auth_received(e){_e.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new _e.Request(t.tree(),this._onRequestStateChange.bind(this,e),Number(t.tree().getAttribute("rid")))),this._throttledRequestHandler()}_onDisconnectTimeout(){this._abortAllRequests()}_abortAllRequests(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}}_onIdle(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(_e.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const t=this._buildBody();for(let s=0;s<e.length;s++)null!==e[s]&&("restart"===e[s]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":_e.NS.BOSH}):t.cnode(e[s]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new _e.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),Number(t.tree().getAttribute("rid")))),this._throttledRequestHandler()}if(this._requests.length>0){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(_e.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>Math.floor(_e.TIMEOUT*this.wait)&&(_e.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(_e.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}}static _getRequestStatus(e,t){let s;if(4===e.xhr.readyState)try{s=e.xhr.status}catch(e){_e.error("Caught an error while retrieving a request's status, reqStatus: "+s)}return void 0===s&&(s="number"==typeof t?t:0),s}_onRequestStateChange(e,t){if(_e.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)return void(t.abort=!1);if(4!==t.xhr.readyState)return;const s=he._getRequestStatus(t);if(this.lastResponseHeaders=t.xhr.getAllResponseHeaders(),this._conn.disconnecting&&s>=400)return this._hitError(s),void this._callProtocolErrorHandlers(t);const n=this._requests[0]===t,r=this._requests[1]===t,o=s>0&&s<500,i=t.sends>this._conn.maxRetries;(o||i)&&(this._removeRequest(t),_e.debug("request id "+t.id+" should now be removed")),200===s?((r||n&&this._requests.length>0&&this._requests[0].age()>Math.floor(_e.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(t.rid+1),_e.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0):0===s||s>=400&&s<600||s>=12e3?(_e.error("request id "+t.id+"."+t.sends+" error "+s+" happened"),this._hitError(s),this._callProtocolErrorHandlers(t),s>=400&&s<500&&(this._conn._changeConnectStatus(_e.Status.DISCONNECTING,null),this._conn._doDisconnect())):_e.error("request id "+t.id+"."+t.sends+" error "+s+" happened"),o||i?i&&!this._conn.connected&&this._conn._changeConnectStatus(_e.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}_processRequest(e){let t=this._requests[e];const s=he._getRequestStatus(t,-1);if(t.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const n=t.age(),r=!isNaN(n)&&n>Math.floor(_e.TIMEOUT*this.wait),o=null!==t.dead&&t.timeDead()>Math.floor(_e.SECONDARY_TIMEOUT*this.wait),i=4===t.xhr.readyState&&(s<1||s>=500);if((r||o||i)&&(o&&_e.error(`Request ${this._requests[e].id} timed out (secondary), restarting`),t.abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){},this._requests[e]=new _e.Request(t.xmlData,t.origFunc,t.rid,t.sends),t=this._requests[e]),0===t.xhr.readyState){_e.debug("request id "+t.id+"."+t.sends+" posting");try{const e=this._conn.options.contentType||"text/xml; charset=utf-8";t.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==t.xhr.setRequestHeader&&t.xhr.setRequestHeader("Content-Type",e),this._conn.options.withCredentials&&(t.xhr.withCredentials=!0)}catch(e){return _e.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(_e.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const e=()=>{if(t.date=(new Date).valueOf(),this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.xhr.setRequestHeader(s,e[s])}t.xhr.send(t.data)};if(t.sends>1){const s=1e3*Math.min(Math.floor(_e.TIMEOUT*this.wait),Math.pow(t.sends,3));setTimeout((function(){e()}),s)}else e();t.sends++,this.strip&&"body"===t.xmlData.nodeName&&t.xmlData.childNodes.length?this._conn.xmlOutput?.(t.xmlData.children[0]):this._conn.xmlOutput?.(t.xmlData),this._conn.rawOutput?.(t.data)}else _e.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+t.xhr.readyState)}_removeRequest(e){_e.debug("removing request");for(let t=this._requests.length-1;t>=0;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()}_restartRequest(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)}_reqToData(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}}_sendTerminate(e){_e.debug("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"}),s=e instanceof y?e.tree():e;e&&t.cnode(s);const n=new _e.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),Number(t.tree().getAttribute("rid")));this._requests.push(n),this._throttledRequestHandler()}_send(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout((()=>this._conn._onIdle()),100)}_sendRestart(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)}_throttledRequestHandler(){this._requests?_e.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):_e.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}}const fe=he,me=class{constructor(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let s="";"ws"===e.options.protocol&&"https:"!==location.protocol?s+="ws":s+="wss",s+="://"+location.host,0!==t.indexOf("/")?s+=location.pathname+t:s+=t,e.service=s}}_buildStream(){return m("open",{xmlns:_e.NS.FRAMING,to:this._conn.domain,version:"1.0"})}_checkStreamError(e,t){let s;if(s=e.getElementsByTagNameNS?e.getElementsByTagNameNS(_e.NS.STREAM,"error"):e.getElementsByTagName("stream:error"),0===s.length)return!1;const n=s[0];let r="",o="";for(let e=0;e<n.childNodes.length;e++){const t=n.children[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?o=t.textContent:r=t.nodeName}let i="WebSocket stream error: ";return i+=r||"unknown",o&&(i+=" - "+o),_e.error(i),this._conn._changeConnectStatus(t,r),this._conn._doDisconnect(),!0}_reset(){}_connect(){this._closeSocket(),this.socket=new o(this._conn.service,"xmpp"),this.socket.onopen=()=>this._onOpen(),this.socket.onerror=e=>this._onError(e),this.socket.onclose=e=>this._onClose(e),this.socket.onmessage=e=>this._onInitialMessage(e)}_connect_cb(e){if(this._checkStreamError(e,_e.Status.CONNFAIL))return _e.Status.CONNFAIL}_handleStreamStart(e){let t=null;const s=e.getAttribute("xmlns");"string"!=typeof s?t="Missing xmlns in <open />":s!==_e.NS.FRAMING&&(t="Wrong xmlns in <open />: "+s);const n=e.getAttribute("version");return"string"!=typeof n?t="Missing version in <open />":"1.0"!==n&&(t="Wrong version in <open />: "+n),!t||(this._conn._changeConnectStatus(_e.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)}_onInitialMessage(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const s=(new i).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(s),this._conn.rawInput(e.data),this._handleStreamStart(s)&&this._connect_cb(s)}else if(0===e.data.indexOf("<close ")){const t=(new i).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const s=t.getAttribute("see-other-uri");if(s){const e=this._conn.service;(e.indexOf("wss:")>=0&&s.indexOf("wss:")>=0||e.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(_e.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=s,this._connect())}else this._conn._changeConnectStatus(_e.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{this._replaceMessageHandler();const t=this._streamWrap(e.data),s=(new i).parseFromString(t,"text/xml").documentElement;this._conn._connect_cb(s,null,e.data)}}_replaceMessageHandler(){this.socket.onmessage=e=>this._onMessage(e)}_disconnect(e){if(this.socket&&this.socket.readyState!==o.CLOSED){e&&this._conn.send(e);const t=m("close",{xmlns:_e.NS.FRAMING});this._conn.xmlOutput(t.tree());const s=_e.serialize(t);this._conn.rawOutput(s);try{this.socket.send(s)}catch(e){_e.warn("Couldn't send <close /> tag.")}}setTimeout((()=>this._conn._doDisconnect()),0)}_doDisconnect(){_e.debug("WebSockets _doDisconnect was called"),this._closeSocket()}_streamWrap(e){return"<wrapper>"+e+"</wrapper>"}_closeSocket(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){_e.debug(e.message)}this.socket=null}_emptyQueue(){return!0}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(_e.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(_e.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(_e.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):_e.debug("Websocket closed")}_no_auth_received(e){_e.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(_e.Status.CONNFAIL,_e.ErrorCondition.NO_AUTH_MECH),e?.call(this._conn),this._conn._doDisconnect()}_onDisconnectTimeout(){}_abortAllRequests(){}_onError(e){_e.error("Websocket error "+JSON.stringify(e)),this._conn._changeConnectStatus(_e.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()}_onIdle(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){const s="restart"===e[t]?this._buildStream().tree():e[t];if("restart"===s)throw new Error("Wrong type for stanza");const n=_e.serialize(s);this._conn.xmlOutput(s),this._conn.rawOutput(n),this.socket.send(n)}this._conn._data=[]}}_onMessage(e){let t;const s='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===s)return this._conn.rawInput(s),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(t=(new i).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return}else{const s=this._streamWrap(e.data);t=(new i).parseFromString(s,"text/xml").documentElement}return this._checkStreamError(t,_e.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstElementChild.nodeName&&"unavailable"===t.firstElementChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(_e.serialize(t))):void this._conn._dataRecv(t,e.data)}_onOpen(){_e.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=_e.serialize(e);this._conn.rawOutput(t),this.socket.send(t)}_send(){this._conn.flush()}_sendRestart(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}},pe=class extends me{constructor(e){super(e),this._conn=e,this.worker=new SharedWorker(this._conn.options.worker,"Strophe XMPP Connection"),this.worker.onerror=e=>{console?.error(e),_e.log(_e.LogLevel.ERROR,`Shared Worker Error: ${e}`)}}_setSocket(){this.socket={send:e=>this.worker.port.postMessage(["send",e]),close:()=>this.worker.port.postMessage(["_closeSocket"]),onopen:()=>{},onerror:e=>this._onError(e),onclose:e=>this._onClose(e),onmessage:()=>{},readyState:null}}_connect(){this._setSocket(),this._messageHandler=e=>this._onInitialMessage(e),this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_connect",this._conn.service,this._conn.jid])}_attach(e){this._setSocket(),this._messageHandler=e=>this._onMessage(e),this._conn.connect_callback=e,this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_attach",this._conn.service])}_attachCallback(e,t){e===_e.Status.ATTACHED?(this._conn.jid=t,this._conn.authenticated=!0,this._conn.connected=!0,this._conn.restored=!0,this._conn._changeConnectStatus(_e.Status.ATTACHED)):e===_e.Status.ATTACHFAIL&&(this._conn.authenticated=!1,this._conn.connected=!1,this._conn.restored=!1,this._conn._changeConnectStatus(_e.Status.ATTACHFAIL))}_disconnect(e){e&&this._conn.send(e);const t=m("close",{xmlns:_e.NS.FRAMING});this._conn.xmlOutput(t.tree());const s=_e.serialize(t);this._conn.rawOutput(s),this.worker.port.postMessage(["send",s]),this._conn._doDisconnect()}_closeSocket(){this.socket.close()}_replaceMessageHandler(){this._messageHandler=e=>this._onMessage(e)}_onWorkerMessage(e){const t={};t.debug=_e.LogLevel.DEBUG,t.info=_e.LogLevel.INFO,t.warn=_e.LogLevel.WARN,t.error=_e.LogLevel.ERROR,t.fatal=_e.LogLevel.FATAL;const{data:s}=e,n=s[0];if("_onMessage"===n)this._messageHandler(s[1]);else if(n in this)try{this[n].apply(this,e.data.slice(1))}catch(e){_e.log(_e.LogLevel.ERROR,e)}else if("log"===n){const e=s[1],n=s[2];_e.log(t[e],n)}else _e.log(_e.LogLevel.ERROR,`Found unhandled service worker message: ${s}`)}},ge={VERSION:"1.6.1",TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,shims:n,Request:ue,Bosh:fe,Websocket:me,WorkerWebsocket:pe,SASLAnonymous:te,SASLPlain:re,SASLSHA1:ie,SASLSHA256:ae,SASLSHA384:le,SASLSHA512:ce,SASLOAuthBearer:ne,SASLExternal:se,SASLXOAuth2:de,Builder:y,Connection:Z,ElementType:f,ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},Handler:Q,LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},NS:l,SASLMechanism:ee,Status:h,TimedHandler:Y,...r,XHTML:{...u,validTag:N,validCSS:M,validAttribute:O},addNamespace(e,t){ge.NS[e]=t},_handleError(e){void 0!==e.stack&&ge.fatal(e.stack),ge.fatal("error: "+e.message)},log(e,t){e===this.LogLevel.FATAL&&console?.error(t)},debug(e){this.log(this.LogLevel.DEBUG,e)},info(e){this.log(this.LogLevel.INFO,e)},warn(e){this.log(this.LogLevel.WARN,e)},error(e){this.log(this.LogLevel.ERROR,e)},fatal(e){this.log(this.LogLevel.FATAL,e)},_requestId:0,_connectionPlugins:{},addConnectionPlugin(e,t){ge._connectionPlugins[e]=t}},_e=ge;globalThis.$build=m,globalThis.$iq=g,globalThis.$msg=p,globalThis.$pres=_,globalThis.Strophe=_e;const ve="v10.1.5",ye={offline:6,unavailable:5,xa:4,away:3,dnd:2,chat:1,online:1},be="anonymous",je="external",we="login",Se="logout",xe="prebind",Ee="headline",Ae={};Ae[_e.Status.ATTACHED]="ATTACHED",Ae[_e.Status.AUTHENTICATING]="AUTHENTICATING",Ae[_e.Status.AUTHFAIL]="AUTHFAIL",Ae[_e.Status.CONNECTED]="CONNECTED",Ae[_e.Status.CONNECTING]="CONNECTING",Ae[_e.Status.CONNFAIL]="CONNFAIL",Ae[_e.Status.DISCONNECTED]="DISCONNECTED",Ae[_e.Status.DISCONNECTING]="DISCONNECTING",Ae[_e.Status.ERROR]="ERROR",Ae[_e.Status.RECONNECTING]="RECONNECTING",Ae[_e.Status.REDIRECT]="REDIRECT",_e.addNamespace("ACTIVITY","http://jabber.org/protocol/activity"),_e.addNamespace("CARBONS","urn:xmpp:carbons:2"),_e.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),_e.addNamespace("CSI","urn:xmpp:csi:0"),_e.addNamespace("DELAY","urn:xmpp:delay"),_e.addNamespace("EME","urn:xmpp:eme:0"),_e.addNamespace("FASTEN","urn:xmpp:fasten:0"),_e.addNamespace("FORWARD","urn:xmpp:forward:0"),_e.addNamespace("HINTS","urn:xmpp:hints"),_e.addNamespace("HTTPUPLOAD","urn:xmpp:http:upload:0"),_e.addNamespace("MAM","urn:xmpp:mam:2"),_e.addNamespace("MARKERS","urn:xmpp:chat-markers:0"),_e.addNamespace("MENTIONS","urn:xmpp:mmn:0"),_e.addNamespace("MESSAGE_CORRECT","urn:xmpp:message-correct:0"),_e.addNamespace("MODERATE","urn:xmpp:message-moderate:0"),_e.addNamespace("NICK","http://jabber.org/protocol/nick"),_e.addNamespace("OCCUPANTID","urn:xmpp:occupant-id:0"),_e.addNamespace("OMEMO","eu.siacs.conversations.axolotl"),_e.addNamespace("OUTOFBAND","jabber:x:oob"),_e.addNamespace("PUBSUB","http://jabber.org/protocol/pubsub"),_e.addNamespace("RAI","urn:xmpp:rai:0"),_e.addNamespace("RECEIPTS","urn:xmpp:receipts"),_e.addNamespace("REFERENCE","urn:xmpp:reference:0"),_e.addNamespace("REGISTER","jabber:iq:register"),_e.addNamespace("RETRACT","urn:xmpp:message-retract:0"),_e.addNamespace("ROSTERX","http://jabber.org/protocol/rosterx"),_e.addNamespace("RSM","http://jabber.org/protocol/rsm"),_e.addNamespace("SID","urn:xmpp:sid:0"),_e.addNamespace("SPOILER","urn:xmpp:spoiler:0"),_e.addNamespace("STANZAS","urn:ietf:params:xml:ns:xmpp-stanzas"),_e.addNamespace("STYLING","urn:xmpp:styling:0"),_e.addNamespace("VCARD","vcard-temp"),_e.addNamespace("VCARDUPDATE","vcard-temp:x:update"),_e.addNamespace("XFORM","jabber:x:data"),_e.addNamespace("XHTML","http://www.w3.org/1999/xhtml");const Ce=["converse-adhoc","converse-bookmarks","converse-bosh","converse-caps","converse-chat","converse-chatboxes","converse-disco","converse-emoji","converse-headlines","converse-mam","converse-muc","converse-ping","converse-pubsub","converse-roster","converse-smacks","converse-status","converse-vcard"],Te={start:/(\b|_)(?:([a-z][a-z0-9.+-]*:\/\/)|xmpp:|mailto:|www\.)/gi};var Ie=c(734),ke=c.n(Ie),Ne=c(293);const Oe={initialize(){},__(){return(0,Ne.sprintf)(...arguments)}};function Me(e){return e instanceof Element||e instanceof HTMLDocument}const $e={debug:0,info:1,warn:2,error:3,fatal:4},Re=Object.assign({debug:console?.log?console.log.bind(console):function(){},error:console?.log?console.log.bind(console):function(){},info:console?.log?console.log.bind(console):function(){},warn:console?.log?console.log.bind(console):function(){}},console),De={setLogLevel(e){if(!["debug","info","warn","error","fatal"].includes(e))throw new Error(`Invalid loglevel: ${e}`);this.loglevel=e},log(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if($e[t]<$e[this.loglevel])return;"error"===t||"fatal"===t?s=s||"color: maroon":"debug"===t&&(s=s||"color: green"),e instanceof Error?e=e.stack:Me(e)&&(e=e.outerHTML);const n=s?"%c":"";"error"===t?Re.error(`${n} ERROR: ${e}`,s):"warn"===t?Re.warn(`${n} ${(new Date).toISOString()} WARNING: ${e}`,s):"fatal"===t?Re.error(`${n} FATAL: ${e}`,s):"debug"===t?Re.debug(`${n} ${(new Date).toISOString()} DEBUG: ${e}`,s):Re.info(`${n} ${(new Date).toISOString()} INFO: ${e}`,s)},debug(e,t){this.log(e,"debug",t)},error(e,t){this.log(e,"error",t)},info(e,t){this.log(e,"info",t)},warn(e,t){this.log(e,"warn",t)},fatal(e,t){this.log(e,"fatal",t)}};function Pe(e,t,s,n){"function"==typeof s&&(void 0===this.__super__&&(this.__super__=n),this.__super__[e]=s.bind(this));for(var r=arguments.length,o=new Array(r>4?r-4:0),i=4;i<r;i++)o[i-4]=arguments[i];return t.apply(this,o)}class Le{constructor(e,t){this.name=t,this.plugged=e,void 0===this.plugged.__super__?this.plugged.__super__={}:"string"==typeof this.plugged.__super__&&(this.plugged.__super__={__string__:this.plugged.__super__}),this.plugged.__super__[t]=this.plugged,this.plugins={},this.initialized_plugins=[]}_overrideAttribute(e,t){const s=t.overrides[e];if("function"==typeof s){const t={};t[this.name]=this.plugged;const n=this.plugged[e];this.plugged[e]=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return Pe.apply(this,[e,s,n,t,...o])}}else this.plugged[e]=s}_extendObject(e,t){e.prototype.__super__||(e.prototype.__super__={},e.prototype.__super__[this.name]=this.plugged);for(const[s,n]of Object.entries(t))if("events"===s)e.prototype[s]=Object.assign(n,e.prototype[s]);else if("function"==typeof n){const t={};t[this.name]=this.plugged;const r=e.prototype[s];e.prototype[s]=function(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return Pe.apply(this,[s,n,r,t,...o])}}else e.prototype[s]=n}loadPluginDependencies(e){e.dependencies?.forEach((t=>{const s=this.plugins[t];if(s){if(s.dependencies?.includes(e.__name__))throw'Found a circular dependency between the plugins "'+e.__name__+'" and "'+t+'"';this.initializePlugin(s)}else this.throwUndefinedDependencyError('Could not find dependency "'+t+'" for the plugin "'+e.__name__+"\". If it's needed, make sure it's loaded by require.js")}))}throwUndefinedDependencyError(e){if(this.plugged.strict_plugin_dependencies)throw e;console.warn?console.warn(e):console.log(e)}applyOverrides(e){Object.keys(e.overrides||{}).forEach((t=>{const s=e.overrides[t];"object"==typeof s?void 0===this.plugged[t]?this.throwUndefinedDependencyError(`Plugin "${e.__name__}" tried to override "${t}" but it's not found.`):this._extendObject(this.plugged[t],s):this._overrideAttribute(t,e)}))}initializePlugin(e){Object.keys(this.allowed_plugins).includes(e.__name__)&&(this.initialized_plugins.includes(e.__name__)||("boolean"==typeof e.enabled&&e.enabled||e.enabled?.(this.plugged)||null==e.enabled)&&(Object.assign(e,this.properties),e.dependencies&&this.loadPluginDependencies(e),this.applyOverrides(e),"function"==typeof e.initialize&&e.initialize.bind(e)(this),this.initialized_plugins.push(e.__name__)))}registerPlugin(e,t){if(e in this.plugins)throw new Error("Error: Plugin name "+e+" is already taken");t.__name__=e,this.plugins[e]=t}initializePlugins(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Object.keys(this.plugins).length){this.properties=e,this.allowed_plugins={};for(const[e,n]of Object.entries(this.plugins))t.length&&!t.includes(e)||s.includes(e)||(this.allowed_plugins[e]=n);Object.values(this.allowed_plugins).forEach((e=>this.initializePlugin(e)))}}}const ze={enable:function(e,t,s){return void 0===s&&(s="pluginSocket"),void 0===t&&(t="plugged"),e[s]=new Le(e,t),e}};var Fe=Object.prototype;const Ue=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Fe)},Be=function(e,t){return function(s){return e(t(s))}},qe=Be(Object.keys,Object);var He=Object.prototype.hasOwnProperty;const Ge=function(e){if(!Ue(e))return qe(e);var t=[];for(var s in Object(e))He.call(e,s)&&"constructor"!=s&&t.push(s);return t},We="object"==typeof s.g&&s.g&&s.g.Object===Object&&s.g;var Ve="object"==typeof self&&self&&self.Object===Object&&self;const Je=We||Ve||Function("return this")(),Qe=Je.Symbol;var Ye=Object.prototype,Ke=Ye.hasOwnProperty,Xe=Ye.toString,Ze=Qe?Qe.toStringTag:void 0;const et=function(e){var t=Ke.call(e,Ze),s=e[Ze];try{e[Ze]=void 0;var n=!0}catch(e){}var r=Xe.call(e);return n&&(t?e[Ze]=s:delete e[Ze]),r};var tt=Object.prototype.toString;const st=function(e){return tt.call(e)};var nt=Qe?Qe.toStringTag:void 0;const rt=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":nt&&nt in Object(e)?et(e):st(e)},ot=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},it=function(e){if(!ot(e))return!1;var t=rt(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},at=Je["__core-js_shared__"];var lt,ct=(lt=/[^.]+$/.exec(at&&at.keys&&at.keys.IE_PROTO||""))?"Symbol(src)_1."+lt:"";const dt=function(e){return!!ct&&ct in e};var ut=Function.prototype.toString;const ht=function(e){if(null!=e){try{return ut.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var ft=/^\[object .+?Constructor\]$/,mt=Function.prototype,pt=Object.prototype,gt=mt.toString,_t=pt.hasOwnProperty,vt=RegExp("^"+gt.call(_t).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const yt=function(e){return!(!ot(e)||dt(e))&&(it(e)?vt:ft).test(ht(e))},bt=function(e,t){return null==e?void 0:e[t]},jt=function(e,t){var s=bt(e,t);return yt(s)?s:void 0},wt=jt(Je,"DataView"),St=jt(Je,"Map"),xt=jt(Je,"Promise"),Et=jt(Je,"Set"),At=jt(Je,"WeakMap");var Ct="[object Map]",Tt="[object Promise]",It="[object Set]",kt="[object WeakMap]",Nt="[object DataView]",Ot=ht(wt),Mt=ht(St),$t=ht(xt),Rt=ht(Et),Dt=ht(At),Pt=rt;(wt&&Pt(new wt(new ArrayBuffer(1)))!=Nt||St&&Pt(new St)!=Ct||xt&&Pt(xt.resolve())!=Tt||Et&&Pt(new Et)!=It||At&&Pt(new At)!=kt)&&(Pt=function(e){var t=rt(e),s="[object Object]"==t?e.constructor:void 0,n=s?ht(s):"";if(n)switch(n){case Ot:return Nt;case Mt:return Ct;case $t:return Tt;case Rt:return It;case Dt:return kt}return t});const Lt=Pt,zt=function(e){return null!=e&&"object"==typeof e},Ft=function(e){return zt(e)&&"[object Arguments]"==rt(e)};var Ut=Object.prototype,Bt=Ut.hasOwnProperty,qt=Ut.propertyIsEnumerable,Ht=Ft(function(){return arguments}())?Ft:function(e){return zt(e)&&Bt.call(e,"callee")&&!qt.call(e,"callee")};const Gt=Ht,Wt=Array.isArray,Vt=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Jt=function(e){return null!=e&&Vt(e.length)&&!it(e)},Qt=function(){return!1};var Yt=t&&!t.nodeType&&t,Kt=Yt&&e&&!e.nodeType&&e,Xt=Kt&&Kt.exports===Yt?Je.Buffer:void 0;const Zt=(Xt?Xt.isBuffer:void 0)||Qt;var es={};es["[object Float32Array]"]=es["[object Float64Array]"]=es["[object Int8Array]"]=es["[object Int16Array]"]=es["[object Int32Array]"]=es["[object Uint8Array]"]=es["[object Uint8ClampedArray]"]=es["[object Uint16Array]"]=es["[object Uint32Array]"]=!0,es["[object Arguments]"]=es["[object Array]"]=es["[object ArrayBuffer]"]=es["[object Boolean]"]=es["[object DataView]"]=es["[object Date]"]=es["[object Error]"]=es["[object Function]"]=es["[object Map]"]=es["[object Number]"]=es["[object Object]"]=es["[object RegExp]"]=es["[object Set]"]=es["[object String]"]=es["[object WeakMap]"]=!1;const ts=function(e){return zt(e)&&Vt(e.length)&&!!es[rt(e)]},ss=function(e){return function(t){return e(t)}};var ns=t&&!t.nodeType&&t,rs=ns&&e&&!e.nodeType&&e,os=rs&&rs.exports===ns&&We.process;const is=function(){try{var e=rs&&rs.require&&rs.require("util").types;return e||os&&os.binding&&os.binding("util")}catch(e){}}();var as=is&&is.isTypedArray;const ls=as?ss(as):ts;var cs=Object.prototype.hasOwnProperty;const ds=function(e){if(null==e)return!0;if(Jt(e)&&(Wt(e)||"string"==typeof e||"function"==typeof e.splice||Zt(e)||ls(e)||Gt(e)))return!e.length;var t=Lt(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Ue(e))return!Ge(e).length;for(var s in e)if(cs.call(e,s))return!1;return!0},us=function(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n};var hs=/^(?:0|[1-9]\d*)$/;const fs=function(e,t){var s=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==s||"symbol"!=s&&hs.test(e))&&e>-1&&e%1==0&&e<t};var ms=Object.prototype.hasOwnProperty;const ps=function(e,t){var s=Wt(e),n=!s&&Gt(e),r=!s&&!n&&Zt(e),o=!s&&!n&&!r&&ls(e),i=s||n||r||o,a=i?us(e.length,String):[],l=a.length;for(var c in e)!t&&!ms.call(e,c)||i&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||fs(c,l))||a.push(c);return a},gs=function(e){return Jt(e)?ps(e):Ge(e)};var _s=/\s/;const vs=function(e){for(var t=e.length;t--&&_s.test(e.charAt(t)););return t};var ys=/^\s+/;const bs=function(e){return e?e.slice(0,vs(e)+1).replace(ys,""):e},js=function(e){return"symbol"==typeof e||zt(e)&&"[object Symbol]"==rt(e)};var ws=/^[-+]0x[0-9a-f]+$/i,Ss=/^0b[01]+$/i,xs=/^0o[0-7]+$/i,Es=parseInt;const As=function(e){if("number"==typeof e)return e;if(js(e))return NaN;if(ot(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ot(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=bs(e);var s=Ss.test(e);return s||xs.test(e)?Es(e.slice(2),s?2:8):ws.test(e)?NaN:+e};var Cs=1/0;const Ts=function(e){return e?(e=As(e))===Cs||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},Is=function(e){var t=Ts(e),s=t%1;return t==t?s?t-s:t:0},ks=function(e,t){var s;if("function"!=typeof t)throw new TypeError("Expected a function");return e=Is(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=void 0),s}},Ns=function(e){return ks(2,e)},Os=function(e,t){for(var s=-1,n=null==e?0:e.length,r=Array(n);++s<n;)r[s]=t(e[s],s,e);return r};var Ms=Qe?Qe.prototype:void 0,$s=Ms?Ms.toString:void 0;const Rs=function e(t){if("string"==typeof t)return t;if(Wt(t))return Os(t,e)+"";if(js(t))return $s?$s.call(t):"";var s=t+"";return"0"==s&&1/t==-1/0?"-0":s},Ds=function(e){return null==e?"":Rs(e)};var Ps=0;const Ls=function(e){var t=++Ps;return Ds(e)+t},zs={},Fs=/\s+/;let Us;const Bs=function(e,t,s,n,r){let o,i=0;if(s&&"object"==typeof s){void 0!==n&&"context"in r&&void 0===r.context&&(r.context=n);for(o=gs(s);i<o.length;i++)t=Bs(e,t,o[i],s[o[i]],r)}else if(s&&Fs.test(s))for(o=s.split(Fs);i<o.length;i++)t=e(t,o[i],n,r);else t=e(t,s,n,r);return t};zs.on=function(e,t,s){return this._events=Bs(qs,this._events||{},e,t,{context:s,ctx:this,listening:Us}),Us&&((this._listeners||(this._listeners={}))[Us.id]=Us,Us.interop=!1),this},zs.listenTo=function(e,t,s){if(!e)return this;const n=e._listenId||(e._listenId=Ls("l")),r=this._listeningTo||(this._listeningTo={});let o=Us=r[n];o||(this._listenId||(this._listenId=Ls("l")),o=Us=r[n]=new Qs(this,e));const i=Hs(e,t,s,this);if(Us=void 0,i)throw i;return o.interop&&o.on(t,s),this};const qs=function(e,t,s,n){if(s){const r=e[t]||(e[t]=[]),o=n.context,i=n.ctx,a=n.listening;a&&a.count++,r.push({callback:s,context:o,ctx:o||i,listening:a})}return e},Hs=function(e,t,s,n){try{e.on(t,s,n)}catch(e){return e}};zs.off=function(e,t,s){return this._events?(this._events=Bs(Gs,this._events,e,t,{context:s,listeners:this._listeners}),this):this},zs.stopListening=function(e,t,s){const n=this._listeningTo;if(!n)return this;const r=e?[e._listenId]:gs(n);for(let e=0;e<r.length;e++){const o=n[r[e]];if(!o)break;o.obj.off(t,s,this),o.interop&&o.off(t,s)}return ds(n)&&(this._listeningTo=void 0),this};const Gs=function(e,t,s,n){if(!e)return;const r=n.context,o=n.listeners;let i,a=0;if(t||r||s){for(i=t?[t]:gs(e);a<i.length;a++){const n=e[t=i[a]];if(!n)break;const o=[];for(let e=0;e<n.length;e++){const i=n[e];if(s&&s!==i.callback&&s!==i.callback._callback||r&&r!==i.context)o.push(i);else{const e=i.listening;e&&e.off(t,s)}}o.length?e[t]=o:delete e[t]}return e}for(i=gs(o);a<i.length;a++)o[i[a]].cleanup()};zs.once=function(e,t,s){const n=Bs(Ws,{},e,t,this.off.bind(this));return"string"==typeof e&&null==s&&(t=void 0),this.on(n,t,s)},zs.listenToOnce=function(e,t,s){const n=Bs(Ws,{},t,s,this.stopListening.bind(this,e));return this.listenTo(e,n)};const Ws=function(e,t,s,n){if(s){const r=e[t]=Ns((function(){n(t,r),s.apply(this,arguments)}));r._callback=s}return e};zs.trigger=function(e){if(!this._events)return this;const t=Math.max(0,arguments.length-1),s=Array(t);for(let e=0;e<t;e++)s[e]=arguments[e+1];return Bs(Vs,this._events,e,void 0,s),this};const Vs=function(e,t,s,n){if(e){const s=e[t];let r=e.all;s&&r&&(r=r.slice()),s&&Js(s,n),r&&Js(r,[t].concat(n))}return e},Js=function(e,t){let s,n=-1;const r=e.length,o=t[0],i=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(s=e[n]).callback.call(s.ctx);return;case 1:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o);return;case 2:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o,i);return;case 3:for(;++n<r;)(s=e[n]).callback.call(s.ctx,o,i,a);return;default:for(;++n<r;)(s=e[n]).callback.apply(s.ctx,t);return}},Qs=function(e,t){this.id=e._listenId,this.listener=e,this.obj=t,this.interop=!0,this.count=0,this._events=void 0};Qs.prototype.on=zs.on,Qs.prototype.off=function(e,t){let s;this.interop?(this._events=Bs(Gs,this._events,e,t,{context:void 0,listeners:void 0}),s=!this._events):(this.count--,s=0===this.count),s&&this.cleanup()},Qs.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},zs.bind=zs.on,zs.unbind=zs.off;const Ys=function(){try{var e=jt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ks=function(e,t,s){"__proto__"==t&&Ys?Ys(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s},Xs=function(e,t){return e===t||e!=e&&t!=t};var Zs=Object.prototype.hasOwnProperty;const en=function(e,t,s){var n=e[t];Zs.call(e,t)&&Xs(n,s)&&(void 0!==s||t in e)||Ks(e,t,s)},tn=function(e,t,s,n){var r=!s;s||(s={});for(var o=-1,i=t.length;++o<i;){var a=t[o],l=n?n(s[a],e[a],a,s,e):void 0;void 0===l&&(l=e[a]),r?Ks(s,a,l):en(s,a,l)}return s},sn=function(e){return e},nn=function(e,t,s){switch(s.length){case 0:return e.call(t);case 1:return e.call(t,s[0]);case 2:return e.call(t,s[0],s[1]);case 3:return e.call(t,s[0],s[1],s[2])}return e.apply(t,s)};var rn=Math.max;const on=function(e,t,s){return t=rn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=rn(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];r=-1;for(var a=Array(t+1);++r<t;)a[r]=n[r];return a[t]=s(i),nn(e,this,a)}},an=function(e){return function(){return e}},ln=Ys?function(e,t){return Ys(e,"toString",{configurable:!0,enumerable:!1,value:an(t),writable:!0})}:sn;var cn=Date.now;const dn=function(e){var t=0,s=0;return function(){var n=cn(),r=16-(n-s);if(s=n,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},un=dn(ln),hn=function(e,t){return un(on(e,t,sn),e+"")},fn=function(e,t,s){if(!ot(s))return!1;var n=typeof t;return!!("number"==n?Jt(s)&&fs(t,s.length):"string"==n&&t in s)&&Xs(s[t],e)},mn=function(e){return hn((function(t,s){var n=-1,r=s.length,o=r>1?s[r-1]:void 0,i=r>2?s[2]:void 0;for(o=e.length>3&&"function"==typeof o?(r--,o):void 0,i&&fn(s[0],s[1],i)&&(o=r<3?void 0:o,r=1),t=Object(t);++n<r;){var a=s[n];a&&e(t,a,n,o)}return t}))},pn=function(e){var t=[];if(null!=e)for(var s in Object(e))t.push(s);return t};var gn=Object.prototype.hasOwnProperty;const _n=function(e){if(!ot(e))return pn(e);var t=Ue(e),s=[];for(var n in e)("constructor"!=n||!t&&gn.call(e,n))&&s.push(n);return s},vn=function(e){return Jt(e)?ps(e,!0):_n(e)},yn=mn((function(e,t){tn(t,vn(t),e)})),bn=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(t(e[s],s,e))return!0;return!1},jn=function(){this.__data__=[],this.size=0},wn=function(e,t){for(var s=e.length;s--;)if(Xs(e[s][0],t))return s;return-1};var Sn=Array.prototype.splice;const xn=function(e){var t=this.__data__,s=wn(t,e);return!(s<0||(s==t.length-1?t.pop():Sn.call(t,s,1),--this.size,0))},En=function(e){var t=this.__data__,s=wn(t,e);return s<0?void 0:t[s][1]},An=function(e){return wn(this.__data__,e)>-1},Cn=function(e,t){var s=this.__data__,n=wn(s,e);return n<0?(++this.size,s.push([e,t])):s[n][1]=t,this};function Tn(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}Tn.prototype.clear=jn,Tn.prototype.delete=xn,Tn.prototype.get=En,Tn.prototype.has=An,Tn.prototype.set=Cn;const In=Tn,kn=function(){this.__data__=new In,this.size=0},Nn=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s},On=function(e){return this.__data__.get(e)},Mn=function(e){return this.__data__.has(e)},$n=jt(Object,"create"),Rn=function(){this.__data__=$n?$n(null):{},this.size=0},Dn=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var Pn=Object.prototype.hasOwnProperty;const Ln=function(e){var t=this.__data__;if($n){var s=t[e];return"__lodash_hash_undefined__"===s?void 0:s}return Pn.call(t,e)?t[e]:void 0};var zn=Object.prototype.hasOwnProperty;const Fn=function(e){var t=this.__data__;return $n?void 0!==t[e]:zn.call(t,e)},Un=function(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=$n&&void 0===t?"__lodash_hash_undefined__":t,this};function Bn(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}Bn.prototype.clear=Rn,Bn.prototype.delete=Dn,Bn.prototype.get=Ln,Bn.prototype.has=Fn,Bn.prototype.set=Un;const qn=Bn,Hn=function(){this.size=0,this.__data__={hash:new qn,map:new(St||In),string:new qn}},Gn=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},Wn=function(e,t){var s=e.__data__;return Gn(t)?s["string"==typeof t?"string":"hash"]:s.map},Vn=function(e){var t=Wn(this,e).delete(e);return this.size-=t?1:0,t},Jn=function(e){return Wn(this,e).get(e)},Qn=function(e){return Wn(this,e).has(e)},Yn=function(e,t){var s=Wn(this,e),n=s.size;return s.set(e,t),this.size+=s.size==n?0:1,this};function Kn(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}Kn.prototype.clear=Hn,Kn.prototype.delete=Vn,Kn.prototype.get=Jn,Kn.prototype.has=Qn,Kn.prototype.set=Yn;const Xn=Kn,Zn=function(e,t){var s=this.__data__;if(s instanceof In){var n=s.__data__;if(!St||n.length<199)return n.push([e,t]),this.size=++s.size,this;s=this.__data__=new Xn(n)}return s.set(e,t),this.size=s.size,this};function er(e){var t=this.__data__=new In(e);this.size=t.size}er.prototype.clear=kn,er.prototype.delete=Nn,er.prototype.get=On,er.prototype.has=Mn,er.prototype.set=Zn;const tr=er,sr=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},nr=function(e){return this.__data__.has(e)};function rr(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new Xn;++t<s;)this.add(e[t])}rr.prototype.add=rr.prototype.push=sr,rr.prototype.has=nr;const or=rr,ir=function(e,t){return e.has(t)},ar=function(e,t,s,n,r,o){var i=1&s,a=e.length,l=t.length;if(a!=l&&!(i&&l>a))return!1;var c=o.get(e),d=o.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,f=2&s?new or:void 0;for(o.set(e,t),o.set(t,e);++u<a;){var m=e[u],p=t[u];if(n)var g=i?n(p,m,u,t,e,o):n(m,p,u,e,t,o);if(void 0!==g){if(g)continue;h=!1;break}if(f){if(!bn(t,(function(e,t){if(!ir(f,t)&&(m===e||r(m,e,s,n,o)))return f.push(t)}))){h=!1;break}}else if(m!==p&&!r(m,p,s,n,o)){h=!1;break}}return o.delete(e),o.delete(t),h},lr=Je.Uint8Array,cr=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e,n){s[++t]=[n,e]})),s},dr=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s};var ur=Qe?Qe.prototype:void 0,hr=ur?ur.valueOf:void 0;const fr=function(e,t,s,n,r,o,i){switch(s){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new lr(e),new lr(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Xs(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=cr;case"[object Set]":var l=1&n;if(a||(a=dr),e.size!=t.size&&!l)return!1;var c=i.get(e);if(c)return c==t;n|=2,i.set(e,t);var d=ar(a(e),a(t),n,r,o,i);return i.delete(e),d;case"[object Symbol]":if(hr)return hr.call(e)==hr.call(t)}return!1},mr=function(e,t){for(var s=-1,n=t.length,r=e.length;++s<n;)e[r+s]=t[s];return e},pr=function(e,t,s){var n=t(e);return Wt(e)?n:mr(n,s(e))},gr=function(e,t){for(var s=-1,n=null==e?0:e.length,r=0,o=[];++s<n;){var i=e[s];t(i,s,e)&&(o[r++]=i)}return o},_r=function(){return[]};var vr=Object.prototype.propertyIsEnumerable,yr=Object.getOwnPropertySymbols;const br=yr?function(e){return null==e?[]:(e=Object(e),gr(yr(e),(function(t){return vr.call(e,t)})))}:_r,jr=function(e){return pr(e,gs,br)};var wr=Object.prototype.hasOwnProperty;const Sr=function(e,t,s,n,r,o){var i=1&s,a=jr(e),l=a.length;if(l!=jr(t).length&&!i)return!1;for(var c=l;c--;){var d=a[c];if(!(i?d in t:wr.call(t,d)))return!1}var u=o.get(e),h=o.get(t);if(u&&h)return u==t&&h==e;var f=!0;o.set(e,t),o.set(t,e);for(var m=i;++c<l;){var p=e[d=a[c]],g=t[d];if(n)var _=i?n(g,p,d,t,e,o):n(p,g,d,e,t,o);if(!(void 0===_?p===g||r(p,g,s,n,o):_)){f=!1;break}m||(m="constructor"==d)}if(f&&!m){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f};var xr="[object Arguments]",Er="[object Array]",Ar="[object Object]",Cr=Object.prototype.hasOwnProperty;const Tr=function(e,t,s,n,r,o){var i=Wt(e),a=Wt(t),l=i?Er:Lt(e),c=a?Er:Lt(t),d=(l=l==xr?Ar:l)==Ar,u=(c=c==xr?Ar:c)==Ar,h=l==c;if(h&&Zt(e)){if(!Zt(t))return!1;i=!0,d=!1}if(h&&!d)return o||(o=new tr),i||ls(e)?ar(e,t,s,n,r,o):fr(e,t,l,s,n,r,o);if(!(1&s)){var f=d&&Cr.call(e,"__wrapped__"),m=u&&Cr.call(t,"__wrapped__");if(f||m){var p=f?e.value():e,g=m?t.value():t;return o||(o=new tr),r(p,g,s,n,o)}}return!!h&&(o||(o=new tr),Sr(e,t,s,n,r,o))},Ir=function e(t,s,n,r,o){return t===s||(null==t||null==s||!zt(t)&&!zt(s)?t!=t&&s!=s:Tr(t,s,n,r,e,o))},kr=function(e,t,s,n){var r=s.length,o=r,i=!n;if(null==e)return!o;for(e=Object(e);r--;){var a=s[r];if(i&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++r<o;){var l=(a=s[r])[0],c=e[l],d=a[1];if(i&&a[2]){if(void 0===c&&!(l in e))return!1}else{var u=new tr;if(n)var h=n(c,d,l,e,t,u);if(!(void 0===h?Ir(d,c,3,n,u):h))return!1}}return!0},Nr=function(e){return e==e&&!ot(e)},Or=function(e){for(var t=gs(e),s=t.length;s--;){var n=t[s],r=e[n];t[s]=[n,r,Nr(r)]}return t},Mr=function(e,t){return function(s){return null!=s&&s[e]===t&&(void 0!==t||e in Object(s))}},$r=function(e){var t=Or(e);return 1==t.length&&t[0][2]?Mr(t[0][0],t[0][1]):function(s){return s===e||kr(s,e,t)}};var Rr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dr=/^\w*$/;const Pr=function(e,t){if(Wt(e))return!1;var s=typeof e;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=e&&!js(e))||Dr.test(e)||!Rr.test(e)||null!=t&&e in Object(t)};function Lr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var s=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=s.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return s.cache=o.set(r,i)||o,i};return s.cache=new(Lr.Cache||Xn),s}Lr.Cache=Xn;const zr=Lr,Fr=function(e){var t=zr(e,(function(e){return 500===s.size&&s.clear(),e})),s=t.cache;return t};var Ur=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Br=/\\(\\)?/g,qr=Fr((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ur,(function(e,s,n,r){t.push(n?r.replace(Br,"$1"):s||e)})),t}));const Hr=qr,Gr=function(e,t){return Wt(e)?e:Pr(e,t)?[e]:Hr(Ds(e))},Wr=function(e){if("string"==typeof e||js(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Vr=function(e,t){for(var s=0,n=(t=Gr(t,e)).length;null!=e&&s<n;)e=e[Wr(t[s++])];return s&&s==n?e:void 0},Jr=function(e,t,s){var n=null==e?void 0:Vr(e,t);return void 0===n?s:n},Qr=function(e,t){return null!=e&&t in Object(e)},Yr=function(e,t,s){for(var n=-1,r=(t=Gr(t,e)).length,o=!1;++n<r;){var i=Wr(t[n]);if(!(o=null!=e&&s(e,i)))break;e=e[i]}return o||++n!=r?o:!!(r=null==e?0:e.length)&&Vt(r)&&fs(i,r)&&(Wt(e)||Gt(e))},Kr=function(e,t){return null!=e&&Yr(e,t,Qr)},Xr=function(e,t){return Pr(e)&&Nr(t)?Mr(Wr(e),t):function(s){var n=Jr(s,e);return void 0===n&&n===t?Kr(s,e):Ir(t,n,3)}},Zr=function(e){return function(t){return null==t?void 0:t[e]}},eo=function(e){return function(t){return Vr(t,e)}},to=function(e){return Pr(e)?Zr(Wr(e)):eo(e)},so=function(e){return"function"==typeof e?e:null==e?sn:"object"==typeof e?Wt(e)?Xr(e[0],e[1]):$r(e):to(e)},no=function(e){return function(t,s,n){for(var r=-1,o=Object(t),i=n(t),a=i.length;a--;){var l=i[e?a:++r];if(!1===s(o[l],l,o))break}return t}},ro=no(),oo=function(e,t){return e&&ro(e,t,gs)},io=function(e,t){return function(s,n){if(null==s)return s;if(!Jt(s))return e(s,n);for(var r=s.length,o=t?r:-1,i=Object(s);(t?o--:++o<r)&&!1!==n(i[o],o,i););return s}},ao=io(oo),lo=function(e,t){var s;return ao(e,(function(e,n,r){return!(s=t(e,n,r))})),!!s},co=function(e,t,s){var n=Wt(e)?bn:lo;return s&&fn(e,t,s)&&(t=void 0),n(e,so(t,3))},uo=function(e,t){return e&&tn(t,gs(t),e)};var ho=Object.create,fo=function(){function e(){}return function(t){if(!ot(t))return{};if(ho)return ho(t);e.prototype=t;var s=new e;return e.prototype=void 0,s}}();const mo=fo,po=function(e,t){var s=mo(e);return null==t?s:uo(s,t)};var go=Object.prototype.hasOwnProperty;const _o=function(e,t){return null!=e&&go.call(e,t)},vo=function(e,t){return null!=e&&Yr(e,t,_o)},yo=function(e,t,s){var n=-1,r=(t=Gr(t,e)).length;for(r||(r=1,e=void 0);++n<r;){var o=null==e?void 0:e[Wr(t[n])];void 0===o&&(n=r,o=s),e=it(o)?o.call(e):o}return e};function bo(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function jo(e,t){const s=this;let n;return n=e&&vo(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},yn(n,s,t),n.prototype=po(s.prototype,e),n.prototype.constructor=n,n.__super__=s.prototype,n}function wo(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise(((t,s)=>{e.resolve=t,e.reject=s}));return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}function So(){throw new Error('A "url" property or function must be specified')}function xo(e,t){const s=t.error;t.error=function(n){s&&s.call(t.context,e,n,t),e.trigger("error",e,n,t)}}const Eo={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};function Ao(e){const t=yo(e,"browserStorage")||yo(e.collection,"browserStorage");return t?t.sync():Co}function Co(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={type:Eo[e],dataType:"json"};s.url||(n.url=yo(t,"url")||So()),null!=s.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(n.contentType="application/json",n.data=JSON.stringify(s.attrs||t.toJSON(s))),"GET"!==n.type&&(n.processData=!1);const r=s.error;s.error=function(e,t,n){s.textStatus=t,s.errorThrown=n,r&&r.call(s.context,e,t,n)};const o=s.xhr=function(){return fetch.apply(this,arguments)}(yn(n,s));return t.trigger("request",t,o,s),o}const To=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)};To.extend=jo;const Io=/^[#\/]|\s+$/g,ko=/^\/+|\/+$/g,No=/#.*$/;To.started=!1,Object.assign(To.prototype,zs,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){const e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){const t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){const e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(Io,"")},start:function(e){if(To.started)throw new Error("history has already been started");if(To.started=!0,this.options=yn({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(ko,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){const e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;const e=document.body,t=e.insertBefore(this.iframe,e.firstChild).contentWindow;t.document.open(),t.document.close(),t.location.hash="#"+this.fragment}if(this._usePushState?addEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?addEventListener("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){this._usePushState?removeEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&removeEventListener("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),To.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){let t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),co(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!To.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");let s=this.root;""!==e&&"?"!==e.charAt(0)||(s=s.slice(0,-1)||"/");const n=s+e;e=e.replace(No,"");const r=this.decodeFragment(e);if(this.fragment!==r){if(this.fragment=r,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){const s=this.iframe.contentWindow;t.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,s){if(s){const s=e.href.replace(/(javascript:|#).*$/,"");e.replace(s+"#"+t)}else e.hash="#"+t}});const Oo=To,Mo=function(e){return zt(e)&&"[object RegExp]"==rt(e)};var $o=is&&is.isRegExp;const Ro=$o?ss($o):Mo,Do=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.history=e.history||new Oo,this.preinitialize.apply(this,arguments),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};Do.extend=jo;const Po=/\((.*?)\)/g,Lo=/(\(\?)?:\w+/g,zo=/\*\w+/g,Fo=/[\-{}\[\]+?.,\\\^$|#\s]/g;Object.assign(Do.prototype,zs,{preinitialize:function(){},initialize:function(){},route:function(e,t,s){return Ro(e)||(e=this._routeToRegExp(e)),it(t)&&(s=t,t=""),s||(s=this[t]),this.history.route(e,(n=>{const r=this._extractParameters(e,n);!1!==this.execute(s,r,t)&&(this.trigger.apply(this,["route:"+t].concat(r)),this.trigger("route",t,r),this.history.trigger("route",this,t,r))})),this},execute:function(e,t,s){e&&e.apply(this,t)},navigate:function(e,t){return this.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;let e;this.routes=yo(this,"routes");const t=gs(this.routes);for(;null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(Fo,"\\$&").replace(Po,"(?:$1)?").replace(Lo,(function(e,t){return t?e:"([^/?]+)"})).replace(zo,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){const s=e.exec(t).slice(1);return s.map((function(e,t){return t===s.length-1?e||null:e?decodeURIComponent(e):null}))}});var Uo=c(245);const Bo=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n&&!1!==t(e[s],s,e););return e},qo=function(e,t){return e&&tn(t,vn(t),e)};var Ho=t&&!t.nodeType&&t,Go=Ho&&e&&!e.nodeType&&e,Wo=Go&&Go.exports===Ho?Je.Buffer:void 0,Vo=Wo?Wo.allocUnsafe:void 0;const Jo=function(e,t){if(t)return e.slice();var s=e.length,n=Vo?Vo(s):new e.constructor(s);return e.copy(n),n},Qo=function(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t},Yo=function(e,t){return tn(e,br(e),t)},Ko=Be(Object.getPrototypeOf,Object);var Xo=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)mr(t,br(e)),e=Ko(e);return t}:_r;const Zo=Xo,ei=function(e,t){return tn(e,Zo(e),t)},ti=function(e){return pr(e,vn,Zo)};var si=Object.prototype.hasOwnProperty;const ni=function(e){var t=e.length,s=new e.constructor(t);return t&&"string"==typeof e[0]&&si.call(e,"index")&&(s.index=e.index,s.input=e.input),s},ri=function(e){var t=new e.constructor(e.byteLength);return new lr(t).set(new lr(e)),t},oi=function(e,t){var s=t?ri(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)};var ii=/\w*$/;const ai=function(e){var t=new e.constructor(e.source,ii.exec(e));return t.lastIndex=e.lastIndex,t};var li=Qe?Qe.prototype:void 0,ci=li?li.valueOf:void 0;const di=function(e){return ci?Object(ci.call(e)):{}},ui=function(e,t){var s=t?ri(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)},hi=function(e,t,s){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return ri(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return oi(e,s);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ui(e,s);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return ai(e);case"[object Symbol]":return di(e)}},fi=function(e){return"function"!=typeof e.constructor||Ue(e)?{}:mo(Ko(e))},mi=function(e){return zt(e)&&"[object Map]"==Lt(e)};var pi=is&&is.isMap;const gi=pi?ss(pi):mi,_i=function(e){return zt(e)&&"[object Set]"==Lt(e)};var vi=is&&is.isSet;const yi=vi?ss(vi):_i;var bi="[object Arguments]",ji="[object Function]",wi="[object Object]",Si={};Si[bi]=Si["[object Array]"]=Si["[object ArrayBuffer]"]=Si["[object DataView]"]=Si["[object Boolean]"]=Si["[object Date]"]=Si["[object Float32Array]"]=Si["[object Float64Array]"]=Si["[object Int8Array]"]=Si["[object Int16Array]"]=Si["[object Int32Array]"]=Si["[object Map]"]=Si["[object Number]"]=Si[wi]=Si["[object RegExp]"]=Si["[object Set]"]=Si["[object String]"]=Si["[object Symbol]"]=Si["[object Uint8Array]"]=Si["[object Uint8ClampedArray]"]=Si["[object Uint16Array]"]=Si["[object Uint32Array]"]=!0,Si["[object Error]"]=Si[ji]=Si["[object WeakMap]"]=!1;const xi=function e(t,s,n,r,o,i){var a,l=1&s,c=2&s,d=4&s;if(n&&(a=o?n(t,r,o,i):n(t)),void 0!==a)return a;if(!ot(t))return t;var u=Wt(t);if(u){if(a=ni(t),!l)return Qo(t,a)}else{var h=Lt(t),f=h==ji||"[object GeneratorFunction]"==h;if(Zt(t))return Jo(t,l);if(h==wi||h==bi||f&&!o){if(a=c||f?{}:fi(t),!l)return c?ei(t,qo(a,t)):Yo(t,uo(a,t))}else{if(!Si[h])return o?t:{};a=hi(t,h,l)}}i||(i=new tr);var m=i.get(t);if(m)return m;i.set(t,a),yi(t)?t.forEach((function(r){a.add(e(r,s,n,r,t,i))})):gi(t)&&t.forEach((function(r,o){a.set(o,e(r,s,n,o,t,i))}));var p=u?void 0:(d?c?ti:jr:c?vn:gs)(t);return Bo(p||t,(function(r,o){p&&(r=t[o=r]),en(a,o,e(r,s,n,o,t,i))})),a},Ei=function(e){return xi(e,5)},Ai=function(e){return"string"==typeof e||!Wt(e)&&zt(e)&&"[object String]"==rt(e)},Ci=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}(),Ti=function(){try{if(!Ci||!Ci.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}},Ii=function(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}};"undefined"==typeof Promise&&c(236);const ki=Promise,Ni=function(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))},Oi=function(e,t,s){"function"==typeof t&&e.then(t),"function"==typeof s&&e.catch(s)};function Mi(e){return"string"!=typeof e&&(console.warn(`${e} used as a key, but it is not a string.`),e=String(e)),e}function $i(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}const Ri="local-forage-detect-blob-support";let Di;const Pi={},Li=Object.prototype.toString,zi="readonly",Fi="readwrite";function Ui(e){return"boolean"==typeof Di?ki.resolve(Di):function(e){return new ki((function(t){var s=e.transaction(Ri,Fi),n=Ii([""]);s.objectStore(Ri).put(n,"key"),s.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},s.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);t(s||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return Di=e,Di}))}function Bi(e){var t=Pi[e.name],s={};s.promise=new ki((function(e,t){s.resolve=e,s.reject=t})),t.deferredOperations.push(s),t.dbReady?t.dbReady=t.dbReady.then((function(){return s.promise})):t.dbReady=s.promise}function qi(e){var t=Pi[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function Hi(e,t){var s=Pi[e.name].deferredOperations.pop();if(s)return s.reject(t),s.promise}function Gi(e,t){return new ki((function(s,n){if(Pi[e.name]=Pi[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return s(e.db);Bi(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var o=Ci.open.apply(Ci,r);t&&(o.onupgradeneeded=function(t){var s=o.result;try{s.createObjectStore(e.storeName),t.oldVersion<=1&&s.createObjectStore(Ri)}catch(s){if("ConstraintError"!==s.name)throw s;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},s(t),qi(e)}}))}function Wi(e){return Gi(e,!1)}function Vi(e){return Gi(e,!0)}function Ji(e,t){if(!e.db)return!0;var s=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||s){if(s){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function Qi(e){var t=function(e){for(var t=e.length,s=new ArrayBuffer(t),n=new Uint8Array(s),r=0;r<t;r++)n[r]=e.charCodeAt(r);return s}(atob(e.data));return Ii([t],{type:e.type})}function Yi(e){return e&&e.__local_forage_encoded_blob}function Ki(e){var t=this,s=t._initReady().then((function(){var e=Pi[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return Oi(s,e,e),s}function Xi(e,t,s,n){void 0===n&&(n=1);try{var r=e.db.transaction(e.storeName,t);s(null,r)}catch(r){if(n>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return ki.resolve().then((()=>{if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),Vi(e)})).then((()=>function(e){Bi(e);for(var t=Pi[e.name],s=t.forages,n=0;n<s.length;n++){const e=s[n];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return e.db=null,Wi(e).then((t=>(e.db=t,Ji(e)?Vi(e):t))).then((n=>{e.db=t.db=n;for(var r=0;r<s.length;r++)s[r]._dbInfo.db=n})).catch((t=>{throw Hi(e,t),t}))}(e).then((function(){Xi(e,t,s,n-1)})))).catch(s);s(r)}}var Zi={_driver:"asyncStorage",_initStorage:function(e){var t=this,s={db:null};if(e)for(var n in e)s[n]=e[n];var r=Pi[s.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},Pi[s.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=Ki);var o=[];function i(){return ki.resolve()}for(var a=0;a<r.forages.length;a++){var l=r.forages[a];l!==t&&o.push(l._initReady().catch(i))}var c=r.forages.slice(0);return ki.all(o).then((function(){return s.db=r.db,Wi(s)})).then((function(e){return s.db=e,Ji(s,t._defaultConfig.version)?Vi(s):e})).then((function(e){s.db=r.db=e,t._dbInfo=s;for(var n=0;n<c.length;n++){var o=c[n];o!==t&&(o._dbInfo.db=s.db,o._dbInfo.version=s.version)}}))},_support:Ti(),iterate:function(e,t){var s=this,n=new ki((function(t,n){s.ready().then((function(){Xi(s._dbInfo,zi,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).openCursor(),a=1;i.onsuccess=function(){var s=i.result;if(s){var n=s.value;Yi(n)&&(n=Qi(n));var r=e(n,s.key,a++);void 0!==r?t(r):s.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return Ni(n,t),n},getItem:function(e,t){var s=this;e=Mi(e);var n=new ki((function(t,n){s.ready().then((function(){Xi(s._dbInfo,zi,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),Yi(e)&&(e=Qi(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return Ni(n,t),n},setItem:function(e,t,s){var n=this;e=Mi(e);var r=new ki((function(s,r){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===Li.call(t)?Ui(o.db).then((function(e){return e?t:(s=t,new ki((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:s.type})},n.readAsBinaryString(s)})));var s})):t})).then((function(t){Xi(n._dbInfo,Fi,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),s(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return Ni(r,s),r},removeItem:function(e,t){var s=this;e=Mi(e);var n=new ki((function(t,n){s.ready().then((function(){Xi(s._dbInfo,Fi,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return Ni(n,t),n},clear:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){Xi(t._dbInfo,Fi,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;s(e)}}catch(e){s(e)}}))})).catch(s)}));return Ni(s,e),s},length:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){Xi(t._dbInfo,zi,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return Ni(s,e),s},key:function(e,t){var s=this,n=new ki((function(t,n){e<0?t(null):s.ready().then((function(){Xi(s._dbInfo,zi,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName),a=!1,l=i.openKeyCursor();l.onsuccess=function(){var s=l.result;s?0===e||a?t(s.key):(a=!0,s.advance(e)):t(null)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return Ni(n,t),n},keys:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){Xi(t._dbInfo,zi,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return Ni(s,e),s},dropInstance:function(e,t){t=$i.apply(this,arguments);var s,n=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName),e.name){const t=e.name===n.name&&this._dbInfo.db?ki.resolve(this._dbInfo.db):Wi(e).then((t=>{const s=Pi[e.name],n=s.forages;s.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}));s=e.storeName?t.then((t=>{if(!t.objectStoreNames.contains(e.storeName))return;const s=t.version+1;Bi(e);const n=Pi[e.name],r=n.forages;t.close();for(let e=0;e<r.length;e++){const t=r[e];t._dbInfo.db=null,t._dbInfo.version=s}const o=new ki(((t,n)=>{const r=Ci.open(e.name,s);r.onerror=e=>{r.result.close(),n(e)},r.onupgradeneeded=()=>{r.result.deleteObjectStore(e.storeName)},r.onsuccess=()=>{const e=r.result;e.close(),t(e)}}));return o.then((e=>{n.db=e;for(let t=0;t<r.length;t++){const s=r[t];s._dbInfo.db=e,qi(s._dbInfo)}})).catch((t=>{throw(Hi(e,t)||ki.resolve()).catch((()=>{})),t}))})):t.then((t=>{Bi(e);const s=Pi[e.name],n=s.forages;t.close();for(var r=0;r<n.length;r++)n[r]._dbInfo.db=null;const o=new ki(((t,s)=>{var n=Ci.deleteDatabase(e.name);n.onerror=()=>{const e=n.result;e&&e.close(),s(n.error)},n.onblocked=()=>{console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=()=>{const e=n.result;e&&e.close(),t(e)}}));return o.then((e=>{s.db=e;for(var t=0;t<n.length;t++)qi(n[t]._dbInfo)})).catch((t=>{throw(Hi(e,t)||ki.resolve()).catch((()=>{})),t}))}))}else s=ki.reject("Invalid arguments");return Ni(s,t),s}};const ea=Zi,ta=function(){return"function"==typeof openDatabase};var sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",na=/^~~local_forage_type~([^~]+)~/,ra="__lfsc__:",oa="arbf",ia="blob",aa="si08",la="ui08",ca="uic8",da="si16",ua="si32",ha="ur16",fa="ui32",ma="fl32",pa="fl64",ga=Object.prototype.toString;function _a(e){var t,s,n,r,o,i=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),d=new Uint8Array(c);for(t=0;t<a;t+=4)s=sa.indexOf(e[t]),n=sa.indexOf(e[t+1]),r=sa.indexOf(e[t+2]),o=sa.indexOf(e[t+3]),d[l++]=s<<2|n>>4,d[l++]=(15&n)<<4|r>>2,d[l++]=(3&r)<<6|63&o;return c}function va(e){var t,s=new Uint8Array(e),n="";for(t=0;t<s.length;t+=3)n+=sa[s[t]>>2],n+=sa[(3&s[t])<<4|s[t+1]>>4],n+=sa[(15&s[t+1])<<2|s[t+2]>>6],n+=sa[63&s[t+2]];return s.length%3==2?n=n.substring(0,n.length-1)+"=":s.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var ya={serialize:function(e,t){var s="";if(e&&(s=ga.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===ga.call(e.buffer))){var n,r=ra;e instanceof ArrayBuffer?(n=e,r+=oa):(n=e.buffer,"[object Int8Array]"===s?r+=aa:"[object Uint8Array]"===s?r+=la:"[object Uint8ClampedArray]"===s?r+=ca:"[object Int16Array]"===s?r+=da:"[object Uint16Array]"===s?r+=ha:"[object Int32Array]"===s?r+=ua:"[object Uint32Array]"===s?r+=fa:"[object Float32Array]"===s?r+=ma:"[object Float64Array]"===s?r+=pa:t(new Error("Failed to get type for BinaryArray"))),t(r+va(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s="~~local_forage_type~"+e.type+"~"+va(this.result);t(ra+ia+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}},deserialize:function(e){if(e.substring(0,9)!==ra)return JSON.parse(e);var t,s=e.substring(13),n=e.substring(9,13);if(n===ia&&na.test(s)){var r=s.match(na);t=r[1],s=s.substring(r[0].length)}var o=_a(s);switch(n){case oa:return o;case ia:return Ii([o],{type:t});case aa:return new Int8Array(o);case la:return new Uint8Array(o);case ca:return new Uint8ClampedArray(o);case da:return new Int16Array(o);case ha:return new Uint16Array(o);case ua:return new Int32Array(o);case fa:return new Uint32Array(o);case ma:return new Float32Array(o);case pa:return new Float64Array(o);default:throw new Error("Unkown type: "+n)}},stringToBuffer:_a,bufferToString:va};const ba=ya;function ja(e,t,s,n){e.executeSql(`CREATE TABLE IF NOT EXISTS ${t.storeName} (id INTEGER PRIMARY KEY, key unique, value)`,[],s,n)}function wa(e,t,s,n,r,o){e.executeSql(s,n,r,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,i):ja(e,t,(function(){e.executeSql(s,n,r,o)}),o)}),o):o(e,i)}),o)}function Sa(e,t,s,n){var r=this;e=Mi(e);var o=new ki((function(o,i){r.ready().then((function(){void 0===t&&(t=null);var a=t,l=r._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(s){wa(s,l,`INSERT OR REPLACE INTO ${l.storeName} (key, value) VALUES (?, ?)`,[e,t],(function(){o(a)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(Sa.apply(r,[e,a,s,n-1]));i(t)}}))}))})).catch(i)}));return Ni(o,s),o}var xa={_driver:"webSQLStorage",_initStorage:function(e){var t=this,s={db:null};if(e)for(var n in e)s[n]="string"!=typeof e[n]?e[n].toString():e[n];var r=new ki((function(e,n){try{s.db=openDatabase(s.name,String(s.version),s.description,s.size)}catch(e){return n(e)}s.db.transaction((function(r){ja(r,s,(function(){t._dbInfo=s,e()}),(function(e,t){n(t)}))}),n)}));return s.serializer=ba,r},_support:ta(),iterate:function(e,t){var s=this,n=new ki((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){wa(s,r,`SELECT * FROM ${r.storeName}`,[],(function(s,n){for(var o=n.rows,i=o.length,a=0;a<i;a++){var l=o.item(a),c=l.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return Ni(n,t),n},getItem:function(e,t){var s=this;e=Mi(e);var n=new ki((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){wa(s,r,`SELECT * FROM ${r.storeName} WHERE key = ? LIMIT 1`,[e],(function(e,s){var n=s.rows.length?s.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return Ni(n,t),n},setItem:function(e,t,s){return Sa.apply(this,[e,t,s,1])},removeItem:function(e,t){var s=this;e=Mi(e);var n=new ki((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){wa(s,r,`DELETE FROM ${r.storeName} WHERE key = ?`,[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return Ni(n,t),n},clear:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){wa(t,n,`DELETE FROM ${n.storeName}`,[],(function(){e()}),(function(e,t){s(t)}))}))})).catch(s)}));return Ni(s,e),s},length:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){wa(t,n,`SELECT COUNT(key) as c FROM ${n.storeName}`,[],(function(t,s){var n=s.rows.item(0).c;e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return Ni(s,e),s},key:function(e,t){var s=this,n=new ki((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){wa(s,r,`SELECT key FROM ${r.storeName} WHERE id = ? LIMIT 1`,[e+1],(function(e,s){var n=s.rows.length?s.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return Ni(n,t),n},keys:function(e){var t=this,s=new ki((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){wa(t,n,`SELECT key FROM ${n.storeName}`,[],(function(t,s){for(var n=[],r=0;r<s.rows.length;r++)n.push(s.rows.item(r).key);e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return Ni(s,e),s},dropInstance:function(e,t){t=$i.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;return n=e.name?new ki((function(t){var n;n=e.name===s.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(function(e){return new ki((function(t,s){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(s,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).name);t({db:e,storeNames:r})}),(function(e,t){s(t)}))}),(function(e){s(e)}))}))}(n))})).then((function(e){return new ki((function(t,s){e.db.transaction((function(n){function r(e){return new ki((function(t,s){n.executeSql(`DROP TABLE IF EXISTS ${e}`,[],(function(){t()}),(function(e,t){s(t)}))}))}for(var o=[],i=0,a=e.storeNames.length;i<a;i++)o.push(r(e.storeNames[i]));ki.all(o).then((function(){t()})).catch((function(e){s(e)}))}),(function(e){s(e)}))}))})):ki.reject("Invalid arguments"),Ni(n,t),n}};const Ea=xa;function Aa(e,t){var s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}function Ca(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0}var Ta={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var s in e)t[s]=e[s];return t.keyPrefix=Aa(e,this._defaultConfig),Ca()?(this._dbInfo=t,t.serializer=ba,ki.resolve()):ki.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var s=this,n=s.ready().then((function(){for(var t=s._dbInfo,n=t.keyPrefix,r=n.length,o=localStorage.length,i=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(n)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(r),i++)))return c}}}));return Ni(n,t),n},getItem:function(e,t){var s=this;e=Mi(e);var n=s.ready().then((function(){var t=s._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return Ni(n,t),n},setItem:function(e,t,s){var n=this;e=Mi(e);var r=n.ready().then((function(){void 0===t&&(t=null);var s=t;return new ki((function(r,o){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(i.keyPrefix+e,t),r(s)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return Ni(r,s),r},removeItem:function(e,t){var s=this;e=Mi(e);var n=s.ready().then((function(){var t=s._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return Ni(n,t),n},clear:function(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var n=localStorage.key(s);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return Ni(s,e),s},length:function(e){var t=this.keys().then((function(e){return e.length}));return Ni(t,e),t},key:function(e,t){var s=this,n=s.ready().then((function(){var t,n=s._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return Ni(n,t),n},keys:function(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo,s=localStorage.length,n=[],r=0;r<s;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return Ni(s,e),s},dropInstance:function(e,t){if(t=$i.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var s=this.config();e.name=e.name||s.name,e.storeName=e.storeName||s.storeName}var n,r=this;return n=e.name?new ki((function(t){e.storeName?t(Aa(e,r._defaultConfig)):t(`${e.name}/`)})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var s=localStorage.key(t);0===s.indexOf(e)&&localStorage.removeItem(s)}})):ki.reject("Invalid arguments"),Ni(n,t),n}};const Ia=Ta,ka=(e,t)=>e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t),Na=(e,t)=>{const s=e.length;let n=0;for(;n<s;){if(ka(e[n],t))return!0;n++}return!1},Oa=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ma={},$a={},Ra={INDEXEDDB:ea,WEBSQL:Ea,LOCALSTORAGE:Ia},Da=[Ra.INDEXEDDB._driver,Ra.WEBSQL._driver,Ra.LOCALSTORAGE._driver],Pa=["dropInstance"],La=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Pa),za={description:"",driver:Da.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fa(e,t){e[t]=function(){const s=arguments;return e.ready().then((function(){return e[t].apply(e,s)}))}}function Ua(){for(let e=1;e<arguments.length;e++){const t=arguments[e];if(t)for(let e in t)t.hasOwnProperty(e)&&(Oa(t[e])?arguments[0][e]=t[e].slice():arguments[0][e]=t[e])}return arguments[0]}class Ba{constructor(e){for(let e in Ra)if(Ra.hasOwnProperty(e)){const t=Ra[e],s=t._driver;this[e]=s,Ma[s]||this.defineDriver(t)}this._defaultConfig=Ua({},za),this._config=Ua({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((()=>{}))}config(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(let t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config}defineDriver(e,t,s){const n=new ki((function(t,s){try{const n=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void s(r);const o=La.concat("_initStorage");for(let t=0,n=o.length;t<n;t++){const n=o[t];if((!Na(Pa,n)||e[n])&&"function"!=typeof e[n])return void s(r)}const i=function(){const t=function(e){return function(){const t=new Error(`Method ${e} is not implemented by the current driver`),s=ki.reject(t);return Ni(s,arguments[arguments.length-1]),s}};for(let s=0,n=Pa.length;s<n;s++){const n=Pa[s];e[n]||(e[n]=t(n))}};i();const a=function(s){Ma[n]&&console.info(`Redefining LocalForage driver: ${n}`),Ma[n]=e,$a[n]=s,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(a,s):a(!!e._support):a(!0)}catch(e){s(e)}}));return Oi(n,t,s),n}driver(){return this._driver||null}getDriver(e,t,s){const n=Ma[e]?ki.resolve(Ma[e]):ki.reject(new Error("Driver not found."));return Oi(n,t,s),n}getSerializer(e){const t=ki.resolve(ba);return Oi(t,e),t}ready(e){const t=this,s=t._driverSet.then((()=>(null===t._ready&&(t._ready=t._initDriver()),t._ready)));return Oi(s,e,e),s}setDriver(e,t,s){const n=this;Oa(e)||(e=[e]);const r=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function i(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}const a=null!==this._driverSet?this._driverSet.catch((()=>ki.resolve())):ki.resolve();return this._driverSet=a.then((()=>{const e=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((e=>{n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){let t=0;return function s(){for(;t<e.length;){let r=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(i).catch(s)}o();const r=new Error("No available storage method found.");return n._driverSet=ki.reject(r),n._driverSet}()}}(r)}))})).catch((()=>{o();const e=new Error("No available storage method found.");return n._driverSet=ki.reject(e),n._driverSet})),Oi(this._driverSet,t,s),this._driverSet}supports(e){return!!$a[e]}_extend(e){Ua(this,e)}_getSupportedDrivers(e){const t=[];for(let s=0,n=e.length;s<n;s++){const n=e[s];this.supports(n)&&t.push(n)}return t}_wrapLibraryMethodsWithReady(){for(let e=0,t=La.length;e<t;e++)Fa(this,La[e])}createInstance(e){return new Ba(e)}}const qa=new Ba,Ha=function(e,t,s){(void 0!==s&&!Xs(e[t],s)||void 0===s&&!(t in e))&&Ks(e,t,s)},Ga=function(e){return zt(e)&&Jt(e)};var Wa=Function.prototype,Va=Object.prototype,Ja=Wa.toString,Qa=Va.hasOwnProperty,Ya=Ja.call(Object);const Ka=function(e){if(!zt(e)||"[object Object]"!=rt(e))return!1;var t=Ko(e);if(null===t)return!0;var s=Qa.call(t,"constructor")&&t.constructor;return"function"==typeof s&&s instanceof s&&Ja.call(s)==Ya},Xa=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Za=function(e){return tn(e,vn(e))},el=function(e,t,s,n,r,o,i){var a=Xa(e,s),l=Xa(t,s),c=i.get(l);if(c)Ha(e,s,c);else{var d=o?o(a,l,s+"",e,t,i):void 0,u=void 0===d;if(u){var h=Wt(l),f=!h&&Zt(l),m=!h&&!f&&ls(l);d=l,h||f||m?Wt(a)?d=a:Ga(a)?d=Qo(a):f?(u=!1,d=Jo(l,!0)):m?(u=!1,d=ui(l,!0)):d=[]:Ka(l)||Gt(l)?(d=a,Gt(a)?d=Za(a):ot(a)&&!it(a)||(d=fi(l))):u=!1}u&&(i.set(l,d),r(d,l,n,o,i),i.delete(l)),Ha(e,s,d)}},tl=function e(t,s,n,r,o){t!==s&&ro(s,(function(i,a){if(o||(o=new tr),ot(i))el(t,s,a,n,e,r,o);else{var l=r?r(Xa(t,a),i,a+"",t,s,o):void 0;void 0===l&&(l=i),Ha(t,a,l)}}),vn)},sl=mn((function(e,t,s){tl(e,t,s)})),nl=mn((function(e,t,s,n){tl(e,t,s,n)})),rl=function(){return Je.Date.now()};function ol(){const e={isResolved:!1,isPending:!0,isRejected:!1},t=new Promise(((t,s)=>{e.resolve=t,e.reject=s}));return Object.assign(t,e),t.then((function(e){return t.isResolved=!0,t.isPending=!1,t.isRejected=!1,e}),(function(e){throw t.isResolved=!1,t.isPending=!1,t.isRejected=!0,e})),t}const il=Math.max,al=Math.min,ll=function(e,t){let s,n,r,o,i,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=0,d=!1,u=l.promise?ol():null;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){const r=s,i=n,a=u;return s=n=void 0,c=t,o=e.apply(i,r),l.promise&&(a.resolve(o),u=ol()),l.promise?a:o}function f(e){const s=e-a;return void 0===a||s>=t||s<0||d&&e-c>=r}function m(){const e=rl();if(f(e))return p(e);i=setTimeout(m,function(e){const s=t-(e-a);return d?al(s,r-(e-c)):s}(e))}function p(e){return i=void 0,s?h(e):(s=n=void 0,l.promise?u:o)}function g(e,t){if(Array.isArray(e)&&Array.isArray(t))return l?.dedupeArrays?e.concat(t.filter((t=>-1===e.indexOf(t)))):e.concat(t)}function _(){const e=rl(),r=f(e);var p;if(p=Array.from(arguments),s=s?.length?p.length?l?.concatArrays||l?.dedupeArrays?nl(s,p,g):sl(s,p):s:p||[],n=this,a=e,r){if(void 0===i)return function(e){return c=e,i=setTimeout(m,t),l.promise?u:o}(a);if(d)return clearTimeout(i),i=setTimeout(m,t),h(a)}return void 0===i&&(i=setTimeout(m,t)),l.promise?u:o}return t=As(t)||0,ot(l)&&(d="maxWait"in l,r=d?il(As(l.maxWait)||0,t):r),_.cancel=function(){void 0!==i&&clearTimeout(i),c=0,s=a=n=i=void 0},_.flush=function(){return void 0===i?o:p(rl())},_};function cl(e,t){let s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}const dl={serializer:{serialize:ba.serialize,deserialize:ba.deserialize}},ul={_driver:"sessionStorageWrapper",_initStorage:function(e){if(dl.keyPrefix=cl(e,this._defaultConfig),e)for(const t in e)dl[t]=e[t]},_support:function(){try{if(sessionStorage&&"setItem"in sessionStorage)return!0}catch(e){console.log(e)}return!1}(),iterate:function(e,t){const s=this.ready().then((function(){const t=dl.keyPrefix,s=t.length,n=sessionStorage.length;let r=1;for(let o=0;o<n;o++){const n=sessionStorage.key(o);if(0!==n.indexOf(t))continue;let i=sessionStorage.getItem(n);if(i&&(i=dl.serializer.deserialize(i)),i=e(i,n.substring(s),r++),void 0!==i)return i}}));return Ni(s,t),s},getItem:function(e,t){e=Mi(e);const s=this.ready().then((function(){let t=sessionStorage.getItem(dl.keyPrefix+e);return t&&(t=dl.serializer.deserialize(t)),t}));return Ni(s,t),s},setItem:async function(e,t,s){e=Mi(e),await this.ready();const n=t=t??null;dl.serializer.serialize(t,((t,r)=>{if(r)throw r;try{sessionStorage.setItem(dl.keyPrefix+e,t),Ni(Promise.resolve(n),s)}catch(e){if("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)throw console.error("Your sesionStorage capacity is used up."),e;throw e}}))},removeItem:function(e,t){e=Mi(e);const s=this.ready().then((function(){sessionStorage.removeItem(dl.keyPrefix+e)}));return Ni(s,t),s},clear:function(e){const t=this.ready().then((function(){const e=dl.keyPrefix;for(let t=sessionStorage.length-1;t>=0;t--){const s=sessionStorage.key(t);0===s.indexOf(e)&&sessionStorage.removeItem(s)}}));return Ni(t,e),t},length:function(e){const t=this.keys().then((function(e){return e.length}));return Ni(t,e),t},key:function(e,t){const s=this.ready().then((function(){let t;try{t=sessionStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(dl.keyPrefix.length)),t}));return Ni(s,t),s},keys:function(e){const t=this.ready().then((function(){const e=sessionStorage.length,t=[];for(let s=0;s<e;s++){const e=sessionStorage.key(s);0===e.indexOf(dl.keyPrefix)&&t.push(e.substring(dl.keyPrefix.length))}return t}));return Ni(t,e),t},dropInstance:function(e,t){if(t=$i.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){const t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}const s=this;let n;return n=e.name?new Promise((function(t){e.storeName?t(cl(e,s._defaultConfig)):t(`${e.name}/`)})).then((function(e){for(let t=sessionStorage.length-1;t>=0;t--){const s=sessionStorage.key(t);0===s.indexOf(e)&&sessionStorage.removeItem(s)}})):Promise.reject(new Error("Invalid arguments")),Ni(n,t),n}},hl=ul;var fl=c(459),ml=c(487);const pl=Uo._driver;qa.defineDriver(Uo),(0,fl.extendPrototype)(qa),(0,ml.extendPrototype)(qa);class gl{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("local"===t&&!window.localStorage)throw new Error("Skeletor.storage: Environment does not support localStorage.");if("session"===t&&!window.sessionStorage)throw new Error("Skeletor.storage: Environment does not support sessionStorage.");Ai(t)?this.storeInitialized=this.initStore(t,s):(this.store=t,s&&(this.store.debouncedSetItems=ll((e=>this.store.setItems(e)),50,{promise:!0})),this.storeInitialized=Promise.resolve()),this.name=e}async initStore(e,t){if("session"===e)qa.setDriver(hl._driver);else if("local"===e)await qa.config({driver:qa.LOCALSTORAGE});else if("in_memory"===e)qa.config({driver:pl});else if("indexed"!==e)throw new Error("Skeletor.storage: No storage type was specified");this.store=qa,t&&(this.store.debouncedSetItems=ll((e=>this.store.setItems(e)),50,{promise:!0}))}flush(){return this.store.debouncedSetItems?.flush()}async clear(){await this.store.removeItem(this.name).catch((e=>console.error(e)));const e=new RegExp(`^${this.name}-`),t=(await this.store.keys()).filter((t=>e.test(t)));await Promise.all(t.map((e=>this.store.removeItem(e).catch((e=>console.error(e))))))}sync(){const e=this;async function t(t,s,n){let r,o,i,a;const l=s.collection;["patch","update"].includes(t)&&(a=Ei(s.attributes)),await e.storeInitialized;try{const o=s.attributes;switch(t){case"read":r=void 0!==s.id?await e.find(s):await e.findAll();break;case"create":r=await e.create(s,n);break;case"patch":case"update":n.wait&&(s.attributes=a),i=e.update(s,n),n.wait&&(s.attributes=o),r=await i;break;case"delete":r=await e.destroy(s,l)}}catch(t){o=22===t.code&&0===e.getStorageSize()?"Private browsing is unsupported":t.message}if(r){if(n&&n.success){const e="read"===t?r:null;n.success(e,n)}}else o=o||"Record Not Found",n&&n.error&&n.error(o)}return t.__name__="localSync",t}removeCollectionReference(e,t){if(!t)return;const s=t.filter((t=>t.id!==e.id)).map((e=>this.getItemName(e.id)));return this.store.setItem(this.name,s)}addCollectionReference(e,t){if(!t)return;const s=t.map((e=>this.getItemName(e.id))),n=this.getItemName(e.id);return s.includes(n)||s.push(n),this.store.setItem(this.name,s)}getCollectionReferenceData(e){if(!e.collection)return{};const t=e.collection.map((e=>this.getItemName(e.id))),s=this.getItemName(e.id);t.includes(s)||t.push(s);const n={};return n[this.name]=t,n}async save(e){if(this.store.setItems){const t={};return t[this.getItemName(e.id)]=e.toJSON(),Object.assign(t,this.getCollectionReferenceData(e)),this.store.debouncedSetItems?this.store.debouncedSetItems(t):this.store.setItems(t)}{const t=this.getItemName(e.id),s=await this.store.setItem(t,e.toJSON());return await this.addCollectionReference(e,e.collection),s}}create(e,t){return e.id||(e.id=bo()+bo()+"-"+bo()+"-"+bo()+"-"+bo()+"-"+bo()+bo()+bo(),e.set(e.idAttribute,e.id,t)),this.save(e)}update(e){return this.save(e)}find(e){return this.store.getItem(this.getItemName(e.id))}async findAll(){const e=await this.store.getItem(this.name);if(e?.length){const t=await this.store.getItems(e);return Object.values(t)}return[]}async destroy(e,t){return await this.flush(),await this.store.removeItem(this.getItemName(e.id)),await this.removeCollectionReference(e,t),e}getStorageSize(){return this.store.length}getItemName(e){return this.name+"-"+e}}gl.sessionStorageInitialized=qa.defineDriver(hl),gl.localForage=qa;const _l=gl,vl=function(e,t){return Ir(e,t)},yl=function(e,t,s,n){if(!ot(e))return e;for(var r=-1,o=(t=Gr(t,e)).length,i=o-1,a=e;null!=a&&++r<o;){var l=Wr(t[r]),c=s;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=i){var d=a[l];void 0===(c=n?n(d,l,a):void 0)&&(c=ot(d)?d:fs(t[r+1])?[]:{})}en(a,l,c),a=a[l]}return e},bl=function(e,t,s){for(var n=-1,r=t.length,o={};++n<r;){var i=t[n],a=Vr(e,i);s(a,i)&&yl(o,Gr(i,e),a)}return o},jl=function(e,t){return bl(e,t,(function(t,s){return Kr(e,s)}))};var wl=Qe?Qe.isConcatSpreadable:void 0;const Sl=function(e){return Wt(e)||Gt(e)||!!(wl&&e&&e[wl])},xl=function e(t,s,n,r,o){var i=-1,a=t.length;for(n||(n=Sl),o||(o=[]);++i<a;){var l=t[i];s>0&&n(l)?s>1?e(l,s-1,n,r,o):mr(o,l):r||(o[o.length]=l)}return o},El=function(e){return null!=e&&e.length?xl(e,1):[]},Al=function(e){return un(on(e,void 0,El),e+"")},Cl=Al((function(e,t){return null==e?{}:jl(e,t)}));var Tl=c(856),Il=c.n(Tl),kl=c(271),Nl=c.n(kl);const Ol=function(e){return xi(e,4)};var Ml=Object.prototype,$l=Ml.hasOwnProperty,Rl=hn((function(e,t){e=Object(e);var s=-1,n=t.length,r=n>2?t[2]:void 0;for(r&&fn(t[0],t[1],r)&&(n=1);++s<n;)for(var o=t[s],i=vn(o),a=-1,l=i.length;++a<l;){var c=i[a],d=e[c];(void 0===d||Xs(d,Ml[c])&&!$l.call(e,c))&&(e[c]=o[c])}return e}));const Dl=Rl,Pl=function(e,t,s){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,s)}),t)},Ll=hn((function(e,t){return Pl(e,1,t)})),zl=function(e){return function(t){return null==e?void 0:e[t]}},Fl=zl({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});var Ul=/[&<>"']/g,Bl=RegExp(Ul.source);const ql=function(e){return(e=Ds(e))&&Bl.test(e)?e.replace(Ul,Fl):e},Hl=function(e,t,s,n){return oo(e,(function(e,r,o){t(n,s(e),r,o)})),n},Gl=function(e,t){return function(s,n){return Hl(s,e,t(n),{})}};var Wl=Object.prototype.toString,Vl=Gl((function(e,t,s){null!=t&&"function"!=typeof t.toString&&(t=Wl.call(t)),e[t]=s}),an(sn));const Jl=Vl,Ql=function(e){return so("function"==typeof e?e:xi(e,1))},Yl=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},Kl=function(e,t,s){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(s=s>r?r:s)<0&&(s+=r),r=t>s?0:s-t>>>0,t>>>=0;for(var o=Array(r);++n<r;)o[n]=e[n+t];return o},Xl=function(e,t){return t.length<2?e:Vr(e,Kl(t,0,-1))},Zl=function(e,t){return t=Gr(t,e),null==(e=Xl(e,t))||delete e[Wr(Yl(t))]},ec=function(e){return Ka(e)?void 0:e};var tc=Al((function(e,t){var s={};if(null==e)return s;var n=!1;t=Os(t,(function(t){return t=Gr(t,e),n||(n=t.length>1),t})),tn(e,ti(e),s),n&&(s=xi(s,7,ec));for(var r=t.length;r--;)Zl(s,t[r]);return s}));const sc=tc,nc=function(e,t){let s=e||{};t||(t={}),this.preinitialize.apply(this,arguments),this.cid=Ls(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(s=this.parse(s,t)||{});const n=yo(this,"defaults");s=Dl(yn({},n,s),n),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};nc.extend=jo,Object.assign(nc.prototype,zs,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(e){return Ol(this.attributes)},sync:function(e,t,s){return Ao(this)(e,t,s)},get:function(e){return this.attributes[e]},keys:function(){return Object.keys(this.attributes)},values:function(){return Object.values(this.attributes)},pairs:function(){return this.entries()},entries:function(){return Object.entries(this.attributes)},invert:function(){return Jl(this.attributes)},pick:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),Cl(this.attributes,t)},omit:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return 1===t.length&&Array.isArray(t[0])&&(t=t[0]),sc(this.attributes,t)},isEmpty:function(){return ds(this.attributes)},escape:function(e){return ql(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!Ql(e,this)(this.attributes)},set:function(e,t,s){if(null==e)return this;let n;if("object"==typeof e?(n=e,s=t):(n={})[e]=t,s||(s={}),!this._validate(n,s))return!1;const r=s.unset,o=s.silent,i=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=Ol(this.attributes),this.changed={});const l=this.attributes,c=this.changed,d=this._previousAttributes;for(const e in n)t=n[e],vl(l[e],t)||i.push(e),vl(d[e],t)?delete c[e]:c[e]=t,r?delete l[e]:l[e]=t;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!o){i.length&&(this._pending=s);for(let e=0;e<i.length;e++)this.trigger("change:"+i[e],this,l[i[e]],s)}if(a)return this;if(!o)for(;this._pending;)s=this._pending,this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,yn({},t,{unset:!0}))},clear:function(e){const t={};for(const e in this.attributes)t[e]=void 0;return this.set(t,yn({},e,{unset:!0}))},hasChanged:function(e){return null==e?!ds(this.changed):vo(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&Ol(this.changed);const t=this._changing?this._previousAttributes:this.attributes,s={};let n;for(const r in e){const o=e[r];vl(t[r],o)||(s[r]=o,n=!0)}return!!n&&s},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return Ol(this._previousAttributes)},fetch:function(e){e=yn({parse:!0},e);const t=this,s=e.success;return e.success=function(n){const r=e.parse?t.parse(n,e):n;if(!t.set(r,e))return!1;s&&s.call(e.context,t,n,e),t.trigger("sync",t,n,e)},xo(this,e),this.sync("read",this,e)},save:function(e,t,s){let n;null==e||"object"==typeof e?(n=e,s=t):(n={})[e]=t;const r=(s=yn({validate:!0,parse:!0},s)).wait,o=s.promise,i=o&&wo();if(n&&!r){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;const a=this,l=s.success,c=s.error,d=this.attributes;s.success=function(e){a.attributes=d;let t=s.parse?a.parse(e,s):e;if(r&&(t=yn({},n,t)),t&&!a.set(t,s))return!1;l&&l.call(s.context,a,e,s),a.trigger("sync",a,e,s),o&&i.resolve()},s.error=function(e,t,s){c&&c.call(s.context,e,t,s),o&&i.reject(t)},xo(this,s),n&&r&&(this.attributes=yn({},d,n));const u=this.isNew()?"create":s.patch?"patch":"update";"patch"!==u||s.attrs||(s.attrs=n);const h=this.sync(u,this,s);return this.attributes=d,o?i:h},destroy:function(e){e=e?Ol(e):{};const t=this,s=e.success,n=e.wait,r=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(o){n&&r(),s&&s.call(e.context,t,o,e),t.isNew()||t.trigger("sync",t,o,e)};let o=!1;return this.isNew()?Ll(e.success):(xo(this,e),o=this.sync("delete",this,e)),n||r(),o},url:function(){const e=yo(this,"urlRoot")||yo(this.collection,"url")||So();if(this.isNew())return e;const t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},yn({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=yn({},this.attributes,e);const s=this.validationError=this.validate(e,t)||null;return!s||(this.trigger("invalid",this,s,yn(t,{validationError:s})),!1)}});const rc="http://www.w3.org/1999/xhtml";function oc(e,t){const s=_e.xmlHtmlNode(e);if(s.getElementsByTagNameNS(rc,"parsererror").length)throw new Error(`Parser Error: ${e}`);const n=s.firstElementChild;if(["message","iq","presence"].includes(n.nodeName.toLowerCase())&&"jabber:client"!==n.namespaceURI&&"jabber:server"!==n.namespaceURI){const e=`Invalid namespaceURI ${n.namespaceURI}`;if(De.error(e),t)throw new Error(e)}return n}class ic{constructor(e,t){this.strings=e,this.values=t}toString(){return this.string=this.string||this.strings.reduce(((e,t)=>{const s=this.strings.indexOf(t);return e+t+(this.values.length>s?this.values[s].toString():"")}),""),this.string}tree(){return this.node=this.node??oc(this.toString(),!0),this.node}}function ac(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return new ic(e,s)}const lc=e=>`<value>${e}</value>`;function cc(e){const t=[],s=e?.options;for(let e=0,n=s.length;e<n;e++){const n=s[e];n.selected&&t.push(n.value||n.text)}return t}function dc(e){return"@"!==e&&RegExp("(\\p{Z}|\\p{P})","u").test(e)}function uc(e){return new TextEncoder("utf-8").encode(e).buffer}function hc(e){return btoa(new Uint8Array(e).reduce(((e,t)=>e+String.fromCharCode(t)),""))}var fc=c(988),mc=c.n(fc);function pc(e){const t=gc(e),{protocol:s}=window.location;return!!["chrome-extension:","file:"].includes(s)||"http:"===s||"https:"===s&&["https","aesgcm"].includes(t.protocol().toLowerCase())}function gc(e){try{return e instanceof mc()?e:new(mc())(e)}catch(e){return De.debug(e),null}}function _c(e,t){const s=gc(t);if(null===s)throw new Error(`checkFileTypes: could not parse url ${t}`);const n=s.filename().toLowerCase();return!!e.filter((e=>n.endsWith(e))).length}function vc(e,t){const s=gc(t),n=s.subdomain(),r=s.domain(),o=`${n?`${n}.`:""}${r}`;return e.includes(r)||e.includes(o)}function yc(e,t){const s=ef.settings.get(t);if(!Array.isArray(s))return!0;try{return vc(s,e)}catch(e){return De.debug(e),!1}}function bc(e){return _c([".jpg",".jpeg",".png",".gif",".bmp",".tiff",".svg"],e)}function jc(e){return _c([".ogg",".mp3",".m4a"],e)}function wc(e){return _c([".mp4",".webm"],e)}function Sc(e){const t=ef.settings.get("image_urls_regex");return t?.test(e)||bc(e)}const xc={arrayBufferToBase64:hc,arrayBufferToHex:function(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")},arrayBufferToString:function(e){return new TextDecoder("utf-8").decode(e)},base64ToArrayBuffer:function(e){const t=window.atob(e),s=t.length,n=new Uint8Array(s);for(let e=0;e<s;e++)n[e]=t.charCodeAt(e);return n.buffer},checkFileTypes:_c,getSelectValues:cc,getURI:gc,isAllowedProtocolForMedia:pc,isAudioURL:jc,isGIFURL:function(e){return _c([".gif"],e)},isImageURL:Sc,isURLWithImageExtension:bc,isVideoURL:wc,shouldRenderMediaFromURL:function(e,t){if(!pc(e))return!1;const s=ef.settings.get("render_media"),n=yc(e,`allowed_${t}_domains`);return Array.isArray(s)?n&&vc(s,e):n&&s},stringToArrayBuffer:uc,webForm2xForm:function(e){const t=e.getAttribute("name");if(!t)return null;let s;return s="checkbox"===e.getAttribute("type")?e.checked?"1":"0":"TEXTAREA"==e.tagName?e.value.split("\n").filter((e=>e.trim())):"SELECT"==e.tagName?cc(e):e.value,oc(((e,t)=>`<field var="${e}">${t}</field>`)(t,Array.isArray(s)?s.map(lc):lc(s)))}};function Ec(e){return e instanceof nc&&(e=e.attributes),!(e.oob_url||e.file||e.is_encrypted&&e.plaintext||e.message||e.body)}function Ac(){return["mobile","fullscreen","embedded"].includes(Jc.get("view_mode"))}function Cc(){const{api:e}=td;return!td.config.get("trusted")||e.settings.get("clear_cache_on_logout")||td.isTestEnv()}async function Tc(){const{api:e}=td;return await e.trigger("beforeTearDown",{synchronous:!0}),window.removeEventListener("click",td.onUserActivity),window.removeEventListener("focus",td.onUserActivity),window.removeEventListener("keypress",td.onUserActivity),window.removeEventListener("mousemove",td.onUserActivity),window.removeEventListener(td.unloadevent,td.onUserActivity),window.clearInterval(td.everySecondTrigger),e.trigger("afterTearDown"),td}function Ic(){return td.session?.destroy(),delete td.session,Cc()&&td.api.user.settings.clear(),td.api.trigger("clearSession",{synchronous:!0})}function kc(e){return"string"==typeof e&&2===e.split("@").filter((e=>!!e)).length&&!e.startsWith("@")&&!e.endsWith("@")}function Nc(e,t,s){xc.isPersistableModel(e)?e.save(t,s):e.set(t,s)}function Oc(e){return Math.random()*e|0}function Mc(e){const t=crypto.randomUUID?.()??"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Oc(16);return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t}function $c(e,t){clearTimeout(e),clearInterval(t)}function Rc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{const t=e();if(t)return Promise.resolve(t)}catch(e){return Promise.reject(e)}const n=ol(),r=new Error,o=setInterval((function(){try{const t=e();t&&($c(i,o),n.resolve(t))}catch(e){$c(i,o),n.reject(e)}}),s),i=setTimeout((function(){$c(i,o);const e=`Wait until promise timed out: \n\n${r.stack}`;console.trace(),De.error(e),n.reject(new Error(e))}),t);return n}function Dc(e){const t=td.promises[e];if(!t)throw new Error(`Tried to replace non-existing promise: ${e}`);if(t.replace){const s=ol();s.replace=t.replace,td.promises[e]=s}else De.debug(`Not replacing promise "${e}"`)}xc.getJIDFromURI=function(e){return e.startsWith("xmpp:")&&e.endsWith("?join")?e.replace(/^xmpp:/,"").replace(/\?join$/,""):e},xc.getLongestSubstring=function(e,t){return t.reduce((function(t,s){return e.startsWith(s)&&s.length>t.length?s:t}),"")},xc.isValidMUCJID=function(e){return!e.startsWith("@")&&!e.endsWith("@")},xc.isSameBareJID=function(e,t){return"string"==typeof e&&"string"==typeof t&&_e.getBareJidFromJid(e).toLowerCase()===_e.getBareJidFromJid(t).toLowerCase()},xc.isSameDomain=function(e,t){return"string"==typeof e&&"string"==typeof t&&_e.getDomainFromJid(e).toLowerCase()===_e.getDomainFromJid(t).toLowerCase()},xc.isNewMessage=function(e){return e instanceof Element?!(Nl()(`result[xmlns="${_e.NS.MAM}"]`,e).length&&Nl()(`delay[xmlns="${_e.NS.DELAY}"]`,e).length):(e instanceof nc&&(e=e.attributes),!(e.is_delayed&&e.is_archived))},xc.shouldCreateMessage=function(e){return e.retracted||!Ec(e)},xc.shouldCreateGroupchatMessage=function(e){return e.nick&&(xc.shouldCreateMessage(e)||e.is_tombstone)},xc.isChatRoom=function(e){return e&&"chatroom"===e.get("type")},xc.isErrorStanza=function(e){return!!Me(e)&&"error"===e.getAttribute("type")},xc.isForbiddenError=function(e){return!!Me(e)&&Nl()(`error[type="auth"] forbidden[xmlns="${_e.NS.STANZAS}"]`,e).length>0},xc.isServiceUnavailableError=function(e){return!!Me(e)&&Nl()(`error[type="cancel"] service-unavailable[xmlns="${_e.NS.STANZAS}"]`,e).length>0},xc.contains=function(e,t){const s=(e,s)=>e.get(s).toLowerCase().includes(t.toLowerCase());return function(t){if("object"==typeof e)return Object.keys(e).reduce(((e,n)=>e||s(t,n)),!1);if("string"==typeof e)return s(t,e);throw new TypeError("contains: wrong attribute type. Must be string or array.")}},xc.getAttribute=function(e,t){return t.get(e)},xc.contains.not=function(e,t){return function(s){return!xc.contains(e,t)(s)}},xc.isPersistableModel=function(e){return e.collection&&e.collection.browserStorage},xc.getResolveablePromise=ol,xc.getOpenPromise=ol,xc.onMultipleEvents=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=[];function n(n){s.push(n),e.length===s.length&&(t(s),s=[])}e.forEach((e=>e.object.on(e.event,n)))},xc.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t};const Pc=document.createElement("div");function Lc(e){return e&&"string"==typeof e&&(Pc.innerHTML=Il().sanitize(e),e=Pc.textContent,Pc.textContent=""),e}function zc(e){let t;const s={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};t=(e=e||document.createEvent("Events")).type in s?s[e.type]:document.hidden?"hidden":"visible",td.windowState=t,td.api.trigger("windowStateChanged",{state:t})}const Fc=Object.assign({getCurrentWord:function(e,t,s){t||(t=e.selectionEnd||void 0);let[n]=e.value.slice(0,t).split(/\s/).slice(-1);return s&&([n]=n.split(s).slice(-1)),n},getOuterWidth:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.offsetWidth;if(!t)return s;const n=window.getComputedStyle(e);return s+=parseInt(n.marginLeft?n.marginLeft:"0",10)+parseInt(n.marginRight?n.marginRight:"0",10),s},getRandomInt:Oc,isMentionBoundary:dc,getUniqueId:Mc,isElement:Me,isEmptyMessage:Ec,isErrorObject:function(e){return e instanceof Error},isTagEqual:function e(t,s){if(t instanceof _e.Builder)return e(t.tree(),s);if(t instanceof Element)return _e.isTagEqual(t,s);throw Error("isTagEqual called with value which isn't an element or Strophe.Builder instance")},isValidJID:kc,merge:function e(t,s){for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&"__proto__"!==n&&"constructor"!==n&&(t[n]instanceof Object?e(t[n],s[n]):t[n]=s[n])},placeCaretAtEnd:function(e){e!==document.activeElement&&e.focus();const t=2*e.value.length;setTimeout((()=>e.setSelectionRange(t,t)),1),e.scrollTop=999999},prefixMentions:function(e){let t=e.getMessageText();return(e.get("references")||[]).sort(((e,t)=>t.begin-e.begin)).forEach((e=>{t=`${t.slice(0,e.begin)}@${t.slice(e.begin)}`})),t},queryChildren:function(e,t){return Array.from(e.childNodes).filter((e=>e instanceof Element&&e.matches(t)))},replaceCurrentWord:function(e,t){const s=e.selectionEnd||void 0,n=e.value.slice(0,s).split(/\s/).pop(),r=e.value,o=dc(n[0])?n[0]:"";e.value=r.slice(0,s-n.length)+o+`${t} `+r.slice(s);const i=s-n.length+t.length+1;e.selectionEnd=o?i+1:i},safeSave:Nc,saveWindowState:zc,shouldClearCache:Cc,stringToElement:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild},stx:ac,toStanza:oc,triggerEvent:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Event",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=document.createEvent(s);o.initEvent(t,n,r),e.dispatchEvent(o)},waitUntil:Rc},xc),Uc={allow_non_roster_messaging:!1,allow_url_history_change:!0,assets_path:"/dist",authentication:"login",auto_login:!1,reuse_scram_keys:!1,auto_reconnect:!0,blacklisted_plugins:[],clear_cache_on_logout:!1,connection_options:{},credentials_url:null,discover_connection_methods:!0,geouri_regex:/https\:\/\/www.openstreetmap.org\/.*#map=[0-9]+\/([\-0-9.]+)\/([\-0-9.]+)\S*/g,geouri_replacement:"https://www.openstreetmap.org/?mlat=$1&mlon=$2#map=18/$1/$2",i18n:void 0,jid:void 0,keepalive:!0,loglevel:"info",locales:["af","ar","bg","ca","cs","da","de","el","en","eo","es","eu","fa","fi","fr","gl","he","hi","hu","id","it","ja","lt","mr","nb","nl","oc","pl","pt","pt_BR","ro","ru","sv","th","tr","ug","uk","vi","zh_CN","zh_TW"],nickname:void 0,password:void 0,persistent_store:"IndexedDB",rid:void 0,root:window.document,sid:void 0,singleton:!1,strict_plugin_dependencies:!1,stanza_timeout:2e4,view_mode:"overlayed",websocket_url:void 0,whitelisted_plugins:[]};let Bc,qc,Hc={};function Gc(){if(!td.bare_jid){const e="No JID to fetch user settings for";throw De.error(e),Error(e)}if(!qc?.fetched){const e=`converse.user-settings.${td.bare_jid}`;qc=new nc({id:e}),Zc(qc,e),qc.fetched=qc.fetch({promise:!0})}return qc.fetched}async function Wc(){return await Gc(),qc}async function Vc(e,t){return await Gc(),qc.save(e,t)}const Jc={extend:e=>function(e){Fc.merge(Uc,e);const t=Object.keys(e).filter((e=>e in Uc)),s=Cl(Hc,t),n=Object.assign(Cl(e,t),s);Fc.merge(Bc,n)}(e),update(e){return De.warn("The api.settings.update method has been deprecated and will be removed. Please use api.settings.extend instead."),this.extend(e)},get:e=>function(e){if(Object.keys(Uc).includes(e))return Bc[e]}(e),set(e,t){!function(e,t){if(null==e)return this;let s;e instanceof Object?s=e:"string"==typeof e&&(s={},s[e]=t);const n=Object.keys(s).filter((e=>e in Uc)),r={};n.forEach((e=>{const t=s[e];vl(Bc[e],t)||(r[e]=t,Bc[e]=t)})),Object.keys(r).forEach((e=>Bc.trigger("change:"+e,r[e]))),Bc.trigger("change",r)}(e,t)},listen:{on(e,t,s){!function(e,t,s){Bc.on(e,t,s)}(e,t,s)},not(e,t){!function(e,t){Bc.off(e,t)}(e,t)}}},Qc={getModel:()=>Wc(),async get(e,t){const s=await Wc();return void 0===s.get(e)?t:s.get(e)},set(e,t){if(e instanceof Object)return Vc(e,{promise:!0});{const s={};return s[e]=t,Vc(s,{promise:!0})}},clear:()=>async function(){return await Gc(),qc.clear()}()};function Yc(){return td.config.get("trusted")?"sessionStorage"===Jc.get("persistent_store")?"session":"persistent":"session"}function Kc(e){return"persistent"===e&&"IndexedDB"===Jc.get("persistent_store")}function Xc(e,t){const s=t||Yc(),n=td.storage[s];if(void 0===n)throw new TypeError(`createStore: Could not find store for ${e}`);return new _l(e,n,Kc(t))}function Zc(e,t,s){const n=s||Yc();if(e.browserStorage=Xc(t,n),Kc(n)){const t=()=>e.browserStorage.flush();window.addEventListener(td.unloadevent,t),e.on("destroy",(()=>window.removeEventListener(td.unloadevent,t))),e.listenTo(td,"beforeLogout",t)}}const ed={log:De,shouldClearCache:Cc,VERSION_NAME:ve,templates:{},promises:{initialized:ol()},ANONYMOUS:be,CLOSED:"closed",EXTERNAL:je,LOGIN:we,LOGOUT:Se,OPENED:"opened",PREBIND:xe,SUCCESS:"success",FAILURE:"failure",DEFAULT_IMAGE_TYPE:"image/svg+xml",DEFAULT_IMAGE:"PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+CiA8cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzU1NSIvPgogPGNpcmNsZSBjeD0iNjQiIGN5PSI0MSIgcj0iMjQiIGZpbGw9IiNmZmYiLz4KIDxwYXRoIGQ9Im0yOC41IDExMiB2LTEyIGMwLTEyIDEwLTI0IDI0LTI0IGgyMyBjMTQgMCAyNCAxMiAyNCAyNCB2MTIiIGZpbGw9IiNmZmYiLz4KPC9zdmc+Cg==",INACTIVE:"inactive",ACTIVE:"active",COMPOSING:"composing",PAUSED:"paused",GONE:"gone",PRIVATE_CHAT_TYPE:"chatbox",CHATROOMS_TYPE:"chatroom",HEADLINES_TYPE:Ee,CONTROLBOX_TYPE:"controlbox",TIMEOUTS:{PAUSED:1e4,INACTIVE:9e4},default_connection_options:{explicitResourceBinding:!0},router:new Do,isTestEnv:()=>"montague.lit/http-bind"===Hc.bosh_service_url,getDefaultStore:Yc,createStore:Xc,__:function(){return Oe.__(...arguments)},___:e=>e};Object.assign(ed,zs),ze.enable(ed,"_converse","pluggable");const td=ed,sd={authenticated:()=>td?.connection?.authenticated&&!0,connected:()=>td?.connection?.connected&&!0,disconnect(){td.connection&&td.connection.disconnect()},reconnect(){const{__:e,connection:t}=td;return t.setConnectionStatus(_e.Status.RECONNECTING,e("The connection has dropped, attempting to reconnect.")),t?.reconnecting?t.debouncedReconnect():t.reconnect()},isType:e=>td.connection.isType(e)},nd={async trigger(e){if(!td._events)return;const t=Array.from(arguments),s=t.pop();if(s&&s.synchronous){const s=td._events[e]||[],n=t.splice(1);await Promise.all(s.map((e=>e.callback.apply(e.ctx,n))))}else td.trigger.apply(td,arguments);const n=td.promises[e];void 0!==n&&n.resolve()},hook(e,t,s){const n=td._events[e]||[];return n.length?n.reduce(((e,s)=>e.then((e=>s.callback(t,e)))),Promise.resolve(s)):s},listen:{once:td.once.bind(td),on:td.on.bind(td),not:td.off.bind(td),stanza(e,t,s){Fc(t)?(s=t,t={}):t=t||{},td.connection.addHandler(s,t.ns,e,t.type,t.id,t.from,t)}}},rd={promises:{add(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(e=Array.isArray(e)?e:[e]).forEach((e=>{const s=ol();s.replace=t,td.promises[e]=s}))}},waitUntil(e){if("function"==typeof e)return Rc(e);{const t=td.promises[e];return void 0===t?null:t}}};class od extends Error{}const id={send(e){const{api:t}=td;return t.connection.connected()?("string"==typeof e?e=oc(e):e?.tree&&(e=e.tree()),"iq"===e.tagName?t.sendIQ(e):(td.connection.send(e),void t.trigger("send",e))):(De.warn("Not sending stanza because we're not connected!"),void De.warn(_e.serialize(e)))},sendIQ(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{api:n,connection:r}=td;let o;return e=e.tree?.()??e,["get","set"].includes(e.getAttribute("type"))?(t=t||n.settings.get("stanza_timeout"),s?(o=new Promise(((s,n)=>r.sendIQ(e,s,n,t))),o.catch((s=>{if(null===s)throw new od(`Timeout error after ${t}ms for the following IQ stanza: ${_e.serialize(e)}`)}))):o=new Promise((s=>r.sendIQ(e,s,s,t)))):(td.connection.sendIQ(e),o=Promise.resolve()),n.trigger("send",e),o}},ad={presence:{async send(e,t,s,n){await ef.waitUntil("statusInitialized"),n&&!Array.isArray(n)&&(n=[n]);const r=td.xmppstatus,o=await r.constructPresence(e,t,s);n?.map((e=>e?.tree()??e)).forEach((e=>o.cnode(e).up())),ef.send(o),["away","chat","dnd","online","xa",void 0].includes(e)&&(await ef.rooms.get()).forEach((t=>t.sendStatusPresence(e,s,n)))}}};var ld=Math.max,cd=Math.min;const dd=function(e,t,s){var n,r,o,i,a,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var s=n,o=r;return n=r=void 0,c=t,i=e.apply(o,s)}function m(e){var s=e-l;return void 0===l||s>=t||s<0||u&&e-c>=o}function p(){var e=rl();if(m(e))return g(e);a=setTimeout(p,function(e){var s=t-(e-l);return u?cd(s,o-(e-c)):s}(e))}function g(e){return a=void 0,h&&n?f(e):(n=r=void 0,i)}function _(){var e=rl(),s=m(e);if(n=arguments,r=this,l=e,s){if(void 0===a)return function(e){return c=e,a=setTimeout(p,t),d?f(e):i}(l);if(u)return clearTimeout(a),a=setTimeout(p,t),f(l)}return void 0===a&&(a=setTimeout(p,t)),i}return t=As(t)||0,ot(s)&&(d=!!s.leading,o=(u="maxWait"in s)?ld(As(s.maxWait)||0,t):o,h="trailing"in s?!!s.trailing:h),_.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=r=a=void 0},_.flush=function(){return void 0===a?i:g(rl())},_};var ud=c(2),hd=c(63);const fd=Object.keys(_e.Status).reduce(((e,t)=>Math.max(e,_e.Status[t])),0);_e.Status.RECONNECTING=fd+1;class md extends _e.Connection{constructor(e,t){super(e,t),this.debouncedReconnect=dd(this.reconnect,3e3)}static generateResource(){return`/converse.js-${Math.floor(139749528*Math.random()).toString()}`}async bind(){await ef.trigger("beforeResourceBinding",{synchronous:!0}),super.bind()}async onDomainDiscovered(e){const t=await e.text(),s=(new window.DOMParser).parseFromString(t,"text/xml").firstElementChild;if("XRD"!=s.nodeName||"http://docs.oasis-open.org/ns/xri/xrd-1.0"!=s.namespaceURI)return De.warn("Could not discover XEP-0156 connection methods");const n=Nl()('Link[rel="urn:xmpp:alt-connections:xbosh"]',s),r=Nl()('Link[rel="urn:xmpp:alt-connections:websocket"]',s),o=n.map((e=>e.getAttribute("href"))),i=r.map((e=>e.getAttribute("href")));0===o.length&&0===i.length?De.warn("Neither BOSH nor WebSocket connection methods have been specified with XEP-0156."):(ef.settings.set("websocket_url",i.pop()),ef.settings.set("bosh_service_url",o.pop()),this.service=ef.settings.get("websocket_url")||ef.settings.get("bosh_service_url"),this.setProtocol())}async discoverConnectionMethods(e){const t={mode:"cors",headers:{Accept:"application/xrd+xml, text/xml"}},s=`https://${e}/.well-known/host-meta`;let n;try{n=await fetch(s,t)}catch(e){return De.error(`Failed to discover alternative connection methods at ${s}`),void De.error(e)}n.status>=200&&n.status<400?await this.onDomainDiscovered(n):De.warn("Could not discover XEP-0156 connection methods")}async connect(e,t,s){if(ef.settings.get("discover_connection_methods")){const t=_e.getDomainFromJid(e);await this.discoverConnectionMethods(t)}if(!ef.settings.get("bosh_service_url")&&!ef.settings.get("websocket_url"))throw new Error("You must supply a value for either the bosh_service_url or websocket_url or both.");super.connect(e,t,s||this.onConnectStatusChanged,59)}async switchTransport(){ef.connection.isType("websocket")&&ef.settings.get("bosh_service_url")?(await yd(td.bare_jid),this._proto._doDisconnect(),this._proto=new _e.Bosh(this),this.service=ef.settings.get("bosh_service_url")):ef.connection.isType("bosh")&&ef.settings.get("websocket_url")&&(ef.settings.get("authentication")===be?await yd(ef.settings.get("jid")):await yd(td.bare_jid),this._proto._doDisconnect(),this._proto=new _e.Websocket(this),this.service=ef.settings.get("websocket_url"))}async reconnect(){De.debug("RECONNECTING: the connection has dropped, attempting to reconnect."),this.reconnecting=!0,await Tc();const e=td.connfeedback.get("connection_status");return e===_e.Status.CONNFAIL?this.switchTransport():e===_e.Status.AUTHFAIL&&ef.settings.get("authentication")===be&&await yd(ef.settings.get("jid")),ef.trigger("will-reconnect"),ef.settings.get("authentication")===be&&await Ic(),ef.user.login()}async onConnected(e){delete this.reconnecting,this.flush(),await yd(this.jid),td.config.get("trusted")&&localStorage.setItem("conversejs-session-jid",td.bare_jid),await ef.trigger("afterResourceBinding",e,{synchronous:!0}),e?ef.trigger("reconnected"):ef.trigger("connected")}setDisconnectionCause(e,t,s){void 0===e?(delete this.disconnection_cause,delete this.disconnection_reason):(void 0===this.disconnection_cause||s)&&(this.disconnection_cause=e,this.disconnection_reason=t)}setConnectionStatus(e,t){this.status=e,td.connfeedback.set({connection_status:e,message:t})}async finishDisconnection(){De.debug("DISCONNECTED"),delete this.reconnecting,this.reset(),Tc(),await Ic(),delete td.connection,ef.trigger("disconnected")}onDisconnected(){if(!ef.settings.get("auto_reconnect"))return this.finishDisconnection();{const e=this.disconnection_reason;if(this.disconnection_cause===_e.Status.AUTHFAIL)return ef.settings.get("credentials_url")||ef.settings.get("authentication")===be?ef.connection.reconnect():this.finishDisconnection();if(this.status===_e.Status.CONNECTING){const{__:e}=td;return this.setConnectionStatus(_e.Status.CONNFAIL,e("An error occurred while connecting to the chat server.")),this.finishDisconnection()}if(this.disconnection_cause===Se||e===_e.ErrorCondition.NO_AUTH_MECH||"host-unknown"===e||"remote-connection-failed"===e)return this.finishDisconnection();ef.connection.reconnect()}}onConnectStatusChanged(e,t){const{__:s}=td;if(De.debug(`Status changed to: ${Ae[e]}`),e===_e.Status.ATTACHFAIL)this.setConnectionStatus(e),this.worker_attach_promise?.resolve(!1);else if(e===_e.Status.CONNECTED||e===_e.Status.ATTACHED){if(this.worker_attach_promise?.isResolved&&this.status===_e.Status.ATTACHED)return;this.setConnectionStatus(e),this.worker_attach_promise?.resolve(!0),td.send_initial_presence=!0,this.setDisconnectionCause(),this.reconnecting?(De.debug(e===_e.Status.CONNECTED?"Reconnected":"Reattached"),this.onConnected(!0)):(De.debug(e===_e.Status.CONNECTED?"Connected":"Attached"),this.restored&&(td.send_initial_presence=!1),this.onConnected())}else if(e===_e.Status.DISCONNECTED)this.setDisconnectionCause(e,t),this.onDisconnected();else if(e===_e.Status.BINDREQUIRED)this.bind();else if(e===_e.Status.ERROR)this.setConnectionStatus(e,s("An error occurred while connecting to the chat server."));else if(e===_e.Status.CONNECTING)this.setConnectionStatus(e);else if(e===_e.Status.AUTHENTICATING)this.setConnectionStatus(e);else if(e===_e.Status.AUTHFAIL)t||(t=s("Your XMPP address and/or password is incorrect. Please try again.")),this.setConnectionStatus(e,t),this.setDisconnectionCause(e,t,!0),this.onDisconnected();else if(e===_e.Status.CONNFAIL){let n=t;"host-unknown"===t||"remote-connection-failed"==t?n=s("Sorry, we could not connect to the XMPP host with domain: %1$s",`"${_e.getDomainFromJid(this.jid)}"`):void 0!==t&&t===_e?.ErrorCondition?.NO_AUTH_MECH&&(n=s("The XMPP server did not offer a supported authentication mechanism")),this.setConnectionStatus(e,n),this.setDisconnectionCause(e,t)}else e===_e.Status.DISCONNECTING&&this.setDisconnectionCause(e,t)}isType(e){return"websocket"===e.toLowerCase()?this._proto instanceof _e.Websocket:"bosh"===e.toLowerCase()?_e.Bosh&&this._proto instanceof _e.Bosh:void 0}hasResumed(){return ef.settings.get("connection_options")?.worker||this.isType("bosh")?td.connfeedback.get("connection_status")===_e.Status.ATTACHED:!this.do_bind}restoreWorkerSession(){return this.attach(this.onConnectStatusChanged),this.worker_attach_promise=ol(),this.worker_attach_promise}}class pd extends md{constructor(e,t){super(e,t),this.sent_stanzas=[],this.IQ_stanzas=[],this.IQ_ids=[],this.features=_e.xmlHtmlNode('<stream:features xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client"><ver xmlns="urn:xmpp:features:rosterver"/><csi xmlns="urn:xmpp:csi:0"/><this xmlns="http://jabber.org/protocol/caps" ver="UwBpfJpEt3IoLYfWma/o/p3FFRo=" hash="sha-1" node="http://prosody.im"/><bind xmlns="urn:ietf:params:xml:ns:xmpp-bind"><required/></bind><sm xmlns=\'urn:xmpp:sm:3\'/><session xmlns="urn:ietf:params:xml:ns:xmpp-session"><optional/></session></stream:features>').firstChild,this._proto._processRequest=()=>{},this._proto._disconnect=()=>this._onDisconnectTimeout(),this._proto._onDisconnectTimeout=()=>{},this._proto._connect=()=>{this.connected=!0,this.mock=!0,this.jid="romeo@montague.lit/orchard",this._changeConnectStatus(_e.Status.BINDREQUIRED)}}_processRequest(){}sendIQ(e,t,s){e=e.tree?.()??e,this.IQ_stanzas.push(e);const n=super.sendIQ(e,t,s);return this.IQ_ids.push(n),n}send(e){return e=e.tree?.()??e,this.sent_stanzas.push(e),super.send(e)}async bind(){await ef.trigger("beforeResourceBinding",{synchronous:!0}),this.authenticated=!0,td.no_connection_on_bind||this._changeConnectStatus(_e.Status.CONNECTED)}}function gd(){const{api:e}=td;return("WebSocket"in window||"MozWebSocket"in window)&&e.settings.get("websocket_url")?e.settings.get("websocket_url"):e.settings.get("bosh_service_url")?e.settings.get("bosh_service_url"):""}function _d(){const e=td.api;if(!e.settings.get("bosh_service_url")&&e.settings.get("authentication")===xe)throw new Error("authentication is set to 'prebind' but we don't have a BOSH connection");const t=td.isTestEnv()?pd:md;td.connection=new t(gd(),Object.assign(td.default_connection_options,e.settings.get("connection_options"),{keepalive:e.settings.get("keepalive")})),function(){const e={};e[_e.LogLevel.DEBUG]="debug",e[_e.LogLevel.INFO]="info",e[_e.LogLevel.WARN]="warn",e[_e.LogLevel.ERROR]="error",e[_e.LogLevel.FATAL]="fatal",_e.log=(t,s)=>De.log(s,e[t]),_e.error=e=>De.error(e),td.connection.xmlInput=e=>De.debug(e.outerHTML,"color: darkgoldenrod"),td.connection.xmlOutput=e=>De.debug(e.outerHTML,"color: darkcyan")}(),e.trigger("connectionInitialized")}function vd(e,t){t=e.session.get("jid")||t,e.api.settings.get("authentication")===be||_e.getResourceFromJid(t)||(t=t.toLowerCase()+md.generateResource()),e.jid=t,e.bare_jid=_e.getBareJidFromJid(t),e.resource=_e.getResourceFromJid(t),e.domain=_e.getDomainFromJid(t),e.session.save({jid:t,bare_jid:e.bare_jid,resource:e.resource,domain:e.domain,active:!0}),e.connection.jid=t}async function yd(e){return await async function(e,t){const s=e.api.settings.get("connection_options").worker,n=_e.getBareJidFromJid(t).toLowerCase(),r=`converse.session-${n}`;e.session?.get("id")!==r?(function(e,t){if("sessionStorage"===e.api.settings.get("persistent_store"))return;if("BrowserExtLocal"===e.api.settings.get("persistent_store"))return _l.localForage.defineDriver(ud.Z).then((()=>_l.localForage.setDriver("webExtensionLocalStorage"))),void(e.storage.persistent=_l.localForage);if("BrowserExtSync"===e.api.settings.get("persistent_store"))return _l.localForage.defineDriver(hd.Z).then((()=>_l.localForage.setDriver("webExtensionSyncStorage"))),void(e.storage.persistent=_l.localForage);const s={name:e.isTestEnv()?"converse-test-persistent":"converse-persistent",storeName:t};"localStorage"===e.api.settings.get("persistent_store")?(s.description="localStorage instance",s.driver=[_l.localForage.LOCALSTORAGE]):"IndexedDB"===e.api.settings.get("persistent_store")&&(s.description="indexedDB instance",s.driver=[_l.localForage.INDEXEDDB]),e.storage.persistent=_l.localForage.createInstance(s)}(e,n),e.session=new nc({id:r}),Zc(e.session,r,s?"persistent":"session"),await new Promise((t=>e.session.fetch({success:t,error:t}))),!s&&e.session.get("active")&&(e.session.clear(),e.session.save({id:r})),vd(e,t),window.addEventListener(e.unloadevent,(()=>e.session?.save("active",!1))),e.api.trigger("userSessionInitialized")):vd(e,t)}(td,e),td.api.trigger("setUserJID"),e}async function bd(e){const{api:t}=e;await t.trigger("cleanup",{synchronous:!0}),e.router.history.stop(),function(e){const{api:t}=e;document.removeEventListener("visibilitychange",zc),t.trigger("unregisteredGlobalEventHandlers")}(e),e.connection?.reset(),e.stopListening(),e.off(),e.promises.initialized.isResolved&&t.promises.add("initialized")}function jd(){return new Promise(dd((async(e,t)=>{let s=new XMLHttpRequest;s.open("GET",td.api.settings.get("credentials_url"),!0),s.setRequestHeader("Accept","application/json, text/javascript"),s.onload=()=>{if(s.status>=200&&s.status<400){const t=JSON.parse(s.responseText);yd(t.jid).then((()=>{e({jid:t.jid,password:t.password})}))}else t(new Error(`${s.status}: ${s.responseText}`))},s.onerror=t,s=await td.api.hook("beforeFetchLoginCredentials",this,s),s.send()}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:0))}async function wd(e,t){const{api:s}=td;if(s.settings.get("authentication")===we){if(e)return xd(e);if(s.settings.get("credentials_url"))return xd(await async function(){let e,t=0;for(;!e;){try{e=await jd(t)}catch(e){De.error("Could not fetch login credentials"),De.error(e)}t=2e3}return e}());if(td.jid&&(s.settings.get("password")||td.connection.pass))return xd();if(s.settings.get("reuse_scram_keys")){const e=await async function(){const e=localStorage.getItem("conversejs-session-jid");if(!e)return null;await yd(e);const t=(await Sd(e)).get("scram_keys");return t?{jid:e,password:t}:null}();if(e)return xd(e)}if(!td.isTestEnv()&&"credentials"in navigator){const e=await async function(){if(!localStorage.getItem("conversejs-session-jid"))return null;try{const e=await navigator.credentials.get({password:!0});if(e&&"password"==e.type&&kc(e.id))return await yd(e.id),{jid:e.id,password:e.password}}catch(e){return De.error(e),null}}();if(e)return xd(e)}td.isTestEnv()||De.warn("attemptNonPreboundSession: Couldn't find credentials to log in with")}else![be,je].includes(s.settings.get("authentication"))||t&&!s.settings.get("auto_login")||xd()}async function Sd(e){const t=`converse.scram-keys-${_e.getBareJidFromJid(e)}`,s=new nc({id:t});return Zc(s,t,"persistent"),await new Promise((e=>s.fetch({success:e,error:e}))),s}async function xd(e){const{api:t}=td;if([be,je].includes(t.settings.get("authentication"))){if(!td.jid)throw new Error("Config Error: when using anonymous login you need to provide the server's domain via the 'jid' option. Either when calling converse.initialize, or when calling _converse.api.user.login.");td.connection.reconnecting||td.connection.reset(),td.connection.connect(td.jid.toLowerCase())}else if(t.settings.get("authentication")===we){const s=e?.password??(td.connection?.pass||t.settings.get("password"));if(!s){if(t.settings.get("auto_login"))throw new Error("autoLogin: If you use auto_login and authentication='login' then you also need to provide a password.");return td.connection.setDisconnectionCause(_e.Status.AUTHFAIL,void 0,!0),void t.connection.disconnect()}let n;if(td.connection.reconnecting||(td.connection.reset(),td.connection.service=gd()),td.config.get("trusted")&&td.jid&&t.settings.get("reuse_scram_keys")&&!s?.ck){const e=await Sd(td.jid);n=t=>{const{scram_keys:s}=td.connection;s&&e.save({scram_keys:s}),td.connection.onConnectStatusChanged(t)}}td.connection.connect(td.jid,s,n)}}const Ed={user:{settings:Qc,...ad,jid:()=>td.connection.jid,async login(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{api:n}=td;if(e=e||n.settings.get("jid"),(!td.connection?.jid||e&&!Fc.isSameDomain(td.connection.jid,e))&&_d(),n.settings.get("connection_options")?.worker&&await td.connection.restoreWorkerSession())return;e&&(e=await yd(e));const r=td.pluggable.plugins["converse-bosh"];if(r?.enabled()){if(await td.restoreBOSHSession())return;if(n.settings.get("authentication")===xe&&(!s||n.settings.get("auto_login")))return td.startNewPreboundBOSHSession()}t=t||n.settings.get("password"),wd(e&&t?{jid:e,password:t}:null,s)},async logout(){const{api:e}=td;await e.trigger("beforeLogout",{synchronous:!0});const t=ol(),s=()=>{Object.keys(td.promises).forEach(Dc),delete td.jid,localStorage.removeItem("conversejs-session-jid"),e.trigger("logout"),t.resolve()};return td.connection.setDisconnectionCause(Se,void 0,!0),void 0!==td.connection?(e.listen.once("disconnected",(()=>s())),td.connection.disconnect()):s(),t}}},Ad=class extends nc{defaults(){return{connection_status:_e.Status.DISCONNECTED,message:""}}initialize(){super.initialize();const{api:e}=td;this.on("change",(()=>e.trigger("connfeedback",td.connfeedback)))}};var Cd=c(484),Td=c.n(Cd);const Id=function(e,t,s,n){for(var r=-1,o=null==e?0:e.length;++r<o;){var i=e[r];t(n,i,s(i),e)}return n},kd=function(e,t,s,n){return ao(e,(function(e,r,o){t(n,e,s(e),o)})),n},Nd=function(e,t){return function(s,n){var r=Wt(s)?Id:kd,o=t?t():{};return r(s,e,so(n,2),o)}};var Od=Object.prototype.hasOwnProperty,Md=Nd((function(e,t,s){Od.call(e,s)?++e[s]:Ks(e,s,1)}));const $d=Md,Rd=function(e,t,s,n){for(var r=e.length,o=s+(n?1:-1);n?o--:++o<r;)if(t(e[o],o,e))return o;return-1},Dd=function(e){return e!=e},Pd=function(e,t,s){for(var n=s-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1},Ld=function(e,t,s){return t==t?Pd(e,t,s):Rd(e,Dd,s)},zd=function(e,t){return!(null==e||!e.length)&&Ld(e,t,0)>-1},Fd=function(e,t,s){for(var n=-1,r=null==e?0:e.length;++n<r;)if(s(t,e[n]))return!0;return!1},Ud=function(e,t,s,n){var r=-1,o=zd,i=!0,a=e.length,l=[],c=t.length;if(!a)return l;s&&(t=Os(t,ss(s))),n?(o=Fd,i=!1):t.length>=200&&(o=ir,i=!1,t=new or(t));e:for(;++r<a;){var d=e[r],u=null==s?d:s(d);if(d=n||0!==d?d:0,i&&u==u){for(var h=c;h--;)if(t[h]===u)continue e;l.push(d)}else o(t,u,n)||l.push(d)}return l},Bd=hn((function(e,t){return Ga(e)?Ud(e,xl(t,1,Ga,!0)):[]})),qd=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(!t(e[s],s,e))return!1;return!0},Hd=function(e,t){var s=!0;return ao(e,(function(e,n,r){return s=!!t(e,n,r)})),s},Gd=function(e,t,s){var n=Wt(e)?qd:Hd;return s&&fn(e,t,s)&&(t=void 0),n(e,so(t,3))};var Wd=Math.max;const Vd=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var r=null==s?0:Is(s);return r<0&&(r=Wd(n+r,0)),Rd(e,so(t,3),r)};var Jd=Math.max,Qd=Math.min;const Yd=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var r=n-1;return void 0!==s&&(r=Is(s),r=s<0?Jd(n+r,0):Qd(r,n-1)),Rd(e,so(t,3),r,!0)};var Kd=Object.prototype.hasOwnProperty,Xd=Nd((function(e,t,s){Kd.call(e,s)?e[s].push(t):Ks(e,s,[t])}));const Zd=Xd;var eu=Math.max;const tu=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var r=null==s?0:Is(s);return r<0&&(r=eu(n+r,0)),Ld(e,t,r)};var su=Nd((function(e,t,s){Ks(e,s,t)}));const nu=su,ru=function(e,t,s){for(var n=s+1;n--;)if(e[n]===t)return n;return n};var ou=Math.max,iu=Math.min;const au=function(e,t,s){var n=null==e?0:e.length;if(!n)return-1;var r=n;return void 0!==s&&(r=(r=Is(s))<0?ou(n+r,0):iu(r,n-1)),t==t?ru(e,t,r):Rd(e,Dd,r,!0)},lu=function(e,t){var s=-1,n=Jt(e)?Array(e.length):[];return ao(e,(function(e,r,o){n[++s]=t(e,r,o)})),n},cu=function(e,t){var s=e.length;for(e.sort(t);s--;)e[s]=e[s].value;return e},du=function(e,t){if(e!==t){var s=void 0!==e,n=null===e,r=e==e,o=js(e),i=void 0!==t,a=null===t,l=t==t,c=js(t);if(!a&&!c&&!o&&e>t||o&&i&&l&&!a&&!c||n&&i&&l||!s&&l||!r)return 1;if(!n&&!o&&!c&&e<t||c&&s&&r&&!n&&!o||a&&s&&r||!i&&r||!l)return-1}return 0},uu=function(e,t,s){for(var n=-1,r=e.criteria,o=t.criteria,i=r.length,a=s.length;++n<i;){var l=du(r[n],o[n]);if(l)return n>=a?l:l*("desc"==s[n]?-1:1)}return e.index-t.index},hu=function(e,t,s){t=t.length?Os(t,(function(e){return Wt(e)?function(t){return Vr(t,1===e.length?e[0]:e)}:e})):[sn];var n=-1;t=Os(t,ss(so));var r=lu(e,(function(e,s,r){var o=Os(t,(function(t){return t(e)}));return{criteria:o,index:++n,value:e}}));return cu(r,(function(e,t){return uu(e,t,s)}))};var fu=hn((function(e,t){if(null==e)return[];var s=t.length;return s>1&&fn(e,t[0],t[1])?t=[]:s>2&&fn(t[0],t[1],t[2])&&(t=[t[0]]),hu(e,xl(t,1),[])}));const mu=fu,pu=Array.prototype.slice,gu=function(e,t){t||(t={}),this.preinitialize.apply(this,arguments),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,yn({silent:!0},t))};gu.extend=jo;const _u={add:!0,remove:!0,merge:!0},vu={add:!0,remove:!1},yu=function(e,t,s){s=Math.min(Math.max(s,0),e.length);const n=Array(e.length-s),r=t.length;let o;for(o=0;o<n.length;o++)n[o]=e[o+s];for(o=0;o<r;o++)e[o+s]=t[o];for(o=0;o<n.length;o++)e[o+r+s]=n[o]};Object.assign(gu.prototype,zs,{model:nc,preinitialize:function(){},initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(e,t,s){return Ao(this)(e,t,s)},add:function(e,t){return this.set(e,yn({merge:!1},t,vu))},remove:function(e,t){t=yn({},t);const s=!Array.isArray(e);e=s?[e]:e.slice();const n=this._removeModels(e,t);return!t.silent&&n.length&&(t.changes={added:[],merged:[],removed:n},this.trigger("update",this,t)),s?n[0]:n},set:function(e,t){if(null==e)return;(t=yn({},_u,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);const s=!Array.isArray(e);e=s?[e]:e.slice();let n=t.at;null!=n&&(n=+n),n>this.length&&(n=this.length),n<0&&(n+=this.length+1);const r=[],o=[],i=[],a=[],l={},c=t.add,d=t.merge,u=t.remove;let h=!1;const f=this.comparator&&null==n&&!1!==t.sort,m=Ai(this.comparator)?this.comparator:null;let p,g;for(g=0;g<e.length;g++){p=e[g];const s=this.get(p);if(s){if(d&&p!==s){let e=this._isModel(p)?p.attributes:p;t.parse&&(e=s.parse(e,t)),s.set(e,t),i.push(s),f&&!h&&(h=s.hasChanged(m))}l[s.cid]||(l[s.cid]=!0,r.push(s)),e[g]=s}else c&&(p=e[g]=this._prepareModel(p,t),p&&(o.push(p),this._addReference(p,t),l[p.cid]=!0,r.push(p)))}if(u){for(g=0;g<this.length;g++)p=this.models[g],l[p.cid]||a.push(p);a.length&&this._removeModels(a,t)}let _=!1;const v=!f&&c&&u;if(r.length&&v?(_=this.length!==r.length||co(this.models,((e,t)=>e!==r[t])),this.models.length=0,yu(this.models,r,0),this.length=this.models.length):o.length&&(f&&(h=!0),yu(this.models,o,null==n?this.length:n),this.length=this.models.length),h&&this.sort({silent:!0}),!t.silent){for(g=0;g<o.length;g++)null!=n&&(t.index=n+g),p=o[g],p.trigger("add",p,this,t);(h||_)&&this.trigger("sort",this,t),(o.length||a.length||i.length)&&(t.changes={added:o,removed:a,merged:i},this.trigger("update",this,t))}return s?e[0]:e},clearStore:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;await Promise.all(this.models.filter(t).map((t=>new Promise((s=>{t.destroy(Object.assign(e,{success:s,error:(e,t)=>{console.error(t),s()}}))}))))),await this.browserStorage.clear(),this.reset()},reset:function(e,t){t=t?Ol(t):{};for(let e=0;e<this.models.length;e++)this._removeReference(this.models[e],t);return t.previousModels=this.models,this._reset(),e=this.add(e,yn({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,yn({at:this.length},t))},pop:function(e){const t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,yn({at:0},t))},shift:function(e){const t=this.at(0);return this.remove(t,e)},slice:function(){return pu.apply(this.models,arguments)},filter:function(e,t){return this.models.filter(it(e)?e:t=>t.matches(e),t)},every:function(e){return Gd(this.models.map((e=>e.attributes)),e)},difference:function(e){return Bd(this.models,e)},max:function(){return Math.max.apply(Math,this.models)},min:function(){return Math.min.apply(Math,this.models)},drop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.models.slice(e)},some:function(e){return co(this.models.map((e=>e.attributes)),e)},sortBy:function(e){return mu(this.models,it(e)?e:t=>Ai(e)?t.get(e):t.matches(e))},isEmpty:function(){return ds(this.models)},keyBy:function(e){return nu(this.models,e)},each:function(e,t){return this.forEach(e,t)},forEach:function(e,t){return this.models.forEach(e,t)},includes:function(e){return this.models.includes(e)},size:function(){return this.models.length},countBy:function(e){return $d(this.models,it(e)?e:t=>Ai(e)?t.get(e):t.matches(e))},groupBy:function(e){return Zd(this.models,it(e)?e:t=>Ai(e)?t.get(e):t.matches(e))},indexOf:function(e){return tu(this.models,e)},findLastIndex:function(e,t){return Yd(this.models,it(e)?e:t=>Ai(e)?t.get(e):t.matches(e),t)},lastIndexOf:function(e){return au(this.models,e)},findIndex:function(e){return Vd(this.models,it(e)?e:t=>Ai(e)?t.get(e):t.matches(e))},last:function(){const e=null==this.models?0:this.models.length;return e?this.models[e-1]:void 0},head:function(){return this.models[0]},first:function(){return this.head()},map:function(e,t){return this.models.map(it(e)?e:t=>Ai(e)?t.get(e):t.matches(e),t)},reduce:function(e,t){return this.models.reduce(e,t||this.models[0])},reduceRight:function(e,t){return this.models.reduceRight(e,t||this.models[0])},toArray:function(){return Array.from(this.models)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(this._isModel(e)?e.attributes:e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},find:function(e,t){const s=it(e)?e:t=>t.matches(e);return this.models.find(s,t)},sort:function(e){let t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});const s=t.length;return it(t)&&(t=t.bind(this)),1===s||Ai(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){const t=(e=yn({parse:!0},e)).success,s=this,n=e.promise&&wo();return e.success=function(r){const o=e.reset?"reset":"set";s[o](r,e),t&&t.call(e.context,s,r,e),n&&n.resolve(),s.trigger("sync",s,r,e)},xo(this,e),n||this.sync("read",this,e)},create:function(e,t){const s=(t=t?Ol(t):{}).wait,n=t.promise,r=n&&wo();if(!(e=this._prepareModel(e,t)))return!1;s||this.add(e,t);const o=this,i=t.success,a=t.error;return t.success=function(e,t,a){s&&o.add(e,a),i&&i.call(a.context,e,t,a),n&&r.resolve(e)},t.error=function(e,t,s){a&&a.call(s.context,e,t,s),n&&r.reject(t)},e.save(null,Object.assign(t,{promise:!1})),n?r:e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype?.idAttribute||"id"]},values:function(){return new ju(this,wu)},keys:function(){return new ju(this,Su)},entries:function(){return new ju(this,xu)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?Ol(t):{}).collection=this;const s=new this.model(e,t);return s.validationError?(this.trigger("invalid",this,s.validationError,t),!1):s},_removeModels:function(e,t){const s=[];for(let n=0;n<e.length;n++){const r=this.get(e[n]);if(!r)continue;const o=this.indexOf(r);this.models.splice(o,1),this.length--,delete this._byId[r.cid];const i=this.modelId(r.attributes);null!=i&&delete this._byId[i],t.silent||(t.index=o,r.trigger("remove",r,this,t)),s.push(r),this._removeReference(r,t)}return s},_isModel:function(e){return e instanceof nc},_addReference:function(e,t){this._byId[e.cid]=e;const s=this.modelId(e.attributes);null!=s&&(this._byId[s]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];const s=this.modelId(e.attributes);null!=s&&delete this._byId[s],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,s,n){if(t){if(("add"===e||"remove"===e)&&s!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){const e=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);e!==s&&(null!=e&&delete this._byId[e],null!=s&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}});const bu="function"==typeof Symbol&&Symbol.iterator;bu&&(gu.prototype[bu]=gu.prototype.values);const ju=function(e,t){this._collection=e,this._kind=t,this._index=0},wu=1,Su=2,xu=3;bu&&(ju.prototype[bu]=function(){return this}),ju.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){const e=this._collection.at(this._index);let t;if(this._index++,this._kind===wu)t=e;else{const s=this._collection.modelId(e.attributes);t=this._kind===Su?s:[s,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};const Eu="array",Au="bit",Cu="bits",Tu="byte",Iu="bytes",ku="",Nu="exponent",Ou="function",Mu="iec",$u="Invalid number",Ru="Invalid rounding method",Du="jedec",Pu="object",Lu=".",zu="round",Fu="s",Uu="kbit",Bu="kB",qu=" ",Hu="string",Gu="0",Wu={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function Vu(e){let{bits:t=!1,pad:s=!1,base:n=-1,round:r=2,locale:o=ku,localeOptions:i={},separator:a=ku,spacer:l=qu,symbols:c={},standard:d=ku,output:u=Hu,fullform:h=!1,fullforms:f=[],exponent:m=-1,roundingMethod:p=zu,precision:g=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=m,v=Number(e),y=[],b=0,j=ku;-1===n&&0===d.length?(n=10,d=Du):-1===n&&d.length>0?(d=d===Mu?Mu:Du,n=d===Mu?2:10):(n=2===n?2:10,d=10===n||d===Du?Du:Mu);const w=10===n?1e3:1024,S=!0===h,x=v<0,E=Math[p];if("bigint"!=typeof e&&isNaN(e))throw new TypeError($u);if(typeof E!==Ou)throw new TypeError(Ru);if(x&&(v=-v),(-1===_||isNaN(_))&&(_=Math.floor(Math.log(v)/Math.log(w)),_<0&&(_=0)),_>8&&(g>0&&(g+=8-_),_=8),u===Nu)return _;if(0===v)y[0]=0,j=y[1]=Wu.symbol[d][t?Cu:Iu][_];else{b=v/(2===n?Math.pow(2,10*_):Math.pow(1e3,_)),t&&(b*=8,b>=w&&_<8&&(b/=w,_++));const e=Math.pow(10,_>0?r:0);y[0]=E(b*e)/e,y[0]===w&&_<8&&-1===m&&(y[0]=1,_++),j=y[1]=10===n&&1===_?t?Uu:Bu:Wu.symbol[d][t?Cu:Iu][_]}if(x&&(y[0]=-y[0]),g>0&&(y[0]=y[0].toPrecision(g)),y[1]=c[y[1]]||y[1],!0===o?y[0]=y[0].toLocaleString():o.length>0?y[0]=y[0].toLocaleString(o,i):a.length>0&&(y[0]=y[0].toString().replace(Lu,a)),s&&!1===Number.isInteger(y[0])&&r>0){const e=a||Lu,t=y[0].toString().split(e),s=t[1]||ku,n=s.length,o=r-n;y[0]=`${t[0]}${e}${s.padEnd(n+o,Gu)}`}return S&&(y[1]=f[_]?f[_]:Wu.fullform[d][_]+(t?Au:Tu)+(1===y[0]?ku:Fu)),u===Eu?y:u===Pu?{value:y[0],symbol:y[1],exponent:_,unit:j}:y.join(l)}const Ju=window,Qu=Ju.ShadowRoot&&(void 0===Ju.ShadyCSS||Ju.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Yu=Symbol(),Ku=new WeakMap;class Xu{constructor(e,t,s){if(this._$cssResult$=!0,s!==Yu)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Qu&&void 0===e){const s=void 0!==t&&1===t.length;s&&(e=Ku.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&Ku.set(t,e))}return e}toString(){return this.cssText}}const Zu=Qu?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const s of e.cssRules)t+=s.cssText;return(e=>new Xu("string"==typeof e?e:e+"",void 0,Yu))(t)})(e):e;var eh;const th=window,sh=th.trustedTypes,nh=sh?sh.emptyScript:"",rh=th.reactiveElementPolyfillSupport,oh={toAttribute(e,t){switch(t){case Boolean:e=e?nh:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let s=e;switch(t){case Boolean:s=null!==e;break;case Number:s=null===e?null:Number(e);break;case Object:case Array:try{s=JSON.parse(e)}catch(e){s=null}}return s}},ih=(e,t)=>t!==e&&(t==t||e==e),ah={attribute:!0,type:String,converter:oh,reflect:!1,hasChanged:ih},lh="finalized";class ch extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,s)=>{const n=this._$Ep(s,t);void 0!==n&&(this._$Ev.set(n,s),e.push(n))})),e}static createProperty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ah;if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const s="symbol"==typeof e?Symbol():"__"+e,n=this.getPropertyDescriptor(e,s,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}static getPropertyDescriptor(e,t,s){return{get(){return this[t]},set(n){const r=this[e];this[t]=n,this.requestUpdate(e,r,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||ah}static finalize(){if(this.hasOwnProperty(lh))return!1;this[lh]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const s of t)this.createProperty(s,e[s])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const e of s)t.unshift(Zu(e))}else void 0!==e&&t.push(Zu(e));return t}static _$Ep(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,s;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(s=e.hostConnected)||void 0===s||s.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{Qu?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const s=document.createElement("style"),n=Ju.litNonce;void 0!==n&&s.setAttribute("nonce",n),s.textContent=t.cssText,e.appendChild(s)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,s){this._$AK(e,s)}_$EO(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ah;var n;const r=this.constructor._$Ep(e,s);if(void 0!==r&&!0===s.reflect){const o=(void 0!==(null===(n=s.converter)||void 0===n?void 0:n.toAttribute)?s.converter:oh).toAttribute(t,s.type);this._$El=e,null==o?this.removeAttribute(r):this.setAttribute(r,o),this._$El=null}}_$AK(e,t){var s;const n=this.constructor,r=n._$Ev.get(e);if(void 0!==r&&this._$El!==r){const e=n.getPropertyOptions(r),o="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(s=e.converter)||void 0===s?void 0:s.fromAttribute)?e.converter:oh;this._$El=r,this[r]=o.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,s){let n=!0;void 0!==e&&(((s=s||this.constructor.getPropertyOptions(e)).hasChanged||ih)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===s.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,s))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(s)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(s)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var dh;ch[lh]=!0,ch.elementProperties=new Map,ch.elementStyles=[],ch.shadowRootOptions={mode:"open"},null==rh||rh({ReactiveElement:ch}),(null!==(eh=th.reactiveElementVersions)&&void 0!==eh?eh:th.reactiveElementVersions=[]).push("1.6.2");const uh=window,hh=uh.trustedTypes,fh=hh?hh.createPolicy("lit-html",{createHTML:e=>e}):void 0,mh="$lit$",ph=`lit$${(Math.random()+"").slice(9)}$`,gh="?"+ph,_h=`<${gh}>`,vh=document,yh=()=>vh.createComment(""),bh=e=>null===e||"object"!=typeof e&&"function"!=typeof e,jh=Array.isArray,wh=e=>jh(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),Sh="[ \t\n\f\r]",xh=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Eh=/-->/g,Ah=/>/g,Ch=RegExp(`>|${Sh}(?:([^\\s"'>=/]+)(${Sh}*=${Sh}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),Th=/'/g,Ih=/"/g,kh=/^(?:script|style|textarea|title)$/i,Nh=e=>function(t){for(var s=arguments.length,n=new Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];return{_$litType$:e,strings:t,values:n}},Oh=Nh(1),Mh=(Nh(2),Symbol.for("lit-noChange")),$h=Symbol.for("lit-nothing"),Rh=new WeakMap,Dh=vh.createTreeWalker(vh,129,null,!1),Ph=(e,t)=>{const s=e.length-1,n=[];let r,o=2===t?"<svg>":"",i=xh;for(let t=0;t<s;t++){const s=e[t];let a,l,c=-1,d=0;for(;d<s.length&&(i.lastIndex=d,l=i.exec(s),null!==l);)d=i.lastIndex,i===xh?"!--"===l[1]?i=Eh:void 0!==l[1]?i=Ah:void 0!==l[2]?(kh.test(l[2])&&(r=RegExp("</"+l[2],"g")),i=Ch):void 0!==l[3]&&(i=Ch):i===Ch?">"===l[0]?(i=null!=r?r:xh,c=-1):void 0===l[1]?c=-2:(c=i.lastIndex-l[2].length,a=l[1],i=void 0===l[3]?Ch:'"'===l[3]?Ih:Th):i===Ih||i===Th?i=Ch:i===Eh||i===Ah?i=xh:(i=Ch,r=void 0);const u=i===Ch&&e[t+1].startsWith("/>")?" ":"";o+=i===xh?s+_h:c>=0?(n.push(a),s.slice(0,c)+mh+s.slice(c)+ph+u):s+ph+(-2===c?(n.push(void 0),t):u)}const a=o+(e[s]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==fh?fh.createHTML(a):a,n]};class Lh{constructor(e,t){let s,{strings:n,_$litType$:r}=e;this.parts=[];let o=0,i=0;const a=n.length-1,l=this.parts,[c,d]=Ph(n,r);if(this.el=Lh.createElement(c,t),Dh.currentNode=this.el.content,2===r){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(s=Dh.nextNode())&&l.length<a;){if(1===s.nodeType){if(s.hasAttributes()){const e=[];for(const t of s.getAttributeNames())if(t.endsWith(mh)||t.startsWith(ph)){const n=d[i++];if(e.push(t),void 0!==n){const e=s.getAttribute(n.toLowerCase()+mh).split(ph),t=/([.?@])?(.*)/.exec(n);l.push({type:1,index:o,name:t[2],strings:e,ctor:"."===t[1]?qh:"?"===t[1]?Gh:"@"===t[1]?Wh:Bh})}else l.push({type:6,index:o})}for(const t of e)s.removeAttribute(t)}if(kh.test(s.tagName)){const e=s.textContent.split(ph),t=e.length-1;if(t>0){s.textContent=hh?hh.emptyScript:"";for(let n=0;n<t;n++)s.append(e[n],yh()),Dh.nextNode(),l.push({type:2,index:++o});s.append(e[t],yh())}}}else if(8===s.nodeType)if(s.data===gh)l.push({type:2,index:o});else{let e=-1;for(;-1!==(e=s.data.indexOf(ph,e+1));)l.push({type:7,index:o}),e+=ph.length-1}o++}}static createElement(e,t){const s=vh.createElement("template");return s.innerHTML=e,s}}function zh(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3?arguments[3]:void 0;var r,o,i,a;if(t===Mh)return t;let l=void 0!==n?null===(r=s._$Co)||void 0===r?void 0:r[n]:s._$Cl;const c=bh(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(o=null==l?void 0:l._$AO)||void 0===o||o.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,s,n)),void 0!==n?(null!==(i=(a=s)._$Co)&&void 0!==i?i:a._$Co=[])[n]=l:s._$Cl=l),void 0!==l&&(t=zh(e,l._$AS(e,t.values),l,n)),t}class Fh{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:s},parts:n}=this._$AD,r=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:vh).importNode(s,!0);Dh.currentNode=r;let o=Dh.nextNode(),i=0,a=0,l=n[0];for(;void 0!==l;){if(i===l.index){let t;2===l.type?t=new Uh(o,o.nextSibling,this,e):1===l.type?t=new l.ctor(o,l.name,l.strings,this,e):6===l.type&&(t=new Vh(o,this,e)),this._$AV.push(t),l=n[++a]}i!==(null==l?void 0:l.index)&&(o=Dh.nextNode(),i++)}return Dh.currentNode=vh,r}v(e){let t=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}}class Uh{constructor(e,t,s,n){var r;this.type=2,this._$AH=$h,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=n,this._$Cp=null===(r=null==n?void 0:n.isConnected)||void 0===r||r}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e){e=zh(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),bh(e)?e===$h||null==e||""===e?(this._$AH!==$h&&this._$AR(),this._$AH=$h):e!==this._$AH&&e!==Mh&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):wh(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==$h&&bh(this._$AH)?this._$AA.nextSibling.data=e:this.$(vh.createTextNode(e)),this._$AH=e}g(e){var t;const{values:s,_$litType$:n}=e,r="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=Lh.createElement(n.h,this.options)),n);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===r)this._$AH.v(s);else{const e=new Fh(r,this),t=e.u(this.options);e.v(s),this.$(t),this._$AH=e}}_$AC(e){let t=Rh.get(e.strings);return void 0===t&&Rh.set(e.strings,t=new Lh(e)),t}T(e){jh(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let s,n=0;for(const r of e)n===t.length?t.push(s=new Uh(this.k(yh()),this.k(yh()),this,this.options)):s=t[n],s._$AI(r),n++;n<t.length&&(this._$AR(s&&s._$AB.nextSibling,n),t.length=n)}_$AR(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,t=arguments.length>1?arguments[1]:void 0;var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class Bh{constructor(e,t,s,n,r){this.type=1,this._$AH=$h,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=r,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=$h}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const r=this.strings;let o=!1;if(void 0===r)e=zh(this,e,t,0),o=!bh(e)||e!==this._$AH&&e!==Mh,o&&(this._$AH=e);else{const n=e;let i,a;for(e=r[0],i=0;i<r.length-1;i++)a=zh(this,n[s+i],t,i),a===Mh&&(a=this._$AH[i]),o||(o=!bh(a)||a!==this._$AH[i]),a===$h?e=$h:e!==$h&&(e+=(null!=a?a:"")+r[i+1]),this._$AH[i]=a}o&&!n&&this.j(e)}j(e){e===$h?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class qh extends Bh{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===$h?void 0:e}}const Hh=hh?hh.emptyScript:"";class Gh extends Bh{constructor(){super(...arguments),this.type=4}j(e){e&&e!==$h?this.element.setAttribute(this.name,Hh):this.element.removeAttribute(this.name)}}class Wh extends Bh{constructor(e,t,s,n,r){super(e,t,s,n,r),this.type=5}_$AI(e){var t;if((e=null!==(t=zh(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==t?t:$h)===Mh)return;const s=this._$AH,n=e===$h&&s!==$h||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,r=e!==$h&&(s===$h||n);n&&this.element.removeEventListener(this.name,this,s),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,s;"function"==typeof this._$AH?this._$AH.call(null!==(s=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==s?s:this.element,e):this._$AH.handleEvent(e)}}class Vh{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){zh(this,e)}}const Jh=uh.litHtmlPolyfillSupport;var Qh,Yh;null==Jh||Jh(Lh,Uh),(null!==(dh=uh.litHtmlVersions)&&void 0!==dh?dh:uh.litHtmlVersions=[]).push("2.7.4");class Kh extends ch{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const s=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=s.firstChild),s}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,s)=>{var n,r;const o=null!==(n=null==s?void 0:s.renderBefore)&&void 0!==n?n:t;let i=o._$litPart$;if(void 0===i){const e=null!==(r=null==s?void 0:s.renderBefore)&&void 0!==r?r:null;o._$litPart$=i=new Uh(t.insertBefore(yh(),e),e,void 0,null!=s?s:{})}return i._$AI(e),i})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return Mh}}Kh.finalized=!0,Kh._$litElement$=!0,null===(Qh=globalThis.litElementHydrateSupport)||void 0===Qh||Qh.call(globalThis,{LitElement:Kh});const Xh=globalThis.litElementPolyfillSupport;null==Xh||Xh({LitElement:Kh}),(null!==(Yh=globalThis.litElementVersions)&&void 0!==Yh?Yh:globalThis.litElementVersions=[]).push("3.3.2");const Zh=Object.assign(window.converse||{},{CHAT_STATES:["active","composing","gone","inactive","paused"],keycodes:{TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,FORWARD_SLASH:47,AT:50,META:91,META_RIGHT:93},async initialize(e){const{api:t}=td;if(await bd(td),"onpagehide"in window?td.unloadevent="pagehide":"onbeforeunload"in window?td.unloadevent="beforeunload":"onunload"in window&&(td.unloadevent="unload"),function(e){Hc=e,Bc={},Object.assign(Bc,zs);const t=Cl(e,Object.keys(Uc));Object.assign(Bc,Uc,t)}(e),td.strict_plugin_dependencies=e.strict_plugin_dependencies,De.setLogLevel(t.settings.get("loglevel")),t.settings.get("authentication")===be&&t.settings.get("auto_login")&&!t.settings.get("jid"))throw new Error("Config Error: you need to provide the server's domain via the 'jid' option when using anonymous authentication with auto_login.");td.router.route(/^converse\?loglevel=(debug|info|warn|error|fatal)$/,"loglevel",(e=>De.setLogLevel(e))),td.connfeedback=new Ad,td.send_initial_presence=!0,await async function(e){await _l.sessionStorageInitialized,e.storage={session:_l.localForage.createInstance({name:e.isTestEnv()?"converse-test-session":"converse-session",description:"sessionStorage instance",driver:["sessionStorageWrapper"]})}}(td),await async function(e){const t="converse.client-config";e.config=new nc({id:t,trusted:!0}),e.config.browserStorage=Xc(t,"session"),await new Promise((t=>e.config.fetch({success:t,error:t}))),e.api.trigger("clientConfigInitialized")}(td),await Oe.initialize(),function(e){e.pluggable.initialized_plugins=[];const t=Ce.concat(e.api.settings.get("whitelisted_plugins"));e.api.settings.get("singleton")&&["converse-bookmarks","converse-controlbox","converse-headline","converse-register"].forEach((t=>e.api.settings.get("blacklisted_plugins").push(t))),e.pluggable.initializePlugins({_converse:e},t,e.api.settings.get("blacklisted_plugins")),e.api.trigger("pluginsInitialized")}(td),t.elements?.register(),function(e){document.addEventListener("visibilitychange",zc),zc({type:document.hidden?"blur":"focus"}),e.api.trigger("registeredGlobalEventHandlers")}(td);try{!History.started&&td.router.history.start()}catch(e){De.error(e)}const s=td.pluggable.plugins;if((t.settings.get("auto_login")||t.settings.get("keepalive")&&s["converse-bosh"]?.enabled())&&await t.user.login(null,null,!0),t.trigger("initialized"),td.isTestEnv())return td},plugins:{add(e,t){if(t.__name__=e,void 0!==td.pluggable.plugins[e])throw new TypeError(`Error: plugin with name "${e}" has already been registered!`);td.pluggable.plugins[e]=t}},env:{$build:m,$iq:g,$msg:p,$pres:_,utils:Fc,Collection:gu,Model:nc,Promise,Strophe:_e,TimeoutError:od,URI:mc(),VERSION_NAME:ve,dayjs:Td(),filesize:Vu,html:Oh,log:De,sizzle:Nl(),sprintf:Ne.sprintf,stx:ac,u:Fc}}),ef={connection:sd,settings:Jc,...id,...Ed,...nd,...rd},tf=nc.extend({initialize(){this.rosterContactAdded=ol()},async setRosterContact(e){const t=await ef.contacts.get(e);t&&(this.contact=t,this.set("nickname",t.get("nickname")),this.rosterContactAdded.resolve())}}),sf=tf,nf=function(e,t){return e===t||kr(e,t,Or(t))},{u:rf}=Zh.env;async function of(e,t){if(!t.replace_id||!t.from)return;const s="groupchat"===t.type&&t.occupant_id?e=>{let{attributes:s}=e;return s.msgid===t.replace_id&&s.occupant_id==t.occupant_id}:e=>{let{attributes:s}=e;return s.msgid===t.replace_id&&s.from===t.from&&null==s.occupant_id},n=e.messages.models.find(s);if(!n)return t.older_versions={},await e.createMessage(t);const r=n.get("older_versions")||{};return t.time<n.get("time")&&n.get("edited")?(r[t.time]=t.message,n.save({older_versions:r})):(Object.keys(r).length?r[n.get("edited")]=n.getMessageText():r[n.get("time")]=n.getMessageText(),delete(t=Object.assign(t,{older_versions:r})).msgid,delete t.id,t.time=n.get("time"),n.save(t)),n}const af=dd((function(e){const t=ef.settings.get("prune_messages_above");if(t&&"number"==typeof t&&e.messages.length>t){const s=e.messages.filter((e=>!rf.isEmptyMessage(e)));if(s.length>t){for(;s.length>t;)s.shift().destroy();ef.trigger("historyPruned",e)}}}),500),lf=Zh.env.utils;function cf(e,t){ef.send(p({to:e.getAttribute("from"),type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("not-allowed",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).t(t)),De.warn(`Rejecting message stanza with the following reason: ${t}`),De.warn(e)}function df(e,t,s,n){const r=p({from:td.connection.jid,id:lf.getUniqueId(),to:e,type:n||"chat"}).c(s,{xmlns:_e.NS.MARKERS,id:t});ef.send(r)}const{NS:uf}=_e;class hf extends Error{constructor(e,t){super(e,t),this.name="StanzaParseError",this.stanza=t}}function ff(e,t){const s={},n=Nl()(`stanza-id[xmlns="${_e.NS.SID}"]`,e).reduce(((e,t)=>(e[`stanza_id ${t.getAttribute("by")}`]=t.getAttribute("id"),e)),{});Object.assign(s,n);const r=Nl()(`message > result[xmlns="${_e.NS.MAM}"]`,t).pop();r&&(s[`stanza_id ${t.getAttribute("from")||td.bare_jid}`]=r.getAttribute("id"));const o=Nl()(`origin-id[xmlns="${_e.NS.SID}"]`,e).pop();return o&&(s.origin_id=o.getAttribute("id")),s}function mf(e){const t=Nl()(`encryption[xmlns="${_e.NS.EME}"]`,e).pop(),s=t?.getAttribute("namespace"),n={};return s?(n.is_encrypted=!0,n.encryption_namespace=s):Nl()(`encrypted[xmlns="${_e.NS.OMEMO}"]`,e).pop()&&(n.is_encrypted=!0,n.encryption_namespace=_e.NS.OMEMO),n}function pf(e,t){const s=Nl()(`> apply-to[xmlns="${_e.NS.FASTEN}"]`,e).pop();if(s){const e=s.getAttribute("id");if(Nl()(`> retract[xmlns="${_e.NS.RETRACT}"]`,s).pop()){const s=Nl()(`delay[xmlns="${_e.NS.DELAY}"]`,t).pop();return{editable:!1,retracted:s?Td()(s.getAttribute("stamp")).toISOString():(new Date).toISOString(),retracted_id:e}}}else{const t=Nl()(`> retracted[xmlns="${_e.NS.RETRACT}"]`,e).pop();if(t)return{editable:!1,is_tombstone:!0,retracted:t.getAttribute("stamp")}}return{}}function gf(e,t){const s=Nl()(`replace[xmlns="${_e.NS.MESSAGE_CORRECT}"]`,e).pop();if(s){const e=s.getAttribute("id");if(e){const s=Nl()(`delay[xmlns="${_e.NS.DELAY}"]`,t).pop();return{replace_id:e,edited:s?Td()(s.getAttribute("stamp")).toISOString():(new Date).toISOString()}}}return{}}function _f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=[];if(!e)return{};try{mc().withinString(e,((e,n,r)=>(e.startsWith("_")&&(e=e.slice(1),n+=1),e.endsWith("_")&&(e=e.slice(0,e.length-1),r-=1),s.push({url:e,start:n+t,end:r+t}),e)),Te)}catch(e){De.debug(e)}const n=s.map((e=>{return{end:e.end,is_audio:jc(e.url),is_image:Sc(e.url),is_video:wc(e.url),is_encrypted:(t=e.url,t.startsWith("aesgcm://")),start:e.start};var t}));return n.length?{media_urls:n}:{}}function vf(e){const t=Nl()(`spoiler[xmlns="${_e.NS.SPOILER}"]`,e).pop();return{is_spoiler:!!t,spoiler_hint:t?.textContent}}function yf(e){const t=Nl()(`x[xmlns="${_e.NS.OUTOFBAND}"]`,e).pop();return t?{oob_url:t.querySelector("url")?.textContent,oob_desc:t.querySelector("desc")?.textContent}:{}}function bf(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error"),s=Nl()(`text[xmlns="${_e.NS.STANZAS}"]`,t).pop();return{is_error:!0,error_text:s?.textContent,error_type:t.getAttribute("type"),error_condition:t.firstElementChild.nodeName}}return{}}function jf(e){return Nl()(`reference[xmlns="${_e.NS.REFERENCE}"]`,e).map((t=>{const s=t.getAttribute("anchor"),n=e.querySelector(s?`#${s}`:"body")?.textContent;if(!n)return De.warn(`Could not find referenced text for ${t}`),null;const r=t.getAttribute("begin"),o=t.getAttribute("end");return{begin:r,end:o,type:t.getAttribute("type"),value:n.slice(r,o),uri:t.getAttribute("uri")}})).filter((e=>e))}function wf(e){const t=Nl()(`received[xmlns="${_e.NS.RECEIPTS}"]`,e).pop();return t?.getAttribute("id")}function Sf(e){const t=_e.NS.CARBONS;return Nl()(`message > received[xmlns="${t}"]`,e).length>0||Nl()(`message > sent[xmlns="${t}"]`,e).length>0}function xf(e){return Nl()(`\n        composing[xmlns="${uf.CHATSTATES}"],\n        paused[xmlns="${uf.CHATSTATES}"],\n        inactive[xmlns="${uf.CHATSTATES}"],\n        active[xmlns="${uf.CHATSTATES}"],\n        gone[xmlns="${uf.CHATSTATES}"]`,e).pop()?.nodeName}function Ef(e,t){return"me"!==t.sender&&!t.is_carbon&&!t.is_archived&&Nl()(`request[xmlns="${_e.NS.RECEIPTS}"]`,e).length}function Af(e){if(Nl()(`message > forwarded[xmlns="${_e.NS.FORWARD}"]`,e).length){cf(e,"Forwarded messages not part of an encapsulating protocol are not supported");const t=e.getAttribute("from");throw new hf(`Ignoring unencapsulated forwarded message from ${t}`,e)}}function Cf(e){return Nl()(`\n        acknowledged[xmlns="${_e.NS.MARKERS}"],\n        displayed[xmlns="${_e.NS.MARKERS}"],\n        received[xmlns="${_e.NS.MARKERS}"]`,e).pop()}function Tf(e){return"headline"===e.getAttribute("type")}function If(e){if(Nl()(`mentions[xmlns="${_e.NS.MENTIONS}"]`,e).pop())return!1;const t=e.getAttribute("from");return!("error"===e.getAttribute("type")||!t||t.includes("@"))}function kf(e){return!!Nl()(`message > result[xmlns="${_e.NS.MAM}"]`,e).pop()}function Nf(e){return e.getAttributeNames().reduce(((t,s)=>(t[s]=_e.xmlunescape(e.getAttribute(s)),t)),{})}const{Strophe:Of,sizzle:Mf}=Zh.env;async function $f(e){Af(e);let t=e.getAttribute("to");const s=Of.getResourceFromJid(t);if(ef.settings.get("filter_by_resource")&&s&&s!==td.resource)return new hf(`Ignoring incoming message intended for a different resource: ${t}`,e);const n=e;let r=e.getAttribute("from")||td.bare_jid;if(Sf(e)){if(r!==td.bare_jid)return cf(e,"Rejecting carbon from invalid JID"),new hf(`Rejecting carbon from invalid JID ${t}`,e);{const s=`[xmlns="${Of.NS.CARBONS}"] > forwarded[xmlns="${Of.NS.FORWARD}"] > message`;t=(e=Mf(s,e).pop()).getAttribute("to"),r=e.getAttribute("from")}}const o=kf(e);if(o){if(r!==td.bare_jid)return new hf(`Invalid Stanza: alleged MAM message from ${e.getAttribute("from")}`,e);{const s=`[xmlns="${Of.NS.MAM}"] > forwarded[xmlns="${Of.NS.FORWARD}"] > message`;t=(e=Mf(s,e).pop()).getAttribute("to"),r=e.getAttribute("from")}}const i=Of.getBareJidFromJid(r),a=i===td.bare_jid;if(a&&null===t)return new hf(`Don't know how to handle message stanza without 'to' attribute. ${e.outerHTML}`,e);const l=Tf(e),c=If(e);let d,u;if(!l&&!c&&(u=a?Of.getBareJidFromJid(t):i,d=await ef.contacts.get(u),void 0===d&&!ef.settings.get("allow_non_roster_messaging")))return De.error(e),new hf("Blocking messaging with a JID not in our roster because allow_non_roster_messaging is false.",e);const h=Mf(`delay[xmlns="${Of.NS.DELAY}"]`,n).pop(),f=Cf(e),m=(new Date).toISOString();let p=Object.assign({contact_jid:u,is_archived:o,is_headline:l,is_server_message:c,body:e.querySelector("body")?.textContent?.trim(),chat_state:xf(e),from:Of.getBareJidFromJid(e.getAttribute("from")),is_carbon:Sf(n),is_delayed:!!h,is_markable:!!Mf(`markable[xmlns="${Of.NS.MARKERS}"]`,e).length,is_marker:!!f,is_unstyled:!!Mf(`unstyled[xmlns="${Of.NS.STYLING}"]`,e).length,marker_id:f&&f.getAttribute("id"),msgid:e.getAttribute("id")||n.getAttribute("id"),nick:d?.attributes?.nickname,receipt_id:wf(e),received:(new Date).toISOString(),references:jf(e),sender:a?"me":"them",subject:e.querySelector("subject")?.textContent,thread:e.querySelector("thread")?.textContent,time:h?Td()(h.getAttribute("stamp")).toISOString():m,to:e.getAttribute("to"),type:e.getAttribute("type")||"normal"},bf(e),yf(e),vf(e),gf(e,n),ff(e,n),pf(e,n),mf(e));if(p.is_archived){const t=n.getAttribute("from");if(t&&t!==td.bare_jid)return new hf(`Invalid Stanza: Forged MAM message from ${t}`,e)}return await ef.emojis.initialize(),p=Object.assign({message:p.body||p.error,is_only_emojis:!!p.body&&Fc.isOnlyEmojis(p.body),is_valid_receipt_request:Ef(e,p)},p),p.id=p.origin_id||p[`stanza_id ${p.from}`]||Fc.getUniqueId(),p=await ef.hook("parseMessage",e,p),Object.assign(p,_f(p.is_encrypted?p.plaintext:p.body))}const{Strophe:Rf,$msg:Df}=Zh.env,Pf=Zh.env.utils,Lf=sf.extend({defaults(){return{bookmarked:!1,chat_state:void 0,hidden:Ac()&&!ef.settings.get("singleton"),message_type:"chat",nickname:void 0,num_unread:0,time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:td.PRIVATE_CHAT_TYPE,url:""}},async initialize(){this.initialized=ol(),sf.prototype.initialize.apply(this,arguments);const e=this.get("jid");e&&(this.set({box_id:`box-${e}`}),this.initNotifications(),this.initUI(),this.initMessages(),this.get("type")===td.PRIVATE_CHAT_TYPE&&(this.presence=td.presences.get(e)||td.presences.create({jid:e}),await this.setRosterContact(e),this.presence.on("change:show",(e=>this.onPresenceChanged(e)))),this.on("change:chat_state",this.sendChatState,this),this.ui.on("change:scrolled",this.onScrolledChanged,this),await this.fetchMessages(),await ef.trigger("chatBoxInitialized",this,{Synchronous:!0}),this.initialized.resolve())},getMessagesCollection:()=>new td.Messages,getMessagesCacheKey(){return`converse.messages-${this.get("jid")}-${td.bare_jid}`},initMessages(){this.messages=this.getMessagesCollection(),this.messages.fetched=ol(),this.messages.chatbox=this,Zc(this.messages,this.getMessagesCacheKey()),this.listenTo(this.messages,"change:upload",this.onMessageUploadChanged,this),this.listenTo(this.messages,"add",this.onMessageAdded,this)},initUI(){this.ui=new nc},initNotifications(){this.notifications=new nc},getNotificationsText(){const{__:e}=td;return this.notifications?.get("chat_state")===td.COMPOSING?e("%1$s is typing",this.getDisplayName()):this.notifications?.get("chat_state")===td.PAUSED?e("%1$s has stopped typing",this.getDisplayName()):this.notifications?.get("chat_state")===td.GONE?e("%1$s has gone away",this.getDisplayName()):""},afterMessagesFetched(){this.pruneHistoryWhenScrolledDown(),ef.trigger("afterMessagesFetched",this)},fetchMessages(){if(this.messages.fetched_flag)return void De.info(`Not re-fetching messages for ${this.get("jid")}`);this.messages.fetched_flag=!0;const e=this.messages.fetched.resolve;return this.messages.fetch({add:!0,success:t=>{this.afterMessagesFetched(t),e()},error:()=>{this.afterMessagesFetched(),e()}}),this.messages.fetched},async handleErrorMessageStanza(e){const{__:t}=td,s=await $f(e);if(!await this.shouldShowErrorMessage(s))return;const n=this.getMessageReferencedByError(s);if(n){const e={error:s.error,error_condition:s.error_condition,error_text:s.error_text,error_type:s.error_type,editable:!1};s.msgid===n.get("retraction_id")?(e.retraction_id=void 0,s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to retract your message."):e.error=t("Sorry, an error occurred while trying to retract your message."))):s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to send a message."):e.error=t("Sorry, an error occurred while trying to send your message.")),n.save(e)}else this.createMessage(s)},queueMessage(e){return this.msg_chain=(this.msg_chain||this.messages.fetched).then((()=>this.onMessage(e))).catch((e=>De.error(e))),this.msg_chain},async onMessage(e){if(e=await e,Pf.isErrorObject(e))return e.stanza&&De.error(e.stanza),De.error(e.message);const t=this.getDuplicateMessage(e);if(t)this.updateMessage(t,e);else if(!this.handleReceipt(e)&&!this.handleChatMarker(e)&&!await this.handleRetraction(e)&&(this.setEditable(e,e.time),e.chat_state&&"them"===e.sender&&this.notifications.set("chat_state",e.chat_state),Pf.shouldCreateMessage(e))){const t=await of(this,e)||await this.createMessage(e);this.notifications.set({chat_state:null}),this.handleUnreadMessage(t)}},async onMessageUploadChanged(e){if(e.get("upload")===td.SUCCESS){const t={body:e.get("body"),spoiler_hint:e.get("spoiler_hint"),oob_url:e.get("oob_url")};await this.sendMessage(t),e.destroy()}},onMessageAdded(e){!ef.settings.get("prune_messages_above")||"scrolled"!==ef.settings.get("pruning_behavior")&&this.ui.get("scrolled")||Ec(e)||af(this)},async clearMessages(){try{await this.messages.clearStore()}catch(e){this.messages.trigger("reset"),De.error(e)}finally{this.messages.fetched.resolve()}},async close(){ef.connection.connected()&&(this.setChatState(td.INACTIVE),this.sendChatState());try{await new Promise(((e,t)=>this.destroy({success:e,error:(e,s)=>t(s)})))}catch(e){De.error(e)}finally{ef.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()}ef.trigger("chatBoxClosed",this)},announceReconnection(){ef.trigger("chatReconnected",this)},async onReconnection(){ef.settings.get("clear_messages_on_reconnection")&&await this.clearMessages(),this.announceReconnection()},onPresenceChanged(e){const{__:t}=td,s=e.get("show"),n=this.getDisplayName();let r;"offline"===s?r=t("%1$s has gone offline",n):"away"===s?r=t("%1$s has gone away",n):"dnd"===s?r=t("%1$s is busy",n):"online"===s&&(r=t("%1$s is online",n)),r&&this.createMessage({message:r,type:"info"})},onScrolledChanged(){this.ui.get("scrolled")||(this.clearUnreadMsgCounter(),this.pruneHistoryWhenScrolledDown())},pruneHistoryWhenScrolledDown(){ef.settings.get("prune_messages_above")&&"unscrolled"===ef.settings.get("pruning_behavior")&&!this.ui.get("scrolled")&&af(this)},validate(e){if(!e.jid)return"Ignored ChatBox without JID";const t=ef.settings.get("auto_join_rooms").map((e=>e instanceof Object?e.jid:e)),s=ef.settings.get("auto_join_private_chats").concat(t);if(ef.settings.get("singleton")&&!s.includes(e.jid)&&!ef.settings.get("auto_join_on_invite")){const t=`${e.jid} is not allowed because singleton is true and it's not being auto_joined`;return De.warn(t),t}},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("jid")},async createMessageFromError(e){e instanceof od&&((await this.createMessage({type:"error",message:e.message,retry_event_id:e.retry_event_id,is_ephemeral:3e4})).error=e)},editEarlierMessage(){let e,t=this.messages.findLastIndex("correcting");if(t>=0)for(this.messages.at(t).save("correcting",!1);t>0;){t-=1;const s=this.messages.at(t);if(s.get("editable")){e=s;break}}e=e||this.messages.filter({sender:"me"}).reverse().find((e=>e.get("editable"))),e&&e.save("correcting",!0)},editLaterMessage(){let e,t=this.messages.findLastIndex("correcting");if(t>=0)for(this.messages.at(t).save("correcting",!1);t<this.messages.length-1;){t+=1;const s=this.messages.at(t);if(s.get("editable")){e=s,e.save("correcting",!0);break}}return e},getOldestMessage(){for(let e=0;e<this.messages.length;e++){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getMostRecentMessage(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getUpdatedMessageAttributes:(e,t)=>t.error_type||"Decryption"!==e.get("error_type")?{is_archived:t.is_archived}:Object.assign({},t,{error_condition:void 0,error_message:void 0,error_text:void 0,error_type:void 0,is_archived:t.is_archived,is_ephemeral:!1,is_error:!1}),updateMessage(e,t){const s=this.getUpdatedMessageAttributes(e,t);s&&e.save(s)},setChatState(e,t){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),e===td.COMPOSING?this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),td.TIMEOUTS.PAUSED,td.PAUSED):e===td.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),td.TIMEOUTS.INACTIVE,td.INACTIVE)),this.set("chat_state",e,t),this},getMessageReferencedByError(e){const t=e.msgid;return t&&this.messages.models.find((e=>[e.get("msgid"),e.get("retraction_id")].includes(t)))},shouldShowErrorMessage(e){if(this.getMessageReferencedByError(e)||!e.chat_state)return!0},isSameUser:(e,t)=>Pf.isSameBareJID(e,t),findDanglingRetraction(e){if(!e.origin_id||!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models);return t.reverse(),t.find((t=>{let{attributes:s}=t;return s.retracted_id===e.origin_id&&s.from===e.from&&!s.moderated_by}))}},async handleRetraction(e){const t=["retracted","retracted_id","editable"];if(e.retracted){if(e.is_tombstone)return!1;const s=this.messages.findWhere({origin_id:e.retracted_id,from:e.from});return s?(s.save(Cl(e,t)),!0):(e.dangling_retraction=!0,await this.createMessage(e),!0)}{const s=this.findDanglingRetraction(e);if(s){const n=Cl(s.attributes,t),r=Object.assign({dangling_retraction:!1},e,n);return delete r.id,s.save(r),!0}}return!1},getDuplicateMessage(e){const t=[...this.getStanzaIdQueryAttrs(e),this.getOriginIdQueryAttrs(e),this.getMessageBodyQueryAttrs(e)].filter((e=>e));return this.messages.models.find((e=>t.reduce(((t,s)=>t||nf(e.attributes,s)),!1)))},getOriginIdQueryAttrs:e=>e.origin_id&&{origin_id:e.origin_id,from:e.from},getStanzaIdQueryAttrs(e){const t=Object.keys(e).filter((e=>e.startsWith("stanza_id ")));return t.map((t=>{const s={};return s[`stanza_id ${t.replace(/^stanza_id /,"")}`]=e[t],s}))},getMessageBodyQueryAttrs(e){if(e.msgid){const t={from:e.from,msgid:e.msgid};return!e.is_encrypted&&e.body&&(t.body=e.body),t}},retractOwnMessage(e){this.sendRetractionMessage(e),e.save({retracted:(new Date).toISOString(),retracted_id:e.get("origin_id"),retraction_id:e.get("id"),is_ephemeral:!0,editable:!1})},sendRetractionMessage(e){const t=e.get("origin_id");if(!t)throw new Error("Can't retract message without a XEP-0359 Origin ID");const s=Df({id:Pf.getUniqueId(),to:this.get("jid"),type:"chat"}).c("store",{xmlns:Rf.NS.HINTS}).up().c("apply-to",{id:t,xmlns:Rf.NS.FASTEN}).c("retract",{xmlns:Rf.NS.RETRACT});return td.connection.send(s)},sendMarkerForLastMessage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"displayed",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=Array.from(this.messages.models);s.reverse();const n=s.find((e=>"them"===e.get("sender")&&(t||e.get("is_markable"))));n&&this.sendMarkerForMessage(n,e,t)},sendMarkerForMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"displayed",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&ef.settings.get("send_chat_markers").includes(t)&&(e?.get("is_markable")||s)&&df(Rf.getBareJidFromJid(e.get("from")),e.get("msgid"),t,e.get("type"))},handleChatMarker(e){if(Rf.getBareJidFromJid(e.to)!==td.bare_jid)return!1;if(e.is_markable)return!this.contact||e.is_archived||e.is_carbon||df(e.from,e.msgid,"received"),!1;if(e.marker_id){const t=this.messages.findWhere({msgid:e.marker_id}),s=`marker_${e.marker}`;return t&&!t.get(s)&&t.save({field_name:(new Date).toISOString()}),!0}},sendReceiptStanza(e,t){const s=Df({from:td.connection.jid,id:Pf.getUniqueId(),to:e,type:"chat"}).c("received",{xmlns:Rf.NS.RECEIPTS,id:t}).up().c("store",{xmlns:Rf.NS.HINTS}).up();ef.send(s)},handleReceipt(e){if("them"===e.sender)if(e.is_valid_receipt_request)this.sendReceiptStanza(e.from,e.msgid);else if(e.receipt_id){const t=this.messages.findWhere({msgid:e.receipt_id});return t&&!t.get("received")&&t.save({received:(new Date).toISOString()}),!0}return!1},async createMessageStanza(e){const t=Df({from:td.connection.jid,to:this.get("jid"),type:this.get("message_type"),id:e.get("edited")&&Pf.getUniqueId()||e.get("msgid")}).c("body").t(e.get("body")).up().c(td.ACTIVE,{xmlns:Rf.NS.CHATSTATES}).root();return"chat"===e.get("type")&&t.c("request",{xmlns:Rf.NS.RECEIPTS}).root(),e.get("is_encrypted")||(e.get("is_spoiler")&&(e.get("spoiler_hint")?t.c("spoiler",{xmlns:Rf.NS.SPOILER},e.get("spoiler_hint")).root():t.c("spoiler",{xmlns:Rf.NS.SPOILER}).root()),(e.get("references")||[]).forEach((e=>{const s={xmlns:Rf.NS.REFERENCE,begin:e.begin,end:e.end,type:e.type};e.uri&&(s.uri=e.uri),t.c("reference",s).root()})),e.get("oob_url")&&t.c("x",{xmlns:Rf.NS.OUTOFBAND}).c("url").t(e.get("oob_url")).root()),e.get("edited")&&t.c("replace",{xmlns:Rf.NS.MESSAGE_CORRECT,id:e.get("msgid")}).root(),e.get("origin_id")&&t.c("origin-id",{xmlns:Rf.NS.SID,id:e.get("origin_id")}).root(),t.root(),(await ef.hook("createMessageStanza",this,{message:e,stanza:t})).stanza},async getOutgoingMessageAttributes(e){await ef.emojis.initialize();const t=!!this.get("composing_spoiler"),s=Pf.getUniqueId(),n=e?.body,r=n?Pf.shortnamesToUnicode(n):void 0;return e=Object.assign({},e,{from:td.bare_jid,fullname:td.xmppstatus.get("fullname"),id:s,is_only_emojis:!!n&&Pf.isOnlyEmojis(n),jid:this.get("jid"),message:r,msgid:s,nickname:this.get("nickname"),sender:"me",time:(new Date).toISOString(),type:this.get("message_type"),body:r,is_spoiler:t,origin_id:s},_f(n)),e=await ef.hook("getOutgoingMessageAttributes",this,e)},setEditable(e,t){e.is_headline||Ec(e)||"me"!==e.sender||("all"===ef.settings.get("allow_message_corrections")?e.editable=!(e.file||e.retracted||"oob_url"in e):"last"===ef.settings.get("allow_message_corrections")&&t>this.get("time_sent")&&(this.set({time_sent:t}),this.messages.findWhere({editable:!0})?.save({editable:!1}),e.editable=!(e.file||e.retracted||"oob_url"in e)))},async createMessage(e,t){return e.time=e.time||(new Date).toISOString(),await this.messages.fetched,this.messages.create(e,t)},async sendMessage(e){e=await this.getOutgoingMessageAttributes(e);let t=this.messages.findWhere("correcting");if(t){const s=t.get("older_versions")||{};s[t.get("edited")||t.get("time")]=t.getMessageText(),t.save({...Cl(e,["body","is_only_emojis","media_urls","references","is_encrypted"]),correcting:!1,edited:(new Date).toISOString(),message:e.body,ogp_metadata:[],origin_id:Pf.getUniqueId(),received:void 0,older_versions:s,plaintext:e.is_encrypted?e.message:void 0})}else this.setEditable(e,(new Date).toISOString()),t=await this.createMessage(e);try{const e=await this.createMessageStanza(t);ef.send(e)}catch(e){return t.destroy(),void De.error(e)}return ef.trigger("sendMessage",{chatbox:this,message:t}),t},sendChatState(){if(ef.settings.get("send_chat_state_notifications")&&this.get("chat_state")){const e=ef.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;ef.send(Df({id:Pf.getUniqueId(),to:this.get("jid"),type:"chat"}).c(this.get("chat_state"),{xmlns:Rf.NS.CHATSTATES}).up().c("no-store",{xmlns:Rf.NS.HINTS}).up().c("no-permanent-store",{xmlns:Rf.NS.HINTS}))}},async sendFiles(e){const{__:t}=td,s=(await ef.disco.features.get(Rf.NS.HTTPUPLOAD,td.domain)).pop();if(!s)return void this.createMessage({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0});const n=s.dataforms.where({FORM_TYPE:{value:Rf.NS.HTTPUPLOAD,type:"hidden"}}).pop(),r=window.parseInt((n?.attributes||{})["max-file-size"]?.value),o=s?.id;o?Array.from(e).forEach((async e=>{if(e=await ef.hook("beforeFileUpload",this,e),!window.isNaN(r)&&window.parseInt(e.size)>r)return this.createMessage({message:t("The size of your file, %1$s, exceeds the maximum allowed by your server, which is %2$s.",e.name,Vu(r)),type:"error",is_ephemeral:!0});{const t=await this.getOutgoingMessageAttributes(),s=Object.assign(t,{file:!0,progress:0,slot_request_url:o});this.setEditable(s,(new Date).toISOString());const n=await this.createMessage(s,{silent:!0});n.file=e,this.messages.trigger("add",n),n.getRequestSlotURL()}})):this.createMessage({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0})},maybeShow(e){if(!Ac())return Pf.safeSave(this,{hidden:!1}),this.trigger("show"),this;{const t=e=>!e.get("hidden")&&e.get("jid")!==this.get("jid")&&"controlbox"!==e.get("id"),s=td.chatboxes.filter(t);(e||0===s.length)&&(s.forEach((e=>Pf.safeSave(e,{hidden:!0}))),Pf.safeSave(this,{hidden:!1}))}},isHidden(){return this.get("hidden")||this.isScrolledUp()||"hidden"===td.windowState},handleUnreadMessage(e){e?.get("body")&&Pf.isNewMessage(e)&&("me"===e.get("sender")?this.ui.set("scrolled",!1):this.isHidden()?this.incrementUnreadMsgsCounter(e):this.sendMarkerForMessage(e))},incrementUnreadMsgsCounter(e){const t={num_unread:this.get("num_unread")+1};0===this.get("num_unread")&&(t.first_unread_id=e.get("id")),this.save(t)},clearUnreadMsgCounter(){this.get("num_unread")>0&&this.sendMarkerForMessage(this.messages.last()),Pf.safeSave(this,{num_unread:0})},isScrolledUp(){return this.ui.get("scrolled")}}),zf=Lf,{Strophe:Ff,sizzle:Uf,u:Bf}=Zh.env,qf={defaults:()=>({msgid:Bf.getUniqueId(),time:(new Date).toISOString(),is_ephemeral:!1}),async initialize(){this.checkValidity()&&(this.initialized=ol(),this.get("file")&&this.on("change:put",(()=>this.uploadFile())),this.on("change:type",(()=>this.setContact())),this.on("change:is_ephemeral",(()=>this.setTimerForEphemeralMessage())),await this.setContact(),this.setTimerForEphemeralMessage(),await ef.trigger("messageInitialized",this,{Synchronous:!0}),this.initialized.resolve())},setContact(){["chat","normal"].includes(this.get("type"))&&(sf.prototype.initialize.apply(this,arguments),this.setRosterContact(Ff.getBareJidFromJid(this.get("from"))))},setTimerForEphemeralMessage(){this.ephemeral_timer&&clearTimeout(this.ephemeral_timer);const e=this.isEphemeral();if(e){const t="number"==typeof e?e:1e4;this.ephemeral_timer=window.setTimeout((()=>this.safeDestroy()),t)}},checkValidity(){return 3!==Object.keys(this.attributes).length||(this.validationError="Empty message",this.safeDestroy(),!1)},mayBeRetracted(){const e="me"===this.get("sender"),t="cancel"!==this.get("error_type");return e&&t&&["all","own"].includes(ef.settings.get("allow_message_retraction"))},safeDestroy(){try{this.destroy()}catch(e){De.warn(`safeDestroy: ${e}`)}},isEphemeral(){return this.get("is_ephemeral")},isMeCommand(){const e=this.getMessageText();return!!e&&e.startsWith("/me ")},isFollowup(){const e=this.collection.models,t=e.indexOf(this),s=t?e[t-1]:null;if(null===s)return!1;const n=Td()(this.get("time"));return this.get("from")===s.get("from")&&!this.isMeCommand()&&!s.isMeCommand()&&!!this.get("is_encrypted")==!!s.get("is_encrypted")&&this.get("type")===s.get("type")&&"info"!==this.get("type")&&n.isBefore(Td()(s.get("time")).add(10,"minutes"))&&("groupchat"!==this.get("type")||this.get("occupant_id")===s.get("occupant_id"))},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("from")},getMessageText(){if(this.get("is_encrypted")){const{__:e}=td;return this.get("plaintext")||this.get("body")||e("Undecryptable OMEMO message")}return["groupchat","chat","normal"].includes(this.get("type"))?this.get("body"):this.get("message")},sendSlotRequestStanza(){if(!this.file)return Promise.reject(new Error("file is undefined"));const e=Zh.env.$iq({from:td.jid,to:this.get("slot_request_url"),type:"get"}).c("request",{xmlns:Ff.NS.HTTPUPLOAD,filename:this.file.name,size:this.file.size,"content-type":this.file.type});return ef.sendIQ(e)},getUploadRequestMetadata:e=>({headers:Uf(`slot[xmlns="${Ff.NS.HTTPUPLOAD}"] put header`,e).map((e=>({name:e.getAttribute("name"),value:e.textContent}))).filter((e=>["Authorization","Expires"].includes(e.name)))}),async getRequestSlotURL(){const{__:e}=td;let t;try{t=await this.sendSlotRequestStanza()}catch(t){return De.error(t),this.save({type:"error",message:e("Sorry, could not determine upload URL."),is_ephemeral:!0})}const s=Uf(`slot[xmlns="${Ff.NS.HTTPUPLOAD}"]`,t).pop();if(!s)return this.save({type:"error",message:e("Sorry, could not determine file upload URL."),is_ephemeral:!0});this.upload_metadata=this.getUploadRequestMetadata(t),this.save({get:s.querySelector("get").getAttribute("url"),put:s.querySelector("put").getAttribute("url")})},uploadFile(){const e=new XMLHttpRequest;e.onreadystatechange=async()=>{if(e.readyState===XMLHttpRequest.DONE)if(De.info("Status: "+e.status),200===e.status||201===e.status){let e={upload:td.SUCCESS,oob_url:this.get("get"),message:this.get("get"),body:this.get("get")};e=await ef.hook("afterFileUploaded",this,e),this.save(e)}else e.onerror()},e.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.set("progress",e.loaded/e.total)}),!1),e.onerror=()=>{const{__:t}=td;let s;s=e.responseText?t('Sorry, could not succesfully upload your file. Your servers response: "%1$s"',e.responseText):t("Sorry, could not succesfully upload your file."),this.save({type:"error",upload:td.FAILURE,message:s,is_ephemeral:!0})},e.open("PUT",this.get("put"),!0),e.setRequestHeader("Content-type",this.file.type),this.upload_metadata.headers?.forEach((t=>e.setRequestHeader(t.name,t.value))),e.send(this.file)}},Hf=qf,Gf={chats:{async create(e,t){if("string"==typeof e){if(t&&!t?.fullname){const s=await ef.contacts.get(e);t.fullname=s?.attributes?.fullname}const s=ef.chats.get(e,t,!0);return s||void De.error("Could not open chatbox for JID: "+e)}return Array.isArray(e)?Promise.all(e.forEach((async s=>{const n=await ef.contacts.get(e);return t.fullname=n?.attributes?.fullname,ef.chats.get(s,t,!0).maybeShow()}))):(De.error("chats.create: You need to provide at least one JID"),null)},async open(e,t,s){if("string"==typeof e){const n=await ef.chats.get(e,t,!0);return n?n.maybeShow(s):n}if(Array.isArray(e))return Promise.all(e.map((e=>ef.chats.get(e,t,!0).then((e=>e&&e.maybeShow(s))))).filter((e=>e)));const n="chats.open: You need to provide at least one JID";throw De.error(n),new Error(n)},async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];async function n(e){let n=await ef.chatboxes.get(e);return!n&&s?n=await ef.chatboxes.create(e,t,td.ChatBox):(n=n&&n.get("type")===td.PRIVATE_CHAT_TYPE?n:null,n&&Object.keys(t).length&&n.save(t)),n}return await ef.waitUntil("chatBoxesFetched"),void 0===e?(await ef.chatboxes.get()).filter((e=>e.get("type")===td.PRIVATE_CHAT_TYPE)):"string"==typeof e?n(e):Promise.all(e.map((e=>n(e))))}}},{Strophe:Wf,u:Vf}=Zh.env;function Jf(e){if(!Vf.isValidJID(e))return De.warn(`Invalid JID "${e}" provided in URL fragment`);ef.chats.open(e)}async function Qf(){if(Cc()){await Promise.all(td.chatboxes.map((e=>e.messages&&e.messages.clearStore({silent:!0}))));const e=e=>e.get("type")!==td.CONTROLBOX_TYPE;td.chatboxes.clearStore({silent:!0},e)}}function Yf(){ef.settings.get("auto_join_private_chats").forEach((e=>{td.chatboxes.where({jid:e}).length||("string"==typeof e?ef.chats.open(e):De.error('Invalid jid criteria specified for "auto_join_private_chats"'))})),ef.trigger("privateChatsAutoJoined")}function Kf(){td.connection.addHandler((e=>!!(["groupchat","error"].includes(e.getAttribute("type"))||Tf(e)||If(e)||kf(e))||td.handleMessageStanza(e)||!0),null,"message"),td.connection.addHandler((e=>async function(e){const t=Wf.getBareJidFromJid(e.getAttribute("from"));if(Vf.isSameBareJID(t,td.bare_jid))return;const s=await ef.chatboxes.get(t);s?.get("type")===td.PRIVATE_CHAT_TYPE&&s?.handleErrorMessageStanza(e)}(e)||!0),null,"message","error")}async function Xf(e){if(If(e=e.tree?.()??e)){const t=e.getAttribute("from");return De.info(`handleMessageStanza: Ignoring incoming server message from JID: ${t}`)}let t;try{t=await $f(e)}catch(e){return De.error(e)}if(Vf.isErrorObject(t))return t.stanza&&De.error(t.stanza),De.error(t.message);const s=!(!t.body&&!t.plaintext),n=await ef.chats.get(t.contact_jid,{nickname:t.nick},s);await(n?.queueMessage(t));const r={stanza:e,attrs:t,chatbox:n};ef.trigger("message",r)}async function Zf(){const e=Wf.getDomainFromJid(td.bare_jid);if(!await ef.disco.supports(Wf.NS.CARBONS,e))return void De.warn("Not enabling carbons because it's not supported!");const t=new Wf.Builder("iq",{from:td.connection.jid,type:"set"}).c("enable",{xmlns:Wf.NS.CARBONS}),s=await ef.sendIQ(t,null,!1);null===s?De.warn("A timeout occurred while trying to enable carbons"):Vf.isErrorStanza(s)?(De.warn("An error occurred while trying to enable message carbons."),De.error(s)):De.debug("Message carbons have been enabled.")}Zh.plugins.add("converse-chat",{dependencies:["converse-chatboxes","converse-disco"],initialize(){ef.settings.extend({allow_message_corrections:"all",allow_message_retraction:"all",allow_message_styling:!0,auto_join_private_chats:[],clear_messages_on_reconnection:!1,filter_by_resource:!1,prune_messages_above:void 0,pruning_behavior:"unscrolled",send_chat_markers:["received","displayed","acknowledged"],send_chat_state_notifications:!0}),td.Message=sf.extend(Hf),td.Messages=gu.extend({model:td.Message,comparator:"time"}),Object.assign(td,{ChatBox:zf,handleMessageStanza:Xf}),Object.assign(ef,Gf),td.router.route("converse/chat?jid=:jid",Jf),ef.listen.on("chatBoxesFetched",Yf),ef.listen.on("presencesInitialized",Kf),ef.listen.on("clearSession",Qf),ef.listen.on("connected",(()=>Zf())),ef.listen.on("reconnected",(()=>Zf()))}});const{Strophe:em}=Zh.env,tm=class extends nc{get idAttribute(){return"jid"}initialize(e,t){super.initialize(),this.waitUntilFeaturesDiscovered=ol(),this.dataforms=new gu;let s=`converse.dataforms-${this.get("jid")}`;this.dataforms.browserStorage=td.createStore(s,"session"),this.features=new gu,s=`converse.features-${this.get("jid")}`,this.features.browserStorage=td.createStore(s,"session"),this.listenTo(this.features,"add",this.onFeatureAdded),this.fields=new gu,s=`converse.fields-${this.get("jid")}`,this.fields.browserStorage=td.createStore(s,"session"),this.listenTo(this.fields,"add",this.onFieldAdded),this.identities=new gu,s=`converse.identities-${this.get("jid")}`,this.identities.browserStorage=td.createStore(s,"session"),this.fetchFeatures(t)}async getIdentity(e,t){return await this.waitUntilFeaturesDiscovered,this.identities.findWhere({category:e,type:t})}async getFeature(e){if(await this.waitUntilFeaturesDiscovered,this.features.findWhere({var:e}))return this}onFeatureAdded(e){e.entity=this,ef.trigger("serviceDiscovered",e)}onFieldAdded(e){e.entity=this,ef.trigger("discoExtensionFieldDiscovered",e)}async fetchFeatures(e){if(e.ignore_cache)this.queryInfo();else{const e=this.features.browserStorage.name,t=await this.features.browserStorage.store.getItem(e);t&&0===t.length||null===t?this.queryInfo():(this.features.fetch({add:!0,success:()=>{this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),this.identities.fetch({add:!0}))}}async queryInfo(){let e;try{e=await ef.disco.info(this.get("jid"),null)}catch(e){return null===e?De.error(`Timeout for disco#info query for ${this.get("jid")}`):De.error(e),void this.waitUntilFeaturesDiscovered.resolve(this)}this.onInfo(e)}onDiscoItems(e){Nl()(`query[xmlns="${em.NS.DISCO_ITEMS}"] item`,e).forEach((e=>{if(e.getAttribute("node"))return;const t=e.getAttribute("jid"),s=td.disco_entities.get(t);s?s.set({parent_jids:[this.get("jid")]}):ef.disco.entities.create({jid:t,parent_jids:[this.get("jid")],name:e.getAttribute("name")})}))}async queryForItems(){if(0===this.identities.where({category:"server"}).length)return;const e=await ef.disco.items(this.get("jid"));this.onDiscoItems(e)}async onInfo(e){Array.from(e.querySelectorAll("identity")).forEach((e=>{this.identities.create({category:e.getAttribute("category"),type:e.getAttribute("type"),name:e.getAttribute("name")})})),Nl()(`x[type="result"][xmlns="${em.NS.XFORM}"]`,e).forEach((e=>{const t={};Nl()("field",e).forEach((e=>{t[e.getAttribute("var")]={value:e.querySelector("value")?.textContent,type:e.getAttribute("type")}})),this.dataforms.create(t)})),e.querySelector(`feature[var="${em.NS.DISCO_ITEMS}"]`)&&await this.queryForItems(),Array.from(e.querySelectorAll("feature")).forEach((t=>{this.features.create({var:t.getAttribute("var"),from:e.getAttribute("from")})})),Nl()('x[type="result"][xmlns="jabber:x:data"] field',e).forEach((t=>{this.fields.create({var:t.getAttribute("var"),value:t.querySelector("value")?.textContent,from:e.getAttribute("from")})})),this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}},sm=gu.extend({model:tm,fetchEntities(){return new Promise(((e,t)=>{this.fetch({add:!0,success:e,error(e,s){De.error(s),t(new Error("Could not fetch disco entities"))}})}))}}),nm=sm,{Strophe:rm,$iq:om}=Zh.env,im={disco:{stream:{async getFeature(e,t){if(await ef.waitUntil("streamFeaturesAdded"),!e||!t)throw new Error("name and xmlns need to be provided when calling disco.stream.getFeature");if(void 0!==td.stream_features||ef.connection.connected())return td.stream_features.findWhere({name:e,xmlns:t});{const s=`Tried to get feature ${e} ${t} but _converse.stream_features has been torn down`;De.warn(s)}}},own:{identities:{add(e,t,s,n){for(var r=0;r<td.disco._identities.length;r++)if(td.disco._identities[r].category==e&&td.disco._identities[r].type==t&&td.disco._identities[r].name==s&&td.disco._identities[r].lang==n)return!1;td.disco._identities.push({category:e,type:t,name:s,lang:n})},clear(){td.disco._identities=[]},get:()=>td.disco._identities},features:{add(e){for(var t=0;t<td.disco._features.length;t++)if(td.disco._features[t]==e)return!1;td.disco._features.push(e)},clear(){td.disco._features=[]},get:()=>td.disco._features}},info(e,t){const s={xmlns:rm.NS.DISCO_INFO};t&&(s.node=t);const n=om({from:td.connection.jid,to:e,type:"get"}).c("query",s);return ef.sendIQ(n)},items(e,t){const s={xmlns:rm.NS.DISCO_ITEMS};return t&&(s.node=t),ef.sendIQ(om({from:td.connection.jid,to:e,type:"get"}).c("query",s))},entities:{async get(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(await ef.waitUntil("discoInitialized"),!e)return td.disco_entities;if(void 0===td.disco_entities)return void De.warn(`Tried to look up entity ${e} but _converse.disco_entities has been torn down`);const s=td.disco_entities.get(e);return s||!t?s:ef.disco.entities.create({jid:e})},items:e=>td.disco_entities.filter((t=>t.get("parent_jids")?.includes(e))),create:(e,t)=>td.disco_entities.create(e,t)},features:{async get(e,t){if(!t)throw new TypeError("You need to provide an entity JID");const s=await ef.disco.entities.get(t,!0);if(void 0===td.disco_entities&&!ef.connection.connected())return De.warn(`Tried to get feature ${e} for ${t} but _converse.disco_entities has been torn down`),[];const n=[s.getFeature(e),...ef.disco.entities.items(t).map((t=>t.getFeature(e)))];return(await Promise.all(n)).filter((e=>e instanceof Object))},async has(e,t){if(!t)throw new TypeError("You need to provide an entity JID");const s=await ef.disco.entities.get(t,!0);if(void 0===td.disco_entities&&!ef.connection.connected())return De.warn(`Tried to check if ${t} supports feature ${e}`),!1;if(await s.getFeature(e))return!0;const n=await Promise.all(ef.disco.entities.items(t).map((t=>t.getFeature(e))));return n.map((e=>e instanceof Object)).includes(!0)}},supports:(e,t)=>ef.disco.features.has(e,t),async refresh(e){if(!e)throw new TypeError("api.disco.refresh: You need to provide an entity JID");await ef.waitUntil("discoInitialized");let t=await ef.disco.entities.get(e);return t?(t.features.reset(),t.fields.reset(),t.identities.reset(),t.waitUntilFeaturesDiscovered.isPending||(t.waitUntilFeaturesDiscovered=ol()),t.queryInfo()):t=await ef.disco.entities.create({jid:e},{ignore_cache:!0}),t.waitUntilFeaturesDiscovered},refreshFeatures:e=>ef.refresh(e),async getFeatures(e){if(!e)throw new TypeError("api.disco.getFeatures: You need to provide an entity JID");await ef.waitUntil("discoInitialized");let t=await ef.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.features},async getFields(e){if(!e)throw new TypeError("api.disco.getFields: You need to provide an entity JID");await ef.waitUntil("discoInitialized");let t=await ef.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.fields},async getIdentity(e,t,s){const n=await ef.disco.entities.get(s,!0);if(void 0!==n||ef.connection.connected())return n.getIdentity(e,t);{const t=`Tried to look up category ${e} for ${s} but _converse.disco_entities has been torn down`;De.warn(t)}}}},{Strophe:am,$iq:lm}=Zh.env;async function cm(){ef.disco.own.identities.add("client","web","Converse"),ef.disco.own.features.add(am.NS.CHATSTATES),ef.disco.own.features.add(am.NS.DISCO_INFO),ef.disco.own.features.add(am.NS.ROSTERX),ef.disco.own.features.add(am.NS.CARBONS),ef.trigger("addClientFeatures"),td.connection.addHandler((e=>function(e){const t=e.getElementsByTagName("query")[0].getAttribute("node"),s={xmlns:am.NS.DISCO_INFO};t&&(s.node=t);const n=lm({type:"result",id:e.getAttribute("id")}),r=e.getAttribute("from");return null!==r&&n.attrs({to:r}),n.c("query",s),td.disco._identities.forEach((e=>{const t={category:e.category,type:e.type};e.name&&(t.name=e.name),e.lang&&(t["xml:lang"]=e.lang),n.c("identity",t).up()})),td.disco._features.forEach((e=>n.c("feature",{var:e}).up())),ef.send(n.tree()),!0}(e)),am.NS.DISCO_INFO,"iq","get",null,null),td.disco_entities=new td.DiscoEntities;const e=`converse.disco-entities-${td.bare_jid}`;td.disco_entities.browserStorage=td.createStore(e,"session");const t=await td.disco_entities.fetchEntities();0!==t.length&&t.get(td.domain)||ef.disco.entities.create({jid:td.domain},{ignore_cache:!0}),ef.trigger("discoInitialized")}function dm(){if(!td.stream_features){const e=`converse.stream-features-${am.getBareJidFromJid(td.jid)}`;ef.promises.add("streamFeaturesAdded"),td.stream_features=new gu,td.stream_features.browserStorage=td.createStore(e,"session")}}function um(){ef.trigger("streamFeaturesAdded")}function hm(){dm(),Array.from(td.connection.features.childNodes).forEach((e=>{td.stream_features.create({name:e.nodeName,xmlns:e.getAttribute("xmlns")})})),um()}function fm(){td.disco_entities?.forEach((e=>e.features.clearStore())),td.disco_entities?.forEach((e=>e.identities.clearStore())),td.disco_entities?.forEach((e=>e.dataforms.clearStore())),td.disco_entities?.forEach((e=>e.fields.clearStore())),td.disco_entities?.clearStore(),delete td.disco_entities}const{Strophe:mm}=Zh.env;Zh.plugins.add("converse-disco",{initialize(){Object.assign(ef,im),ef.promises.add("discoInitialized"),ef.promises.add("streamFeaturesAdded"),td.DiscoEntity=tm,td.DiscoEntities=nm,td.disco={_identities:[],_features:[]},ef.listen.on("userSessionInitialized",(async()=>{dm(),td.connfeedback.get("connection_status")===mm.Status.ATTACHED&&(await new Promise(((e,t)=>td.stream_features.fetch({success:e,error:t}))),um())})),ef.listen.on("beforeResourceBinding",hm),ef.listen.on("reconnected",cm),ef.listen.on("connected",cm),ef.listen.on("beforeTearDown",(async()=>{ef.promises.add("streamFeaturesAdded"),td.stream_features&&(await td.stream_features.clearStore(),delete td.stream_features)})),ef.listen.on("will-reconnect",fm),ef.listen.on("clearSession",fm)}});const pm=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)(\\*\\\\0\\/\\*|\\*\\\\O\\/\\*|\\-___\\-|\\:'\\-\\)|'\\:\\-\\)|'\\:\\-D|\\>\\:\\-\\)|>\\:\\-\\)|'\\:\\-\\(|\\>\\:\\-\\(|>\\:\\-\\(|\\:'\\-\\(|O\\:\\-\\)|0\\:\\-3|0\\:\\-\\)|0;\\^\\)|O;\\-\\)|0;\\-\\)|O\\:\\-3|\\-__\\-|\\:\\-|\\:\\-|\\<\\/3|<\\/3|\\:'\\)|\\:\\-D|'\\:\\)|'\\=\\)|'\\:D|'\\=D|\\>\\:\\)|>\\:\\)|\\>;\\)|>;\\)|\\>\\=\\)|>\\=\\)|;\\-\\)|\\*\\-\\)|;\\-\\]|;\\^\\)|'\\:\\(|'\\=\\(|\\:\\-\\*|\\:\\^\\*|\\>\\:P|>\\:P|X\\-P|\\>\\:\\[|>\\:\\[|\\:\\-\\(|\\:\\-\\[|\\>\\:\\(|>\\:\\(|\\:'\\(|;\\-\\(|\\>\\.\\<|>\\.<|#\\-\\)|%\\-\\)|X\\-\\)|\\\\0\\/|\\\\O\\/|0\\:3|0\\:\\)|O\\:\\)|O\\=\\)|O\\:3|B\\-\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\>\\:\\\\|>\\:\\\\|\\>\\:\\/|>\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\-P|\\:|\\:|\\:\\-b|\\:\\-O|O_O|\\>\\:O|>\\:O|\\:\\-X|\\:\\-#|\\:\\-\\)|\\(y\\)|\\<3|<3|\\:D|\\=D|;\\)|\\*\\)|;\\]|;D|\\:\\*|\\=\\*|\\:\\(|\\:\\[|\\=\\(|\\:@|;\\(|D\\:|\\:\\$|\\=\\$|#\\)|%\\)|X\\)|B\\)|8\\)|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\=P|\\:b|\\:O|\\:X|\\:#|\\=X|\\=#|\\:\\)|\\=\\]|\\=\\)|\\:\\])(?=\\s|$|[!,.?]))","gi"),gm=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,{u:_m}=Zh.env,vm={},ym={"*\\0/*":"1f646","*\\O/*":"1f646","-___-":"1f611",":'-)":"1f602","':-)":"1f605","':-D":"1f605",">:-)":"1f606","':-(":"1f613",">:-(":"1f620",":'-(":"1f622","O:-)":"1f607","0:-3":"1f607","0:-)":"1f607","0;^)":"1f607","O;-)":"1f607","0;-)":"1f607","O:-3":"1f607","-__-":"1f611",":-":"1f61b","</3":"1f494",":')":"1f602",":-D":"1f603","':)":"1f605","'=)":"1f605","':D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">=)":"1f606",";-)":"1f609","*-)":"1f609",";-]":"1f609",";^)":"1f609","':(":"1f613","'=(":"1f613",":-*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c",">:[":"1f61e",":-(":"1f61e",":-[":"1f61e",">:(":"1f620",":'(":"1f622",";-(":"1f622",">.<":"1f623","#-)":"1f635","%-)":"1f635","X-)":"1f635","\\0/":"1f646","\\O/":"1f646","0:3":"1f607","0:)":"1f607","O:)":"1f607","O=)":"1f607","O:3":"1f607","B-)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":-P":"1f61b",":":"1f61b",":-b":"1f61b",":-O":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":-#":"1f636",":-)":"1f642","(y)":"1f44d","<3":"2764",":D":"1f603","=D":"1f603",";)":"1f609","*)":"1f609",";]":"1f609",";D":"1f609",":*":"1f618","=*":"1f618",":(":"1f61e",":[":"1f61e","=(":"1f61e",":@":"1f620",";(":"1f622","D:":"1f628",":$":"1f633","=$":"1f633","#)":"1f635","%)":"1f635","X)":"1f635","B)":"1f60e","8)":"1f60e",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b","=P":"1f61b",":b":"1f61b",":O":"1f62e",":X":"1f636",":#":"1f636","=X":"1f636","=#":"1f636",":)":"1f642","=]":"1f642","=)":"1f642",":]":"1f642"};function bm(e){if(e.indexOf("-")>-1){const t=[],s=e.split("-");for(let e=0;e<s.length;e++){let n=parseInt(s[e],16);if(n>=65536&&n<=1114111){const e=Math.floor((n-65536)/1024)+55296,t=(n-65536)%1024+56320;n=String.fromCharCode(e)+String.fromCharCode(t)}else n=String.fromCharCode(n);t.push(n)}return t.join("")}return function(e){let t="string"==typeof e?parseInt(e,16):e;return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}(e)}function jm(e){if(!Zh.emojis.initialized)throw new Error("getShortnameReferences called before emojis are initialized. To avoid this problem, first await the converse.emojis.initialized_promise");return[...e.matchAll(Zh.emojis.shortnames_regex)].filter((e=>e[0].length>0)).map((e=>{const t=Zh.emojis.by_sn[e[0]].cp;return{cp:t,begin:e.index,end:e.index+e[0].length,shortname:e[0],emoji:t?bm(t):null}}))}function wm(e){const t=[];return function(e,t){const s=/\uFE0F/g,n=String.fromCharCode(8205);String(e).replace(gm,((e,r,o)=>{const i=function(e){const t=[];let s=0,n=0;for(;n<e.length;){const r=e.charCodeAt(n++);s?(t.push((65536+(s-55296<<10)+(r-56320)).toString(16)),s=0):55296<=r&&r<=56319?s=r:t.push(r.toString(16))}return t.join("-")}(e.indexOf(n)<0?e.replace(s,""):e);i&&t(i,e,o)}))}(e,((e,s,n)=>{t.push({begin:n,cp:e,emoji:s,end:n+s.length,shortname:Sm("cp")[e]?.sn||""})})),t}function Sm(e){if(vm[e])return vm[e];if("category"===e)return Zh.emojis.json;const t=Zh.emojis.list.map((t=>t[e])).filter(((e,t,s)=>s.indexOf(e)==t));return vm[e]={},t.forEach((t=>vm[e][t]=Zh.emojis.list.find((s=>s[e]===t)))),vm[e]}Object.assign(_m,{getEmojisByAtrribute:Sm,isOnlyEmojis:function(e){const t=e.trim().split(/\s+/);return!(0===t.length||t.length>3)&&t.filter((e=>{const t=wm(_m.shortnamesToUnicode(e));return 1===t.length&&(e===t[0].shortname||e===t[0].emoji)})).length===t.length},shortnamesToUnicode:function(e){return function(e){let t=[e];return[...jm(e),...wm(e)].sort(((e,t)=>t.begin-e.begin)).forEach((e=>{const s=t.shift(),n=e.emoji||e.shortname;t=[s.slice(0,e.begin)+n+s.slice(e.end),...t]})),t}(function(e){return e.replace(pm,((e,t,s,n)=>void 0!==n&&""!==n&&_m.unescapeHTML(n)in ym?(n=_m.unescapeHTML(n),s+bm(ym[n].toUpperCase())):e))}(e)).pop()}}),Zh.emojis={initialized:!1,initialized_promise:ol()},Zh.plugins.add("converse-emoji",{initialize(){const{___:e}=td;ef.settings.extend({emoji_image_path:"https://twemoji.maxcdn.com/v/12.1.6/",emoji_categories:{smileys:":grinning:",people:":thumbsup:",activity:":soccer:",travel:":motorcycle:",objects:":bomb:",nature:":rainbow:",food:":hotdog:",symbols:":musical_note:",flags:":flag_ac:",custom:null},emoji_category_labels:{smileys:e("Smileys and emotions"),people:e("People"),activity:e("Activities"),travel:e("Travel"),objects:e("Objects"),nature:e("Animals and nature"),food:e("Food and drink"),symbols:e("Symbols"),flags:e("Flags"),custom:e("Stickers")}}),td.EmojiPicker=class extends nc{defaults(){return{current_category:"smileys",current_skintone:"",scroll_position:0}}},Object.assign(ef,{emojis:{async initialize(){if(!Zh.emojis.initialized){Zh.emojis.initialized=!0;const e=await c.e(610).then(c.t.bind(c,175,19)),t=Zh.emojis.json=e.default;Zh.emojis.by_sn=Object.keys(t).reduce(((e,s)=>Object.assign(e,t[s])),{}),Zh.emojis.list=Object.values(Zh.emojis.by_sn),Zh.emojis.list.sort(((e,t)=>e.sn<t.sn?-1:e.sn>t.sn?1:0)),Zh.emojis.shortnames=Zh.emojis.list.map((e=>e.sn));const s=()=>Zh.emojis.shortnames.map((e=>e.replace(/[+]/g,"\\$&"))).join("|");Zh.emojis.shortnames_regex=new RegExp(s(),"gi"),Zh.emojis.initialized_promise.resolve()}return Zh.emojis.initialized_promise}}})}});const xm={initialize(){this.checkValidity()&&(this.get("file")&&this.on("change:put",(()=>this.uploadFile())),this.on("change:type",(()=>this.setOccupant())),this.on("change:is_ephemeral",(()=>this.setTimerForEphemeralMessage())),this.chatbox=this.collection?.chatbox,this.setTimerForEphemeralMessage(),this.setOccupant(),ef.trigger("chatRoomMessageInitialized",this))},getDisplayName(){return this.occupant?.getDisplayName()||this.get("nick")},mayBeModerated(){if(void 0!==this.get("from_muc"))return["all","moderator"].includes(ef.settings.get("allow_message_retraction"))&&this.get(`stanza_id ${this.get("from_muc")}`)&&this.chatbox.canModerateMessages()},checkValidity(){const e=td.Message.prototype.checkValidity.call(this);return!e&&this.chatbox.debouncedRejoin(),e},onOccupantRemoved(){this.stopListening(this.occupant),delete this.occupant,this.listenTo(this.chatbox.occupants,"add",this.onOccupantAdded)},onOccupantAdded(e){if(this.get("occupant_id")){if(e.get("occupant_id")!==this.get("occupant_id"))return}else if(e.get("nick")!==_e.getResourceFromJid(this.get("from")))return;this.occupant=e,e.get("jid")&&this.save("from_real_jid",e.get("jid")),this.trigger("occupantAdded"),this.listenTo(this.occupant,"destroy",this.onOccupantRemoved),this.stopListening(this.chatbox.occupants,"add",this.onOccupantAdded)},getOccupant(){return this.occupant||this.setOccupant(),this.occupant},setOccupant(){if("groupchat"!==this.get("type")||this.isEphemeral()||this.occupant)return;const e=_e.getResourceFromJid(this.get("from")),t=this.get("occupant_id");if(this.occupant=this.chatbox.occupants.findOccupant({nick:e,occupant_id:t}),!this.occupant&&(this.occupant=this.chatbox.occupants.create({nick:e,occupant_id:t,jid:this.get("from_real_jid")}),ef.settings.get("muc_send_probes"))){const t=`${this.chatbox.get("jid")}/${e}`;ef.user.presence.send("probe",t)}this.listenTo(this.occupant,"destroy",this.onOccupantRemoved)}},Em=xm,Am={},Cm=(e,t)=>e.replace(RegExp("\\"+t,"ig"),"\\"+t);Am.escapeCharacters=e=>t=>e.split("").reduce(Cm,t),Am.escapeRegexString=Am.escapeCharacters("[\\^$.?*+(){}|"),Am.findFirstMatchInArray=e=>t=>{for(let s=0;s<e.length;s++)if(0===t.localeCompare(e[s],void 0,{sensitivity:"base"}))return e[s];return null};const Tm=(e,t,s)=>{let[n,r]=e,o=n,{begin:i,end:a}=t;const{value:l}=t;return i-=s,a=a-s-1,o=`${o.slice(0,i)}${l}${o.slice(a+1)}`,[o,[...r,{...t,begin:i,end:a}]]};Am.reduceTextFromReferences=(e,t)=>t.reduce(Tm,[e,[]]);const Im=Am,km=["moderator","participant","visitor"],Nm=["owner","admin","member","outcast","none"],Om={moderator:1,participant:2,visitor:3,none:2},Mm={OWNER:"owner",ADMIN:"admin",MEMBER:"member",EXADMIN:"exadmin",EXOWNER:"exowner",EXOUTCAST:"exoutcast",EXMEMBER:"exmember"},$m=Object.values(Mm),Rm={ENTERED:"entered",EXITED:"exited"},Dm=Object.values(Rm),Pm={OP:"op",DEOP:"deop",VOICE:"voice",MUTE:"mute"},Lm=Object.values(Pm),zm={visibility_changes:["100","102","103","172","173","174"],self:["110"],non_privacy_changes:["104","201"],muc_logging_changes:["170","171"],nickname_changes:["210","303"],disconnected:["301","307","321","322","332","333"],affiliation_changes:[...$m],join_leave_events:[...Dm],role_changes:[...Lm]},Fm={CONNECTED:0,CONNECTING:1,NICKNAME_REQUIRED:2,PASSWORD_REQUIRED:3,DISCONNECTED:4,ENTERED:5,DESTROYED:6,BANNED:7,CLOSING:8},{Strophe:Um,sizzle:Bm,u:qm}=Zh.env,{NS:Hm}=Um;function Gm(e){const t=Bm(`items[node="${Um.NS.CONFINFO}"]`,e).pop();if(!t)return null;const s=e.getAttribute("from"),n=e.getAttribute("id"),r=`item conference-info[xmlns="${Um.NS.CONFINFO}"] activity[xmlns="${Um.NS.ACTIVITY}"]`;return Bm(r,t).map((t=>{const r=t.querySelector("text")?.textContent;if(r){const o=jf(e),i=t.querySelector("reason")?.textContent;return{from:s,msgid:n,message:r,reason:i,references:o,type:"mep"}}return{}}))}function Wm(e,t){if(t.features.get(Um.NS.OCCUPANTID))return Bm(`occupant-id[xmlns="${Um.NS.OCCUPANTID}"]`,e).pop()?.getAttribute("id")}function Vm(e,t){let s;const n=t.get("occupant_id");return s=n?e.occupant_id===n:e.from_real_jid?Um.getBareJidFromJid(e.from_real_jid)===td.bare_jid:e.nick===t.get("nick"),s?"me":"them"}async function Jm(e,t){Af(e);const s=`[xmlns="${Hm.MAM}"] > forwarded[xmlns="${Hm.FORWARD}"] > message`,n=e;if(e=Bm(s,e).pop()||e,Bm(`message > forwarded[xmlns="${Um.NS.FORWARD}"]`,e).length)return new hf(`Invalid Stanza: Forged MAM groupchat message from ${e.getAttribute("from")}`,e);const r=Bm(`delay[xmlns="${Um.NS.DELAY}"]`,n).pop(),o=e.getAttribute("from"),i=Cf(e);let a=Object.assign({from:o,activities:Gm(e),body:e.querySelector(":scope > body")?.textContent?.trim(),chat_state:xf(e),from_muc:Um.getBareJidFromJid(o),is_archived:kf(n),is_carbon:Sf(n),is_delayed:!!r,is_forwarded:!!e.querySelector("forwarded"),is_headline:Tf(e),is_markable:!!Bm(`markable[xmlns="${Um.NS.MARKERS}"]`,e).length,is_marker:!!i,is_unstyled:!!Bm(`unstyled[xmlns="${Um.NS.STYLING}"]`,e).length,marker_id:i&&i.getAttribute("id"),msgid:e.getAttribute("id")||n.getAttribute("id"),nick:Um.unescapeNode(Um.getResourceFromJid(o)),occupant_id:Wm(e,t),receipt_id:wf(e),received:(new Date).toISOString(),references:jf(e),subject:e.querySelector("subject")?.textContent,thread:e.querySelector("thread")?.textContent,time:r?Td()(r.getAttribute("stamp")).toISOString():(new Date).toISOString(),to:e.getAttribute("to"),type:e.getAttribute("type")},bf(e),yf(e),vf(e),gf(e,n),ff(e,n),function(e){const t=Nl()(`> apply-to[xmlns="${_e.NS.FASTEN}"]`,e).pop();if(t){const e=t.getAttribute("id"),s=Nl()(`> meta[xmlns="${_e.NS.XHTML}"]`,t);if(s.length){const t=ef.settings.get("message_limit"),n=s.reduce(((e,s)=>{const n=s.getAttribute("property");if(n){let r=Lc(s.getAttribute("content")||"");t&&"og:description"===n&&r.length>=t&&(r=`${r.slice(0,t)}${Lc("&#8230;")}`),e[n]=r}return e}),{ogp_for_id:e});if("og:description"in n||"og:title"in n||"og:image"in n)return n}}return{}}(e),pf(e,n),function(e){const t=Bm(`apply-to[xmlns="${Um.NS.FASTEN}"]`,e).pop();if(t){const e=t.getAttribute("id"),s=Bm(`moderated[xmlns="${Um.NS.MODERATE}"]`,t).pop();if(s&&Bm(`retract[xmlns="${Um.NS.RETRACT}"]`,s).pop())return{editable:!1,moderated:"retracted",moderated_by:s.getAttribute("by"),moderated_id:e,moderation_reason:s.querySelector("reason")?.textContent}}else{const t=Bm(`> moderated[xmlns="${Um.NS.MODERATE}"]`,e).pop();if(t&&Bm(`retracted[xmlns="${Um.NS.RETRACT}"]`,t).pop())return{editable:!1,is_tombstone:!0,moderated_by:t.getAttribute("by"),retracted:t.getAttribute("stamp"),moderation_reason:t.querySelector("reason")?.textContent}}return{}}(e),mf(e));return await ef.emojis.initialize(),a.from_real_jid=a.is_archived&&function(e){const t=Bm(`x[xmlns="${Um.NS.MUC_USER}"] item`,e).pop();return t?.getAttribute("jid")}(e)||t.occupants.findOccupant(a)?.get("jid"),a=Object.assign({is_only_emojis:!!a.body&&qm.isOnlyEmojis(a.body),is_valid_receipt_request:Ef(e,a),message:a.body||a.error,sender:Vm(a,t)},a),a.is_archived&&n.getAttribute("from")!==a.from_muc?new hf(`Invalid Stanza: Forged MAM message from ${n.getAttribute("from")}`,e):a.is_archived&&n.getAttribute("from")!==t.get("jid")?new hf(`Invalid Stanza: Forged MAM groupchat message from ${e.getAttribute("from")}`,e):a.is_carbon?new hf("Invalid Stanza: MUC messages SHOULD NOT be XEP-0280 carbon copied",e):(a.id=a.origin_id||a[`stanza_id ${a.from_muc||a.from}`]||qm.getUniqueId(),a=await ef.hook("parseMUCMessage",e,a),Object.assign(a,_f(a.is_encrypted?a.plaintext:a.body)))}const{Strophe:Qm,$iq:Ym,u:Km}=Zh.env;async function Xm(e,t){const{__:s}=td,n=Ym({to:t,type:"get"}).c("query",{xmlns:Qm.NS.MUC_ADMIN}).c("item",{affiliation:e}),r=await ef.sendIQ(n,null,!1);if(null===r){const n=s("Error: timeout while fetching %1s list for MUC %2s",e,t),r=new Error(n);return De.warn(n),r}if(Km.isErrorStanza(r)){const n=s("Error: not allowed to fetch %1s list for MUC %2s",e,t),o=new Error(n);return De.warn(n),De.warn(r),o}return function(e){return Bm(`query[xmlns="${Um.NS.MUC_ADMIN}"] item`,e).map((e=>{const t={affiliation:e.getAttribute("affiliation")},s=e.getAttribute("jid");qm.isValidJID(s)?t.jid=s:t.nick=s;const n=e.getAttribute("nick");return n&&(t.nick=n),e.getAttribute("role")&&(t.role=n),t}))}(r).filter((e=>e)).sort(((e,t)=>e.nick<t.nick?-1:e.nick>t.nick?1:0))}function Zm(e,t){const s=[...new Set(t.map((e=>e.affiliation)))];return Promise.all(s.map((s=>{return n=s,r=e,o=t,Array.isArray(r)||(r=[r]),o=o.filter((e=>[void 0,n].includes(e.affiliation))),Promise.all(r.reduce(((e,t)=>[...e,...o.map((e=>function(e,t,s){const n=Ym({to:t,type:"set"}).c("query",{xmlns:Qm.NS.MUC_ADMIN}).c("item",{affiliation:s.affiliation||e,nick:s.nick,jid:s.jid});return void 0!==s.reason&&n.c("reason",s.reason),ef.sendIQ(n)}(n,t,e)))]),[]));var n,r,o})))}function ep(e,t,s,n){const r=s.map((e=>e.jid)),o=n.map((e=>e.jid));let i=r.filter((e=>!o.includes(e))).map((e=>s[r.indexOf(e)]));return e||(i=i.concat(s.filter((e=>{const t=o.indexOf(e.jid);return t>=0&&e.affiliation!==n[t].affiliation})))),t&&(i=i.concat(o.filter((e=>!r.includes(e))).map((e=>({jid:e,affiliation:"none"}))))),i}td.getAssignableAffiliations=function(e){let t=ef.settings.get("modtools_disable_assign");return Array.isArray(t)||(t=t?Nm:[]),"owner"===e?.get("affiliation")?Nm.filter((e=>!t.includes(e))):"admin"===e?.get("affiliation")?Nm.filter((e=>!["owner","admin",...t].includes(e))):[]};const{u:tp}=Zh.env,sp=["owner"],np=["admin","ban","deop","destroy","member","op","revoke"],rp=["kick","mute","voice","modtools"],op=["nick"],ip=["og:article:author","og:article:published_time","og:description","og:image","og:image:height","og:image:width","og:site_name","og:title","og:type","og:url","og:video:height","og:video:secure_url","og:video:tag","og:video:type","og:video:url","og:video:width"],ap=["301","303","333","307","321","322"];class lp extends nc{defaults(){return{connection_status:Fm.DISCONNECTED}}}const cp={defaults(){return{bookmarked:!1,chat_state:void 0,has_activity:!1,hidden:Ac()&&!ef.settings.get("singleton"),hidden_occupants:!!ef.settings.get("hide_muc_participants"),message_type:"groupchat",name:"",num_unread_general:0,num_unread:0,roomconfig:{},time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:td.CHATROOMS_TYPE}},async initialize(){this.initialized=ol(),this.debouncedRejoin=dd(this.rejoin,250),this.set("box_id",`box-${this.get("jid")}`),this.initNotifications(),this.initMessages(),this.initUI(),this.initOccupants(),this.initDiscoModels(),this.registerHandlers(),this.on("change:chat_state",this.sendChatState,this),this.on("change:hidden",this.onHiddenChange,this),this.on("destroy",this.removeHandlers,this),this.ui.on("change:scrolled",this.onScrolledChanged,this),await this.restoreSession(),this.session.on("change:connection_status",this.onConnectionStatusChanged,this),this.listenTo(this.occupants,"add",this.onOccupantAdded),this.listenTo(this.occupants,"remove",this.onOccupantRemoved),this.listenTo(this.occupants,"change:show",this.onOccupantShowChanged),this.listenTo(this.occupants,"change:affiliation",this.createAffiliationChangeMessage),this.listenTo(this.occupants,"change:role",this.createRoleChangeMessage),await this.restoreFromCache()||this.join(),await ef.trigger("chatRoomInitialized",this,{Synchronous:!0}),this.initialized.resolve()},isEntered(){return this.session.get("connection_status")===Fm.ENTERED},isRAICandidate(){return this.get("hidden")&&ef.settings.get("muc_subscribe_to_rai")&&"none"!==this.getOwnAffiliation()},async restoreFromCache(){if(this.isEntered()){if(await this.fetchOccupants().catch((e=>De.error(e))),this.isRAICandidate())return this.session.save("connection_status",Fm.DISCONNECTED),this.enableRAI(),!0;if(await this.isJoined())return await new Promise((e=>this.config.fetch({success:e,error:e}))),await new Promise((e=>this.features.fetch({success:e,error:e}))),await this.fetchMessages().catch((e=>De.error(e))),!0}return this.session.save("connection_status",Fm.DISCONNECTED),this.clearOccupantsCache(),!1},async join(e,t){return this.isEntered()?this:(this.session.save("connection_status",Fm.CONNECTING),await this.refreshDiscoInfo(),(e=await this.getAndPersistNickname(e))?(ef.send(await this.constructJoinPresence(t)),this):(Nc(this.session,{connection_status:Fm.NICKNAME_REQUIRED}),ef.settings.get("muc_show_logs_before_join")&&await this.fetchMessages(),this))},rejoin(){return this.session.save("connection_status",Fm.DISCONNECTED),this.registerHandlers(),this.clearOccupantsCache(),this.join()},async constructJoinPresence(e){let t=_({id:Mc(),from:td.connection.jid,to:this.getRoomJIDAndNick()}).c("x",{xmlns:_e.NS.MUC}).c("history",{maxstanzas:this.features.get("mam_enabled")?0:ef.settings.get("muc_history_max_stanzas")}).up();return(e=e||this.get("password"))&&t.cnode(_e.xmlElement("password",[],e)),t.up(),t=await ef.hook("constructedMUCPresence",this,t),t},clearOccupantsCache(){this.occupants.length?this.occupants.filter((e=>!e.isMember())).forEach((e=>e.destroy())):this.occupants.clearStore()},sendMarkerForMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"displayed",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&ef.settings.get("send_chat_markers").includes(t)&&"groupchat"===e?.get("type")&&(e?.get("is_markable")||s)){const s=`stanza_id ${this.get("jid")}`,n=e.get(s);if(!n)return void De.error(`Can't send marker for message without stanza ID: ${s}`);df(_e.getBareJidFromJid(e.get("from")),n,t,e.get("type"))}},enableRAI(){if(ef.settings.get("muc_subscribe_to_rai")){const e=_e.getDomainFromJid(this.get("jid"));ef.user.presence.send(null,e,null,m("rai",{xmlns:_e.NS.RAI}))}},async onHiddenChange(){const e=Fm,t=this.session.get("connection_status");this.get("hidden")?t===e.ENTERED&&this.isRAICandidate()&&(this.sendMarkerForLastMessage("received",!0),await this.leave(),this.enableRAI()):(t===e.DISCONNECTED&&this.rejoin(),this.clearUnreadMsgCounter())},onOccupantAdded(e){td.isInfoVisible(Zh.MUC_TRAFFIC_STATES.ENTERED)&&this.session.get("connection_status")===Fm.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),Zh.MUC_TRAFFIC_STATES.ENTERED)},onOccupantRemoved(e){td.isInfoVisible(Zh.MUC_TRAFFIC_STATES.EXITED)&&this.isEntered()&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),Zh.MUC_TRAFFIC_STATES.EXITED)},onOccupantShowChanged(e){e.get("states").includes("303")||("offline"===e.get("show")&&td.isInfoVisible(Zh.MUC_TRAFFIC_STATES.EXITED)?this.updateNotifications(e.get("nick"),Zh.MUC_TRAFFIC_STATES.EXITED):"online"===e.get("show")&&td.isInfoVisible(Zh.MUC_TRAFFIC_STATES.ENTERED)&&this.updateNotifications(e.get("nick"),Zh.MUC_TRAFFIC_STATES.ENTERED))},async onRoomEntered(){await this.occupants.fetchMembers(),ef.settings.get("clear_messages_on_reconnection")?await this.clearMessages():await this.fetchMessages(),ef.trigger("enteredNewRoom",this),ef.settings.get("auto_register_muc_nickname")&&await ef.disco.supports(_e.NS.MUC_REGISTER,this.get("jid"))&&this.registerNickname()},async onConnectionStatusChanged(){if(this.isEntered())if(this.isRAICandidate()){try{await this.leave()}catch(e){De.error(e)}this.enableRAI()}else await this.onRoomEntered()},async onReconnection(){await this.rejoin(),this.announceReconnection()},getMessagesCollection:()=>new td.ChatRoomMessages,restoreSession(){const e=`muc.session-${td.bare_jid}-${this.get("jid")}`;return this.session=new lp({id:e}),Zc(this.session,e,"session"),new Promise((e=>this.session.fetch({success:e,error:e})))},initDiscoModels(){let e=`converse.muc-features-${td.bare_jid}-${this.get("jid")}`;this.features=new nc(Object.assign({id:e},Zh.ROOM_FEATURES.reduce(((e,t)=>(e[t]=!1,e)),{}))),this.features.browserStorage=td.createStore(e,"session"),this.features.listenTo(td,"beforeLogout",(()=>this.features.browserStorage.flush())),e=`converse.muc-config-${td.bare_jid}-${this.get("jid")}`,this.config=new nc({id:e}),this.config.browserStorage=td.createStore(e,"session"),this.config.listenTo(td,"beforeLogout",(()=>this.config.browserStorage.flush()))},initOccupants(){this.occupants=new td.ChatRoomOccupants;const e=`converse.occupants-${td.bare_jid}${this.get("jid")}`;this.occupants.browserStorage=td.createStore(e,"session"),this.occupants.chatroom=this,this.occupants.listenTo(td,"beforeLogout",(()=>this.occupants.browserStorage.flush()))},fetchOccupants(){return this.occupants.fetched=new Promise((e=>{this.occupants.fetch({add:!0,silent:!0,success:e,error:e})})),this.occupants.fetched},handleAffiliationChangedMessage(e){const t=Nl()(`x[xmlns="${_e.NS.MUC_USER}"] item`,e).pop();if(t){const s=e.getAttribute("from"),n=e.getAttribute("type"),r=t.getAttribute("affiliation"),o=t.getAttribute("jid"),i={from:s,type:n,affiliation:r,states:[],show:"unavailable"==n?"offline":"online",role:t.getAttribute("role"),jid:_e.getBareJidFromJid(o),resource:_e.getResourceFromJid(o)},a=this.occupants.findOccupant({jid:i.jid});a?a.save(i):this.occupants.create(i)}},async handleErrorMessageStanza(e){const{__:t}=td,s=await Jm(e,this);if(!await this.shouldShowErrorMessage(s))return;const n=this.getMessageReferencedByError(s);if(n){const e={error:s.error,error_condition:s.error_condition,error_text:s.error_text,error_type:s.error_type,editable:!1};s.msgid===n.get("retraction_id")?(e.retracted=void 0,e.retraction_id=void 0,e.retracted_id=void 0,s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to retract your message."):"not-acceptable"===s.error_condition?e.error=t("Your retraction was not delivered because you're not present in the groupchat."):e.error=t("Sorry, an error occurred while trying to retract your message."))):s.error||("forbidden"===s.error_condition?e.error=t("Your message was not delivered because you weren't allowed to send it."):"not-acceptable"===s.error_condition?e.error=t("Your message was not delivered because you're not present in the groupchat."):e.error=t("Sorry, an error occurred while trying to send your message.")),n.save(e)}else this.createMessage(s)},handleMessageFromMUCHost(e){if(this.isEntered())return;const t=Nl()(`rai[xmlns="${_e.NS.RAI}"]`,e).pop(),s=Array.from(t?.querySelectorAll("activity")||[]).map((e=>e.textContent));s.includes(this.get("jid"))&&this.save({has_activity:!0,num_unread_general:0})},handleForwardedMentions(e){if(this.isEntered())return;const t=Nl()(`mentions[xmlns="${_e.NS.MENTIONS}"] forwarded[xmlns="${_e.NS.FORWARD}"] message[type="groupchat"]`,e),s=this.get("jid"),n=t.filter((e=>_e.getBareJidFromJid(e.getAttribute("from"))===s));n.length&&(this.save({has_activity:!0,num_unread:this.get("num_unread")+n.length}),n.forEach((async e=>{const t={stanza:e,attrs:await Jm(e,this),chatbox:this};ef.trigger("message",t)})))},async handleMessageStanza(e){const t=(e=e.tree?.()??e).getAttribute("type");if("error"===t)return this.handleErrorMessageStanza(e);if("groupchat"===t){if(kf(e))return De.warn('Received a MAM message with type "groupchat"');this.createInfoMessages(e),this.fetchFeaturesIfConfigurationChanged(e)}else if(!t)return this.handleForwardedMentions(e);let s;try{s=await Jm(e,this)}catch(e){return De.error(e)}const n={stanza:e,attrs:s,chatbox:this};return ef.trigger("message",n),s&&this.queueMessage(s)},registerHandlers(){const e=this.get("jid"),t=_e.getDomainFromJid(e);this.removeHandlers(),this.presence_handler=td.connection.addHandler((e=>this.onPresence(e)||!0),null,"presence",null,null,e,{ignoreNamespaceFragment:!0,matchBareFromJid:!0}),this.domain_presence_handler=td.connection.addHandler((e=>this.onPresenceFromMUCHost(e)||!0),null,"presence",null,null,t),this.message_handler=td.connection.addHandler((e=>!!this.handleMessageStanza(e)||!0),null,"message",null,null,e,{matchBareFromJid:!0}),this.domain_message_handler=td.connection.addHandler((e=>this.handleMessageFromMUCHost(e)||!0),null,"message",null,null,t),this.affiliation_message_handler=td.connection.addHandler((e=>this.handleAffiliationChangedMessage(e)||!0),_e.NS.MUC_USER,"message",null,null,e)},removeHandlers(){return this.message_handler&&(td.connection&&td.connection.deleteHandler(this.message_handler),delete this.message_handler),this.domain_message_handler&&(td.connection&&td.connection.deleteHandler(this.domain_message_handler),delete this.domain_message_handler),this.presence_handler&&(td.connection&&td.connection.deleteHandler(this.presence_handler),delete this.presence_handler),this.domain_presence_handler&&(td.connection&&td.connection.deleteHandler(this.domain_presence_handler),delete this.domain_presence_handler),this.affiliation_message_handler&&(td.connection&&td.connection.deleteHandler(this.affiliation_message_handler),delete this.affiliation_message_handler),this},invitesAllowed(){return ef.settings.get("allow_muc_invitations")&&(this.features.get("open")||"owner"===this.getOwnAffiliation())},getDisplayName(){const e=this.get("name");return e||("hidden"===ef.settings.get("locked_muc_domain")?_e.getNodeFromJid(this.get("jid")):this.get("jid"))},sendTimedMessage(e){"function"==typeof e.tree&&(e=e.tree());let t=e.getAttribute("id");t||(t=this.getUniqueId("sendIQ"),e.setAttribute("id",t));const s=ol(),n=ef.settings.get("stanza_timeout"),r=td.connection.addTimedHandler(n,(()=>{td.connection.deleteHandler(o);const e=new od("Timeout Error: No response from server");return s.resolve(e),!1})),o=td.connection.addHandler((e=>{r&&td.connection.deleteTimedHandler(r),s.resolve(e)}),null,"message",["error","groupchat"],t);return ef.send(e),s},async retractOwnMessage(e){const t=td.__,s=e.get("origin_id");if(!s)throw new Error("Can't retract message without a XEP-0359 Origin ID");const n=e.get("editable"),r=p({id:Mc(),to:this.get("jid"),type:"groupchat"}).c("store",{xmlns:_e.NS.HINTS}).up().c("apply-to",{id:s,xmlns:_e.NS.FASTEN}).c("retract",{xmlns:_e.NS.RETRACT});e.set({retracted:(new Date).toISOString(),retracted_id:s,retraction_id:r.tree().getAttribute("id"),editable:!1});const o=await this.sendTimedMessage(r);tp.isErrorStanza(o)?De.error(o):o instanceof od&&(De.error(o),e.save({editable:n,error_type:"timeout",error:t("A timeout happened while while trying to retract your message."),retracted:void 0,retracted_id:void 0,retraction_id:void 0}))},async retractOtherMessage(e,t){const s=e.get("editable");e.save({moderated:"retracted",moderated_by:td.bare_jid,moderated_id:e.get("msgid"),moderation_reason:t,editable:!1});const n=await this.sendRetractionIQ(e,t);return(null===n||tp.isErrorStanza(n))&&e.save({editable:s,moderated:void 0,moderated_by:void 0,moderated_id:void 0,moderation_reason:void 0}),n},sendRetractionIQ(e,t){const s=g({to:this.get("jid"),type:"set"}).c("apply-to",{id:e.get(`stanza_id ${this.get("jid")}`),xmlns:_e.NS.FASTEN}).c("moderate",{xmlns:_e.NS.MODERATE}).c("retract",{xmlns:_e.NS.RETRACT}).up().c("reason").t(t||"");return ef.sendIQ(s,null,!1)},sendDestroyIQ(e,t){const s=m("destroy");t&&s.attrs({jid:t});const n=g({to:this.get("jid"),type:"set"}).c("query",{xmlns:_e.NS.MUC_OWNER}).cnode(s.node);return e&&e.length>0&&n.c("reason",e),ef.sendIQ(n)},async leave(e){ef.connection.connected()&&ef.user.presence.send("unavailable",this.getRoomJIDAndNick(),e),this.features&&await new Promise((e=>this.features.destroy({success:e,error:(t,s)=>{De.error(s),e()}})));const t=td.disco_entities?.get(this.get("jid"));t&&await new Promise((e=>t.destroy({success:e,error:(t,s)=>{De.error(s),e()}}))),Nc(this.session,{connection_status:Fm.DISCONNECTED})},async close(e){const{ENTERED:t,CLOSING:s}=Fm,n=this.session.get("connection_status")===t;return Nc(this.session,{connection_status:s}),n&&this.sendMarkerForLastMessage("received",!0),await this.unregisterNickname(),await this.leave(),this.occupants.clearStore(),"closeAllChatBoxes"!==e?.name&&ef.settings.get("muc_clear_messages_on_leave")&&this.clearMessages(),await new Promise((e=>this.session.destroy({success:e,error:(t,s)=>{De.error(s),e()}}))),td.ChatBox.prototype.close.call(this)},canModerateMessages(){const e=this.getOwnOccupant();return e&&e.isModerator()&&ef.disco.supports(_e.NS.MODERATE,this.get("jid"))},getAllKnownNicknames(){return[...new Set([...this.occupants.map((e=>e.get("nick"))),...this.messages.map((e=>e.get("nick")))])].filter((e=>e))},getAllKnownNicknamesRegex(){const e=this.getAllKnownNicknames().map((e=>Im.escapeRegexString(e))).join("|");return RegExp(`(?:\\p{P}|\\p{Z}|^)@(${e})(?![\\w@-])`,"uig")},getOccupantByJID(e){return this.occupants.findOccupant({jid:e})},getOccupantByNickname(e){return this.occupants.findOccupant({nick:e})},getReferenceURIFromNickname(e){const t=this.get("jid"),s=this.getOccupant(e),n=this.features.get("nonanonymous")&&s?.get("jid")||`${t}/${e}`;return encodeURI(`xmpp:${n}`)},parseTextForReferences(e){if(!e||!/(\p{P}|\p{Z}|^)([@][\w_-]+(?:\.\w+)*)/giu.test(e))return[e,[]];const t=Im.findFirstMatchInArray(this.getAllKnownNicknames()),s=this.getAllKnownNicknamesRegex(),n=[...e.matchAll(s)].filter((e=>!e[0].startsWith("/"))),r=n.map((e=>{let s=e[0].indexOf("@");"@"===e[0][s+1]&&(s+=1);const n=e.index+s,r=n+e[0].length-s,o=t(e[1]);return{begin:n,end:r,value:o,type:"mention",uri:this.getReferenceURIFromNickname(o)}})),[o,i]=Im.reduceTextFromReferences(e,r);return[o,i]},async getOutgoingMessageAttributes(e){await ef.emojis.initialize();const t=this.get("composing_spoiler");let s,n="";e?.body&&([n,s]=this.parseTextForReferences(e.body));const r=Mc(),o=n?tp.shortnamesToUnicode(n):void 0;return e=Object.assign({},e,{body:o,is_spoiler:t,origin_id:r,references:s,id:r,msgid:r,from:`${this.get("jid")}/${this.get("nick")}`,fullname:this.get("nick"),is_only_emojis:!!n&&tp.isOnlyEmojis(n),message:o,nick:this.get("nick"),sender:"me",type:"groupchat"},_f(n)),e=await ef.hook("getOutgoingMessageAttributes",this,e)},getRoomJIDAndNick(){const e=this.get("nick");return _e.getBareJidFromJid(this.get("jid"))+(null!==e?`/${e}`:"")},sendChatState(){if(!ef.settings.get("send_chat_state_notifications")||!this.get("chat_state")||!this.isEntered()||this.features.get("moderated")&&"visitor"===this.getOwnRole())return;const e=ef.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;const t=this.get("chat_state");t!==td.GONE&&ef.send(p({to:this.get("jid"),type:"groupchat"}).c(t,{xmlns:_e.NS.CHATSTATES}).up().c("no-store",{xmlns:_e.NS.HINTS}).up().c("no-permanent-store",{xmlns:_e.NS.HINTS}))},directInvite(e,t){this.features.get("membersonly")&&this.updateMemberLists([{jid:e,affiliation:"member",reason:t}]);const s={xmlns:"jabber:x:conference",jid:this.get("jid")};null!==t&&(s.reason=t),this.get("password")&&(s.password=this.get("password"));const n=p({from:td.connection.jid,to:e,id:Mc()}).c("x",s);ef.send(n),ef.trigger("roomInviteSent",{room:this,recipient:e,reason:t})},refreshDiscoInfo(){return ef.disco.refresh(this.get("jid")).then((()=>this.getDiscoInfo())).catch((e=>De.error(e)))},getDiscoInfo(){return ef.disco.getIdentity("conference","text",this.get("jid")).then((e=>this.save({name:e?.get("name")}))).then((()=>this.getDiscoInfoFields())).then((()=>this.getDiscoInfoFeatures())).catch((e=>De.error(e)))},async getDiscoInfoFields(){const e=(await ef.disco.getFields(this.get("jid"))).reduce(((e,t)=>{const s=t.get("var");return s?.startsWith("muc#roominfo_")&&(e[s.replace("muc#roominfo_","")]=t.get("value")),e}),{});this.config.save(e)},async getDiscoInfoFeatures(){const e=await ef.disco.getFeatures(this.get("jid")),t=Zh.ROOM_FEATURES.reduce(((e,t)=>(e[t]=!1,e)),{fetched:(new Date).toISOString()});e.each((e=>{const s=e.get("var");s.startsWith("muc_")?t[s.replace("muc_","")]=!0:s===_e.NS.MAM?t.mam_enabled=!0:t[s]=!0})),this.features.save(t)},addFieldValue(e){const t=e.getAttribute("type");if("fixed"===t)return e;const s=e.getAttribute("var").replace("muc#roomconfig_",""),n=this.get("roomconfig");if(s in n){let r;switch(t){case"boolean":r=[n[s]?1:0];break;case"list-multi":r=n[s];break;default:r=[n[s]]}e.innerHTML=r.map((e=>m("value").t(e))).join("")}return e},async autoConfigureChatRoom(){const e=await this.fetchRoomConfiguration(),t=Nl()("field",e).map((e=>this.addFieldValue(e)));if(t.length)return this.sendConfiguration(t)},fetchRoomConfiguration(){return ef.sendIQ(g({to:this.get("jid"),type:"get"}).c("query",{xmlns:_e.NS.MUC_OWNER}))},sendConfiguration(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=g({to:this.get("jid"),type:"set"}).c("query",{xmlns:_e.NS.MUC_OWNER}).c("x",{xmlns:_e.NS.XFORM,type:"submit"});return e.forEach((e=>t.cnode(e).up())),ef.sendIQ(t)},onCommandError(e){const{__:t}=td;De.fatal(e);const s=t("Sorry, an error happened while running the command.")+" "+t("Check your browser's developer console for details.");this.createMessage({message:s,type:"error"})},getNickOrJIDFromCommandArgs(e){const{__:t}=td;if(tp.isValidJID(e.trim()))return e.trim();e.startsWith("@")||(e="@"+e);const[s,n]=this.parseTextForReferences(e);if(!n.length){const e=t("Error: couldn't find a groupchat participant based on your arguments");return void this.createMessage({message:e,type:"error"})}if(n.length>1){const e=t("Error: found multiple groupchat participant based on your arguments");return void this.createMessage({message:e,type:"error"})}const r=n.pop().value,o=e.split(r,2)[1];if(!o||o.startsWith(" "))return r;{const e=t("Error: couldn't find a groupchat participant based on your arguments");this.createMessage({message:e,type:"error"})}},validateRoleOrAffiliationChangeArgs(e,t){const{__:s}=td;if(!t){const t=s('Error: the "%1$s" command takes two arguments, the user\'s nickname and optionally a reason.',e);return this.createMessage({message:t,type:"error"}),!1}return!0},getAllowedCommands(){let e=["clear","help","me","nick","register"];(this.config.get("changesubject")||["owner","admin"].includes(this.getOwnAffiliation()))&&(e=[...e,"subject","topic"]);const t=this.occupants.findWhere({jid:td.bare_jid});return this.verifyAffiliations(["owner"],t,!1)?e=e.concat(sp).concat(np):this.verifyAffiliations(["admin"],t,!1)&&(e=e.concat(np)),this.verifyRoles(["moderator"],t,!1)?e=e.concat(rp).concat(op):this.verifyRoles(["visitor","participant","moderator"],t,!1)||(e=e.concat(op)),e.sort(),Array.isArray(ef.settings.get("muc_disable_slash_commands"))?e.filter((e=>!ef.settings.get("muc_disable_slash_commands").includes(e))):e},verifyAffiliations(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{__:n}=td;if(!Array.isArray(e))throw new TypeError("affiliations must be an Array");if(!e.length)return!0;if(t=t||this.occupants.findWhere({jid:td.bare_jid})){const s=t.get("affiliation");if(e.includes(s))return!0}if(s){const e=n("Forbidden: you do not have the necessary affiliation in order to do that.");this.createMessage({message:e,type:"error"})}return!1},verifyRoles(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{__:n}=td;if(!Array.isArray(e))throw new TypeError("roles must be an Array");if(!e.length)return!0;if(t=t||this.occupants.findWhere({jid:td.bare_jid})){const s=t.get("role");if(e.includes(s))return!0}if(s){const e=n("Forbidden: you do not have the necessary role in order to do that.");this.createMessage({message:e,type:"error",is_ephemeral:2e4})}return!1},getOwnRole(){return this.getOwnOccupant()?.attributes?.role},getOwnAffiliation(){return this.getOwnOccupant()?.attributes?.affiliation||"none"},getOwnOccupant(){return this.occupants.getOwnOccupant()},async setNickname(e){if(ef.settings.get("auto_register_muc_nickname")&&await ef.disco.supports(_e.NS.MUC_REGISTER,this.get("jid"))){const t=this.get("nick");this.set({nick:e});try{await this.registerNickname()}catch(e){const{__:s}=td;De.error(e);const n=s("Error: couldn't register new nickname in members only room");return this.createMessage({message:n,type:"error",is_ephemeral:!0}),void this.set({nick:t})}}const t=_e.getBareJidFromJid(this.get("jid"));ef.send(_({from:td.connection.jid,to:`${t}/${e}`,id:Mc()}).tree())},setRole(e,t,s,n,r){const o=m("item",{nick:e.get("nick"),role:t}),i=g({to:this.get("jid"),type:"set"}).c("query",{xmlns:_e.NS.MUC_ADMIN}).cnode(o.node);return null!==s&&i.c("reason",s),ef.sendIQ(i).then(n).catch(r)},getOccupant(e){return tp.isValidJID(e)?this.getOccupantByJID(e):this.getOccupantByNickname(e)},getOccupantsWithRole(e){return this.getOccupantsSortedBy("nick").filter((t=>t.get("role")===e)).map((e=>({jid:e.get("jid"),nick:e.get("nick"),role:e.get("role")})))},getOccupantsWithAffiliation(e){return this.getOccupantsSortedBy("nick").filter((t=>t.get("affiliation")===e)).map((e=>({jid:e.get("jid"),nick:e.get("nick"),affiliation:e.get("affiliation")})))},getOccupantsSortedBy(e){return Array.from(this.occupants.models).sort(((t,s)=>t.get(e)<s.get(e)?-1:t.get(e)>s.get(e)?1:0))},async updateMemberLists(e){const t=this.get("jid"),s=await Promise.all(["member","admin","owner"].map((e=>Xm(e,t)))),n=s.reduce(((e,t)=>tp.isErrorObject(t)?e:[...t,...e]),[]);await Zm(t,ep(!0,!1,e,n)),await this.occupants.fetchMembers()},async getAndPersistNickname(e){return(e=e||this.get("nick")||await this.getReservedNick()||td.getDefaultMUCNickname())&&Nc(this,{nick:e},{silent:!0}),e},async getReservedNick(){const e=g({to:this.get("jid"),from:td.connection.jid,type:"get"}).c("query",{xmlns:_e.NS.DISCO_INFO,node:"x-roomuser-item"}),t=await ef.sendIQ(e,null,!1);if(tp.isErrorObject(t))throw t;const s=t?.querySelector('query[node="x-roomuser-item"] identity');return s?s.getAttribute("name"):null},async registerNickname(){const{__:e}=td,t=this.get("nick"),s=this.get("jid");let n,r;try{n=await ef.sendIQ(g({to:s,type:"get"}).c("query",{xmlns:_e.NS.MUC_REGISTER}))}catch(t){return Nl()(`not-allowed[xmlns="${_e.NS.STANZAS}"]`,t).length?r=e("You're not allowed to register yourself in this groupchat."):Nl()(`registration-required[xmlns="${_e.NS.STANZAS}"]`,t).length&&(r=e("You're not allowed to register in this groupchat because it's members-only.")),De.error(t),r}const o=Nl()("field required",n).map((e=>e.parentElement));if(o.length>1&&"muc#register_roomnick"!==o[0].getAttribute("var"))return De.error(`Can't register the user register in the groupchat ${s} due to the required fields`);try{await ef.sendIQ(g({to:s,type:"set"}).c("query",{xmlns:_e.NS.MUC_REGISTER}).c("x",{xmlns:_e.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up().c("field",{var:"muc#register_roomnick"}).c("value").t(t))}catch(t){return Nl()(`service-unavailable[xmlns="${_e.NS.STANZAS}"]`,t).length?r=e("Can't register your nickname in this groupchat, it doesn't support registration."):Nl()(`bad-request[xmlns="${_e.NS.STANZAS}"]`,t).length&&(r=e("Can't register your nickname in this groupchat, invalid data form supplied.")),De.error(r),De.error(t),r}},async unregisterNickname(){if("unregister"===ef.settings.get("auto_register_muc_nickname"))try{await ef.disco.supports(_e.NS.MUC_REGISTER,this.get("jid"))&&await this.sendUnregistrationIQ()}catch(e){De.error(e)}},sendUnregistrationIQ(){const e=g({to:this.get("jid"),type:"set"}).c("query",{xmlns:_e.NS.MUC_REGISTER}).c("remove");return ef.sendIQ(e).catch((e=>De.error(e)))},updateOccupantsOnPresence(e){const t=function(e,t){const s=e.getAttribute("from"),n=e.getAttribute("type"),r={is_me:!!e.querySelector("status[code='110']"),from:s,occupant_id:Wm(e,t),nick:Um.getResourceFromJid(s),type:n,states:[],hats:[],show:"unavailable"!==n?"online":"offline"};return Array.from(e.children).forEach((e=>{e.matches("status")?r.status=e.textContent||null:e.matches("show")?r.show=e.textContent||"online":e.matches("x")&&e.getAttribute("xmlns")===Um.NS.MUC_USER?Array.from(e.children).forEach((e=>{"item"===e.nodeName?(r.affiliation=e.getAttribute("affiliation"),r.role=e.getAttribute("role"),r.jid=e.getAttribute("jid"),r.nick=e.getAttribute("nick")||r.nick):"status"==e.nodeName&&e.getAttribute("code")&&r.states.push(e.getAttribute("code"))})):e.matches("x")&&e.getAttribute("xmlns")===Um.NS.VCARDUPDATE?r.image_hash=e.querySelector("photo")?.textContent:e.matches("hats")&&e.getAttribute("xmlns")===Um.NS.MUC_HATS&&(r.hats=Array.from(e.children).map((e=>e.matches("hat")&&{title:e.getAttribute("title"),uri:e.getAttribute("uri")})))})),r}(e,this);if("error"===t.type||!t.jid&&!t.nick&&!t.occupant_id)return!0;const s=this.occupants.findOccupant(t);if("unavailable"===t.type&&s&&!t.states.includes(Zh.MUC_NICK_CHANGED_CODE)&&!["admin","owner","member"].includes(t.affiliation))return s.set(t),void s.destroy();const n=t.jid||"",r={...t,jid:_e.getBareJidFromJid(n)||s?.attributes?.jid,resource:_e.getResourceFromJid(n)||s?.attributes?.resource};if(t.is_me){let e=!1;t.states.includes(Zh.MUC_NICK_CHANGED_CODE)&&(e=!0,this.set("nick",t.nick)),this.features.get(_e.NS.OCCUPANTID)&&this.get("occupant-id")!==t.occupant_id&&(e=!0,this.set("occupant_id",t.occupant_id)),e&&this.save()}s?s.save(r):this.occupants.create(r)},fetchFeaturesIfConfigurationChanged(e){const t=["104","170","171","172","173","174"];Nl()("status",e).filter((e=>t.includes(e.getAttribute("status")))).length&&this.refreshDiscoInfo()},isSameUser(e,t){const s=_e.getBareJidFromJid(e),n=_e.getBareJidFromJid(t),r=_e.getResourceFromJid(e),o=_e.getResourceFromJid(t);return tp.isSameBareJID(e,t)?s!==this.get("jid")||r===o:(s===this.get("jid")?this.occupants.findOccupant({nick:r}):this.occupants.findOccupant({jid:s}))===(n===this.get("jid")?this.occupants.findOccupant({nick:o}):this.occupants.findOccupant({jid:n}))},async isSubjectHidden(){return(await ef.user.settings.get("mucs_with_hidden_subject",[])).includes(this.get("jid"))},async toggleSubjectHiddenState(){const e=this.get("jid"),t=await ef.user.settings.get("mucs_with_hidden_subject",[]);t.includes(this.get("jid"))?ef.user.settings.set("mucs_with_hidden_subject",t.filter((t=>t!==e))):ef.user.settings.set("mucs_with_hidden_subject",[...t,e])},async handleSubjectChange(e){const t=td.__;if("string"==typeof e.subject&&!e.thread&&!e.message){const s=e.subject,n=e.nick;if(Nc(this,{subject:{author:n,text:e.subject||""}}),!e.is_delayed&&n){const r=t(s?"Topic set by %1$s":"Topic cleared by %1$s",n),o=this.messages.last();o?.get("nick")===e.nick&&"info"===o?.get("type")&&o?.get("message")===r||this.createMessage({message:r,nick:e.nick,type:"info",is_ephemeral:!0}),await this.isSubjectHidden()&&this.toggleSubjectHiddenState()}return!0}return!1},setSubject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";ef.send(p({to:this.get("jid"),from:td.connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e).tree())},ignorableCSN(e){return e.chat_state&&!e.body&&(e.is_delayed||this.isOwnMessage(e))},isOwnMessage(e){let t;return t=e instanceof Element?e.getAttribute("from"):e instanceof td.Message?e.get("from"):e.from,_e.getResourceFromJid(t)==this.get("nick")},getUpdatedMessageAttributes(e,t){const s={...td.ChatBox.prototype.getUpdatedMessageAttributes.call(this,e,t),...Cl(t,["from_muc","occupant_id"])};if(this.isOwnMessage(t)){const n=Object.keys(t).filter((e=>e.startsWith("stanza_id")));Object.assign(s,Cl(t,n)),e.get("received")||(s.received=(new Date).toISOString())}return s},async isJoined(){return this.isEntered()?(ef.connection.connected()||await new Promise((e=>ef.listen.once("reconnected",e))),ef.ping(`${this.get("jid")}/${this.get("nick")}`)):(De.info(`isJoined: not pinging MUC ${this.get("jid")} since we're not entered`),!1)},async sendStatusPresence(e,t,s){if(this.session.get("connection_status")===Fm.ENTERED){const n=await td.xmppstatus.constructPresence(e,this.getRoomJIDAndNick(),t);s?.map((e=>e?.tree()??e)).forEach((e=>n.cnode(e).up())),ef.send(n)}},async rejoinIfNecessary(){return this.isRAICandidate()?(De.debug(`rejoinIfNecessary: not rejoining hidden MUC "${this.get("jid")}" since we're using RAI`),!0):await this.isJoined()?void 0:(this.rejoin(),!0)},async shouldShowErrorMessage(e){if("Decryption"===e.error_type){if("Message key not found. The counter was repeated or the key was not filled."===e.error_message)return!1;if("not-encrypted-for-this-device"===e.error_condition)return!1}else if("not-acceptable"===e.error_condition&&await this.rejoinIfNecessary())return!1;return td.ChatBox.prototype.shouldShowErrorMessage.call(this,e)},findDanglingModeration(e){if(!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models),s=e[`stanza_id ${this.get("jid")}`];return s?(t.reverse(),t.find((e=>{let{attributes:t}=e;return"retracted"===t.moderated&&t.moderated_id===s&&t.moderated_by}))):null}},async handleModeration(e){const t=["editable","moderated","moderated_by","moderated_id","moderation_reason"];if("retracted"===e.moderated){const s={};s[`stanza_id ${this.get("jid")}`]=e.moderated_id;const n=this.messages.findWhere(s);return n?(n.save(Cl(e,t)),!0):(e.dangling_moderation=!0,await this.createMessage(e),!0)}{const s=this.findDanglingModeration(e);if(s){const n=Cl(s.attributes,t),r=Object.assign({dangling_moderation:!1},e,n);return delete r.id,s.save(r),!0}}return!1},getNotificationsText(){const{__:e}=td,t=this.notifications.toJSON(),s=ef.settings.get("muc_show_info_messages").filter((e=>Zh.MUC_ROLE_CHANGES_LIST.includes(e))),n=ef.settings.get("muc_show_info_messages").filter((e=>Zh.MUC_TRAFFIC_STATES_LIST.includes(e)));return[...Zh.CHAT_STATES,...n,...s].reduce(((s,n)=>{const r=t[n];if(!r?.length)return s;const o=r.map((e=>this.getOccupant(e)?.getDisplayName()||e));if(1===o.length){if("composing"===n)return`${s}${e("%1$s is typing",o[0])}\n`;if("paused"===n)return`${s}${e("%1$s has stopped typing",o[0])}\n`;if(n===td.GONE)return`${s}${e("%1$s has gone away",o[0])}\n`;if("entered"===n)return`${s}${e("%1$s has entered the groupchat",o[0])}\n`;if("exited"===n)return`${s}${e("%1$s has left the groupchat",o[0])}\n`;if("op"===n)return`${s}${e("%1$s is now a moderator",o[0])}\n`;if("deop"===n)return`${s}${e("%1$s is no longer a moderator",o[0])}\n`;if("voice"===n)return`${s}${e("%1$s has been given a voice",o[0])}\n`;if("mute"===n)return`${s}${e("%1$s has been muted",o[0])}\n`}else if(o.length>1){let t;if(o.length>3)t=`${Array.from(o).slice(0,2).join(", ")} and others`;else{const s=o.pop();t=e("%1$s and %2$s",o.join(", "),s)}if("composing"===n)return`${s}${e("%1$s are typing",t)}\n`;if("paused"===n)return`${s}${e("%1$s have stopped typing",t)}\n`;if(n===td.GONE)return`${s}${e("%1$s have gone away",t)}\n`;if("entered"===n)return`${s}${e("%1$s have entered the groupchat",t)}\n`;if("exited"===n)return`${s}${e("%1$s have left the groupchat",t)}\n`;if("op"===n)return`${s}${e("%1$s are now moderators",o[0])}\n`;if("deop"===n)return`${s}${e("%1$s are no longer moderators",o[0])}\n`;if("voice"===n)return`${s}${e("%1$s have been given voices",o[0])}\n`;if("mute"===n)return`${s}${e("%1$s have been muted",o[0])}\n`}return s}),"")},removeNotification(e,t){const s=this.notifications.toJSON();(t=Array.isArray(t)?t:[t]).forEach((t=>{const n=Array.from(s[t]||[]);if(n.includes(e)){const s=n.indexOf(e);n.splice(s,1),this.notifications.set(t,Array.from(n))}}))},updateNotifications(e,t){const s=this.notifications.toJSON(),n=s[t]||[];if(n.includes(e))return;const r=(r,o)=>(r[o]=o===t?[...n,e]:(s[o]||[]).filter((t=>t!==e)),r),o=Zh.CHAT_STATES.reduce(r,{}),i=Zh.MUC_TRAFFIC_STATES_LIST.reduce(r,{}),a=Zh.MUC_ROLE_CHANGES_LIST.reduce(r,{});this.notifications.set(Object.assign(o,i,a)),window.setTimeout((()=>this.removeNotification(e,t)),1e4)},handleMetadataFastening(e){if(e.ogp_for_id){if(e.from!==this.get("jid"))return!1;const t=this.messages.findWhere({origin_id:e.ogp_for_id});if(t){const s=t.get("ogp_metadata")||[];if(s.filter((t=>t["og:url"]===e["og:url"])).length)return!1;const n=[...s,Cl(e,ip)];return t.save("ogp_metadata",n),!0}}return!1},handleMEPNotification(e){return!(e.from!==this.get("jid")||!e.activities||(e.activities?.forEach((t=>{const s=Object.assign(e,t);this.createMessage(s),ef.trigger("message",{attrs:s,chatbox:this})})),!e.activities.length))},getDuplicateMessage(e){return e.activities?.length?this.messages.findWhere({type:"mep",msgid:e.msgid}):td.ChatBox.prototype.getDuplicateMessage.call(this,e)},async onMessage(e){if(e=await e,tp.isErrorObject(e))return e.stanza&&De.error(e.stanza),De.error(e.message);if("error"===e.type&&!await this.shouldShowErrorMessage(e))return;const t=this.getDuplicateMessage(e);if(t)"groupchat"===t.get("type")&&this.updateMessage(t,e);else if(!(e.receipt_id||e.is_marker||this.ignorableCSN(e)))if(this.handleMetadataFastening(e)||this.handleMEPNotification(e)||await this.handleRetraction(e)||await this.handleModeration(e)||await this.handleSubjectChange(e))e.nick&&this.removeNotification(e.nick,["composing","paused"]);else if(this.setEditable(e,e.time),e.chat_state&&this.updateNotifications(e.nick,e.chat_state),tp.shouldCreateGroupchatMessage(e)){const t=await of(this,e)||await this.createMessage(e);this.removeNotification(e.nick,["composing","paused"]),this.handleUnreadMessage(t)}},handleModifyError(e){const t=e.querySelector("error text")?.textContent;if(t)if(this.session.get("connection_status")===Fm.CONNECTING)this.setDisconnectionState(t);else{const e={type:"error",message:t,is_ephemeral:!0};this.createMessage(e)}},handleDisconnection(e){const t=null!==e.querySelector("status[code='110']"),s=Nl()(`x[xmlns="${_e.NS.MUC_USER}"]`,e).pop();if(!s)return;const n=Object.keys(td.muc.disconnect_messages),r=Nl()("status",s).map((e=>e.getAttribute("code"))).filter((e=>n.includes(e)));if(!(t&&r.length>0))return;const o=s.querySelector("item"),i=o?o.querySelector("reason")?.textContent:void 0,a=o?o.querySelector("actor")?.getAttribute("nick"):void 0,l=td.muc.disconnect_messages[r[0]],c=r.includes("301")?Fm.BANNED:Fm.DISCONNECTED;this.setDisconnectionState(l,i,a,c)},getActionInfoMessage(e,t,s){const n=td.__;return"301"===e?s?n("%1$s has been banned by %2$s",t,s):n("%1$s has been banned",t):"303"===e?n("%1$s's nickname has changed",t):"307"===e?s?n("%1$s has been kicked out by %2$s",t,s):n("%1$s has been kicked out",t):"321"===e?n("%1$s has been removed because of an affiliation change",t):"322"===e?n("%1$s has been removed for not being a member",t):void 0},createAffiliationChangeMessage(e){const t=td.__,s=e._previousAttributes.affiliation;if(!s)return;const n=e.get("affiliation");"admin"===s&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.EXADMIN)?this.createMessage({type:"info",message:t("%1$s is no longer an admin of this groupchat",e.get("nick"))}):"owner"===s&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.EXOWNER)?this.createMessage({type:"info",message:t("%1$s is no longer an owner of this groupchat",e.get("nick"))}):"outcast"===s&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.EXOUTCAST)&&this.createMessage({type:"info",message:t("%1$s is no longer banned from this groupchat",e.get("nick"))}),"none"===n&&"member"===s&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.EXMEMBER)&&this.createMessage({type:"info",message:t("%1$s is no longer a member of this groupchat",e.get("nick"))}),"member"===n&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.MEMBER)?this.createMessage({type:"info",message:t("%1$s is now a member of this groupchat",e.get("nick"))}):("admin"===n&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.ADMIN)||"owner"==n&&td.isInfoVisible(Zh.AFFILIATION_CHANGES.OWNER))&&this.createMessage({type:"info",message:t("%1$s is now an %2$s of this groupchat",e.get("nick"),n)})},createRoleChangeMessage(e,t){if("none"===t||e.changed.affiliation)return;const s=e._previousAttributes.role;"moderator"===s&&td.isInfoVisible(Zh.MUC_ROLE_CHANGES.DEOP)?this.updateNotifications(e.get("nick"),Zh.MUC_ROLE_CHANGES.DEOP):"visitor"===s&&td.isInfoVisible(Zh.MUC_ROLE_CHANGES.VOICE)&&this.updateNotifications(e.get("nick"),Zh.MUC_ROLE_CHANGES.VOICE),"visitor"===e.get("role")&&td.isInfoVisible(Zh.MUC_ROLE_CHANGES.MUTE)?this.updateNotifications(e.get("nick"),Zh.MUC_ROLE_CHANGES.MUTE):"moderator"===e.get("role")&&!["owner","admin"].includes(e.get("affiliation"))&&td.isInfoVisible(Zh.MUC_ROLE_CHANGES.OP)&&this.updateNotifications(e.get("nick"),Zh.MUC_ROLE_CHANGES.OP)},createInfoMessage(e,t,s){const n=td.__,r={type:"info",is_ephemeral:!0};if(td.isInfoVisible(e)&&"110"!==e&&("100"!==e||s)){if(e in td.muc.info_messages)r.message=td.muc.info_messages[e];else if(!s&&ap.includes(e)){const s=_e.getResourceFromJid(t.getAttribute("from")),n=Nl()(`x[xmlns="${_e.NS.MUC_USER}"] item`,t).pop();r.actor=n?n.querySelector("actor")?.getAttribute("nick"):void 0,r.reason=n?n.querySelector("reason")?.textContent:void 0,r.message=this.getActionInfoMessage(e,s,r.actor)}else if(s&&e in td.muc.new_nickname_messages){let s;"210"===e?s=_e.getResourceFromJid(t.getAttribute("from")):"303"===e&&(s=Nl()(`x[xmlns="${_e.NS.MUC_USER}"] item`,t).pop().getAttribute("nick")),this.save("nick",s),r.message=n(td.muc.new_nickname_messages[e],s)}if(r.message){if("201"===e&&this.messages.findWhere(r))return;this.createMessage(r)}}},createInfoMessages(e){const t=Nl()(`x[xmlns="${_e.NS.MUC_USER}"] status`,e).map((e=>e.getAttribute("code")));t.includes("333")&&t.includes("307")&&t.splice(t.indexOf("307"),1);const s=t.includes("110");t.forEach((t=>this.createInfoMessage(t,e,s)))},setDisconnectionState(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fm.DISCONNECTED;this.session.save({connection_status:n,disconnection_actor:s,disconnection_message:e,disconnection_reason:t})},onNicknameClash(e){const t=td.__;if(ef.settings.get("muc_nickname_from_jid")){const t=e.getAttribute("from").split("/")[1];if(t===td.getDefaultMUCNickname())this.join(t+"-2");else{const e=t.lastIndexOf("-"),s=t.substring(e+1,t.length);this.join(t.substring(0,e+1)+String(Number(s)+1))}}else this.save({nickname_validation_message:t("The nickname you chose is reserved or currently in use, please choose a different one.")}),this.session.save({connection_status:Fm.NICKNAME_REQUIRED})},onErrorPresence(e){const t=td.__,s=e.querySelector("error"),n=s.getAttribute("type"),r=Nl()(`text[xmlns="${_e.NS.STANZAS}"]`,s).pop()?.textContent;if("modify"===n)this.handleModifyError(e);else if("auth"===n)if(Nl()(`not-authorized[xmlns="${_e.NS.STANZAS}"]`,s).length&&(this.save({password_validation_message:r||t("Password incorrect")}),this.session.save({connection_status:Fm.PASSWORD_REQUIRED})),s.querySelector("registration-required")){const e=t("You are not on the member list of this groupchat.");this.setDisconnectionState(e,r)}else s.querySelector("forbidden")&&this.setDisconnectionState(td.muc.disconnect_messages[301],r,null,Fm.BANNED);else if("cancel"===n)if(s.querySelector("not-allowed")){const e=t("You are not allowed to create new groupchats.");this.setDisconnectionState(e,r)}else if(s.querySelector("not-acceptable")){const e=t("Your nickname doesn't conform to this groupchat's policies.");this.setDisconnectionState(e,r)}else if(Nl()(`gone[xmlns="${_e.NS.STANZAS}"]`,s).length){const e=Nl()(`gone[xmlns="${_e.NS.STANZAS}"]`,s).pop()?.textContent.replace(/^xmpp:/,"").replace(/\?join$/,"");this.save({moved_jid:e,destroyed_reason:r}),this.session.save({connection_status:Fm.DESTROYED})}else if(s.querySelector("conflict"))this.onNicknameClash(e);else if(s.querySelector("item-not-found")){const e=t("This groupchat does not (yet) exist.");this.setDisconnectionState(e,r)}else if(s.querySelector("service-unavailable")){const e=t("This groupchat has reached its maximum number of participants.");this.setDisconnectionState(e,r)}else if(s.querySelector("remote-server-not-found")){const e=t("Remote server not found");this.setDisconnectionState(e,r)}else if(s.querySelector("forbidden")){const e=t("You're not allowed to enter this groupchat");this.setDisconnectionState(e,r)}else{const e=t("An error happened while trying to enter this groupchat");this.setDisconnectionState(e,r)}},onPresenceFromMUCHost(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error");"wait"===t?.getAttribute("type")&&t?.querySelector("resource-constraint")&&this.session.get("connection_status")===Fm.DISCONNECTED&&this.rejoin()}},onPresence(e){if("error"===e.getAttribute("type"))return this.onErrorPresence(e);this.createInfoMessages(e),e.querySelector("status[code='110']")?(this.onOwnPresence(e),"none"!==this.getOwnRole()&&this.session.get("connection_status")===Fm.CONNECTING&&this.session.save("connection_status",Fm.CONNECTED)):this.updateOccupantsOnPresence(e)},async onOwnPresence(e){if(await this.occupants.fetched,"unavailable"===e.getAttribute("type"))return void this.handleDisconnection(e);const t=this.session.get("connection_status");t!==Fm.ENTERED&&t!==Fm.CLOSING?(this.session.save("connection_status",Fm.ENTERED,{silent:!0}),this.updateOccupantsOnPresence(e),this.session.trigger("change:connection_status",this.session,t)):this.updateOccupantsOnPresence(e),e.querySelector("status[code='201']")&&(this.get("auto_configure")?await this.autoConfigureChatRoom().then((()=>this.refreshDiscoInfo())):ef.settings.get("muc_instant_rooms")?await this.sendConfiguration().then((()=>this.refreshDiscoInfo())):this.session.save({view:Zh.MUC.VIEWS.CONFIG}))},isUserMentioned(e){const t=this.get("nick");return e.get("references").length?e.get("references").filter((e=>"mention"===e.type)).map((e=>e.value)).includes(t):new RegExp(`\\b${t}\\b`).test(e.get("body"))},incrementUnreadMsgsCounter(e){const t={num_unread_general:this.get("num_unread_general")+1};0===this.get("num_unread_general")&&(t.first_unread_id=e.get("id")),this.isUserMentioned(e)&&(t.num_unread=this.get("num_unread")+1),this.save(t)},clearUnreadMsgCounter(){(this.get("num_unread_general")>0||this.get("num_unread")>0||this.get("has_activity"))&&this.sendMarkerForMessage(this.messages.last()),Nc(this,{has_activity:!1,num_unread:0,num_unread_general:0})}},dp=cp,up=class extends nc{defaults(){return{hats:[],show:"offline",states:[]}}save(e,t,s){let n;return null==e?super.save(e,t,s):("object"==typeof e?(n=e,s=t):(n={})[e]=t,n.occupant_id&&(n.id=n.occupant_id),super.save(n,s))}getDisplayName(){return this.get("nick")||this.get("jid")}isMember(){return["admin","owner","member"].includes(this.get("affiliation"))}isModerator(){return["admin","owner"].includes(this.get("affiliation"))||"moderator"===this.get("role")}isSelf(){return this.get("states").includes("110")}},{Strophe:hp,sizzle:fp,u:mp}=Zh.env;function pp(){td.connection.addHandler((e=>(td.onDirectMUCInvitation(e),!0)),"jabber:x:conference","message")}function gp(){return td.chatboxes.filter((e=>e.get("type")===td.CHATROOMS_TYPE)).forEach((e=>e.session.save({connection_status:Zh.ROOMSTATUS.DISCONNECTED})))}async function _p(e){"visible"===e.state&&ef.connection.connected()&&(await ef.rooms.get()).forEach((e=>e.rejoinIfNecessary()))}async function vp(e){if(!mp.isValidMUCJID(e))return De.warn(`invalid jid "${e}" provided in url fragment`);await ef.waitUntil("roomsAutoJoined"),ef.settings.get("allow_bookmarks")&&await ef.waitUntil("bookmarksInitialized"),ef.rooms.open(e)}async function yp(e){const t=fp('x[xmlns="jabber:x:conference"]',e).pop(),s=hp.getBareJidFromJid(e.getAttribute("from")),n=t.getAttribute("jid"),r=t.getAttribute("reason");let o;if(ef.settings.get("auto_join_on_invite"))o=!0;else{const e=td.roster.get(s)?.getDisplayName()??s;o=await ef.hook("confirmDirectMUCInvitation",{contact:e,reason:r,jid:n},!1)}o&&(await async function(e,t){t.type=td.CHATROOMS_TYPE,t.id=e;const s=await ef.rooms.get(e,t,!0);return s.maybeShow(!0),s}(n,{password:t.getAttribute("password")})).session.get("connection_status")===Zh.ROOMSTATUS.DISCONNECTED&&td.chatboxes.get(n).rejoin()}function bp(){if(!td.xmppstatus)throw new Error("Can't call _converse.getDefaultMUCNickname before the statusInitialized has been fired.");const e=td.xmppstatus.getNickname();return e||(ef.settings.get("muc_nickname_from_jid")?hp.unescapeNode(hp.getNodeFromJid(td.bare_jid)):void 0)}function jp(e){return!!ef.settings.get("muc_show_info_messages").includes(e)}async function wp(){await Promise.all(ef.settings.get("auto_join_rooms").map((e=>"string"==typeof e?td.chatboxes.where({jid:e}).length?Promise.resolve():ef.rooms.open(e):e instanceof Object?ef.rooms.open(e.jid,{...e}):(De.error('Invalid muc criteria specified for "auto_join_rooms"'),Promise.resolve())))),ef.trigger("roomsAutoJoined")}function Sp(){ef.disco.own.features.add(hp.NS.MUC),ef.settings.get("allow_muc_invitations")&&ef.disco.own.features.add("jabber:x:conference")}function xp(){td.chatboxes.where({type:td.CHATROOMS_TYPE}).forEach((e=>Nc(e.session,{connection_status:Zh.ROOMSTATUS.DISCONNECTED})))}function Ep(){window.addEventListener(td.unloadevent,(()=>{!ef.connection.isType("websocket")||ef.settings.get("enable_smacks")&&td.session.get("smacks_stream_id")||gp()}))}function Ap(){td.connection.addHandler((e=>{const t=hp.getBareJidFromJid(e.getAttribute("from"));return td.chatboxes.get(t)||ef.waitUntil("chatBoxesFetched").then((async()=>{const s=td.chatboxes.get(t);s&&(await s.initialized,s.message_handler.run(e))})),!0}),null,"message","groupchat")}Object.assign(td,{getAssignableRoles:function(e){let t=ef.settings.get("modtools_disable_assign");return Array.isArray(t)||(t=t?km:[]),"moderator"===e.get("role")?km.filter((e=>!t.includes(e))):[]}});const{u:Cp}=Zh.env,Tp=class extends gu{model=up;comparator(e,t){const s=e.get("role")||"none",n=t.get("role")||"none";if(Om[s]===Om[n]){const s=e.getDisplayName().toLowerCase(),n=t.getDisplayName().toLowerCase();return s<n?-1:s>n?1:0}return Om[s]<Om[n]?-1:1}create(e,t){return e.id||e instanceof nc||(e.id=e.occupant_id||Mc()),super.create(e,t)}async fetchMembers(){if(!["member","admin","owner"].includes(this.getOwnOccupant()?.get("affiliation")))return;const e=function(){const e=ef.settings.get("muc_fetch_members");return Array.isArray(e)?e:e?["member","admin","owner"]:[]}();if(0===e.length)return;const t=this.chatroom.get("jid"),s=await Promise.all(e.map((e=>Xm(e,t)))),n=s.reduce(((e,t)=>Cp.isErrorObject(t)?e:[...t,...e]),[]),r=e.filter((t=>!Cp.isErrorObject(s[e.indexOf(t)]))),o=n.map((e=>e.jid)).filter((e=>void 0!==e)),i=n.map((e=>!e.jid&&e.nick||void 0)).filter((e=>void 0!==e)),a=this.filter((e=>r.includes(e.get("affiliation"))&&!i.includes(e.get("nick"))&&!o.includes(e.get("jid"))));a.forEach((e=>{e.get("jid")!==td.bare_jid&&("offline"===e.get("show")?e.destroy():e.save("affiliation",null))})),n.forEach((e=>{const t=this.findOccupant(e);t?t.save(e):this.create(e)})),ef.trigger("membersFetched")}findOccupant(e){if(e.occupant_id)return this.get(e.occupant_id);const t=e.jid&&_e.getBareJidFromJid(e.jid);return t&&this.findWhere({jid:t})||e.nick&&this.findWhere({nick:e.nick})}getOwnOccupant(){return this.findOccupant({jid:td.bare_jid,occupant_id:this.chatroom.get("occupant_id")})}},Ip={affiliations:{set:(e,t)=>(t=Array.isArray(t)?t:[t],Zm(e=Array.isArray(e)?e:[e],t))}},{u:kp}=Zh.env,Np={rooms:{create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t="string"==typeof t?{nick:t}:t||{},!t.nick&&ef.settings.get("muc_nickname_from_jid")&&(t.nick=_e.getNodeFromJid(td.bare_jid)),void 0===e)throw new TypeError("rooms.create: You need to provide at least one JID");return"string"==typeof e?ef.rooms.get(kp.getJIDFromURI(e),t,!0):e.map((e=>ef.rooms.get(kp.getJIDFromURI(e),t,!0)))},async open(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await ef.waitUntil("chatBoxesFetched"),void 0===e){const e="rooms.open: You need to provide at least one JID";throw De.error(e),new TypeError(e)}if("string"==typeof e){const n=await ef.rooms.get(e,t,!0);return!t.hidden&&n?.maybeShow(s),n}{const n=await Promise.all(e.map((e=>ef.rooms.get(e,t,!0))));return n.forEach((e=>!t.hidden&&e.maybeShow(s))),n}},async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];async function n(e){e=kp.getJIDFromURI(e);let n=await ef.chatboxes.get(e);return!n&&s?n=await ef.chatboxes.create(e,t,td.ChatRoom):(n=n&&n.get("type")===td.CHATROOMS_TYPE?n:null,n&&Object.keys(t).length&&n.save(t)),n}return await ef.waitUntil("chatBoxesFetched"),void 0===e?(await ef.chatboxes.get()).filter((e=>e.get("type")===td.CHATROOMS_TYPE)):"string"==typeof e?n(e):Promise.all(e.map((e=>n(e))))}}};Zh.AFFILIATION_CHANGES=Mm,Zh.AFFILIATION_CHANGES_LIST=$m,Zh.MUC_TRAFFIC_STATES=Rm,Zh.MUC_TRAFFIC_STATES_LIST=Dm,Zh.MUC_ROLE_CHANGES=Pm,Zh.MUC_ROLE_CHANGES_LIST=Lm,Zh.MUC={INFO_CODES:zm},Zh.MUC_NICK_CHANGED_CODE="303",Zh.ROOM_FEATURES=["passwordprotected","unsecured","hidden","publicroom","membersonly","open","persistent","temporary","nonanonymous","semianonymous","moderated","unmoderated","mam_enabled"],Zh.ROOMSTATUS=Fm;const{Strophe:Op}=Zh.env;Op.addNamespace("MUC_ADMIN",Op.NS.MUC+"#admin"),Op.addNamespace("MUC_OWNER",Op.NS.MUC+"#owner"),Op.addNamespace("MUC_REGISTER","jabber:iq:register"),Op.addNamespace("MUC_ROOMCONF",Op.NS.MUC+"#roomconfig"),Op.addNamespace("MUC_USER",Op.NS.MUC+"#user"),Op.addNamespace("MUC_HATS","xmpp:prosody.im/protocol/hats:1"),Op.addNamespace("CONFINFO","urn:ietf:params:xml:ns:conference-info"),Zh.plugins.add("converse-muc",{dependencies:["converse-chatboxes","converse-chat","converse-disco"],overrides:{ChatBoxes:{model(e,t){const{_converse:s}=this.__super__;return e&&e.type==s.CHATROOMS_TYPE?new s.ChatRoom(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){const{__:e,___:t}=td;if(ef.settings.extend({allow_muc_invitations:!0,auto_join_on_invite:!1,auto_join_rooms:[],auto_register_muc_nickname:!1,hide_muc_participants:!1,locked_muc_domain:!1,modtools_disable_assign:!1,muc_clear_messages_on_leave:!0,muc_domain:void 0,muc_fetch_members:!0,muc_history_max_stanzas:void 0,muc_instant_rooms:!0,muc_nickname_from_jid:!1,muc_send_probes:!1,muc_show_info_messages:[...Zh.MUC.INFO_CODES.visibility_changes,...Zh.MUC.INFO_CODES.self,...Zh.MUC.INFO_CODES.non_privacy_changes,...Zh.MUC.INFO_CODES.muc_logging_changes,...Zh.MUC.INFO_CODES.nickname_changes,...Zh.MUC.INFO_CODES.disconnected,...Zh.MUC.INFO_CODES.affiliation_changes,...Zh.MUC.INFO_CODES.join_leave_events,...Zh.MUC.INFO_CODES.role_changes],muc_show_logs_before_join:!1,muc_subscribe_to_rai:!1}),ef.promises.add(["roomsAutoJoined"]),ef.settings.get("locked_muc_domain")&&"string"!=typeof ef.settings.get("muc_domain"))throw new Error("Config Error: it makes no sense to set locked_muc_domain to true when muc_domain is not set");Zh.env.muc_utils={computeAffiliationsDelta:ep},Object.assign(ef,Np),Object.assign(ef.rooms,Ip),td.muc={info_messages:{100:e("This groupchat is not anonymous"),102:e("This groupchat now shows unavailable members"),103:e("This groupchat does not show unavailable members"),104:e("The groupchat configuration has changed"),170:e("Groupchat logging is now enabled"),171:e("Groupchat logging is now disabled"),172:e("This groupchat is now no longer anonymous"),173:e("This groupchat is now semi-anonymous"),174:e("This groupchat is now fully-anonymous"),201:e("A new groupchat has been created")},new_nickname_messages:{210:t("Your nickname has been automatically set to %1$s"),303:t("Your nickname has been changed to %1$s")},disconnect_messages:{301:e("You have been banned from this groupchat"),333:e("You have exited this groupchat due to a technical problem"),307:e("You have been kicked from this groupchat"),321:e("You have been removed from this groupchat because of an affiliation change"),322:e("You have been removed from this groupchat because the groupchat has changed to members-only and you're not a member"),332:e("You have been removed from this groupchat because the service hosting it is being shut down")}},td.router.route("converse/room?jid=:jid",vp),td.ChatRoom=td.ChatBox.extend(dp),td.ChatRoomMessage=td.Message.extend(Em),td.ChatRoomOccupants=Tp,td.ChatRoomOccupant=up,td.ChatRoomMessages=gu.extend({model:td.ChatRoomMessage,comparator:"time"}),Object.assign(td,{getDefaultMUCNickname:bp,isInfoVisible:jp,onDirectMUCInvitation:yp}),ef.settings.get("allow_muc_invitations")&&(ef.listen.on("connected",pp),ef.listen.on("reconnected",pp)),ef.listen.on("addClientFeatures",(()=>ef.disco.own.features.add(`${Op.NS.CONFINFO}+notify`))),ef.listen.on("addClientFeatures",Sp),ef.listen.on("beforeResourceBinding",Ap),ef.listen.on("beforeTearDown",xp),ef.listen.on("chatBoxesFetched",wp),ef.listen.on("disconnected",gp),ef.listen.on("statusInitialized",Ep),ef.listen.on("windowStateChanged",_p)}});const{Strophe:Mp}=Zh.env,$p=class extends nc{get idAttribute(){return"jid"}getDisplayName(){return Mp.xmlunescape(this.get("name"))}},{Strophe:Rp,$iq:Dp,sizzle:Pp}=Zh.env,Lp={model:$p,comparator:e=>e.get("name").toLowerCase(),async initialize(){this.on("add",(e=>this.openBookmarkedRoom(e).then((e=>this.markRoomAsBookmarked(e))).catch((e=>De.fatal(e))))),this.on("remove",this.markRoomAsUnbookmarked,this),this.on("remove",this.sendBookmarkStanza,this);const e=`converse.room-bookmarks${td.bare_jid}`;this.fetched_flag=e+"fetched",Zc(this,e),await this.fetchBookmarks(),ef.trigger("bookmarksInitialized",this)},openBookmarkedRoom:async e=>(ef.settings.get("muc_respect_autojoin")&&e.get("autojoin")&&(await ef.rooms.create(e.get("jid"),{nick:e.get("nick")})).maybeShow(),e),fetchBookmarks(){const e=ol();return window.sessionStorage.getItem(this.fetched_flag)?this.fetch({success:()=>e.resolve(),error:()=>e.resolve()}):this.fetchBookmarksFromServer(e),e},createBookmark(e){this.create(e),this.sendBookmarkStanza().catch((t=>this.onBookmarkError(t,e)))},sendBookmarkStanza(){const e=Dp({type:"set",from:td.connection.jid}).c("pubsub",{xmlns:Rp.NS.PUBSUB}).c("publish",{node:Rp.NS.BOOKMARKS}).c("item",{id:"current"}).c("storage",{xmlns:Rp.NS.BOOKMARKS});return this.forEach((t=>{e.c("conference",{name:t.get("name"),autojoin:t.get("autojoin"),jid:t.get("jid")}).c("nick").t(t.get("nick")).up().up()})),e.up().up().up(),e.c("publish-options").c("x",{xmlns:Rp.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("http://jabber.org/protocol/pubsub#publish-options").up().up().c("field",{var:"pubsub#persist_items"}).c("value").t("true").up().up().c("field",{var:"pubsub#access_model"}).c("value").t("whitelist"),ef.sendIQ(e)},onBookmarkError(e,t){const{__:s}=td;De.error("Error while trying to add bookmark"),De.error(e),ef.alert("error",s("Error"),[s("Sorry, something went wrong while trying to save your bookmark.")]),this.get(t.jid)?.destroy()},fetchBookmarksFromServer(e){const t=Dp({from:td.connection.jid,type:"get"}).c("pubsub",{xmlns:Rp.NS.PUBSUB}).c("items",{node:Rp.NS.BOOKMARKS});ef.sendIQ(t).then((t=>this.onBookmarksReceived(e,t))).catch((t=>this.onBookmarksReceivedError(e,t)))},markRoomAsBookmarked(e){const t=td.chatboxes.get(e.get("jid"));t?.save("bookmarked",!0)},markRoomAsUnbookmarked(e){const t=td.chatboxes.get(e.get("jid"));t?.save("bookmarked",!1)},createBookmarksFromStanza(e){const t=Rp.NS.BOOKMARKS;Pp(`items[node="${t}"] item storage[xmlns="${t}"] conference`,e).forEach((e=>{const t=e.getAttribute("jid"),s=this.get(t),n={jid:t,name:e.getAttribute("name")||t,autojoin:"true"===e.getAttribute("autojoin"),nick:e.querySelector("nick")?.textContent||""};s?s.save(n):this.create(n)}))},onBookmarksReceived(e,t){if(this.createBookmarksFromStanza(t),window.sessionStorage.setItem(this.fetched_flag,!0),void 0!==e)return e.resolve()},onBookmarksReceivedError(e,t){const{__:s}=td;if(null===t)De.error("Error: timeout while fetching bookmarks"),ef.alert("error",s("Timeout Error"),[s("The server did not return your bookmarks within the allowed time. You can reload the page to request them again.")]);else{if(e)return t.querySelector('error[type="cancel"] item-not-found')?(window.sessionStorage.setItem(this.fetched_flag,!0),e.resolve()):(De.error("Error while fetching bookmarks"),De.error(t),e.reject(new Error("Could not fetch bookmarks")));De.error("Error while fetching bookmarks"),De.error(t)}},async getUnopenedBookmarks(){return await ef.waitUntil("bookmarksInitialized"),await ef.waitUntil("chatBoxesFetched"),this.filter((e=>!td.chatboxes.get(e.get("jid"))))}},zp=Lp,{Strophe:Fp,sizzle:Up}=Zh.env;async function Bp(){ef.settings.get("allow_bookmarks")&&await async function(){const e=await ef.disco.getIdentity("pubsub","pep",td.bare_jid);return ef.settings.get("allow_public_bookmarks")?!!e:ef.disco.supports(Fp.NS.PUBSUB+"#publish-options",td.bare_jid)}()&&(td.bookmarks=new td.Bookmarks)}function qp(e){return Up(`event[xmlns="${Fp.NS.PUBSUB}#event"] items[node="${Fp.NS.BOOKMARKS}"]`,e).length&&ef.waitUntil("bookmarksInitialized").then((()=>td.bookmarks.createBookmarksFromStanza(e))).catch((e=>De.fatal(e))),!0}const{Strophe:Hp}=Zh.env;Hp.addNamespace("BOOKMARKS","storage:bookmarks"),Zh.plugins.add("converse-bookmarks",{dependencies:["converse-chatboxes","converse-muc"],overrides:{ChatRoom:{getDisplayName(){const{_converse:e,getDisplayName:t}=this.__super__,s=this.get("bookmarked")?e.bookmarks?.get(this.get("jid")):null;return s?.get("name")||t.apply(this,arguments)},getAndPersistNickname(e){var t;return e=e||(t=this.get("jid"),ef.settings.get("allow_bookmarks")?td.bookmarks?.get(t)?.get("nick"):null),this.__super__.getAndPersistNickname.call(this,e)}}},initialize(){ef.settings.extend({allow_bookmarks:!0,allow_public_bookmarks:!1,muc_respect_autojoin:!0}),ef.promises.add("bookmarksInitialized"),td.Bookmark=$p,td.Bookmarks=gu.extend(zp),ef.listen.on("addClientFeatures",(()=>{ef.settings.get("allow_bookmarks")&&ef.disco.own.features.add(Hp.NS.BOOKMARKS+"+notify")})),ef.listen.on("clearSession",(()=>{td.bookmarks&&(td.bookmarks.clearStore({silent:!0}),window.sessionStorage.removeItem(td.bookmarks.fetched_flag),delete td.bookmarks)})),ef.listen.on("connected",(async()=>{const{connection:e}=td;e.addHandler(qp,null,"message","headline",null,td.bare_jid),await Promise.all([ef.waitUntil("chatBoxesFetched")]),Bp()}))}});const{Strophe:Gp}=Zh.env,Wp="converse.bosh-session";Zh.plugins.add("converse-bosh",{enabled:()=>!td.api.settings.get("blacklisted_plugins").includes("converse-bosh"),initialize(){ef.settings.extend({bosh_service_url:void 0,prebind_url:null}),td.startNewPreboundBOSHSession=function(){if(!ef.settings.get("prebind_url"))throw new Error("startNewPreboundBOSHSession: If you use prebind then you MUST supply a prebind_url");const e=new XMLHttpRequest;e.open("GET",ef.settings.get("prebind_url"),!0),e.setRequestHeader("Accept","application/json, text/javascript"),e.onload=async function(){if(e.status>=200&&e.status<400){const t=JSON.parse(e.responseText),s=await yd(t.jid);td.connection.attach(s,t.sid,t.rid,td.connection.onConnectStatusChanged,59)}else e.onerror()},e.onerror=function(){delete td.connection,ef.trigger("noResumeableBOSHSession",td)},e.send()},td.restoreBOSHSession=async function(){const e=(await async function(){const e=Wp;if(td.bosh_session||(td.bosh_session=new nc({id:e}),td.bosh_session.browserStorage=td.createStore(e,"session"),await new Promise((e=>td.bosh_session.fetch({success:e,error:e})))),td.jid){if(td.bosh_session.get("jid")!==td.jid){const e=await yd(td.jid);td.bosh_session.clear({silent:!0}),td.bosh_session.save({jid:e})}}else{const e=td.bosh_session.get("jid");e&&await yd(e)}return td.bosh_session}()).get("jid");if(e&&td.connection._proto instanceof Gp.Bosh)try{return td.connection.restore(e,td.connection.onConnectStatusChanged),!0}catch(t){return!td.isTestEnv()&&De.warn("Could not restore session for jid: "+e+" Error message: "+t.message),!1}return!1},ef.listen.on("clearSession",(()=>{if(void 0===td.bosh_session){const e=Wp;sessionStorage.removeItem(e),sessionStorage.removeItem(`${e}-${e}`)}else td.bosh_session.destroy(),delete td.bosh_session})),ef.listen.on("setUserJID",(()=>{void 0!==td.bosh_session&&td.bosh_session.save({jid:td.jid})})),ef.listen.on("addClientFeatures",(()=>ef.disco.own.features.add(Gp.NS.BOSH))),Object.assign(ef,{tokens:{get:e=>void 0===td.connection?null:"rid"===e.toLowerCase()?td.connection.rid||td.connection._proto.rid:"sid"===e.toLowerCase()?td.connection.sid||td.connection._proto.sid:void 0}})}});const{Strophe:Vp,$build:Jp}=Zh.env;function Qp(e,t){return e.sort(((e,s)=>e[t]>s[t]?-1:1))}async function Yp(){const e=td.api.disco.own.identities.get(),t=td.api.disco.own.features.get();e.length>1&&(Qp(e,"category"),Qp(e,"type"),Qp(e,"lang"));let s=e.reduce(((e,t)=>`${e}${t.category}/${t.type}/${t?.lang??""}/${t.name}<`),"");return t.sort(),s=t.reduce(((e,t)=>`${e}${t}<`),s),hc(await crypto.subtle.digest("SHA-1",uc(s)))}async function Kp(e){const t=await async function(){return Jp("c",{xmlns:Vp.NS.CAPS,hash:"sha-1",node:"https://conversejs.org",ver:await Yp()}).tree()}();return e.root().cnode(t).up(),e}const{Strophe:Xp}=Zh.env;Xp.addNamespace("CAPS","http://jabber.org/protocol/caps"),Zh.plugins.add("converse-caps",{dependencies:["converse-status"],initialize(){ef.listen.on("constructedPresence",((e,t)=>Kp(t))),ef.listen.on("constructedMUCPresence",((e,t)=>Kp(t)))}});const Zp=gu.extend({comparator:"time_opened",model:(e,t)=>new td.ChatBox(e,t),onChatBoxesFetched(e){e.filter((e=>!e.isValid())).forEach((e=>e.destroy())),ef.trigger("chatBoxesFetched")},onConnected(e){e||(Zc(this,`converse.chatboxes-${td.bare_jid}`),this.fetch({add:!0,success:e=>this.onChatBoxesFetched(e)}))}}),eg=Zp,{Strophe:tg}=Zh.env;async function sg(e,t,s){let n;e=tg.getBareJidFromJid(e.toLowerCase()),Object.assign(t,{jid:e,id:e});try{n=new s(t,{collection:td.chatboxes})}catch(e){return De.error(e),null}return await n.initialized,n.isValid()?(td.chatboxes.add(n),n):(n.destroy(),null)}const ng={async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return await ef.waitUntil("chatBoxesFetched"),"string"==typeof e?sg(e,t,s):Promise.all(e.map((e=>sg(e,t,s))))},get:async e=>(await ef.waitUntil("chatBoxesFetched"),void 0===e?td.chatboxes.models:"string"==typeof e?td.chatboxes.get(e.toLowerCase()):(e=e.map((e=>e.toLowerCase())),td.chatboxes.models.filter((t=>e.includes(t.get("jid"))))))},{Strophe:rg}=Zh.env;Zh.plugins.add("converse-chatboxes",{dependencies:["converse-emoji","converse-roster","converse-vcard"],initialize(){ef.promises.add(["chatBoxesFetched","chatBoxesInitialized","privateChatsAutoJoined"]),Object.assign(ef,{chatboxes:ng}),td.ChatBoxes=eg,ef.listen.on("addClientFeatures",(()=>{ef.disco.own.features.add(rg.NS.MESSAGE_CORRECT),ef.disco.own.features.add(rg.NS.HTTPUPLOAD),ef.disco.own.features.add(rg.NS.OUTOFBAND)})),ef.listen.on("pluginsInitialized",(()=>{td.chatboxes=new td.ChatBoxes,ef.trigger("chatBoxesInitialized")})),ef.listen.on("presencesInitialized",(e=>td.chatboxes.onConnected(e))),ef.listen.on("reconnected",(()=>td.chatboxes.forEach((e=>e.onReconnection()))))}});const{Strophe:og,u:ig}=Zh.env;function ag(e,t){const s=Nl()(`command[xmlns="${og.NS.ADHOC}"]`,e).pop(),n={sessionid:s.getAttribute("sessionid"),instructions:Nl()('x[type="form"][xmlns="jabber:x:data"] instructions',s).pop()?.textContent,fields:Nl()('x[type="form"][xmlns="jabber:x:data"] field',s).map((e=>ig.xForm2TemplateResult(e,s,{domain:t}))),actions:Array.from(s.querySelector("actions")?.children).map((e=>e.nodeName.toLowerCase()))??[]};return n}const{Strophe:lg,$iq:cg,u:dg,stx:ug}=Zh.env,hg={adhoc:{async getCommands(e){try{return t=await ef.disco.items(e,lg.NS.ADHOC),Nl()(`query[xmlns="${og.NS.DISCO_ITEMS}"][node="${og.NS.ADHOC}"] item`,t).map(Nf)}catch(t){return null===t?De.error(`Error: timeout while fetching ad-hoc commands for ${e}`):(De.error(`Error while fetching ad-hoc commands for ${e}`),De.error(t)),[]}var t},async fetchCommandForm(e){const t=e.node,s=e.jid,n=cg({type:"set",to:s}).c("command",{xmlns:lg.NS.ADHOC,node:t,action:"execute"});try{return ag(await ef.sendIQ(n),s)}catch(e){null===e?De.error(`Error: timeout while trying to execute command for ${s}`):(De.error(`Error while trying to execute command for ${s}`),De.error(e));const{__:t}=td;return{instructions:t("An error occurred while trying to fetch the command form"),fields:[]}}},async runCommand(e,t,s,n,r){const o=ug`<iq type="set" to="${e}" xmlns="jabber:client">
                    <command sessionid="${t}" node="${s}" action="${n}" xmlns="${lg.NS.ADHOC}">
                        ${["cancel","prev"].includes(n)?"":ug`
                            <x xmlns="${lg.NS.XFORM}" type="submit">
                                ${r.reduce(((e,t)=>{let{name:s,value:n}=t;return e+`<field var="${s}"><value>${n}</value></field>`}),"")}
                            </x>`}
                    </command>
                </iq>`,i=await ef.sendIQ(o,null,!1);if(null===i){De.warn("A timeout occurred while trying to run an ad-hoc command");const{__:e}=td;return{status:"error",note:e("A timeout occurred")}}dg.isErrorStanza(i)&&(De.error("Error while trying to execute an ad-hoc command"),De.error(i));const a=i.querySelector("command"),l=a?.getAttribute("status");return{status:l,..."executing"===l?ag(i):{},note:i.querySelector("note")?.textContent}}}},{Strophe:fg}=Zh.env;fg.addNamespace("ADHOC","http://jabber.org/protocol/commands"),Zh.plugins.add("converse-adhoc",{dependencies:["converse-disco"],initialize(){Object.assign(this._converse.api,hg)}});class mg extends zf{defaults(){return{bookmarked:!1,hidden:["mobile","fullscreen"].includes(ef.settings.get("view_mode")),message_type:"headline",num_unread:0,time_opened:this.get("time_opened")||(new Date).getTime(),type:td.HEADLINES_TYPE}}async initialize(){this.set({box_id:`box-${this.get("jid")}`}),this.initUI(),this.initMessages(),await this.fetchMessages(),ef.trigger("headlinesFeedInitialized",this)}}const pg={headlines:{async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];async function n(e){let n=await ef.chatboxes.get(e);return!n&&s?n=await ef.chatboxes.create(e,t,td.HeadlinesFeed):(n=n&&n.get("type")===td.HEADLINES_TYPE?n:null,n&&Object.keys(t).length&&n.save(t)),n}return void 0===e?(await ef.chatboxes.get()).filter((e=>e.get("type")===td.HEADLINES_TYPE)):"string"==typeof e?n(e):Promise.all(e.map((e=>n(e))))}}};Zh.plugins.add("converse-headlines",{dependencies:["converse-chat"],overrides:{ChatBoxes:{model(e,t){const{_converse:s}=this.__super__;return e.type==s.HEADLINES_TYPE?new s.HeadlinesFeed(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){function e(){td.connection.addHandler((e=>async function(e){if(Tf(e)||If(e)){const t=e.getAttribute("from");if(await ef.waitUntil("rosterInitialized"),t.includes("@")&&!td.roster.get(t)&&!ef.settings.get("allow_non_roster_messaging"))return;if(null===e.querySelector("body"))return;const s=td.chatboxes.create({id:t,jid:t,type:Ee,from:t}),n=await $f(e);await s.createMessage(n),ef.trigger("message",{chatbox:s,stanza:e,attrs:n})}}(e)||!0),null,"message")}td.HeadlinesFeed=mg,ef.listen.on("connected",e),ef.listen.on("reconnected",e),Object.assign(ef,pg)}});class gg extends nc{defaults(){return{msgid:Mc(),is_ephemeral:!1}}}const{Strophe:_g,$build:vg}=Zh.env;_g.addNamespace("RSM","http://jabber.org/protocol/rsm");const yg=["after","before","index","max"],bg=e=>Number(e),jg=e=>e.toString(),wg={after:jg,before:jg,count:bg,first:jg,index:bg,last:jg,max:bg},Sg=e=>void 0===e,xg=Object.keys(wg);class Eg{static getQueryParameters(){return Cl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},yg)}static parseXMLResult(e){const t={};for(var s=0;s<xg.length;s++){const n=xg[s],r=e.getElementsByTagName(n)[0];Sg(r)||null===r||(t[n]=wg[n](_g.getText(r)),"first"==n&&(t.index=wg.index(r.getAttribute("index"))))}return t}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.query=Eg.getQueryParameters(e),this.result=e.xml?Eg.parseXMLResult(e.xml):{}}toXML(){const e=vg("set",{xmlns:_g.NS.RSM});return yg.reduce(((e,t)=>Sg(this.query[t])?e:e.c(t).t((this.query[t]||"").toString()).up()),e).tree()}next(e,t){const s=Object.assign({},this.query,{after:this.result.last,before:t,max:e});return new Eg(s)}previous(e,t){const s=Object.assign({},this.query,{after:t,before:this.result.first,max:e});return new Eg(s)}}td.RSM_ATTRIBUTES=xg,td.RSM=Eg;const{NS:Ag}=_e,Cg=Zh.env.utils,Tg={archive:{async query(e){if(!ef.connection.connected())throw new Error("Can't call `api.archive.query` before having established an XMPP session");const t={type:"set"};if(e&&e.groupchat){if(!e.with)throw new Error('You need to specify a "with" value containing the chat room JID, when querying groupchat messages.');t.to=e.with}const s=t.to||td.bare_jid;if(!await ef.disco.supports(Ag.MAM,s))return De.warn(`Did not fetch MAM archive for ${s} because it doesn't support ${Ag.MAM}`),{messages:[]};const n=Cg.getUniqueId(),r=g(t).c("query",{xmlns:Ag.MAM,queryid:n});if(e){r.c("x",{xmlns:Ag.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(Ag.MAM).up().up(),e.with&&!e.groupchat&&r.c("field",{var:"with"}).c("value").t(e.with).up().up(),["start","end"].forEach((t=>{if(e[t]){const s=Td()(e[t]);if(!s.isValid())throw new TypeError(`archive.query: invalid date provided for: ${t}`);r.c("field",{var:t}).c("value").t(s.toISOString()).up().up()}})),r.up();const t=new Eg(e);Object.keys(t.query).length&&r.cnode(t.toXML())}const o=[],i=td.connection.addHandler((t=>{const s=Nl()(`message > result[xmlns="${Ag.MAM}"]`,t).pop();if(void 0===s||s.getAttribute("queryid")!==n)return!0;const r=t.getAttribute("from")||td.bare_jid;if(e.groupchat){if(r!==e.with)return De.warn(`Ignoring alleged groupchat MAM message from ${t.getAttribute("from")}`),!0}else if(r!==td.bare_jid)return De.warn(`Ignoring alleged MAM message from ${t.getAttribute("from")}`),!0;return o.push(t),!0}),Ag.MAM);let a;const l=ef.settings.get("message_archiving_timeout"),c=await ef.sendIQ(r,l,!1);if(null===c){const{__:e}=td,t=e("Timeout while trying to fetch archived messages.");return De.error(t),a=new od(t),{messages:o,error:a}}if(Cg.isErrorStanza(c)){const{__:e}=td,t=e("An error occurred while querying for archived messages.");return De.error(t),De.error(c),a=new Error(t),{messages:o,error:a}}let d;td.connection.deleteHandler(i);const u=c&&Nl()(`fin[xmlns="${Ag.MAM}"]`,c).pop(),h="true"===u?.getAttribute("complete"),f=Nl()(`set[xmlns="${Ag.RSM}"]`,u).pop();return f&&(d=new Eg({...e,xml:f})),{messages:o,rsm:d,complete:h}}}},{NS:Ig}=_e,kg=Zh.env.utils;function Ng(e){e?.querySelectorAll("feature-not-implemented").length?De.warn(`Message Archive Management (XEP-0313) not supported by ${e.getAttribute("from")}`):(De.error(`Error while trying to set archiving preferences for ${e.getAttribute("from")}.`),De.error(e))}function Og(e,t){const s=Nl()(`prefs[xmlns="${Ig.MAM}"]`,e).pop();if(s.getAttribute("default")!==ef.settings.get("message_archiving")){const e=g({type:"set"}).c("prefs",{xmlns:Ig.MAM,default:ef.settings.get("message_archiving")});Array.from(s.children).forEach((t=>e.cnode(t).up())),ef.sendIQ(e).then((()=>t.save({preferences:{default:ef.settings.get("message_archiving")}}))).catch(td.onMAMError)}else t.save({preferences:{default:ef.settings.get("message_archiving")}})}function Mg(e){const t=e.get("preferences")||{};e.get("var")===Ig.MAM&&void 0!==ef.settings.get("message_archiving")&&t.default!==ef.settings.get("message_archiving")&&ef.sendIQ(g({type:"get"}).c("prefs",{xmlns:Ig.MAM})).then((t=>td.onMAMPreferences(t,e))).catch(td.onMAMError)}function $g(e){ef.settings.get("muc_show_logs_before_join")&&e.features.get("mam_enabled")&&!e.get("prejoin_mam_fetched")&&(Pg(e),e.save({prejoin_mam_fetched:!0}))}async function Rg(e,t,s,n,r){await ef.emojis.initialize();const o=e.get("type")===td.CHATROOMS_TYPE,i=await Promise.all(t.messages.map((t=>o?Jm(t,e):$f(t))));t.messages=i;const a={query:s,chatbox:e,messages:i};if(await ef.trigger("MAMResult",a,{synchronous:!0}),i.forEach((t=>e.queueMessage(t))),t.error){const s=t.error.retry_event_id=kg.getUniqueId();ef.listen.once(s,(()=>Dg(e,n,r))),e.createMessageFromError(t.error)}}async function Dg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.disable_mam)return;const n=e.get("type")===td.CHATROOMS_TYPE,r=n?e.get("jid"):td.bare_jid;if(!await ef.disco.supports(Ig.MAM,r))return;const o=ef.settings.get("archived_messages_page_size"),i=Object.assign({groupchat:n,max:o,with:e.get("jid")},t),a=await ef.archive.query(i);if(await Rg(e,a,i,t,s),a.rsm&&!a.complete){if(s)return"forwards"===s?t=a.rsm.next(o,t.before).query:"backwards"===s&&(t=a.rsm.previous(o,t.after).query),Dg(e,t,s);!async function(e,t,s){if(""==t.before&&(0===e.messages.length||!t.start))return;if(t.before&&!t.start)return;if(null==t.before)return;const n=await Promise.all(s.messages),{rsm:r}=s,o=`stanza_id ${e.get("jid")}`,i=n.find((e=>e[o]===r.result.first)),a={template_hook:"getMessageTemplate",time:new Date(new Date(i.time)-1).toISOString(),before:r.result.first,start:t.start};e.messages.add(new gg(a))}(e,t,a)}}function Pg(e){if(e.disable_mam)return;const t=e.getMostRecentMessage();if(t&&!ef.settings.get("clear_messages_on_reconnection"))if(ef.settings.get("mam_request_all_pages")){const s=t.get(`stanza_id ${e.get("jid")}`);Dg(e,s?{after:s}:{start:t.get("time")},"forwards")}else Dg(e,{before:"",start:t.get("time")});else Dg(e,{before:""})}const{NS:Lg}=_e;Zh.plugins.add("converse-mam",{dependencies:["converse-disco","converse-muc"],initialize(){ef.settings.extend({archived_messages_page_size:"50",mam_request_all_pages:!0,message_archiving:void 0,message_archiving_timeout:2e4}),Object.assign(ef,Tg),Object.assign(td,{onMAMError:Ng,onMAMPreferences:Og,handleMAMResult:Rg,MAMPlaceholderMessage:gg}),ef.listen.on("addClientFeatures",(()=>ef.disco.own.features.add(Lg.MAM))),ef.listen.on("serviceDiscovered",Mg),ef.listen.on("chatRoomViewInitialized",(e=>{ef.settings.get("muc_show_logs_before_join")&&($g(e.model),e.model.features.on("change:mam_enabled",(()=>$g(e.model))))})),ef.listen.on("enteredNewRoom",(e=>e.features.get("mam_enabled")&&Pg(e))),ef.listen.on("chatReconnected",(e=>{e.get("type")===td.PRIVATE_CHAT_TYPE&&Pg(e)})),ef.listen.on("afterMessagesFetched",(e=>{e.get("type")===td.PRIVATE_CHAT_TYPE&&Pg(e)}))}});const{Strophe:zg,$iq:Fg}=Zh.env;let Ug,Bg;function qg(e){"visible"===e.state&&ef.ping(null,5e3)}function Hg(e){Ug=new Date;const t=e.getAttribute("from"),s=e.getAttribute("id"),n=Fg({type:"result",to:t,id:s});return td.connection.sendIQ(n),!0}function Gg(){!function(){const{connection:e}=td;e.disco&&ef.disco.own.features.add(zg.NS.PING),e.addHandler(Hg,zg.NS.PING,"iq","get")}(),td.connection.addHandler((()=>{if(ef.settings.get("ping_interval")>0)return Ug=new Date,!0})),clearInterval(Bg),Bg=setInterval(Vg,1e3)}function Wg(){clearInterval(Bg)}function Vg(){if(td.isTestEnv()||!ef.connection.authenticated())return;const e=ef.settings.get("ping_interval");if(e>0){const t=new Date;Ug=Ug??t,(t-Ug)/1e3>e&&ef.ping()}}const{Strophe:Jg,$iq:Qg,u:Yg}=Zh.env,Kg={async ping(e,t){if(!ef.connection.authenticated())return De.warn("Not pinging when we know we're not authenticated"),null;var s;s=new Date,Ug=s,e=e||Jg.getDomainFromJid(td.bare_jid);const n=Qg({type:"get",to:e,id:Yg.getUniqueId("ping")}).c("ping",{xmlns:Jg.NS.PING}),r=await ef.sendIQ(n,t||1e4,!1);return null===r?(De.warn(`Timeout while pinging ${e}`),e===Jg.getDomainFromJid(td.bare_jid)&&ef.connection.reconnect(),!1):!Yg.isErrorStanza(r)||(De.error(`Error while pinging ${e}`),De.error(r),!1)}},{Strophe:Xg}=Zh.env;Xg.addNamespace("PING","urn:xmpp:ping"),Zh.plugins.add("converse-ping",{initialize(){ef.settings.extend({ping_interval:60}),Object.assign(ef,Kg),ef.listen.on("connected",Gg),ef.listen.on("reconnected",Gg),ef.listen.on("disconnected",Wg),ef.listen.on("windowStateChanged",qg)}});const{Strophe:Zg,$iq:e_}=Zh.env;Zg.addNamespace("PUBSUB_ERROR",Zg.NS.PUBSUB+"#errors"),Zh.plugins.add("converse-pubsub",{dependencies:["converse-disco"],initialize(){Object.assign(td.api,{pubsub:{async publish(e,t,s,n){let r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=e_({from:td.bare_jid,type:"set",to:e}).c("pubsub",{xmlns:Zg.NS.PUBSUB}).c("publish",{node:t}).cnode(s.tree()).up().up();n&&(e=e||td.bare_jid,await ef.disco.supports(Zg.NS.PUBSUB+"#publish-options",e)?(o.c("publish-options").c("x",{xmlns:Zg.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(`${Zg.NS.PUBSUB}#publish-options`).up().up(),Object.keys(n).forEach((e=>o.c("field",{var:e}).c("value").t(n[e]).up().up()))):De.warn(`_converse.api.publish: ${e} does not support #publish-options, so we didn't set them even though they were provided.`));try{await ef.sendIQ(o)}catch(e){if(!(e instanceof Element&&r&&e.querySelector(`precondition-not-met[xmlns="${Zg.NS.PUBSUB_ERROR}"]`)))throw e;{const e=o.tree();e.querySelector("publish-options").outerHTML="",De.warn(`PubSub: Republishing without publish options. ${e.outerHTML}`),await ef.sendIQ(e)}}}}})}});const{Strophe:t_,$pres:s_}=Zh.env;class n_ extends nc{defaults(){return{status:ef.settings.get("default_state")}}initialize(){this.on("change",(e=>{e.changed instanceof Object&&("status"in e.changed||"status_message"in e.changed)&&ef.user.presence.send(this.get("status"),null,this.get("status_message"))}))}getDisplayName(){return this.getFullname()||this.getNickname()||td.bare_jid}getNickname(){return ef.settings.get("nickname")}getFullname(){return""}async constructPresence(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(e="string"==typeof e?e:this.get("status")||ef.settings.get("default_state"),n="string"==typeof n?n:this.get("status_message"),"subscribe"===e){t=s_({to:s,type:e});const{xmppstatus:n}=td,r=n.getNickname();r&&t.c("nick",{xmlns:t_.NS.NICK}).t(r).up()}else t="unavailable"===e||"probe"===e||"error"===e||"unsubscribe"===e||"unsubscribed"===e||"subscribed"===e?s_({to:s,type:e}):"offline"===e?s_({to:s,type:"unavailable"}):"online"===e?s_({to:s}):s_({to:s}).c("show").t(e).up();n&&t.c("status").t(n).up();const r=ef.settings.get("priority");t.c("priority").t(Number.isNaN(Number(r))?0:r).up();const{idle:o,idle_seconds:i}=td;if(o){const e=new Date;e.setSeconds(e.getSeconds()-i),t.c("idle",{xmlns:t_.NS.IDLE,since:e.toISOString()})}return t=await ef.hook("constructedPresence",null,t),t}}const r_={status:{get:async()=>(await ef.waitUntil("statusInitialized"),td.xmppstatus.get("status")),async set(e,t){const s={status:e};if(!Object.keys(ye).includes(e))throw new Error("Invalid availability value. See https://xmpp.org/rfcs/rfc3921.html#rfc.section.2.2.2.1");"string"==typeof t&&(s.status_message=t),await ef.waitUntil("statusInitialized"),td.xmppstatus.save(s)},message:{get:async()=>(await ef.waitUntil("statusInitialized"),td.xmppstatus.get("status_message")),async set(e){await ef.waitUntil("statusInitialized"),td.xmppstatus.save({status_message:e})}}}},{Strophe:o_,$build:i_}=Zh.env;function a_(e){ef.trigger("statusInitialized",e)}function l_(e){if(e=void 0!==td.xmppstatus&&e)a_(e);else{const t=`converse.xmppstatus-${td.bare_jid}`;td.xmppstatus=new td.XMPPStatus({id:t}),Zc(td.xmppstatus,t,"session"),td.xmppstatus.fetch({success:()=>a_(e),error:()=>a_(e),silent:!0})}}function c_(){td.idle_seconds>0&&(td.idle_seconds=0),td.connection?.authenticated&&(td.inactive&&td.sendCSI(td.ACTIVE),td.idle&&(td.idle=!1,ef.user.presence.send()),!0===td.auto_changed_status&&(td.auto_changed_status=!1,td.xmppstatus.set("status",ef.settings.get("default_state"))))}function d_(){if(!td.connection?.authenticated)return;const e=td.xmppstatus.get("status");td.idle_seconds++,ef.settings.get("csi_waiting_time")>0&&td.idle_seconds>ef.settings.get("csi_waiting_time")&&!td.inactive&&td.sendCSI(td.INACTIVE),ef.settings.get("idle_presence_timeout")>0&&td.idle_seconds>ef.settings.get("idle_presence_timeout")&&!td.idle&&(td.idle=!0,ef.user.presence.send()),ef.settings.get("auto_away")>0&&td.idle_seconds>ef.settings.get("auto_away")&&"away"!==e&&"xa"!==e&&"dnd"!==e?(td.auto_changed_status=!0,td.xmppstatus.set("status","away")):ef.settings.get("auto_xa")>0&&td.idle_seconds>ef.settings.get("auto_xa")&&"xa"!==e&&"dnd"!==e&&(td.auto_changed_status=!0,td.xmppstatus.set("status","xa"))}function u_(e){ef.send(i_(e,{xmlns:o_.NS.CSI})),td.inactive=e===td.INACTIVE}function h_(){if(ef.settings.get("auto_away")<1&&ef.settings.get("auto_xa")<1&&ef.settings.get("csi_waiting_time")<1&&ef.settings.get("idle_presence_timeout")<1)return;td.idle_seconds=0,td.auto_changed_status=!1;const{unloadevent:e}=td;window.addEventListener("click",td.onUserActivity),window.addEventListener("focus",td.onUserActivity),window.addEventListener("keypress",td.onUserActivity),window.addEventListener("mousemove",td.onUserActivity),window.addEventListener(e,td.onUserActivity,{once:!0,passive:!0}),td.everySecondTrigger=window.setInterval(td.onEverySecond,1e3)}function f_(e,t){const{xmppstatus:s}=td,n=s.get("status");["away","chat","dnd","xa"].includes(n)&&t.c("show").t(n).up();const r=s.get("status_message");return r&&t.c("status").t(r).up(),t}const{Strophe:m_}=Zh.env;m_.addNamespace("IDLE","urn:xmpp:idle:1"),Zh.plugins.add("converse-status",{initialize(){ef.settings.extend({auto_away:0,auto_xa:0,csi_waiting_time:0,default_state:"online",idle_presence_timeout:300,priority:0}),ef.promises.add(["statusInitialized"]),td.XMPPStatus=n_,td.onUserActivity=c_,td.onEverySecond=d_,td.sendCSI=u_,td.registerIntervalHandler=h_,Object.assign(td.api.user,r_),ef.settings.get("idle_presence_timeout")>0&&ef.listen.on("addClientFeatures",(()=>ef.disco.own.features.add(m_.NS.IDLE))),ef.listen.on("presencesInitialized",(e=>{e||td.registerIntervalHandler()})),ef.listen.on("clearSession",(()=>{Cc()&&td.xmppstatus&&(td.xmppstatus.destroy(),delete td.xmppstatus,ef.promises.add(["statusInitialized"]))})),ef.listen.on("connected",(()=>l_(!1))),ef.listen.on("reconnected",(()=>l_(!0))),ef.listen.on("constructedMUCPresence",f_)}});class p_ extends nc{initialize(){super.initialize(),this.set({filter_text:"",filter_type:"contacts",chat_state:"online"})}}const{$pres:g_}=Zh.env;function __(e){const t=td.roster?.get(e.get("jid"));t?.save({num_unread:e.get("num_unread")})}function v_(){void 0!==td.presence_ref&&(td.connection.deleteHandler(td.presence_ref),delete td.presence_ref)}async function y_(){await(td.presences?.clearStore())}async function b_(){await y_(),Cc()&&(td.rostergroups&&(await td.rostergroups.clearStore(),delete td.rostergroups),td.roster&&(td.roster.data?.destroy(),await td.roster.clearStore(),delete td.roster))}function j_(e){e?ef.trigger("rosterReadyAfterReconnection"):function(){const e=td.roster=new td.RosterContacts;let t=`converse.contacts-${td.bare_jid}`;Zc(e,t);const s=td.roster_filter=new p_;s.id=`_converse.rosterfilter-${td.bare_jid}`,Zc(s,s.id),s.fetch(),t=`converse-roster-model-${td.bare_jid}`,e.data=new nc,e.data.id=t,Zc(e.data,t),e.data.fetch(),ef.trigger("rosterInitialized")}(),td.roster.onConnected(),v_(),td.presence_ref=td.connection.addHandler((e=>(td.roster.presenceHandler(e),!0)),null,"presence",null),async function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(td.send_initial_presence=!0);try{await td.roster.fetchRosterContacts(),ef.trigger("rosterContactsFetched")}catch(e){De.error(e)}finally{td.send_initial_presence&&ef.user.presence.send()}}(!td.connection.restored)}async function w_(e){if(e)!td.connection.hasResumed()&&await y_();else{td.presences=new td.Presences;const e=`converse.presences-${td.bare_jid}`;Zc(td.presences,e,"session"),td.presences.fetch()}ef.trigger("presencesInitialized",e)}function S_(){td.chatboxes.on("change:num_unread",__),td.chatboxes.on("add",(e=>{e.get("type")===td.PRIVATE_CHAT_TYPE&&e.setRosterContact(e.get("jid"))}))}function x_(){td.roster.on("add",(e=>{const t=td.chatboxes.findWhere({jid:e.get("jid")});t?.setRosterContact(e.get("jid"))}))}function E_(e,t){const s=g_({to:e,type:"unsubscribed"});t&&""!==t&&s.c("status").t(t),ef.send(s)}const{Strophe:A_,$iq:C_,$pres:T_}=Zh.env,I_=class extends nc{get idAttribute(){return"jid"}defaults(){return{chat_state:void 0,groups:[],image:td.DEFAULT_IMAGE,image_type:td.DEFAULT_IMAGE_TYPE,num_unread:0,status:void 0}}async initialize(e){super.initialize(e),this.initialized=ol(),this.setPresence();const{jid:t}=e;this.set({...e,jid:A_.getBareJidFromJid(t).toLowerCase(),user_id:A_.getNodeFromJid(t)}),this.listenTo(this.presence,"change:show",(()=>ef.trigger("contactPresenceChanged",this))),this.listenTo(this.presence,"change:show",(()=>this.trigger("presenceChanged"))),await ef.trigger("rosterContactInitialized",this,{Synchronous:!0}),this.initialized.resolve()}setPresence(){const e=this.get("jid");this.presence=td.presences.findWhere(e)||td.presences.create({jid:e})}openChat(){const e=this.attributes;ef.chats.open(e.jid,e,!0)}getFilterCriteria(){const e=this.get("nickname"),t=this.get("jid");let s=this.getDisplayName();return s=s.includes(t)?s:s.concat(`   ${t}`),s=s.includes(e)?s:s.concat(`   ${e}`),s.toLowerCase()}getDisplayName(){return this.get("nickname")?this.get("nickname"):this.get("jid")}getFullname(){return this.get("jid")}subscribe(e){return ef.user.presence.send("subscribe",this.get("jid"),e),this.save("ask","subscribe"),this}ackSubscribe(){ef.send(T_({type:"subscribe",to:this.get("jid")}))}ackUnsubscribe(){ef.send(T_({type:"unsubscribe",to:this.get("jid")})),this.removeFromRoster(),this.destroy()}unauthorize(e){return E_(this.get("jid"),e),this}authorize(e){const t=T_({to:this.get("jid"),type:"subscribed"});return e&&""!==e&&t.c("status").t(e),ef.send(t),this}removeFromRoster(){const e=C_({type:"set"}).c("query",{xmlns:A_.NS.ROSTER}).c("item",{jid:this.get("jid"),subscription:"remove"});return ef.sendIQ(e)}},{Strophe:k_,$iq:N_,sizzle:O_,u:M_}=Zh.env,$_=gu.extend({model:I_,initialize(){const e=`roster.state-${td.bare_jid}-${this.get("jid")}`;this.state=new nc({id:e,collapsed_groups:[]}),Zc(this.state,e),this.state.fetch()},onConnected(){this.registerRosterHandler(),this.registerRosterXHandler()},registerRosterHandler(){td.connection.addHandler((e=>(td.roster.onRosterPush(e),!0)),k_.NS.ROSTER,"iq","set")},registerRosterXHandler(){let e=0;td.connection.addHandler((function(t){return window.setTimeout((function(){td.connection.flush(),td.roster.subscribeToSuggestedItems.bind(td.roster)(t)}),e),e+=250*t.querySelectorAll("item").length,!0}),k_.NS.ROSTERX,"message",null)},async fetchRosterContacts(){const e=await new Promise(((e,t)=>{this.fetch({add:!0,silent:!0,success:e,error:(e,s)=>t(s)})}));if(M_.isErrorObject(e)&&(De.error(e),td.session.save("roster_cached",!1),this.data.save("version",void 0)),!td.session.get("roster_cached"))return td.send_initial_presence=!0,td.roster.fetchFromServer();ef.trigger("cachedRoster",e)},subscribeToSuggestedItems:e=>(Array.from(e.querySelectorAll("item")).forEach((e=>{"add"===e.getAttribute("action")&&td.roster.addAndSubscribe(e.getAttribute("jid"),td.xmppstatus.getNickname()||td.xmppstatus.getFullname())})),!0),isSelf:e=>M_.isSameBareJID(e,td.connection.jid),async addAndSubscribe(e,t,s,n,r){const o=await this.addContactToRoster(e,t,s,r);o instanceof td.RosterContact&&o.subscribe(n)},sendContactAddIQ(e,t,s){t=t||null;const n=N_({type:"set"}).c("query",{xmlns:k_.NS.ROSTER}).c("item",{jid:e,name:t});return s.forEach((e=>n.c("group").t(e).up())),ef.sendIQ(n)},async addContactToRoster(e,t,s,n){await ef.waitUntil("rosterContactsFetched"),s=s||[];try{await this.sendContactAddIQ(e,t,s)}catch(s){const{__:n}=td;return De.error(s),alert(n("Sorry, there was an error while trying to add %1$s as a contact.",t||e)),s}return this.create(Object.assign({ask:void 0,nickname:t,groups:s,jid:e,requesting:!1,subscription:"none"},n),{sort:!1})},async subscribeBack(e,t){const s=this.get(e);if(s instanceof td.RosterContact)s.authorize().subscribe();else{const s=O_(`nick[xmlns="${k_.NS.NICK}"]`,t).pop()?.textContent||null,n=await this.addContactToRoster(e,s,[],{subscription:"from"});n instanceof td.RosterContact&&n.authorize().subscribe()}},onRosterPush(e){const t=e.getAttribute("id"),s=e.getAttribute("from");if(s&&s!==td.bare_jid)return void De.warn(`Ignoring roster illegitimate roster push message from ${e.getAttribute("from")}`);ef.send(N_({type:"result",id:t,from:td.connection.jid}));const n=O_(`query[xmlns="${k_.NS.ROSTER}"]`,e).pop();this.data.save("version",n.getAttribute("ver"));const r=O_("item",n);if(r.length>1)throw De.error(e),new Error('Roster push query may not contain more than one "item" element.');if(0===r.length)return De.warn(e),void De.warn('Received a roster push stanza without an "item" element.');this.updateContact(r.pop()),ef.trigger("rosterPush",e)},rosterVersioningSupported(){return ef.disco.stream.getFeature("ver","urn:xmpp:features:rosterver")&&this.data.get("version")},async fetchFromServer(){const e=N_({type:"get",id:M_.getUniqueId("roster")}).c("query",{xmlns:k_.NS.ROSTER});this.rosterVersioningSupported()&&e.attrs({ver:this.data.get("version")});const t=await ef.sendIQ(e,null,!1);if("result"===t.getAttribute("type")){const e=O_(`query[xmlns="${k_.NS.ROSTER}"]`,t).pop();if(e){const t=O_("item",e);if(!this.data.get("version")&&this.models.length){const e=t.map((e=>e.getAttribute("jid")));this.forEach((t=>!t.get("requesting")&&!e.includes(t.get("jid"))&&t.destroy()))}t.forEach((e=>this.updateContact(e))),this.data.save("version",e.getAttribute("ver"))}}else if(!M_.isServiceUnavailableError(t))return De.error(t),void De.error("Error while trying to fetch roster from the server");td.session.save("roster_cached",!0),ef.trigger("roster",t)},updateContact(e){const t=e.getAttribute("jid"),s=this.get(t),n=e.getAttribute("subscription");if("remove"===n)return s?.destroy();const r=e.getAttribute("ask"),o=e.getAttribute("name"),i=[...new Set(O_("group",e).map((e=>e.textContent)))];s?s.save({subscription:n,ask:r,nickname:o,groups:i,requesting:null}):this.create({nickname:o,ask:r,groups:i,jid:t,subscription:n},{sort:!1})},createRequestingContact(e){const t={jid:k_.getBareJidFromJid(e.getAttribute("from")),subscription:"none",ask:null,requesting:!0,nickname:O_(`nick[xmlns="${k_.NS.NICK}"]`,e).pop()?.textContent||null};ef.trigger("contactRequest",this.create(t))},handleIncomingSubscription(e){const t=e.getAttribute("from"),s=k_.getBareJidFromJid(t),n=this.get(s);if(!ef.settings.get("allow_contact_requests")){const{__:e}=td;E_(t,e("This client does not allow presence subscriptions"))}ef.settings.get("auto_subscribe")?n&&"to"===n.get("subscription")?n.authorize():this.subscribeBack(s,e):n?("none"!==n.get("subscription")||"subscribe"===n.get("ask"))&&n.authorize():this.createRequestingContact(e)},handleOwnPresence(e){const t=e.getAttribute("from"),s=k_.getResourceFromJid(t),n=e.getAttribute("type");if(td.connection.jid!==t&&"unavailable"!==n&&(!0===ef.settings.get("synchronize_availability")||ef.settings.get("synchronize_availability")===s)){const t=e.querySelector("show")?.textContent||"online";td.xmppstatus.save({status:t},{silent:!0});const s=e.querySelector("status")?.textContent;s&&td.xmppstatus.save({status_message:s})}td.jid===t&&"unavailable"===n&&ef.user.presence.send()},presenceHandler(e){const t=e.getAttribute("type");if("error"===t)return!0;const s=e.getAttribute("from"),n=k_.getBareJidFromJid(s);if(this.isSelf(n))return this.handleOwnPresence(e);if(O_(`query[xmlns="${k_.NS.MUC}"]`,e).length)return;const r=this.get(n);if(r){const t=e.querySelector("status")?.textContent;r.get("status")!==t&&r.save({status:t})}if("subscribed"===t&&r)r.ackSubscribe();else if("unsubscribed"===t&&r)r.ackUnsubscribe();else{if("unsubscribe"===t)return;if("subscribe"===t)this.handleIncomingSubscription(e);else if("unavailable"===t&&r){const e=k_.getResourceFromJid(s);r.presence.removeResource(e)}else r&&r.presence.addResource(e)}}}),R_=$_,{Strophe:D_}=Zh.env,P_={contacts:{async get(e){await ef.waitUntil("rosterContactsFetched");const t=e=>td.roster.get(D_.getBareJidFromJid(e));if(void 0===e)e=td.roster.pluck("jid");else if("string"==typeof e)return t(e);return e.map(t)},async add(e,t){if(await ef.waitUntil("rosterContactsFetched"),"string"!=typeof e||!e.includes("@"))throw new TypeError("contacts.add: invalid jid");return td.roster.addAndSubscribe(e,t)}}},{Strophe:L_,dayjs:z_,sizzle:F_}=Zh.env,U_=nc.extend({idAttribute:"name"}),B_=gu.extend({model:U_});class q_ extends nc{get idAttribute(){return"jid"}defaults(){return{show:"offline"}}initialize(){super.initialize(),this.resources=new B_;const e=`converse.identities-${this.get("jid")}`;Zc(this.resources,e,"session"),this.listenTo(this.resources,"update",this.onResourcesChanged),this.listenTo(this.resources,"change",this.onResourcesChanged)}onResourcesChanged(){const e=this.getHighestPriorityResource(),t=e?.attributes?.show||"offline";this.get("show")!==t&&this.save({show:t})}getHighestPriorityResource(){return this.resources.sortBy((e=>`${e.get("priority")}-${e.get("timestamp")}`)).reverse()[0]}addResource(e){const t=e.getAttribute("from"),s=L_.getResourceFromJid(t),n=F_(`delay[xmlns="${L_.NS.DELAY}"]`,e).pop(),r=e.querySelector("priority")?.textContent,o=this.resources.get(s),i={name:s,priority:Number.isNaN(parseInt(r,10))?0:parseInt(r,10),show:e.querySelector("show")?.textContent??"online",timestamp:n?z_(n.getAttribute("stamp")).toISOString():(new Date).toISOString()};o?o.save(i):this.resources.create(i)}removeResource(e){const t=this.resources.get(e);t?.destroy()}}const H_=gu.extend({model:q_});Zh.plugins.add("converse-roster",{dependencies:["converse-status"],initialize(){ef.settings.extend({allow_contact_requests:!0,auto_subscribe:!1,synchronize_availability:!0}),ef.promises.add(["cachedRoster","roster","rosterContactsFetched","rosterInitialized"]),Object.assign(td.api,P_);const{__:e}=td;td.HEADER_CURRENT_CONTACTS=e("My contacts"),td.HEADER_PENDING_CONTACTS=e("Pending contacts"),td.HEADER_REQUESTING_CONTACTS=e("Contact requests"),td.HEADER_UNGROUPED=e("Ungrouped"),td.HEADER_UNREAD=e("New messages"),td.Presence=q_,td.Presences=H_,td.RosterContact=I_,td.RosterContacts=R_,ef.listen.on("beforeTearDown",(()=>v_())),ef.listen.on("chatBoxesInitialized",S_),ef.listen.on("clearSession",b_),ef.listen.on("presencesInitialized",j_),ef.listen.on("statusInitialized",w_),ef.listen.on("streamResumptionFailed",(()=>td.session.set("roster_cached",!1))),ef.waitUntil("rosterContactsFetched").then(x_)}});const{Strophe:G_}=Zh.env,W_=Zh.env.utils;function V_(){return!(ef.connection.isType("bosh")&&!td.isTestEnv())&&ef.disco.stream.getFeature("sm",G_.NS.SM)}function J_(e){if(!td.session.get("smacks_enabled"))return!0;const t=parseInt(e.getAttribute("h"),10),s=td.session.get("num_stanzas_handled_by_server"),n=t-s;if(n<0){const e=`New reported stanza count lower than previous. New: ${t} - Previous: ${s}`;De.error(e)}const r=td.session.get("unacked_stanzas");if(n>r.length){const e=`Higher reported acknowledge count than unacknowledged stanzas. Reported Acknowledged Count: ${n} -Unacknowledged Stanza Count: ${r.length} -New: ${t} - Previous: ${s}`;De.error(e)}return td.session.save({num_stanzas_handled_by_server:t,num_stanzas_since_last_ack:0,unacked_stanzas:r.slice(n)}),!0}function Q_(){if(td.session.get("smacks_enabled")){const e=td.session.get("num_stanzas_handled"),t=W_.toStanza(`<a xmlns="${G_.NS.SM}" h="${e}"/>`);ef.send(t)}return!0}function Y_(e){if(td.session.get("smacks_enabled")&&(W_.isTagEqual(e,"iq")||W_.isTagEqual(e,"presence")||W_.isTagEqual(e,"message"))){const e=td.session.get("num_stanzas_handled");td.session.save("num_stanzas_handled",e+1)}return!0}function K_(){td.session.save({smacks_enabled:td.session.get("smacks_enabled")||!1,num_stanzas_handled:td.session.get("num_stanzas_handled")||0,num_stanzas_handled_by_server:td.session.get("num_stanzas_handled_by_server")||0,num_stanzas_since_last_ack:td.session.get("num_stanzas_since_last_ack")||0,unacked_stanzas:td.session.get("unacked_stanzas")||[]})}function X_(){td.session?.save({smacks_enabled:!1,num_stanzas_handled:0,num_stanzas_handled_by_server:0,num_stanzas_since_last_ack:0,unacked_stanzas:[]})}function Z_(e){const t={smacks_enabled:!0};return["1","true"].includes(e.getAttribute("resume"))&&(t.smacks_stream_id=e.getAttribute("id")),td.session.save(t),!0}function ev(e){return e.querySelector("item-not-found")?De.warn("Could not resume previous SMACKS session, session id not found. A new session will be established."):(De.error("Failed to enable stream management"),De.error(e.outerHTML)),X_(),ef.trigger("streamResumptionFailed"),!0}function tv(e){Z_(e),J_(e),function(){const e=td.session.get("unacked_stanzas");td.session.save("unacked_stanzas",[]),e.forEach((e=>ef.send(e)))}(),td.connection.do_bind=!1,td.connection.authenticated=!0,td.connection.restored=!0,td.connection._changeConnectStatus(G_.Status.CONNECTED,null)}async function sv(){if(ef.settings.get("enable_smacks")&&!td.session.get("smacks_enabled")&&await V_()){const e=ol();td.connection._addSysHandler((t=>e.resolve(Z_(t))),G_.NS.SM,"enabled"),td.connection._addSysHandler((t=>e.resolve(ev(t))),G_.NS.SM,"failed");const t=ef.connection.isType("websocket")||td.isTestEnv(),s=W_.toStanza(`<enable xmlns="${G_.NS.SM}" resume="${t}"/>`);ef.send(s),td.connection.flush(),await e}}const nv=[];async function rv(){if(!ef.settings.get("enable_smacks"))return;if(!await V_())return;const e=td.connection;for(;nv.length;)e.deleteHandler(nv.pop());nv.push(e.addHandler(Y_)),nv.push(e.addHandler(Q_,G_.NS.SM,"r")),nv.push(e.addHandler(J_,G_.NS.SM,"a")),td.session?.get("smacks_stream_id")?await async function(){const e=ol();td.connection._addSysHandler((t=>e.resolve(tv(t))),G_.NS.SM,"resumed"),td.connection._addSysHandler((t=>e.resolve(ev(t))),G_.NS.SM,"failed");const t=td.session.get("smacks_stream_id"),s=td.session.get("num_stanzas_handled"),n=W_.toStanza(`<resume xmlns="${G_.NS.SM}" h="${s}" previd="${t}"/>`);ef.send(n),td.connection.flush(),await e}():X_()}function ov(e){if(td.session){if(td.session.get("smacks_enabled")&&(W_.isTagEqual(e,"iq")||W_.isTagEqual(e,"presence")||W_.isTagEqual(e,"message"))){const t=G_.serialize(e);td.session.save("unacked_stanzas",(td.session.get("unacked_stanzas")||[]).concat([t]));const s=ef.settings.get("smacks_max_unacked_stanzas");if(s>0){const e=td.session.get("num_stanzas_since_last_ack")+1;e%s==0&&ef.send(W_.toStanza(`<r xmlns="${G_.NS.SM}"/>`)),td.session.save({num_stanzas_since_last_ack:e})}}}else De.warn("No _converse.session!")}const{Strophe:iv}=Zh.env;iv.addNamespace("SM","urn:xmpp:sm:3"),Zh.plugins.add("converse-smacks",{initialize(){ef.settings.extend({enable_smacks:!0,smacks_max_unacked_stanzas:5}),ef.listen.on("afterResourceBinding",sv),ef.listen.on("beforeResourceBinding",rv),ef.listen.on("send",ov),ef.listen.on("userSessionInitialized",K_)}});const av=class extends nc{get idAttribute(){return"jid"}defaults(){return{image:td.DEFAULT_IMAGE,image_type:td.DEFAULT_IMAGE_TYPE}}set(e,t,s){let n;return"object"==typeof e?(n=e,s=t):(n={})[e]=t,"image"in n&&!n.image?(n.image=td.DEFAULT_IMAGE,n.image_type=td.DEFAULT_IMAGE_TYPE,nc.prototype.set.call(this,n,s)):nc.prototype.set.apply(this,arguments)}getDisplayName(){return this.get("nickname")||this.get("fullname")||this.get("jid")}},{Strophe:lv,$iq:cv,u:dv}=Zh.env;function uv(e,t,s){const n=cv(t?{type:e,to:t}:{type:e});return s?n.cnode(s):n.c("vCard",{xmlns:lv.NS.VCARD}),n}async function hv(e){let t;if(e instanceof td.Message){if(["error","info"].includes(e.get("type")))return;t=e.get("from")}else t=e.get("jid");t?(await ef.waitUntil("VCardsInitialized"),e.vcard=td.vcards.get(t)||td.vcards.create({jid:t}),e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add")):De.warn("Could not set VCard on model because no JID found!")}async function fv(e){await ef.waitUntil("VCardsInitialized"),e.vcard=function(e){const t=e?.collection?.chatroom,s=e.get("nick");if(s&&t?.get("nick")===s)return td.xmppstatus.vcard;{const t=e.get("jid")||e.get("from");return t?td.vcards.get(t)||td.vcards.create({jid:t}):void De.warn("Could not get VCard for occupant because no JID found!")}}(e),e.vcard&&(e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add"))}async function mv(e){["error","info"].includes(e.get("type"))||(await ef.waitUntil("VCardsInitialized"),e.vcard=function(e){const t=e?.collection?.chatbox,s=lv.getResourceFromJid(e.get("from"));if(s&&t?.get("nick")===s)return td.xmppstatus.vcard;{const t=e.occupant?.get("jid")||e.get("from");return t?td.vcards.get(t)||td.vcards.create({jid:t}):void De.warn(`Could not get VCard for message because no JID found! msgid: ${e.get("msgid")}`)}}(e),e.vcard&&(e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add")))}async function pv(){td.vcards=new td.VCards;const e=`${td.bare_jid}-converse.vcards`;Zc(td.vcards,e),await new Promise((e=>{td.vcards.fetch({success:e,error:e},{silent:!0})}));const t=td.vcards;if(td.session){const e=td.session.get("bare_jid"),s=td.xmppstatus;s.vcard=t.get(e)||t.create({jid:e}),s.vcard&&(s.vcard.on("change",(()=>s.trigger("vcard:change"))),s.trigger("vcard:add"))}ef.trigger("VCardsInitialized")}async function gv(e){const t=lv.getBareJidFromJid(e)===td.bare_jid?null:e;let s;try{s=await ef.sendIQ(uv("get",t))}catch(s){return{jid:e,stanza:s,vcard_error:(new Date).toISOString()}}return async function(e,t){const s=t.querySelector("vCard");let n={};if(null!==s&&(n={stanza:t,fullname:s.querySelector("FN")?.textContent,nickname:s.querySelector("NICKNAME")?.textContent,image:s.querySelector("PHOTO BINVAL")?.textContent,image_type:s.querySelector("PHOTO TYPE")?.textContent,url:s.querySelector("URL")?.textContent,role:s.querySelector("ROLE")?.textContent,email:s.querySelector("EMAIL USERID")?.textContent,vcard_updated:(new Date).toISOString(),vcard_error:void 0}),n.image){const e=dv.base64ToArrayBuffer(n.image),t=await crypto.subtle.digest("SHA-1",e);n.image_hash=dv.arrayBufferToHex(t)}return n}(0,s)}const{dayjs:_v,u:vv}=Zh.env,yv={vcard:{async set(e,t){if(!e)throw Error("No jid provided for the VCard data");const s=document.createElement("div"),n=vv.toStanza(`\n                <vCard xmlns="vcard-temp">\n                    <FN>${t.fn}</FN>\n                    <NICKNAME>${t.nickname}</NICKNAME>\n                    <URL>${t.url}</URL>\n                    <ROLE>${t.role}</ROLE>\n                    <EMAIL><INTERNET/><PREF/><USERID>${t.email}</USERID></EMAIL>\n                    <PHOTO>\n                        <TYPE>${t.image_type}</TYPE>\n                        <BINVAL>${t.image}</BINVAL>\n                    </PHOTO>\n                </vCard>`,s);let r;try{r=await ef.sendIQ(uv("set",e,n))}catch(e){throw e}return await ef.vcard.update(e,!0),r},get(e,t){if("string"==typeof e)return gv(e);const s=e.get("vcard_error"),n=s&&_v(s).isSame(new Date,"day");if(t||!e.get("vcard_updated")&&!n){const t=e.get("jid");return t||De.error("No JID to get vcard for"),gv(t)}return Promise.resolve({})},async update(e,t){const s=await this.get(e,t);(e="string"==typeof e?td.vcards.get(e):e)?Object.keys(s).length&&(delete s.stanza,e.save(s)):De.error(`Could not find a VCard model for ${e}`)}}},{Strophe:bv}=Zh.env;Zh.plugins.add("converse-vcard",{dependencies:["converse-status","converse-roster"],overrides:{XMPPStatus:{getNickname(){const{_converse:e}=this.__super__,t=this.__super__.getNickname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("nickname"):t},getFullname(){const{_converse:e}=this.__super__,t=this.__super__.getFullname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("fullname"):t}},RosterContact:{getDisplayName(){return!this.get("nickname")&&this.vcard?this.vcard.getDisplayName():this.__super__.getDisplayName.apply(this)},getFullname(){return this.vcard?this.vcard.get("fullname"):this.__super__.getFullname.apply(this)}}},initialize(){ef.promises.add("VCardsInitialized"),td.VCard=av,td.VCards=gu.extend({model:td.VCard,initialize(){this.on("add",(e=>e.get("jid")&&ef.vcard.update(e)))}}),ef.listen.on("chatRoomInitialized",(e=>{hv(e),e.occupants.forEach(fv),e.listenTo(e.occupants,"add",fv),e.listenTo(e.occupants,"change:image_hash",(e=>function(e){const t=e.get("image_hash"),s=[];e.get("jid")&&s.push(td.vcards.get(e.get("jid"))),s.push(td.vcards.get(e.get("from"))),s.forEach((e=>t&&e?.get("image_hash")!==t&&ef.vcard.update(e,!0)))}(e)))})),ef.listen.on("chatBoxInitialized",(e=>hv(e))),ef.listen.on("chatRoomMessageInitialized",(e=>mv(e))),ef.listen.on("addClientFeatures",(()=>ef.disco.own.features.add(bv.NS.VCARD))),ef.listen.on("clearSession",(()=>{Cc()&&(ef.promises.add("VCardsInitialized"),td.vcards&&(td.vcards.clearStore(),delete td.vcards))})),ef.listen.on("messageInitialized",(e=>hv(e))),ef.listen.on("rosterContactInitialized",(e=>hv(e))),ef.listen.on("statusInitialized",pv),Object.assign(td.api,yv)}}),td.api=ef,Td().extend(ke());const jv=Zh})(),d})(),e.exports=n()},"./src/headless/log.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/utils/html.js");const r={debug:0,info:1,warn:2,error:3,fatal:4},o=Object.assign({debug:console?.log?console.log.bind(console):function(){},error:console?.log?console.log.bind(console):function(){},info:console?.log?console.log.bind(console):function(){},warn:console?.log?console.log.bind(console):function(){}},console),i={setLogLevel(e){if(!["debug","info","warn","error","fatal"].includes(e))throw new Error(`Invalid loglevel: ${e}`);this.loglevel=e},log(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(r[t]<r[this.loglevel])return;"error"===t||"fatal"===t?s=s||"color: maroon":"debug"===t&&(s=s||"color: green"),e instanceof Error?e=e.stack:(0,n.isElement)(e)&&(e=e.outerHTML);const i=s?"%c":"";"error"===t?o.error(`${i} ERROR: ${e}`,s):"warn"===t?o.warn(`${i} ${(new Date).toISOString()} WARNING: ${e}`,s):"fatal"===t?o.error(`${i} FATAL: ${e}`,s):"debug"===t?o.debug(`${i} ${(new Date).toISOString()} DEBUG: ${e}`,s):o.info(`${i} ${(new Date).toISOString()} INFO: ${e}`,s)},debug(e,t){this.log(e,"debug",t)},error(e,t){this.log(e,"error",t)},info(e,t){this.log(e,"info",t)},warn(e,t){this.log(e,"warn",t)},fatal(e,t){this.log(e,"fatal",t)}}},"./src/headless/plugins/bookmarks/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{checkBookmarksSupport:()=>l,getNicknameFromBookmark:()=>d,handleBookmarksPush:()=>u,initBookmarks:()=>c});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js");const{Strophe:i,sizzle:a}=r.converse.env;async function l(){const e=await r.default.disco.getIdentity("pubsub","pep",n.default.bare_jid);return r.default.settings.get("allow_public_bookmarks")?!!e:r.default.disco.supports(i.NS.PUBSUB+"#publish-options",n.default.bare_jid)}async function c(){r.default.settings.get("allow_bookmarks")&&await l()&&(n.default.bookmarks=new n.default.Bookmarks)}function d(e){return r.default.settings.get("allow_bookmarks")?n.default.bookmarks?.get(e)?.get("nick"):null}function u(e){return a(`event[xmlns="${i.NS.PUBSUB}#event"] items[node="${i.NS.BOOKMARKS}"]`,e).length&&r.default.waitUntil("bookmarksInitialized").then((()=>n.default.bookmarks.createBookmarksFromStanza(e))).catch((e=>o.default.fatal(e))),!0}},"./src/headless/plugins/chat/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js");const i={chats:{async create(e,t){if("string"==typeof e){if(t&&!t?.fullname){const s=await r.default.contacts.get(e);t.fullname=s?.attributes?.fullname}const s=r.default.chats.get(e,t,!0);return s||void o.default.error("Could not open chatbox for JID: "+e)}return Array.isArray(e)?Promise.all(e.forEach((async s=>{const n=await r.default.contacts.get(e);return t.fullname=n?.attributes?.fullname,r.default.chats.get(s,t,!0).maybeShow()}))):(o.default.error("chats.create: You need to provide at least one JID"),null)},async open(e,t,s){if("string"==typeof e){const n=await r.default.chats.get(e,t,!0);return n?n.maybeShow(s):n}if(Array.isArray(e))return Promise.all(e.map((e=>r.default.chats.get(e,t,!0).then((e=>e&&e.maybeShow(s))))).filter((e=>e)));const n="chats.open: You need to provide at least one JID";throw o.default.error(n),new Error(n)},async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];async function o(e){let o=await r.default.chatboxes.get(e);return!o&&s?o=await r.default.chatboxes.create(e,t,n.default.ChatBox):(o=o&&o.get("type")===n.default.PRIVATE_CHAT_TYPE?o:null,o&&Object.keys(t).length&&o.save(t)),o}if(await r.default.waitUntil("chatBoxesFetched"),void 0===e){return(await r.default.chatboxes.get()).filter((e=>e.get("type")===n.default.PRIVATE_CHAT_TYPE))}return"string"==typeof e?o(e):Promise.all(e.map((e=>o(e))))}}}},"./src/headless/plugins/chat/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/plugins/chat/model.js"),r=s("./src/headless/plugins/chat/message.js"),o=s("./src/headless/plugins/chat/model-with-contact.js"),i=s("./src/headless/shared/_converse.js"),a=s("./src/headless/shared/api/index.js"),l=s("./src/headless/plugins/chat/api.js"),c=s("./node_modules/@converse/skeletor/src/collection.js"),d=s("./src/headless/plugins/chat/utils.js");a.converse.plugins.add("converse-chat",{dependencies:["converse-chatboxes","converse-disco"],initialize(){a.default.settings.extend({allow_message_corrections:"all",allow_message_retraction:"all",allow_message_styling:!0,auto_join_private_chats:[],clear_messages_on_reconnection:!1,filter_by_resource:!1,prune_messages_above:void 0,pruning_behavior:"unscrolled",send_chat_markers:["received","displayed","acknowledged"],send_chat_state_notifications:!0}),i.default.Message=o.default.extend(r.default),i.default.Messages=c.Collection.extend({model:i.default.Message,comparator:"time"}),Object.assign(i.default,{ChatBox:n.default,handleMessageStanza:d.handleMessageStanza}),Object.assign(a.default,l.default),i.default.router.route("converse/chat?jid=:jid",d.openChat),a.default.listen.on("chatBoxesFetched",d.autoJoinChats),a.default.listen.on("presencesInitialized",d.registerMessageHandlers),a.default.listen.on("clearSession",d.onClearSession),a.default.listen.on("connected",(()=>(0,d.enableCarbons)())),a.default.listen.on("reconnected",(()=>(0,d.enableCarbons)()))}})},"./src/headless/plugins/chat/message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./src/headless/plugins/chat/model-with-contact.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./node_modules/dayjs/dayjs.min.js"),a=s.n(i),l=s("./src/headless/log.js"),c=s("./node_modules/@converse/openpromise/openpromise.js");const{Strophe:d,sizzle:u,u:h}=o.converse.env,f={defaults:()=>({msgid:h.getUniqueId(),time:(new Date).toISOString(),is_ephemeral:!1}),async initialize(){this.checkValidity()&&(this.initialized=(0,c.getOpenPromise)(),this.get("file")&&this.on("change:put",(()=>this.uploadFile())),this.on("change:type",(()=>this.setContact())),this.on("change:is_ephemeral",(()=>this.setTimerForEphemeralMessage())),await this.setContact(),this.setTimerForEphemeralMessage(),await o.default.trigger("messageInitialized",this,{Synchronous:!0}),this.initialized.resolve())},setContact(){["chat","normal"].includes(this.get("type"))&&(n.default.prototype.initialize.apply(this,arguments),this.setRosterContact(d.getBareJidFromJid(this.get("from"))))},setTimerForEphemeralMessage(){this.ephemeral_timer&&clearTimeout(this.ephemeral_timer);const e=this.isEphemeral();if(e){const t="number"==typeof e?e:1e4;this.ephemeral_timer=window.setTimeout((()=>this.safeDestroy()),t)}},checkValidity(){return 3!==Object.keys(this.attributes).length||(this.validationError="Empty message",this.safeDestroy(),!1)},mayBeRetracted(){const e="me"===this.get("sender"),t="cancel"!==this.get("error_type");return e&&t&&["all","own"].includes(o.default.settings.get("allow_message_retraction"))},safeDestroy(){try{this.destroy()}catch(e){l.default.warn(`safeDestroy: ${e}`)}},isEphemeral(){return this.get("is_ephemeral")},isMeCommand(){const e=this.getMessageText();return!!e&&e.startsWith("/me ")},isFollowup(){const e=this.collection.models,t=e.indexOf(this),s=t?e[t-1]:null;if(null===s)return!1;const n=a()(this.get("time"));return this.get("from")===s.get("from")&&!this.isMeCommand()&&!s.isMeCommand()&&!!this.get("is_encrypted")==!!s.get("is_encrypted")&&this.get("type")===s.get("type")&&"info"!==this.get("type")&&n.isBefore(a()(s.get("time")).add(10,"minutes"))&&("groupchat"!==this.get("type")||this.get("occupant_id")===s.get("occupant_id"))},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("from")},getMessageText(){if(this.get("is_encrypted")){const{__:e}=r.default;return this.get("plaintext")||this.get("body")||e("Undecryptable OMEMO message")}return["groupchat","chat","normal"].includes(this.get("type"))?this.get("body"):this.get("message")},sendSlotRequestStanza(){if(!this.file)return Promise.reject(new Error("file is undefined"));const e=o.converse.env.$iq({from:r.default.jid,to:this.get("slot_request_url"),type:"get"}).c("request",{xmlns:d.NS.HTTPUPLOAD,filename:this.file.name,size:this.file.size,"content-type":this.file.type});return o.default.sendIQ(e)},getUploadRequestMetadata:e=>({headers:u(`slot[xmlns="${d.NS.HTTPUPLOAD}"] put header`,e).map((e=>({name:e.getAttribute("name"),value:e.textContent}))).filter((e=>["Authorization","Expires"].includes(e.name)))}),async getRequestSlotURL(){const{__:e}=r.default;let t;try{t=await this.sendSlotRequestStanza()}catch(t){return l.default.error(t),this.save({type:"error",message:e("Sorry, could not determine upload URL."),is_ephemeral:!0})}const s=u(`slot[xmlns="${d.NS.HTTPUPLOAD}"]`,t).pop();if(!s)return this.save({type:"error",message:e("Sorry, could not determine file upload URL."),is_ephemeral:!0});this.upload_metadata=this.getUploadRequestMetadata(t),this.save({get:s.querySelector("get").getAttribute("url"),put:s.querySelector("put").getAttribute("url")})},uploadFile(){const e=new XMLHttpRequest;e.onreadystatechange=async()=>{if(e.readyState===XMLHttpRequest.DONE)if(l.default.info("Status: "+e.status),200===e.status||201===e.status){let e={upload:r.default.SUCCESS,oob_url:this.get("get"),message:this.get("get"),body:this.get("get")};e=await o.default.hook("afterFileUploaded",this,e),this.save(e)}else e.onerror()},e.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.set("progress",e.loaded/e.total)}),!1),e.onerror=()=>{const{__:t}=r.default;let s;s=e.responseText?t('Sorry, could not succesfully upload your file. Your servers response: "%1$s"',e.responseText):t("Sorry, could not succesfully upload your file."),this.save({type:"error",upload:r.default.FAILURE,message:s,is_ephemeral:!0})},e.open("PUT",this.get("put"),!0),e.setRequestHeader("Content-type",this.file.type),this.upload_metadata.headers?.forEach((t=>e.setRequestHeader(t.name,t.value))),e.send(this.file)}}},"./src/headless/plugins/chat/model-with-contact.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/api/index.js"),r=s("./node_modules/@converse/skeletor/src/model.js"),o=s("./node_modules/@converse/openpromise/openpromise.js");const i=r.Model.extend({initialize(){this.rosterContactAdded=(0,o.getOpenPromise)()},async setRosterContact(e){const t=await n.default.contacts.get(e);t&&(this.contact=t,this.set("nickname",t.get("nickname")),this.rosterContactAdded.resolve())}})},"./src/headless/plugins/chat/model.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var n=s("./src/headless/plugins/chat/model-with-contact.js"),r=s("./node_modules/lodash-es/isMatch.js"),o=s("./src/headless/log.js"),i=s("./node_modules/lodash-es/pick.js"),a=s("./src/headless/shared/_converse.js"),l=s("./src/headless/shared/api/index.js"),c=s("./node_modules/@converse/skeletor/src/model.js"),d=s("./src/headless/shared/errors.js"),u=s("./src/headless/shared/chat/utils.js"),h=s("./node_modules/filesize/dist/filesize.esm.js"),f=s("./src/headless/shared/parsers.js"),m=s("./node_modules/@converse/openpromise/openpromise.js"),p=s("./src/headless/utils/storage.js"),g=s("./src/headless/utils/core.js"),_=s("./src/headless/plugins/chat/parsers.js"),v=s("./src/headless/shared/actions.js");const{Strophe:y,$msg:b}=l.converse.env,j=l.converse.env.utils,w=n.default.extend({defaults(){return{bookmarked:!1,chat_state:void 0,hidden:(0,g.isUniView)()&&!l.default.settings.get("singleton"),message_type:"chat",nickname:void 0,num_unread:0,time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:a.default.PRIVATE_CHAT_TYPE,url:""}},async initialize(){this.initialized=(0,m.getOpenPromise)(),n.default.prototype.initialize.apply(this,arguments);const e=this.get("jid");e&&(this.set({box_id:`box-${e}`}),this.initNotifications(),this.initUI(),this.initMessages(),this.get("type")===a.default.PRIVATE_CHAT_TYPE&&(this.presence=a.default.presences.get(e)||a.default.presences.create({jid:e}),await this.setRosterContact(e),this.presence.on("change:show",(e=>this.onPresenceChanged(e)))),this.on("change:chat_state",this.sendChatState,this),this.ui.on("change:scrolled",this.onScrolledChanged,this),await this.fetchMessages(),await l.default.trigger("chatBoxInitialized",this,{Synchronous:!0}),this.initialized.resolve())},getMessagesCollection:()=>new a.default.Messages,getMessagesCacheKey(){return`converse.messages-${this.get("jid")}-${a.default.bare_jid}`},initMessages(){this.messages=this.getMessagesCollection(),this.messages.fetched=(0,m.getOpenPromise)(),this.messages.chatbox=this,(0,p.initStorage)(this.messages,this.getMessagesCacheKey()),this.listenTo(this.messages,"change:upload",this.onMessageUploadChanged,this),this.listenTo(this.messages,"add",this.onMessageAdded,this)},initUI(){this.ui=new c.Model},initNotifications(){this.notifications=new c.Model},getNotificationsText(){const{__:e}=a.default;return this.notifications?.get("chat_state")===a.default.COMPOSING?e("%1$s is typing",this.getDisplayName()):this.notifications?.get("chat_state")===a.default.PAUSED?e("%1$s has stopped typing",this.getDisplayName()):this.notifications?.get("chat_state")===a.default.GONE?e("%1$s has gone away",this.getDisplayName()):""},afterMessagesFetched(){this.pruneHistoryWhenScrolledDown(),l.default.trigger("afterMessagesFetched",this)},fetchMessages(){if(this.messages.fetched_flag)return void o.default.info(`Not re-fetching messages for ${this.get("jid")}`);this.messages.fetched_flag=!0;const e=this.messages.fetched.resolve;return this.messages.fetch({add:!0,success:t=>{this.afterMessagesFetched(t),e()},error:()=>{this.afterMessagesFetched(),e()}}),this.messages.fetched},async handleErrorMessageStanza(e){const{__:t}=a.default,s=await(0,_.parseMessage)(e,a.default);if(!await this.shouldShowErrorMessage(s))return;const n=this.getMessageReferencedByError(s);if(n){const e={error:s.error,error_condition:s.error_condition,error_text:s.error_text,error_type:s.error_type,editable:!1};s.msgid===n.get("retraction_id")?(e.retraction_id=void 0,s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to retract your message."):e.error=t("Sorry, an error occurred while trying to retract your message."))):s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to send a message."):e.error=t("Sorry, an error occurred while trying to send your message.")),n.save(e)}else this.createMessage(s)},queueMessage(e){return this.msg_chain=(this.msg_chain||this.messages.fetched).then((()=>this.onMessage(e))).catch((e=>o.default.error(e))),this.msg_chain},async onMessage(e){if(e=await e,j.isErrorObject(e))return e.stanza&&o.default.error(e.stanza),o.default.error(e.message);const t=this.getDuplicateMessage(e);if(t)this.updateMessage(t,e);else if(!this.handleReceipt(e)&&!this.handleChatMarker(e)&&!await this.handleRetraction(e)&&(this.setEditable(e,e.time),e.chat_state&&"them"===e.sender&&this.notifications.set("chat_state",e.chat_state),j.shouldCreateMessage(e))){const t=await(0,u.handleCorrection)(this,e)||await this.createMessage(e);this.notifications.set({chat_state:null}),this.handleUnreadMessage(t)}},async onMessageUploadChanged(e){if(e.get("upload")===a.default.SUCCESS){const t={body:e.get("body"),spoiler_hint:e.get("spoiler_hint"),oob_url:e.get("oob_url")};await this.sendMessage(t),e.destroy()}},onMessageAdded(e){!l.default.settings.get("prune_messages_above")||"scrolled"!==l.default.settings.get("pruning_behavior")&&this.ui.get("scrolled")||(0,g.isEmptyMessage)(e)||(0,u.debouncedPruneHistory)(this)},async clearMessages(){try{await this.messages.clearStore()}catch(e){this.messages.trigger("reset"),o.default.error(e)}finally{this.messages.fetched.resolve()}},async close(){l.default.connection.connected()&&(this.setChatState(a.default.INACTIVE),this.sendChatState());try{await new Promise(((e,t)=>this.destroy({success:e,error:(e,s)=>t(s)})))}catch(e){o.default.error(e)}finally{l.default.settings.get("clear_messages_on_reconnection")&&await this.clearMessages()}l.default.trigger("chatBoxClosed",this)},announceReconnection(){l.default.trigger("chatReconnected",this)},async onReconnection(){l.default.settings.get("clear_messages_on_reconnection")&&await this.clearMessages(),this.announceReconnection()},onPresenceChanged(e){const{__:t}=a.default,s=e.get("show"),n=this.getDisplayName();let r;"offline"===s?r=t("%1$s has gone offline",n):"away"===s?r=t("%1$s has gone away",n):"dnd"===s?r=t("%1$s is busy",n):"online"===s&&(r=t("%1$s is online",n)),r&&this.createMessage({message:r,type:"info"})},onScrolledChanged(){this.ui.get("scrolled")||(this.clearUnreadMsgCounter(),this.pruneHistoryWhenScrolledDown())},pruneHistoryWhenScrolledDown(){l.default.settings.get("prune_messages_above")&&"unscrolled"===l.default.settings.get("pruning_behavior")&&!this.ui.get("scrolled")&&(0,u.debouncedPruneHistory)(this)},validate(e){if(!e.jid)return"Ignored ChatBox without JID";const t=l.default.settings.get("auto_join_rooms").map((e=>e instanceof Object?e.jid:e)),s=l.default.settings.get("auto_join_private_chats").concat(t);if(l.default.settings.get("singleton")&&!s.includes(e.jid)&&!l.default.settings.get("auto_join_on_invite")){const t=`${e.jid} is not allowed because singleton is true and it's not being auto_joined`;return o.default.warn(t),t}},getDisplayName(){return this.contact?this.contact.getDisplayName():this.vcard?this.vcard.getDisplayName():this.get("jid")},async createMessageFromError(e){if(e instanceof d.TimeoutError){(await this.createMessage({type:"error",message:e.message,retry_event_id:e.retry_event_id,is_ephemeral:3e4})).error=e}},editEarlierMessage(){let e,t=this.messages.findLastIndex("correcting");if(t>=0)for(this.messages.at(t).save("correcting",!1);t>0;){t-=1;const s=this.messages.at(t);if(s.get("editable")){e=s;break}}e=e||this.messages.filter({sender:"me"}).reverse().find((e=>e.get("editable"))),e&&e.save("correcting",!0)},editLaterMessage(){let e,t=this.messages.findLastIndex("correcting");if(t>=0)for(this.messages.at(t).save("correcting",!1);t<this.messages.length-1;){t+=1;const s=this.messages.at(t);if(s.get("editable")){e=s,e.save("correcting",!0);break}}return e},getOldestMessage(){for(let e=0;e<this.messages.length;e++){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getMostRecentMessage(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages.at(e);if(t.get("type")===this.get("message_type"))return t}},getUpdatedMessageAttributes:(e,t)=>t.error_type||"Decryption"!==e.get("error_type")?{is_archived:t.is_archived}:Object.assign({},t,{error_condition:void 0,error_message:void 0,error_text:void 0,error_type:void 0,is_archived:t.is_archived,is_ephemeral:!1,is_error:!1}),updateMessage(e,t){const s=this.getUpdatedMessageAttributes(e,t);s&&e.save(s)},setChatState(e,t){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),e===a.default.COMPOSING?this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),a.default.TIMEOUTS.PAUSED,a.default.PAUSED):e===a.default.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),a.default.TIMEOUTS.INACTIVE,a.default.INACTIVE)),this.set("chat_state",e,t),this},getMessageReferencedByError(e){const t=e.msgid;return t&&this.messages.models.find((e=>[e.get("msgid"),e.get("retraction_id")].includes(t)))},shouldShowErrorMessage(e){if(this.getMessageReferencedByError(e)||!e.chat_state)return!0},isSameUser:(e,t)=>j.isSameBareJID(e,t),findDanglingRetraction(e){if(!e.origin_id||!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models);return t.reverse(),t.find((t=>{let{attributes:s}=t;return s.retracted_id===e.origin_id&&s.from===e.from&&!s.moderated_by}))}},async handleRetraction(e){const t=["retracted","retracted_id","editable"];if(e.retracted){if(e.is_tombstone)return!1;const s=this.messages.findWhere({origin_id:e.retracted_id,from:e.from});return s?(s.save((0,i.default)(e,t)),!0):(e.dangling_retraction=!0,await this.createMessage(e),!0)}{const s=this.findDanglingRetraction(e);if(s){const n=(0,i.default)(s.attributes,t),r=Object.assign({dangling_retraction:!1},e,n);return delete r.id,s.save(r),!0}}return!1},getDuplicateMessage(e){const t=[...this.getStanzaIdQueryAttrs(e),this.getOriginIdQueryAttrs(e),this.getMessageBodyQueryAttrs(e)].filter((e=>e));return this.messages.models.find((e=>t.reduce(((t,s)=>t||(0,r.default)(e.attributes,s)),!1)))},getOriginIdQueryAttrs:e=>e.origin_id&&{origin_id:e.origin_id,from:e.from},getStanzaIdQueryAttrs:e=>Object.keys(e).filter((e=>e.startsWith("stanza_id "))).map((t=>{const s={};return s[`stanza_id ${t.replace(/^stanza_id /,"")}`]=e[t],s})),getMessageBodyQueryAttrs(e){if(e.msgid){const t={from:e.from,msgid:e.msgid};return!e.is_encrypted&&e.body&&(t.body=e.body),t}},retractOwnMessage(e){this.sendRetractionMessage(e),e.save({retracted:(new Date).toISOString(),retracted_id:e.get("origin_id"),retraction_id:e.get("id"),is_ephemeral:!0,editable:!1})},sendRetractionMessage(e){const t=e.get("origin_id");if(!t)throw new Error("Can't retract message without a XEP-0359 Origin ID");const s=b({id:j.getUniqueId(),to:this.get("jid"),type:"chat"}).c("store",{xmlns:y.NS.HINTS}).up().c("apply-to",{id:t,xmlns:y.NS.FASTEN}).c("retract",{xmlns:y.NS.RETRACT});return a.default.connection.send(s)},sendMarkerForLastMessage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"displayed",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=Array.from(this.messages.models);s.reverse();const n=s.find((e=>"them"===e.get("sender")&&(t||e.get("is_markable"))));n&&this.sendMarkerForMessage(n,e,t)},sendMarkerForMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"displayed",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&l.default.settings.get("send_chat_markers").includes(t)&&(e?.get("is_markable")||s)){const s=y.getBareJidFromJid(e.get("from"));(0,v.sendMarker)(s,e.get("msgid"),t,e.get("type"))}},handleChatMarker(e){if(y.getBareJidFromJid(e.to)!==a.default.bare_jid)return!1;if(e.is_markable)return!this.contact||e.is_archived||e.is_carbon||(0,v.sendMarker)(e.from,e.msgid,"received"),!1;if(e.marker_id){const t=this.messages.findWhere({msgid:e.marker_id}),s=`marker_${e.marker}`;return t&&!t.get(s)&&t.save({field_name:(new Date).toISOString()}),!0}},sendReceiptStanza(e,t){const s=b({from:a.default.connection.jid,id:j.getUniqueId(),to:e,type:"chat"}).c("received",{xmlns:y.NS.RECEIPTS,id:t}).up().c("store",{xmlns:y.NS.HINTS}).up();l.default.send(s)},handleReceipt(e){if("them"===e.sender)if(e.is_valid_receipt_request)this.sendReceiptStanza(e.from,e.msgid);else if(e.receipt_id){const t=this.messages.findWhere({msgid:e.receipt_id});return t&&!t.get("received")&&t.save({received:(new Date).toISOString()}),!0}return!1},async createMessageStanza(e){const t=b({from:a.default.connection.jid,to:this.get("jid"),type:this.get("message_type"),id:e.get("edited")&&j.getUniqueId()||e.get("msgid")}).c("body").t(e.get("body")).up().c(a.default.ACTIVE,{xmlns:y.NS.CHATSTATES}).root();"chat"===e.get("type")&&t.c("request",{xmlns:y.NS.RECEIPTS}).root(),e.get("is_encrypted")||(e.get("is_spoiler")&&(e.get("spoiler_hint")?t.c("spoiler",{xmlns:y.NS.SPOILER},e.get("spoiler_hint")).root():t.c("spoiler",{xmlns:y.NS.SPOILER}).root()),(e.get("references")||[]).forEach((e=>{const s={xmlns:y.NS.REFERENCE,begin:e.begin,end:e.end,type:e.type};e.uri&&(s.uri=e.uri),t.c("reference",s).root()})),e.get("oob_url")&&t.c("x",{xmlns:y.NS.OUTOFBAND}).c("url").t(e.get("oob_url")).root()),e.get("edited")&&t.c("replace",{xmlns:y.NS.MESSAGE_CORRECT,id:e.get("msgid")}).root(),e.get("origin_id")&&t.c("origin-id",{xmlns:y.NS.SID,id:e.get("origin_id")}).root(),t.root();return(await l.default.hook("createMessageStanza",this,{message:e,stanza:t})).stanza},async getOutgoingMessageAttributes(e){await l.default.emojis.initialize();const t=!!this.get("composing_spoiler"),s=j.getUniqueId(),n=e?.body,r=n?j.shortnamesToUnicode(n):void 0;return e=Object.assign({},e,{from:a.default.bare_jid,fullname:a.default.xmppstatus.get("fullname"),id:s,is_only_emojis:!!n&&j.isOnlyEmojis(n),jid:this.get("jid"),message:r,msgid:s,nickname:this.get("nickname"),sender:"me",time:(new Date).toISOString(),type:this.get("message_type"),body:r,is_spoiler:t,origin_id:s},(0,f.getMediaURLsMetadata)(n)),e=await l.default.hook("getOutgoingMessageAttributes",this,e)},setEditable(e,t){e.is_headline||(0,g.isEmptyMessage)(e)||"me"!==e.sender||("all"===l.default.settings.get("allow_message_corrections")?e.editable=!(e.file||e.retracted||"oob_url"in e):"last"===l.default.settings.get("allow_message_corrections")&&t>this.get("time_sent")&&(this.set({time_sent:t}),this.messages.findWhere({editable:!0})?.save({editable:!1}),e.editable=!(e.file||e.retracted||"oob_url"in e)))},async createMessage(e,t){return e.time=e.time||(new Date).toISOString(),await this.messages.fetched,this.messages.create(e,t)},async sendMessage(e){e=await this.getOutgoingMessageAttributes(e);let t=this.messages.findWhere("correcting");if(t){const s=t.get("older_versions")||{};s[t.get("edited")||t.get("time")]=t.getMessageText(),t.save({...(0,i.default)(e,["body","is_only_emojis","media_urls","references","is_encrypted"]),correcting:!1,edited:(new Date).toISOString(),message:e.body,ogp_metadata:[],origin_id:j.getUniqueId(),received:void 0,older_versions:s,plaintext:e.is_encrypted?e.message:void 0})}else this.setEditable(e,(new Date).toISOString()),t=await this.createMessage(e);try{const e=await this.createMessageStanza(t);l.default.send(e)}catch(e){return t.destroy(),void o.default.error(e)}return l.default.trigger("sendMessage",{chatbox:this,message:t}),t},sendChatState(){if(l.default.settings.get("send_chat_state_notifications")&&this.get("chat_state")){const e=l.default.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;l.default.send(b({id:j.getUniqueId(),to:this.get("jid"),type:"chat"}).c(this.get("chat_state"),{xmlns:y.NS.CHATSTATES}).up().c("no-store",{xmlns:y.NS.HINTS}).up().c("no-permanent-store",{xmlns:y.NS.HINTS}))}},async sendFiles(e){const{__:t}=a.default,s=(await l.default.disco.features.get(y.NS.HTTPUPLOAD,a.default.domain)).pop();if(!s)return void this.createMessage({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0});const n=s.dataforms.where({FORM_TYPE:{value:y.NS.HTTPUPLOAD,type:"hidden"}}).pop(),r=window.parseInt((n?.attributes||{})["max-file-size"]?.value),o=s?.id;o?Array.from(e).forEach((async e=>{if(e=await l.default.hook("beforeFileUpload",this,e),!window.isNaN(r)&&window.parseInt(e.size)>r)return this.createMessage({message:t("The size of your file, %1$s, exceeds the maximum allowed by your server, which is %2$s.",e.name,(0,h.filesize)(r)),type:"error",is_ephemeral:!0});{const t=await this.getOutgoingMessageAttributes(),s=Object.assign(t,{file:!0,progress:0,slot_request_url:o});this.setEditable(s,(new Date).toISOString());const n=await this.createMessage(s,{silent:!0});n.file=e,this.messages.trigger("add",n),n.getRequestSlotURL()}})):this.createMessage({message:t("Sorry, looks like file upload is not supported by your server."),type:"error",is_ephemeral:!0})},maybeShow(e){if(!(0,g.isUniView)())return j.safeSave(this,{hidden:!1}),this.trigger("show"),this;{const t=e=>!e.get("hidden")&&e.get("jid")!==this.get("jid")&&"controlbox"!==e.get("id"),s=a.default.chatboxes.filter(t);(e||0===s.length)&&(s.forEach((e=>j.safeSave(e,{hidden:!0}))),j.safeSave(this,{hidden:!1}))}},isHidden(){return this.get("hidden")||this.isScrolledUp()||"hidden"===a.default.windowState},handleUnreadMessage(e){e?.get("body")&&j.isNewMessage(e)&&("me"===e.get("sender")?this.ui.set("scrolled",!1):this.isHidden()?this.incrementUnreadMsgsCounter(e):this.sendMarkerForMessage(e))},incrementUnreadMsgsCounter(e){const t={num_unread:this.get("num_unread")+1};0===this.get("num_unread")&&(t.first_unread_id=e.get("id")),this.save(t)},clearUnreadMsgCounter(){this.get("num_unread")>0&&this.sendMarkerForMessage(this.messages.last()),j.safeSave(this,{num_unread:0})},isScrolledUp(){return this.ui.get("scrolled")}})},"./src/headless/plugins/chat/parsers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{parseMessage:()=>f});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/dayjs/dayjs.min.js"),i=s.n(o),a=s("./src/headless/log.js"),l=s("./src/headless/utils/core.js"),c=s("./src/headless/shared/actions.js"),d=s("./src/headless/shared/parsers.js");const{Strophe:u,sizzle:h}=r.converse.env;async function f(e){(0,d.throwErrorIfInvalidForward)(e);let t=e.getAttribute("to");const s=u.getResourceFromJid(t);if(r.default.settings.get("filter_by_resource")&&s&&s!==n.default.resource)return new d.StanzaParseError(`Ignoring incoming message intended for a different resource: ${t}`,e);const o=e;let f=e.getAttribute("from")||n.default.bare_jid;if((0,d.isCarbon)(e)){if(f!==n.default.bare_jid)return(0,c.rejectMessage)(e,"Rejecting carbon from invalid JID"),new d.StanzaParseError(`Rejecting carbon from invalid JID ${t}`,e);{const s=`[xmlns="${u.NS.CARBONS}"] > forwarded[xmlns="${u.NS.FORWARD}"] > message`;t=(e=h(s,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const m=(0,d.isArchived)(e);if(m){if(f!==n.default.bare_jid)return new d.StanzaParseError(`Invalid Stanza: alleged MAM message from ${e.getAttribute("from")}`,e);{const s=`[xmlns="${u.NS.MAM}"] > forwarded[xmlns="${u.NS.FORWARD}"] > message`;t=(e=h(s,e).pop()).getAttribute("to"),f=e.getAttribute("from")}}const p=u.getBareJidFromJid(f),g=p===n.default.bare_jid;if(g&&null===t)return new d.StanzaParseError(`Don't know how to handle message stanza without 'to' attribute. ${e.outerHTML}`,e);const _=(0,d.isHeadline)(e),v=(0,d.isServerMessage)(e);let y,b;if(!_&&!v&&(b=g?u.getBareJidFromJid(t):p,y=await r.default.contacts.get(b),void 0===y&&!r.default.settings.get("allow_non_roster_messaging")))return a.default.error(e),new d.StanzaParseError("Blocking messaging with a JID not in our roster because allow_non_roster_messaging is false.",e);const j=h(`delay[xmlns="${u.NS.DELAY}"]`,o).pop(),w=(0,d.getChatMarker)(e),S=(new Date).toISOString();let x=Object.assign({contact_jid:b,is_archived:m,is_headline:_,is_server_message:v,body:e.querySelector("body")?.textContent?.trim(),chat_state:(0,d.getChatState)(e),from:u.getBareJidFromJid(e.getAttribute("from")),is_carbon:(0,d.isCarbon)(o),is_delayed:!!j,is_markable:!!h(`markable[xmlns="${u.NS.MARKERS}"]`,e).length,is_marker:!!w,is_unstyled:!!h(`unstyled[xmlns="${u.NS.STYLING}"]`,e).length,marker_id:w&&w.getAttribute("id"),msgid:e.getAttribute("id")||o.getAttribute("id"),nick:y?.attributes?.nickname,receipt_id:(0,d.getReceiptId)(e),received:(new Date).toISOString(),references:(0,d.getReferences)(e),sender:g?"me":"them",subject:e.querySelector("subject")?.textContent,thread:e.querySelector("thread")?.textContent,time:j?i()(j.getAttribute("stamp")).toISOString():S,to:e.getAttribute("to"),type:e.getAttribute("type")||"normal"},(0,d.getErrorAttributes)(e),(0,d.getOutOfBandAttributes)(e),(0,d.getSpoilerAttributes)(e),(0,d.getCorrectionAttributes)(e,o),(0,d.getStanzaIDs)(e,o),(0,d.getRetractionAttributes)(e,o),(0,d.getEncryptionAttributes)(e,n.default));if(x.is_archived){const t=o.getAttribute("from");if(t&&t!==n.default.bare_jid)return new d.StanzaParseError(`Invalid Stanza: Forged MAM message from ${t}`,e)}return await r.default.emojis.initialize(),x=Object.assign({message:x.body||x.error,is_only_emojis:!!x.body&&l.default.isOnlyEmojis(x.body),is_valid_receipt_request:(0,d.isValidReceiptRequest)(e,x)},x),x.id=x.origin_id||x[`stanza_id ${x.from}`]||l.default.getUniqueId(),x=await r.default.hook("parseMessage",e,x),Object.assign(x,(0,d.getMediaURLsMetadata)(x.is_encrypted?x.plaintext:x.body))}},"./src/headless/plugins/chat/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{autoJoinChats:()=>f,enableCarbons:()=>g,handleMessageStanza:()=>p,onClearSession:()=>h,openChat:()=>u,registerMessageHandlers:()=>m});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./src/headless/shared/parsers.js"),a=s("./src/headless/plugins/chat/parsers.js"),l=s("./src/headless/utils/core.js");const{Strophe:c,u:d}=r.converse.env;function u(e){if(!d.isValidJID(e))return o.default.warn(`Invalid JID "${e}" provided in URL fragment`);r.default.chats.open(e)}async function h(){if((0,l.shouldClearCache)()){await Promise.all(n.default.chatboxes.map((e=>e.messages&&e.messages.clearStore({silent:!0}))));const e=e=>e.get("type")!==n.default.CONTROLBOX_TYPE;n.default.chatboxes.clearStore({silent:!0},e)}}function f(){r.default.settings.get("auto_join_private_chats").forEach((e=>{n.default.chatboxes.where({jid:e}).length||("string"==typeof e?r.default.chats.open(e):o.default.error('Invalid jid criteria specified for "auto_join_private_chats"'))})),r.default.trigger("privateChatsAutoJoined")}function m(){n.default.connection.addHandler((e=>!!(["groupchat","error"].includes(e.getAttribute("type"))||(0,i.isHeadline)(e)||(0,i.isServerMessage)(e)||(0,i.isArchived)(e))||(n.default.handleMessageStanza(e)||!0)),null,"message"),n.default.connection.addHandler((e=>async function(e){const t=c.getBareJidFromJid(e.getAttribute("from"));if(d.isSameBareJID(t,n.default.bare_jid))return;const s=await r.default.chatboxes.get(t);s?.get("type")===n.default.PRIVATE_CHAT_TYPE&&s?.handleErrorMessageStanza(e)}(e)||!0),null,"message","error")}async function p(e){if(e=e.tree?.()??e,(0,i.isServerMessage)(e)){const t=e.getAttribute("from");return o.default.info(`handleMessageStanza: Ignoring incoming server message from JID: ${t}`)}let t;try{t=await(0,a.parseMessage)(e)}catch(e){return o.default.error(e)}if(d.isErrorObject(t))return t.stanza&&o.default.error(t.stanza),o.default.error(t.message);const s=!(!t.body&&!t.plaintext),n=await r.default.chats.get(t.contact_jid,{nickname:t.nick},s);await(n?.queueMessage(t));const l={stanza:e,attrs:t,chatbox:n};r.default.trigger("message",l)}async function g(){const e=c.getDomainFromJid(n.default.bare_jid);if(!await r.default.disco.supports(c.NS.CARBONS,e))return void o.default.warn("Not enabling carbons because it's not supported!");const t=new c.Builder("iq",{from:n.default.connection.jid,type:"set"}).c("enable",{xmlns:c.NS.CARBONS}),s=await r.default.sendIQ(t,null,!1);null===s?o.default.warn("A timeout occurred while trying to enable carbons"):d.isErrorStanza(s)?(o.default.warn("An error occurred while trying to enable message carbons."),o.default.error(s)):o.default.debug("Message carbons have been enabled.")}},"./src/headless/plugins/chatboxes/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/plugins/chatboxes/utils.js");const i={async create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return await r.default.waitUntil("chatBoxesFetched"),"string"==typeof e?(0,o.createChatBox)(e,t,s):Promise.all(e.map((e=>(0,o.createChatBox)(e,t,s))))},get:async e=>(await r.default.waitUntil("chatBoxesFetched"),void 0===e?n.default.chatboxes.models:"string"==typeof e?n.default.chatboxes.get(e.toLowerCase()):(e=e.map((e=>e.toLowerCase())),n.default.chatboxes.models.filter((t=>e.includes(t.get("jid"))))))}},"./src/headless/plugins/chatboxes/chatboxes.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/@converse/skeletor/src/collection.js"),i=s("./src/headless/utils/storage.js");const a=o.Collection.extend({comparator:"time_opened",model:(e,t)=>new n.default.ChatBox(e,t),onChatBoxesFetched(e){e.filter((e=>!e.isValid())).forEach((e=>e.destroy())),r.default.trigger("chatBoxesFetched")},onConnected(e){e||((0,i.initStorage)(this,`converse.chatboxes-${n.default.bare_jid}`),this.fetch({add:!0,success:e=>this.onChatBoxesFetched(e)}))}})},"./src/headless/plugins/chatboxes/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/emoji/index.js");var n=s("./src/headless/plugins/chatboxes/chatboxes.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/plugins/chatboxes/api.js");const{Strophe:a}=o.converse.env;o.converse.plugins.add("converse-chatboxes",{dependencies:["converse-emoji","converse-roster","converse-vcard"],initialize(){o.default.promises.add(["chatBoxesFetched","chatBoxesInitialized","privateChatsAutoJoined"]),Object.assign(o.default,{chatboxes:i.default}),r.default.ChatBoxes=n.default,o.default.listen.on("addClientFeatures",(()=>{o.default.disco.own.features.add(a.NS.MESSAGE_CORRECT),o.default.disco.own.features.add(a.NS.HTTPUPLOAD),o.default.disco.own.features.add(a.NS.OUTOFBAND)})),o.default.listen.on("pluginsInitialized",(()=>{r.default.chatboxes=new r.default.ChatBoxes,o.default.trigger("chatBoxesInitialized")})),o.default.listen.on("presencesInitialized",(e=>r.default.chatboxes.onConnected(e))),o.default.listen.on("reconnected",(()=>r.default.chatboxes.forEach((e=>e.onReconnection()))))}})},"./src/headless/plugins/chatboxes/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{createChatBox:()=>a});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js");const{Strophe:i}=r.converse.env;async function a(e,t,s){let r;e=i.getBareJidFromJid(e.toLowerCase()),Object.assign(t,{jid:e,id:e});try{r=new s(t,{collection:n.default.chatboxes})}catch(e){return o.default.error(e),null}return await r.initialized,r.isValid()?(n.default.chatboxes.add(r),r):(r.destroy(),null)}},"./src/headless/plugins/disco/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./node_modules/@converse/openpromise/openpromise.js");const{Strophe:a,$iq:l}=r.converse.env,c={disco:{stream:{async getFeature(e,t){if(await r.default.waitUntil("streamFeaturesAdded"),!e||!t)throw new Error("name and xmlns need to be provided when calling disco.stream.getFeature");if(void 0!==n.default.stream_features||r.default.connection.connected())return n.default.stream_features.findWhere({name:e,xmlns:t});{const s=`Tried to get feature ${e} ${t} but _converse.stream_features has been torn down`;o.default.warn(s)}}},own:{identities:{add(e,t,s,r){for(var o=0;o<n.default.disco._identities.length;o++)if(n.default.disco._identities[o].category==e&&n.default.disco._identities[o].type==t&&n.default.disco._identities[o].name==s&&n.default.disco._identities[o].lang==r)return!1;n.default.disco._identities.push({category:e,type:t,name:s,lang:r})},clear(){n.default.disco._identities=[]},get:()=>n.default.disco._identities},features:{add(e){for(var t=0;t<n.default.disco._features.length;t++)if(n.default.disco._features[t]==e)return!1;n.default.disco._features.push(e)},clear(){n.default.disco._features=[]},get:()=>n.default.disco._features}},info(e,t){const s={xmlns:a.NS.DISCO_INFO};t&&(s.node=t);const o=l({from:n.default.connection.jid,to:e,type:"get"}).c("query",s);return r.default.sendIQ(o)},items(e,t){const s={xmlns:a.NS.DISCO_ITEMS};return t&&(s.node=t),r.default.sendIQ(l({from:n.default.connection.jid,to:e,type:"get"}).c("query",s))},entities:{async get(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(await r.default.waitUntil("discoInitialized"),!e)return n.default.disco_entities;if(void 0===n.default.disco_entities)return void o.default.warn(`Tried to look up entity ${e} but _converse.disco_entities has been torn down`);const s=n.default.disco_entities.get(e);return s||!t?s:r.default.disco.entities.create({jid:e})},items:e=>n.default.disco_entities.filter((t=>t.get("parent_jids")?.includes(e))),create:(e,t)=>n.default.disco_entities.create(e,t)},features:{async get(e,t){if(!t)throw new TypeError("You need to provide an entity JID");const s=await r.default.disco.entities.get(t,!0);if(void 0===n.default.disco_entities&&!r.default.connection.connected())return o.default.warn(`Tried to get feature ${e} for ${t} but _converse.disco_entities has been torn down`),[];const i=[s.getFeature(e),...r.default.disco.entities.items(t).map((t=>t.getFeature(e)))];return(await Promise.all(i)).filter((e=>e instanceof Object))},async has(e,t){if(!t)throw new TypeError("You need to provide an entity JID");const s=await r.default.disco.entities.get(t,!0);if(void 0===n.default.disco_entities&&!r.default.connection.connected())return o.default.warn(`Tried to check if ${t} supports feature ${e}`),!1;if(await s.getFeature(e))return!0;return(await Promise.all(r.default.disco.entities.items(t).map((t=>t.getFeature(e))))).map((e=>e instanceof Object)).includes(!0)}},supports:(e,t)=>r.default.disco.features.has(e,t),async refresh(e){if(!e)throw new TypeError("api.disco.refresh: You need to provide an entity JID");await r.default.waitUntil("discoInitialized");let t=await r.default.disco.entities.get(e);return t?(t.features.reset(),t.fields.reset(),t.identities.reset(),t.waitUntilFeaturesDiscovered.isPending||(t.waitUntilFeaturesDiscovered=(0,i.getOpenPromise)()),t.queryInfo()):t=await r.default.disco.entities.create({jid:e},{ignore_cache:!0}),t.waitUntilFeaturesDiscovered},refreshFeatures:e=>r.default.refresh(e),async getFeatures(e){if(!e)throw new TypeError("api.disco.getFeatures: You need to provide an entity JID");await r.default.waitUntil("discoInitialized");let t=await r.default.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.features},async getFields(e){if(!e)throw new TypeError("api.disco.getFields: You need to provide an entity JID");await r.default.waitUntil("discoInitialized");let t=await r.default.disco.entities.get(e,!0);return t=await t.waitUntilFeaturesDiscovered,t.fields},async getIdentity(e,t,s){const n=await r.default.disco.entities.get(s,!0);if(void 0!==n||r.default.connection.connected())return n.getIdentity(e,t);{const t=`Tried to look up category ${e} for ${s} but _converse.disco_entities has been torn down`;o.default.warn(t)}}}}},"./src/headless/plugins/disco/entities.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/plugins/disco/entity.js"),r=s("./src/headless/log.js");const o=s("./node_modules/@converse/skeletor/src/collection.js").Collection.extend({model:n.default,fetchEntities(){return new Promise(((e,t)=>{this.fetch({add:!0,success:e,error(e,s){r.default.error(s),t(new Error("Could not fetch disco entities"))}})}))}})},"./src/headless/plugins/disco/entity.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./node_modules/sizzle/dist/sizzle.js"),a=s.n(i),l=s("./node_modules/@converse/skeletor/src/collection.js"),c=s("./node_modules/@converse/skeletor/src/model.js"),d=s("./node_modules/@converse/openpromise/openpromise.js");const{Strophe:u}=r.converse.env;class h extends c.Model{get idAttribute(){return"jid"}initialize(e,t){super.initialize(),this.waitUntilFeaturesDiscovered=(0,d.getOpenPromise)(),this.dataforms=new l.Collection;let s=`converse.dataforms-${this.get("jid")}`;this.dataforms.browserStorage=n.default.createStore(s,"session"),this.features=new l.Collection,s=`converse.features-${this.get("jid")}`,this.features.browserStorage=n.default.createStore(s,"session"),this.listenTo(this.features,"add",this.onFeatureAdded),this.fields=new l.Collection,s=`converse.fields-${this.get("jid")}`,this.fields.browserStorage=n.default.createStore(s,"session"),this.listenTo(this.fields,"add",this.onFieldAdded),this.identities=new l.Collection,s=`converse.identities-${this.get("jid")}`,this.identities.browserStorage=n.default.createStore(s,"session"),this.fetchFeatures(t)}async getIdentity(e,t){return await this.waitUntilFeaturesDiscovered,this.identities.findWhere({category:e,type:t})}async getFeature(e){if(await this.waitUntilFeaturesDiscovered,this.features.findWhere({var:e}))return this}onFeatureAdded(e){e.entity=this,r.default.trigger("serviceDiscovered",e)}onFieldAdded(e){e.entity=this,r.default.trigger("discoExtensionFieldDiscovered",e)}async fetchFeatures(e){if(e.ignore_cache)this.queryInfo();else{const e=this.features.browserStorage.name,t=await this.features.browserStorage.store.getItem(e);t&&0===t.length||null===t?this.queryInfo():(this.features.fetch({add:!0,success:()=>{this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}),this.identities.fetch({add:!0}))}}async queryInfo(){let e;try{e=await r.default.disco.info(this.get("jid"),null)}catch(e){return null===e?o.default.error(`Timeout for disco#info query for ${this.get("jid")}`):o.default.error(e),void this.waitUntilFeaturesDiscovered.resolve(this)}this.onInfo(e)}onDiscoItems(e){a()(`query[xmlns="${u.NS.DISCO_ITEMS}"] item`,e).forEach((e=>{if(e.getAttribute("node"))return;const t=e.getAttribute("jid"),s=n.default.disco_entities.get(t);s?s.set({parent_jids:[this.get("jid")]}):r.default.disco.entities.create({jid:t,parent_jids:[this.get("jid")],name:e.getAttribute("name")})}))}async queryForItems(){if(0===this.identities.where({category:"server"}).length)return;const e=await r.default.disco.items(this.get("jid"));this.onDiscoItems(e)}async onInfo(e){Array.from(e.querySelectorAll("identity")).forEach((e=>{this.identities.create({category:e.getAttribute("category"),type:e.getAttribute("type"),name:e.getAttribute("name")})})),a()(`x[type="result"][xmlns="${u.NS.XFORM}"]`,e).forEach((e=>{const t={};a()("field",e).forEach((e=>{t[e.getAttribute("var")]={value:e.querySelector("value")?.textContent,type:e.getAttribute("type")}})),this.dataforms.create(t)})),e.querySelector(`feature[var="${u.NS.DISCO_ITEMS}"]`)&&await this.queryForItems(),Array.from(e.querySelectorAll("feature")).forEach((t=>{this.features.create({var:t.getAttribute("var"),from:e.getAttribute("from")})})),a()('x[type="result"][xmlns="jabber:x:data"] field',e).forEach((t=>{this.fields.create({var:t.getAttribute("var"),value:t.querySelector("value")?.textContent,from:e.getAttribute("from")})})),this.waitUntilFeaturesDiscovered.resolve(this),this.trigger("featuresDiscovered")}}const f=h},"./src/headless/plugins/disco/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/plugins/disco/entities.js"),r=s("./src/headless/plugins/disco/entity.js"),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/shared/api/index.js"),a=s("./src/headless/plugins/disco/api.js"),l=s("./src/headless/plugins/disco/utils.js");const{Strophe:c}=i.converse.env;i.converse.plugins.add("converse-disco",{initialize(){Object.assign(i.default,a.default),i.default.promises.add("discoInitialized"),i.default.promises.add("streamFeaturesAdded"),o.default.DiscoEntity=r.default,o.default.DiscoEntities=n.default,o.default.disco={_identities:[],_features:[]},i.default.listen.on("userSessionInitialized",(async()=>{(0,l.initStreamFeatures)(),o.default.connfeedback.get("connection_status")===c.Status.ATTACHED&&(await new Promise(((e,t)=>o.default.stream_features.fetch({success:e,error:t}))),(0,l.notifyStreamFeaturesAdded)())})),i.default.listen.on("beforeResourceBinding",l.populateStreamFeatures),i.default.listen.on("reconnected",l.initializeDisco),i.default.listen.on("connected",l.initializeDisco),i.default.listen.on("beforeTearDown",(async()=>{i.default.promises.add("streamFeaturesAdded"),o.default.stream_features&&(await o.default.stream_features.clearStore(),delete o.default.stream_features)})),i.default.listen.on("will-reconnect",l.clearSession),i.default.listen.on("clearSession",l.clearSession)}})},"./src/headless/plugins/disco/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearSession:()=>h,initStreamFeatures:()=>c,initializeDisco:()=>l,notifyStreamFeaturesAdded:()=>d,populateStreamFeatures:()=>u});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/@converse/skeletor/src/collection.js");const{Strophe:i,$iq:a}=r.converse.env;async function l(){r.default.disco.own.identities.add("client","web","Converse"),r.default.disco.own.features.add(i.NS.CHATSTATES),r.default.disco.own.features.add(i.NS.DISCO_INFO),r.default.disco.own.features.add(i.NS.ROSTERX),r.default.disco.own.features.add(i.NS.CARBONS),r.default.trigger("addClientFeatures"),n.default.connection.addHandler((e=>function(e){const t=e.getElementsByTagName("query")[0].getAttribute("node"),s={xmlns:i.NS.DISCO_INFO};t&&(s.node=t);const o=a({type:"result",id:e.getAttribute("id")}),l=e.getAttribute("from");return null!==l&&o.attrs({to:l}),o.c("query",s),n.default.disco._identities.forEach((e=>{const t={category:e.category,type:e.type};e.name&&(t.name=e.name),e.lang&&(t["xml:lang"]=e.lang),o.c("identity",t).up()})),n.default.disco._features.forEach((e=>o.c("feature",{var:e}).up())),r.default.send(o.tree()),!0}(e)),i.NS.DISCO_INFO,"iq","get",null,null),n.default.disco_entities=new n.default.DiscoEntities;const e=`converse.disco-entities-${n.default.bare_jid}`;n.default.disco_entities.browserStorage=n.default.createStore(e,"session");const t=await n.default.disco_entities.fetchEntities();0!==t.length&&t.get(n.default.domain)||r.default.disco.entities.create({jid:n.default.domain},{ignore_cache:!0}),r.default.trigger("discoInitialized")}function c(){if(!n.default.stream_features){const e=`converse.stream-features-${i.getBareJidFromJid(n.default.jid)}`;r.default.promises.add("streamFeaturesAdded"),n.default.stream_features=new o.Collection,n.default.stream_features.browserStorage=n.default.createStore(e,"session")}}function d(){r.default.trigger("streamFeaturesAdded")}function u(){c(),Array.from(n.default.connection.features.childNodes).forEach((e=>{n.default.stream_features.create({name:e.nodeName,xmlns:e.getAttribute("xmlns")})})),d()}function h(){n.default.disco_entities?.forEach((e=>e.features.clearStore())),n.default.disco_entities?.forEach((e=>e.identities.clearStore())),n.default.disco_entities?.forEach((e=>e.dataforms.clearStore())),n.default.disco_entities?.forEach((e=>e.fields.clearStore())),n.default.disco_entities?.clearStore(),delete n.default.disco_entities}},"./src/headless/plugins/emoji/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/emoji/utils.js");var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./node_modules/@converse/openpromise/openpromise.js");r.converse.emojis={initialized:!1,initialized_promise:(0,i.getOpenPromise)()},r.converse.plugins.add("converse-emoji",{initialize(){const{___:e}=n.default;r.default.settings.extend({emoji_image_path:"https://twemoji.maxcdn.com/v/12.1.6/",emoji_categories:{smileys:":grinning:",people:":thumbsup:",activity:":soccer:",travel:":motorcycle:",objects:":bomb:",nature:":rainbow:",food:":hotdog:",symbols:":musical_note:",flags:":flag_ac:",custom:null},emoji_category_labels:{smileys:e("Smileys and emotions"),people:e("People"),activity:e("Activities"),travel:e("Travel"),objects:e("Objects"),nature:e("Animals and nature"),food:e("Food and drink"),symbols:e("Symbols"),flags:e("Flags"),custom:e("Stickers")}});class t extends o.Model{defaults(){return{current_category:"smileys",current_skintone:"",scroll_position:0}}}n.default.EmojiPicker=t,Object.assign(r.default,{emojis:{async initialize(){if(!r.converse.emojis.initialized){r.converse.emojis.initialized=!0;const e=await s.e("emojis").then(s.t.bind(s,"./src/headless/plugins/emoji/emoji.json",19)),t=r.converse.emojis.json=e.default;r.converse.emojis.by_sn=Object.keys(t).reduce(((e,s)=>Object.assign(e,t[s])),{}),r.converse.emojis.list=Object.values(r.converse.emojis.by_sn),r.converse.emojis.list.sort(((e,t)=>e.sn<t.sn?-1:e.sn>t.sn?1:0)),r.converse.emojis.shortnames=r.converse.emojis.list.map((e=>e.sn));const n=()=>r.converse.emojis.shortnames.map((e=>e.replace(/[+]/g,"\\$&"))).join("|");r.converse.emojis.shortnames_regex=new RegExp(n(),"gi"),r.converse.emojis.initialized_promise.resolve()}return r.converse.emojis.initialized_promise}}})}})},"./src/headless/plugins/emoji/regexes.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ASCII_REPLACE_REGEX:()=>n,CODEPOINTS_REGEX:()=>r});const n=new RegExp("<object[^>]*>.*?</object>|<span[^>]*>.*?</span>|<(?:object|embed|svg|img|div|span|p|a)[^>]*>|((\\s|^)(\\*\\\\0\\/\\*|\\*\\\\O\\/\\*|\\-___\\-|\\:'\\-\\)|'\\:\\-\\)|'\\:\\-D|\\>\\:\\-\\)|>\\:\\-\\)|'\\:\\-\\(|\\>\\:\\-\\(|>\\:\\-\\(|\\:'\\-\\(|O\\:\\-\\)|0\\:\\-3|0\\:\\-\\)|0;\\^\\)|O;\\-\\)|0;\\-\\)|O\\:\\-3|\\-__\\-|\\:\\-|\\:\\-|\\<\\/3|<\\/3|\\:'\\)|\\:\\-D|'\\:\\)|'\\=\\)|'\\:D|'\\=D|\\>\\:\\)|>\\:\\)|\\>;\\)|>;\\)|\\>\\=\\)|>\\=\\)|;\\-\\)|\\*\\-\\)|;\\-\\]|;\\^\\)|'\\:\\(|'\\=\\(|\\:\\-\\*|\\:\\^\\*|\\>\\:P|>\\:P|X\\-P|\\>\\:\\[|>\\:\\[|\\:\\-\\(|\\:\\-\\[|\\>\\:\\(|>\\:\\(|\\:'\\(|;\\-\\(|\\>\\.\\<|>\\.<|#\\-\\)|%\\-\\)|X\\-\\)|\\\\0\\/|\\\\O\\/|0\\:3|0\\:\\)|O\\:\\)|O\\=\\)|O\\:3|B\\-\\)|8\\-\\)|B\\-D|8\\-D|\\-_\\-|\\>\\:\\\\|>\\:\\\\|\\>\\:\\/|>\\:\\/|\\:\\-\\/|\\:\\-\\.|\\:\\-P|\\:|\\:|\\:\\-b|\\:\\-O|O_O|\\>\\:O|>\\:O|\\:\\-X|\\:\\-#|\\:\\-\\)|\\(y\\)|\\<3|<3|\\:D|\\=D|;\\)|\\*\\)|;\\]|;D|\\:\\*|\\=\\*|\\:\\(|\\:\\[|\\=\\(|\\:@|;\\(|D\\:|\\:\\$|\\=\\$|#\\)|%\\)|X\\)|B\\)|8\\)|\\:\\/|\\:\\\\|\\=\\/|\\=\\\\|\\:L|\\=L|\\:P|\\=P|\\:b|\\:O|\\:X|\\:#|\\=X|\\=#|\\:\\)|\\=\\]|\\=\\)|\\:\\])(?=\\s|$|[!,.?]))","gi"),r=/(?:\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g},"./src/headless/plugins/emoji/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{convertASCII2Emoji:()=>c,getCodePointReferences:()=>u,getShortnameReferences:()=>d});var n=s("./src/headless/plugins/emoji/regexes.js"),r=s("./src/headless/shared/api/index.js");const{u:o}=r.converse.env,i={},a={"*\\0/*":"1f646","*\\O/*":"1f646","-___-":"1f611",":'-)":"1f602","':-)":"1f605","':-D":"1f605",">:-)":"1f606","':-(":"1f613",">:-(":"1f620",":'-(":"1f622","O:-)":"1f607","0:-3":"1f607","0:-)":"1f607","0;^)":"1f607","O;-)":"1f607","0;-)":"1f607","O:-3":"1f607","-__-":"1f611",":-":"1f61b","</3":"1f494",":')":"1f602",":-D":"1f603","':)":"1f605","'=)":"1f605","':D":"1f605","'=D":"1f605",">:)":"1f606",">;)":"1f606",">=)":"1f606",";-)":"1f609","*-)":"1f609",";-]":"1f609",";^)":"1f609","':(":"1f613","'=(":"1f613",":-*":"1f618",":^*":"1f618",">:P":"1f61c","X-P":"1f61c",">:[":"1f61e",":-(":"1f61e",":-[":"1f61e",">:(":"1f620",":'(":"1f622",";-(":"1f622",">.<":"1f623","#-)":"1f635","%-)":"1f635","X-)":"1f635","\\0/":"1f646","\\O/":"1f646","0:3":"1f607","0:)":"1f607","O:)":"1f607","O=)":"1f607","O:3":"1f607","B-)":"1f60e","8-)":"1f60e","B-D":"1f60e","8-D":"1f60e","-_-":"1f611",">:\\":"1f615",">:/":"1f615",":-/":"1f615",":-.":"1f615",":-P":"1f61b",":":"1f61b",":-b":"1f61b",":-O":"1f62e",O_O:"1f62e",">:O":"1f62e",":-X":"1f636",":-#":"1f636",":-)":"1f642","(y)":"1f44d","<3":"2764",":D":"1f603","=D":"1f603",";)":"1f609","*)":"1f609",";]":"1f609",";D":"1f609",":*":"1f618","=*":"1f618",":(":"1f61e",":[":"1f61e","=(":"1f61e",":@":"1f620",";(":"1f622","D:":"1f628",":$":"1f633","=$":"1f633","#)":"1f635","%)":"1f635","X)":"1f635","B)":"1f60e","8)":"1f60e",":/":"1f615",":\\":"1f615","=/":"1f615","=\\":"1f615",":L":"1f615","=L":"1f615",":P":"1f61b","=P":"1f61b",":b":"1f61b",":O":"1f62e",":X":"1f636",":#":"1f636","=X":"1f636","=#":"1f636",":)":"1f642","=]":"1f642","=)":"1f642",":]":"1f642"};function l(e){if(e.indexOf("-")>-1){const t=[],s=e.split("-");for(let e=0;e<s.length;e++){let n=parseInt(s[e],16);if(n>=65536&&n<=1114111){const e=Math.floor((n-65536)/1024)+55296,t=(n-65536)%1024+56320;n=String.fromCharCode(e)+String.fromCharCode(t)}else n=String.fromCharCode(n);t.push(n)}return t.join("")}return function(e){let t="string"==typeof e?parseInt(e,16):e;return t<65536?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}(e)}function c(e){return e.replace(n.ASCII_REPLACE_REGEX,((e,t,s,n)=>{if(void 0===n||""===n||!(o.unescapeHTML(n)in a))return e;n=o.unescapeHTML(n);return s+l(a[n].toUpperCase())}))}function d(e){if(!r.converse.emojis.initialized)throw new Error("getShortnameReferences called before emojis are initialized. To avoid this problem, first await the converse.emojis.initialized_promise");return[...e.matchAll(r.converse.emojis.shortnames_regex)].filter((e=>e[0].length>0)).map((e=>{const t=r.converse.emojis.by_sn[e[0]].cp;return{cp:t,begin:e.index,end:e.index+e[0].length,shortname:e[0],emoji:t?l(t):null}}))}function u(e){const t=[];return function(e,t){const s=/\uFE0F/g,r=String.fromCharCode(8205);String(e).replace(n.CODEPOINTS_REGEX,((e,n,o)=>{const i=function(e){const t=[];let s=0,n=0;for(;n<e.length;){const r=e.charCodeAt(n++);s?(t.push((65536+(s-55296<<10)+(r-56320)).toString(16)),s=0):55296<=r&&r<=56319?s=r:t.push(r.toString(16))}return t.join("-")}(e.indexOf(r)<0?e.replace(s,""):e);i&&t(i,e,o)}))}(e,((e,s,n)=>{t.push({begin:n,cp:e,emoji:s,end:n+s.length,shortname:h("cp")[e]?.sn||""})})),t}function h(e){if(i[e])return i[e];if("category"===e)return r.converse.emojis.json;const t=r.converse.emojis.list.map((t=>t[e])).filter(((e,t,s)=>s.indexOf(e)==t));return i[e]={},t.forEach((t=>i[e][t]=r.converse.emojis.list.find((s=>s[e]===t)))),i[e]}Object.assign(o,{getEmojisByAtrribute:h,isOnlyEmojis:function(e){const t=e.trim().split(/\s+/);if(0===t.length||t.length>3)return!1;return t.filter((e=>{const t=u(o.shortnamesToUnicode(e));return 1===t.length&&(e===t[0].shortname||e===t[0].emoji)})).length===t.length},shortnamesToUnicode:function(e){return function(e){let t=[e];return[...d(e),...u(e)].sort(((e,t)=>t.begin-e.begin)).forEach((e=>{const s=t.shift(),n=e.emoji||e.shortname;t=[s.slice(0,e.begin)+n+s.slice(e.end),...t]})),t}(c(e)).pop()}})},"./src/headless/plugins/mam/placeholder.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/@converse/skeletor/src/model.js"),r=s("./src/headless/utils/core.js");class o extends n.Model{defaults(){return{msgid:(0,r.getUniqueId)(),is_ephemeral:!1}}}},"./src/headless/plugins/mam/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{fetchArchivedMessages:()=>y,fetchNewestMessages:()=>b,getMAMPrefsFromFeature:()=>g,handleMAMResult:()=>v,onMAMError:()=>m,onMAMPreferences:()=>p,preMUCJoinMAMFetch:()=>_});var n=s("./src/headless/plugins/mam/placeholder.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/log.js"),a=s("./node_modules/sizzle/dist/sizzle.js"),l=s.n(a),c=s("./node_modules/strophe.js/src/index.js"),d=s("./src/headless/plugins/muc/parsers.js"),u=s("./src/headless/plugins/chat/parsers.js");const{NS:h}=c.Strophe,f=o.converse.env.utils;function m(e){e?.querySelectorAll("feature-not-implemented").length?i.default.warn(`Message Archive Management (XEP-0313) not supported by ${e.getAttribute("from")}`):(i.default.error(`Error while trying to set archiving preferences for ${e.getAttribute("from")}.`),i.default.error(e))}function p(e,t){const s=l()(`prefs[xmlns="${h.MAM}"]`,e).pop();if(s.getAttribute("default")!==o.default.settings.get("message_archiving")){const e=(0,c.$iq)({type:"set"}).c("prefs",{xmlns:h.MAM,default:o.default.settings.get("message_archiving")});Array.from(s.children).forEach((t=>e.cnode(t).up())),o.default.sendIQ(e).then((()=>t.save({preferences:{default:o.default.settings.get("message_archiving")}}))).catch(r.default.onMAMError)}else t.save({preferences:{default:o.default.settings.get("message_archiving")}})}function g(e){const t=e.get("preferences")||{};e.get("var")===h.MAM&&void 0!==o.default.settings.get("message_archiving")&&t.default!==o.default.settings.get("message_archiving")&&o.default.sendIQ((0,c.$iq)({type:"get"}).c("prefs",{xmlns:h.MAM})).then((t=>r.default.onMAMPreferences(t,e))).catch(r.default.onMAMError)}function _(e){o.default.settings.get("muc_show_logs_before_join")&&e.features.get("mam_enabled")&&!e.get("prejoin_mam_fetched")&&(b(e),e.save({prejoin_mam_fetched:!0}))}async function v(e,t,s,n,i){await o.default.emojis.initialize();const a=e.get("type")===r.default.CHATROOMS_TYPE,l=await Promise.all(t.messages.map((t=>a?(0,d.parseMUCMessage)(t,e):(0,u.parseMessage)(t))));t.messages=l;const c={query:s,chatbox:e,messages:l};if(await o.default.trigger("MAMResult",c,{synchronous:!0}),l.forEach((t=>e.queueMessage(t))),t.error){const s=t.error.retry_event_id=f.getUniqueId();o.default.listen.once(s,(()=>y(e,n,i))),e.createMessageFromError(t.error)}}async function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e.disable_mam)return;const i=e.get("type")===r.default.CHATROOMS_TYPE,a=i?e.get("jid"):r.default.bare_jid;if(!await o.default.disco.supports(h.MAM,a))return;const l=o.default.settings.get("archived_messages_page_size"),c=Object.assign({groupchat:i,max:l,with:e.get("jid")},t),d=await o.default.archive.query(c);if(await v(e,d,c,t,s),d.rsm&&!d.complete){if(s)return"forwards"===s?t=d.rsm.next(l,t.before).query:"backwards"===s&&(t=d.rsm.previous(l,t.after).query),y(e,t,s);!async function(e,t,s){if(""==t.before&&(0===e.messages.length||!t.start))return;if(t.before&&!t.start)return;if(null==t.before)return;const r=await Promise.all(s.messages),{rsm:o}=s,i=`stanza_id ${e.get("jid")}`,a=r.find((e=>e[i]===o.result.first)),l={template_hook:"getMessageTemplate",time:new Date(new Date(a.time)-1).toISOString(),before:o.result.first,start:t.start};e.messages.add(new n.default(l))}(e,t,d)}}function b(e){if(e.disable_mam)return;const t=e.getMostRecentMessage();if(t&&!o.default.settings.get("clear_messages_on_reconnection")){if(o.default.settings.get("mam_request_all_pages")){const s=t.get(`stanza_id ${e.get("jid")}`);y(e,s?{after:s}:{start:t.get("time")},"forwards")}else y(e,{before:"",start:t.get("time")})}else y(e,{before:""})}},"./src/headless/plugins/muc/affiliations/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./src/headless/plugins/muc/affiliations/utils.js");const r={affiliations:{set:(e,t)=>(t=Array.isArray(t)?t:[t],e=Array.isArray(e)?e:[e],(0,n.setAffiliations)(e,t))}}},"./src/headless/plugins/muc/affiliations/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{computeAffiliationsDelta:()=>p,getAffiliationList:()=>u,getAssignableAffiliations:()=>h,setAffiliation:()=>m,setAffiliations:()=>f});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./src/headless/plugins/muc/constants.js"),a=s("./src/headless/plugins/muc/parsers.js");const{Strophe:l,$iq:c,u:d}=r.converse.env;async function u(e,t){const{__:s}=n.default,i=c({to:t,type:"get"}).c("query",{xmlns:l.NS.MUC_ADMIN}).c("item",{affiliation:e}),u=await r.default.sendIQ(i,null,!1);if(null===u){const n=s("Error: timeout while fetching %1s list for MUC %2s",e,t),r=new Error(n);return o.default.warn(n),r}if(d.isErrorStanza(u)){const n=s("Error: not allowed to fetch %1s list for MUC %2s",e,t),r=new Error(n);return o.default.warn(n),o.default.warn(u),r}return(0,a.parseMemberListIQ)(u).filter((e=>e)).sort(((e,t)=>e.nick<t.nick?-1:e.nick>t.nick?1:0))}function h(e){let t=r.default.settings.get("modtools_disable_assign");return Array.isArray(t)||(t=t?i.AFFILIATIONS:[]),"owner"===e?.get("affiliation")?i.AFFILIATIONS.filter((e=>!t.includes(e))):"admin"===e?.get("affiliation")?i.AFFILIATIONS.filter((e=>!["owner","admin",...t].includes(e))):[]}function f(e,t){const s=[...new Set(t.map((e=>e.affiliation)))];return Promise.all(s.map((s=>m(s,e,t))))}function m(e,t,s){return Array.isArray(t)||(t=[t]),s=s.filter((t=>[void 0,e].includes(t.affiliation))),Promise.all(t.reduce(((t,n)=>[...t,...s.map((t=>function(e,t,s){const n=c({to:t,type:"set"}).c("query",{xmlns:l.NS.MUC_ADMIN}).c("item",{affiliation:s.affiliation||e,nick:s.nick,jid:s.jid});void 0!==s.reason&&n.c("reason",s.reason);return r.default.sendIQ(n)}(e,n,t)))]),[]))}function p(e,t,s,n){const r=s.map((e=>e.jid)),o=n.map((e=>e.jid));let i=r.filter((e=>!o.includes(e))).map((e=>s[r.indexOf(e)]));return e||(i=i.concat(s.filter((e=>{const t=o.indexOf(e.jid);return t>=0&&e.affiliation!==n[t].affiliation})))),t&&(i=i.concat(o.filter((e=>!r.includes(e))).map((e=>({jid:e,affiliation:"none"}))))),i}n.default.getAssignableAffiliations=h},"./src/headless/plugins/muc/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./node_modules/strophe.js/src/index.js");const{u:a}=r.converse.env,l={rooms:{create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t="string"==typeof t?{nick:t}:t||{},!t.nick&&r.default.settings.get("muc_nickname_from_jid")&&(t.nick=i.Strophe.getNodeFromJid(n.default.bare_jid)),void 0===e)throw new TypeError("rooms.create: You need to provide at least one JID");return"string"==typeof e?r.default.rooms.get(a.getJIDFromURI(e),t,!0):e.map((e=>r.default.rooms.get(a.getJIDFromURI(e),t,!0)))},async open(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await r.default.waitUntil("chatBoxesFetched"),void 0===e){const e="rooms.open: You need to provide at least one JID";throw o.default.error(e),new TypeError(e)}if("string"==typeof e){const n=await r.default.rooms.get(e,t,!0);return!t.hidden&&n?.maybeShow(s),n}{const n=await Promise.all(e.map((e=>r.default.rooms.get(e,t,!0))));return n.forEach((e=>!t.hidden&&e.maybeShow(s))),n}},async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];async function o(e){e=a.getJIDFromURI(e);let o=await r.default.chatboxes.get(e);return!o&&s?o=await r.default.chatboxes.create(e,t,n.default.ChatRoom):(o=o&&o.get("type")===n.default.CHATROOMS_TYPE?o:null,o&&Object.keys(t).length&&o.save(t)),o}if(await r.default.waitUntil("chatBoxesFetched"),void 0===e){return(await r.default.chatboxes.get()).filter((e=>e.get("type")===n.default.CHATROOMS_TYPE))}return"string"==typeof e?o(e):Promise.all(e.map((e=>o(e))))}}}},"./src/headless/plugins/muc/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AFFILIATIONS:()=>r,AFFILIATION_CHANGES:()=>i,AFFILIATION_CHANGES_LIST:()=>a,INFO_CODES:()=>h,MUC_NICK_CHANGED_CODE:()=>p,MUC_ROLE_CHANGES:()=>d,MUC_ROLE_CHANGES_LIST:()=>u,MUC_ROLE_WEIGHTS:()=>o,MUC_TRAFFIC_STATES:()=>l,MUC_TRAFFIC_STATES_LIST:()=>c,ROLES:()=>n,ROOMSTATUS:()=>f,ROOM_FEATURES:()=>m});const n=["moderator","participant","visitor"],r=["owner","admin","member","outcast","none"],o={moderator:1,participant:2,visitor:3,none:2},i={OWNER:"owner",ADMIN:"admin",MEMBER:"member",EXADMIN:"exadmin",EXOWNER:"exowner",EXOUTCAST:"exoutcast",EXMEMBER:"exmember"},a=Object.values(i),l={ENTERED:"entered",EXITED:"exited"},c=Object.values(l),d={OP:"op",DEOP:"deop",VOICE:"voice",MUTE:"mute"},u=Object.values(d),h={visibility_changes:["100","102","103","172","173","174"],self:["110"],non_privacy_changes:["104","201"],muc_logging_changes:["170","171"],nickname_changes:["210","303"],disconnected:["301","307","321","322","332","333"],affiliation_changes:[...a],join_leave_events:[...c],role_changes:[...u]},f={CONNECTED:0,CONNECTING:1,NICKNAME_REQUIRED:2,PASSWORD_REQUIRED:3,DISCONNECTED:4,ENTERED:5,DESTROYED:6,BANNED:7,CLOSING:8},m=["passwordprotected","unsecured","hidden","publicroom","membersonly","open","persistent","temporary","nonanonymous","semianonymous","moderated","unmoderated","mam_enabled"],p="303"},"./src/headless/plugins/muc/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/chat/index.js"),s("./src/headless/plugins/disco/index.js"),s("./src/headless/plugins/emoji/index.js");var n=s("./src/headless/plugins/muc/message.js"),r=s("./src/headless/plugins/muc/muc.js"),o=s("./src/headless/plugins/muc/occupant.js"),i=s("./src/headless/plugins/muc/occupants.js"),a=s("./src/headless/plugins/muc/affiliations/api.js"),l=s("./src/headless/plugins/muc/api.js"),c=s("./node_modules/@converse/skeletor/src/collection.js"),d=s("./src/headless/shared/_converse.js"),u=s("./src/headless/shared/api/index.js"),h=s("./src/headless/plugins/muc/utils.js"),f=s("./src/headless/plugins/muc/affiliations/utils.js"),m=s("./src/headless/plugins/muc/constants.js");u.converse.AFFILIATION_CHANGES=m.AFFILIATION_CHANGES,u.converse.AFFILIATION_CHANGES_LIST=m.AFFILIATION_CHANGES_LIST,u.converse.MUC_TRAFFIC_STATES=m.MUC_TRAFFIC_STATES,u.converse.MUC_TRAFFIC_STATES_LIST=m.MUC_TRAFFIC_STATES_LIST,u.converse.MUC_ROLE_CHANGES=m.MUC_ROLE_CHANGES,u.converse.MUC_ROLE_CHANGES_LIST=m.MUC_ROLE_CHANGES_LIST,u.converse.MUC={INFO_CODES:m.INFO_CODES},u.converse.MUC_NICK_CHANGED_CODE=m.MUC_NICK_CHANGED_CODE,u.converse.ROOM_FEATURES=m.ROOM_FEATURES,u.converse.ROOMSTATUS=m.ROOMSTATUS;const{Strophe:p}=u.converse.env;p.addNamespace("MUC_ADMIN",p.NS.MUC+"#admin"),p.addNamespace("MUC_OWNER",p.NS.MUC+"#owner"),p.addNamespace("MUC_REGISTER","jabber:iq:register"),p.addNamespace("MUC_ROOMCONF",p.NS.MUC+"#roomconfig"),p.addNamespace("MUC_USER",p.NS.MUC+"#user"),p.addNamespace("MUC_HATS","xmpp:prosody.im/protocol/hats:1"),p.addNamespace("CONFINFO","urn:ietf:params:xml:ns:conference-info"),u.converse.plugins.add("converse-muc",{dependencies:["converse-chatboxes","converse-chat","converse-disco"],overrides:{ChatBoxes:{model(e,t){const{_converse:s}=this.__super__;return e&&e.type==s.CHATROOMS_TYPE?new s.ChatRoom(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){const{__:e,___:t}=d.default;if(u.default.settings.extend({allow_muc_invitations:!0,auto_join_on_invite:!1,auto_join_rooms:[],auto_register_muc_nickname:!1,hide_muc_participants:!1,locked_muc_domain:!1,modtools_disable_assign:!1,muc_clear_messages_on_leave:!0,muc_domain:void 0,muc_fetch_members:!0,muc_history_max_stanzas:void 0,muc_instant_rooms:!0,muc_nickname_from_jid:!1,muc_send_probes:!1,muc_show_info_messages:[...u.converse.MUC.INFO_CODES.visibility_changes,...u.converse.MUC.INFO_CODES.self,...u.converse.MUC.INFO_CODES.non_privacy_changes,...u.converse.MUC.INFO_CODES.muc_logging_changes,...u.converse.MUC.INFO_CODES.nickname_changes,...u.converse.MUC.INFO_CODES.disconnected,...u.converse.MUC.INFO_CODES.affiliation_changes,...u.converse.MUC.INFO_CODES.join_leave_events,...u.converse.MUC.INFO_CODES.role_changes],muc_show_logs_before_join:!1,muc_subscribe_to_rai:!1}),u.default.promises.add(["roomsAutoJoined"]),u.default.settings.get("locked_muc_domain")&&"string"!=typeof u.default.settings.get("muc_domain"))throw new Error("Config Error: it makes no sense to set locked_muc_domain to true when muc_domain is not set");u.converse.env.muc_utils={computeAffiliationsDelta:f.computeAffiliationsDelta},Object.assign(u.default,l.default),Object.assign(u.default.rooms,a.default),d.default.muc={info_messages:{100:e("This groupchat is not anonymous"),102:e("This groupchat now shows unavailable members"),103:e("This groupchat does not show unavailable members"),104:e("The groupchat configuration has changed"),170:e("Groupchat logging is now enabled"),171:e("Groupchat logging is now disabled"),172:e("This groupchat is now no longer anonymous"),173:e("This groupchat is now semi-anonymous"),174:e("This groupchat is now fully-anonymous"),201:e("A new groupchat has been created")},new_nickname_messages:{210:t("Your nickname has been automatically set to %1$s"),303:t("Your nickname has been changed to %1$s")},disconnect_messages:{301:e("You have been banned from this groupchat"),333:e("You have exited this groupchat due to a technical problem"),307:e("You have been kicked from this groupchat"),321:e("You have been removed from this groupchat because of an affiliation change"),322:e("You have been removed from this groupchat because the groupchat has changed to members-only and you're not a member"),332:e("You have been removed from this groupchat because the service hosting it is being shut down")}},d.default.router.route("converse/room?jid=:jid",h.routeToRoom),d.default.ChatRoom=d.default.ChatBox.extend(r.default),d.default.ChatRoomMessage=d.default.Message.extend(n.default),d.default.ChatRoomOccupants=i.default,d.default.ChatRoomOccupant=o.default,d.default.ChatRoomMessages=c.Collection.extend({model:d.default.ChatRoomMessage,comparator:"time"}),Object.assign(d.default,{getDefaultMUCNickname:h.getDefaultMUCNickname,isInfoVisible:h.isInfoVisible,onDirectMUCInvitation:h.onDirectMUCInvitation}),u.default.settings.get("allow_muc_invitations")&&(u.default.listen.on("connected",h.registerDirectInvitationHandler),u.default.listen.on("reconnected",h.registerDirectInvitationHandler)),u.default.listen.on("addClientFeatures",(()=>u.default.disco.own.features.add(`${p.NS.CONFINFO}+notify`))),u.default.listen.on("addClientFeatures",h.onAddClientFeatures),u.default.listen.on("beforeResourceBinding",h.onBeforeResourceBinding),u.default.listen.on("beforeTearDown",h.onBeforeTearDown),u.default.listen.on("chatBoxesFetched",h.autoJoinRooms),u.default.listen.on("disconnected",h.disconnectChatRooms),u.default.listen.on("statusInitialized",h.onStatusInitialized),u.default.listen.on("windowStateChanged",h.onWindowStateChanged)}})},"./src/headless/plugins/muc/message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/strophe.js/src/index.js");const i={initialize(){this.checkValidity()&&(this.get("file")&&this.on("change:put",(()=>this.uploadFile())),this.on("change:type",(()=>this.setOccupant())),this.on("change:is_ephemeral",(()=>this.setTimerForEphemeralMessage())),this.chatbox=this.collection?.chatbox,this.setTimerForEphemeralMessage(),this.setOccupant(),r.default.trigger("chatRoomMessageInitialized",this))},getDisplayName(){return this.occupant?.getDisplayName()||this.get("nick")},mayBeModerated(){if(void 0!==this.get("from_muc"))return["all","moderator"].includes(r.default.settings.get("allow_message_retraction"))&&this.get(`stanza_id ${this.get("from_muc")}`)&&this.chatbox.canModerateMessages()},checkValidity(){const e=n.default.Message.prototype.checkValidity.call(this);return!e&&this.chatbox.debouncedRejoin(),e},onOccupantRemoved(){this.stopListening(this.occupant),delete this.occupant,this.listenTo(this.chatbox.occupants,"add",this.onOccupantAdded)},onOccupantAdded(e){if(this.get("occupant_id")){if(e.get("occupant_id")!==this.get("occupant_id"))return}else if(e.get("nick")!==o.Strophe.getResourceFromJid(this.get("from")))return;this.occupant=e,e.get("jid")&&this.save("from_real_jid",e.get("jid")),this.trigger("occupantAdded"),this.listenTo(this.occupant,"destroy",this.onOccupantRemoved),this.stopListening(this.chatbox.occupants,"add",this.onOccupantAdded)},getOccupant(){return this.occupant||this.setOccupant(),this.occupant},setOccupant(){if("groupchat"!==this.get("type")||this.isEphemeral()||this.occupant)return;const e=o.Strophe.getResourceFromJid(this.get("from")),t=this.get("occupant_id");if(this.occupant=this.chatbox.occupants.findOccupant({nick:e,occupant_id:t}),!this.occupant&&(this.occupant=this.chatbox.occupants.create({nick:e,occupant_id:t,jid:this.get("from_real_jid")}),r.default.settings.get("muc_send_probes"))){const t=`${this.chatbox.get("jid")}/${e}`;r.default.user.presence.send("probe",t)}this.listenTo(this.occupant,"destroy",this.onOccupantRemoved)}}},"./src/headless/plugins/muc/muc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/lodash-es/debounce.js"),i=s("./src/headless/log.js"),a=s("./src/headless/utils/parse-helpers.js"),l=s("./node_modules/lodash-es/pick.js"),c=s("./node_modules/sizzle/dist/sizzle.js"),d=s.n(c),u=s("./node_modules/@converse/skeletor/src/model.js"),h=s("./src/headless/plugins/muc/constants.js"),f=s("./node_modules/strophe.js/src/index.js"),m=s("./src/headless/shared/errors.js"),p=s("./src/headless/plugins/muc/affiliations/utils.js"),g=s("./node_modules/@converse/openpromise/openpromise.js"),_=s("./src/headless/shared/chat/utils.js"),v=s("./src/headless/utils/storage.js"),y=s("./src/headless/shared/parsers.js"),b=s("./src/headless/utils/core.js"),j=s("./src/headless/plugins/muc/parsers.js"),w=s("./src/headless/shared/actions.js");const{u:S}=r.converse.env,x=["owner"],E=["admin","ban","deop","destroy","member","op","revoke"],A=["kick","mute","voice","modtools"],C=["nick"],T=["og:article:author","og:article:published_time","og:description","og:image","og:image:height","og:image:width","og:site_name","og:title","og:type","og:url","og:video:height","og:video:secure_url","og:video:tag","og:video:type","og:video:url","og:video:width"],I=["301","303","333","307","321","322"];class k extends u.Model{defaults(){return{connection_status:h.ROOMSTATUS.DISCONNECTED}}}const N={defaults(){return{bookmarked:!1,chat_state:void 0,has_activity:!1,hidden:(0,b.isUniView)()&&!r.default.settings.get("singleton"),hidden_occupants:!!r.default.settings.get("hide_muc_participants"),message_type:"groupchat",name:"",num_unread_general:0,num_unread:0,roomconfig:{},time_opened:this.get("time_opened")||(new Date).getTime(),time_sent:new Date(0).toISOString(),type:n.default.CHATROOMS_TYPE}},async initialize(){this.initialized=(0,g.getOpenPromise)(),this.debouncedRejoin=(0,o.default)(this.rejoin,250),this.set("box_id",`box-${this.get("jid")}`),this.initNotifications(),this.initMessages(),this.initUI(),this.initOccupants(),this.initDiscoModels(),this.registerHandlers(),this.on("change:chat_state",this.sendChatState,this),this.on("change:hidden",this.onHiddenChange,this),this.on("destroy",this.removeHandlers,this),this.ui.on("change:scrolled",this.onScrolledChanged,this),await this.restoreSession(),this.session.on("change:connection_status",this.onConnectionStatusChanged,this),this.listenTo(this.occupants,"add",this.onOccupantAdded),this.listenTo(this.occupants,"remove",this.onOccupantRemoved),this.listenTo(this.occupants,"change:show",this.onOccupantShowChanged),this.listenTo(this.occupants,"change:affiliation",this.createAffiliationChangeMessage),this.listenTo(this.occupants,"change:role",this.createRoleChangeMessage);await this.restoreFromCache()||this.join(),await r.default.trigger("chatRoomInitialized",this,{Synchronous:!0}),this.initialized.resolve()},isEntered(){return this.session.get("connection_status")===h.ROOMSTATUS.ENTERED},isRAICandidate(){return this.get("hidden")&&r.default.settings.get("muc_subscribe_to_rai")&&"none"!==this.getOwnAffiliation()},async restoreFromCache(){if(this.isEntered()){if(await this.fetchOccupants().catch((e=>i.default.error(e))),this.isRAICandidate())return this.session.save("connection_status",h.ROOMSTATUS.DISCONNECTED),this.enableRAI(),!0;if(await this.isJoined())return await new Promise((e=>this.config.fetch({success:e,error:e}))),await new Promise((e=>this.features.fetch({success:e,error:e}))),await this.fetchMessages().catch((e=>i.default.error(e))),!0}return this.session.save("connection_status",h.ROOMSTATUS.DISCONNECTED),this.clearOccupantsCache(),!1},async join(e,t){return this.isEntered()?this:(this.session.save("connection_status",h.ROOMSTATUS.CONNECTING),await this.refreshDiscoInfo(),(e=await this.getAndPersistNickname(e))?(r.default.send(await this.constructJoinPresence(t)),this):((0,b.safeSave)(this.session,{connection_status:h.ROOMSTATUS.NICKNAME_REQUIRED}),r.default.settings.get("muc_show_logs_before_join")&&await this.fetchMessages(),this))},rejoin(){return this.session.save("connection_status",h.ROOMSTATUS.DISCONNECTED),this.registerHandlers(),this.clearOccupantsCache(),this.join()},async constructJoinPresence(e){let t=(0,f.$pres)({id:(0,b.getUniqueId)(),from:n.default.connection.jid,to:this.getRoomJIDAndNick()}).c("x",{xmlns:f.Strophe.NS.MUC}).c("history",{maxstanzas:this.features.get("mam_enabled")?0:r.default.settings.get("muc_history_max_stanzas")}).up();return(e=e||this.get("password"))&&t.cnode(f.Strophe.xmlElement("password",[],e)),t.up(),t=await r.default.hook("constructedMUCPresence",this,t),t},clearOccupantsCache(){this.occupants.length?this.occupants.filter((e=>!e.isMember())).forEach((e=>e.destroy())):this.occupants.clearStore()},sendMarkerForMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"displayed",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&r.default.settings.get("send_chat_markers").includes(t)&&"groupchat"===e?.get("type")&&(e?.get("is_markable")||s)){const s=`stanza_id ${this.get("jid")}`,n=e.get(s);if(!n)return void i.default.error(`Can't send marker for message without stanza ID: ${s}`);const r=f.Strophe.getBareJidFromJid(e.get("from"));(0,w.sendMarker)(r,n,t,e.get("type"))}},enableRAI(){if(r.default.settings.get("muc_subscribe_to_rai")){const e=f.Strophe.getDomainFromJid(this.get("jid"));r.default.user.presence.send(null,e,null,(0,f.$build)("rai",{xmlns:f.Strophe.NS.RAI}))}},async onHiddenChange(){const e=h.ROOMSTATUS,t=this.session.get("connection_status");this.get("hidden")?t===e.ENTERED&&this.isRAICandidate()&&(this.sendMarkerForLastMessage("received",!0),await this.leave(),this.enableRAI()):(t===e.DISCONNECTED&&this.rejoin(),this.clearUnreadMsgCounter())},onOccupantAdded(e){n.default.isInfoVisible(r.converse.MUC_TRAFFIC_STATES.ENTERED)&&this.session.get("connection_status")===h.ROOMSTATUS.ENTERED&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),r.converse.MUC_TRAFFIC_STATES.ENTERED)},onOccupantRemoved(e){n.default.isInfoVisible(r.converse.MUC_TRAFFIC_STATES.EXITED)&&this.isEntered()&&"online"===e.get("show")&&this.updateNotifications(e.get("nick"),r.converse.MUC_TRAFFIC_STATES.EXITED)},onOccupantShowChanged(e){e.get("states").includes("303")||("offline"===e.get("show")&&n.default.isInfoVisible(r.converse.MUC_TRAFFIC_STATES.EXITED)?this.updateNotifications(e.get("nick"),r.converse.MUC_TRAFFIC_STATES.EXITED):"online"===e.get("show")&&n.default.isInfoVisible(r.converse.MUC_TRAFFIC_STATES.ENTERED)&&this.updateNotifications(e.get("nick"),r.converse.MUC_TRAFFIC_STATES.ENTERED))},async onRoomEntered(){await this.occupants.fetchMembers(),r.default.settings.get("clear_messages_on_reconnection")?await this.clearMessages():await this.fetchMessages(),r.default.trigger("enteredNewRoom",this),r.default.settings.get("auto_register_muc_nickname")&&await r.default.disco.supports(f.Strophe.NS.MUC_REGISTER,this.get("jid"))&&this.registerNickname()},async onConnectionStatusChanged(){if(this.isEntered())if(this.isRAICandidate()){try{await this.leave()}catch(e){i.default.error(e)}this.enableRAI()}else await this.onRoomEntered()},async onReconnection(){await this.rejoin(),this.announceReconnection()},getMessagesCollection:()=>new n.default.ChatRoomMessages,restoreSession(){const e=`muc.session-${n.default.bare_jid}-${this.get("jid")}`;return this.session=new k({id:e}),(0,v.initStorage)(this.session,e,"session"),new Promise((e=>this.session.fetch({success:e,error:e})))},initDiscoModels(){let e=`converse.muc-features-${n.default.bare_jid}-${this.get("jid")}`;this.features=new u.Model(Object.assign({id:e},r.converse.ROOM_FEATURES.reduce(((e,t)=>(e[t]=!1,e)),{}))),this.features.browserStorage=n.default.createStore(e,"session"),this.features.listenTo(n.default,"beforeLogout",(()=>this.features.browserStorage.flush())),e=`converse.muc-config-${n.default.bare_jid}-${this.get("jid")}`,this.config=new u.Model({id:e}),this.config.browserStorage=n.default.createStore(e,"session"),this.config.listenTo(n.default,"beforeLogout",(()=>this.config.browserStorage.flush()))},initOccupants(){this.occupants=new n.default.ChatRoomOccupants;const e=`converse.occupants-${n.default.bare_jid}${this.get("jid")}`;this.occupants.browserStorage=n.default.createStore(e,"session"),this.occupants.chatroom=this,this.occupants.listenTo(n.default,"beforeLogout",(()=>this.occupants.browserStorage.flush()))},fetchOccupants(){return this.occupants.fetched=new Promise((e=>{this.occupants.fetch({add:!0,silent:!0,success:e,error:e})})),this.occupants.fetched},handleAffiliationChangedMessage(e){const t=d()(`x[xmlns="${f.Strophe.NS.MUC_USER}"] item`,e).pop();if(t){const s=e.getAttribute("from"),n=e.getAttribute("type"),r=t.getAttribute("affiliation"),o=t.getAttribute("jid"),i={from:s,type:n,affiliation:r,states:[],show:"unavailable"==n?"offline":"online",role:t.getAttribute("role"),jid:f.Strophe.getBareJidFromJid(o),resource:f.Strophe.getResourceFromJid(o)},a=this.occupants.findOccupant({jid:i.jid});a?a.save(i):this.occupants.create(i)}},async handleErrorMessageStanza(e){const{__:t}=n.default,s=await(0,j.parseMUCMessage)(e,this);if(!await this.shouldShowErrorMessage(s))return;const r=this.getMessageReferencedByError(s);if(r){const e={error:s.error,error_condition:s.error_condition,error_text:s.error_text,error_type:s.error_type,editable:!1};s.msgid===r.get("retraction_id")?(e.retracted=void 0,e.retraction_id=void 0,e.retracted_id=void 0,s.error||("forbidden"===s.error_condition?e.error=t("You're not allowed to retract your message."):"not-acceptable"===s.error_condition?e.error=t("Your retraction was not delivered because you're not present in the groupchat."):e.error=t("Sorry, an error occurred while trying to retract your message."))):s.error||("forbidden"===s.error_condition?e.error=t("Your message was not delivered because you weren't allowed to send it."):"not-acceptable"===s.error_condition?e.error=t("Your message was not delivered because you're not present in the groupchat."):e.error=t("Sorry, an error occurred while trying to send your message.")),r.save(e)}else this.createMessage(s)},handleMessageFromMUCHost(e){if(this.isEntered())return;const t=d()(`rai[xmlns="${f.Strophe.NS.RAI}"]`,e).pop();Array.from(t?.querySelectorAll("activity")||[]).map((e=>e.textContent)).includes(this.get("jid"))&&this.save({has_activity:!0,num_unread_general:0})},handleForwardedMentions(e){if(this.isEntered())return;const t=d()(`mentions[xmlns="${f.Strophe.NS.MENTIONS}"] forwarded[xmlns="${f.Strophe.NS.FORWARD}"] message[type="groupchat"]`,e),s=this.get("jid"),n=t.filter((e=>f.Strophe.getBareJidFromJid(e.getAttribute("from"))===s));n.length&&(this.save({has_activity:!0,num_unread:this.get("num_unread")+n.length}),n.forEach((async e=>{const t={stanza:e,attrs:await(0,j.parseMUCMessage)(e,this),chatbox:this};r.default.trigger("message",t)})))},async handleMessageStanza(e){const t=(e=e.tree?.()??e).getAttribute("type");if("error"===t)return this.handleErrorMessageStanza(e);if("groupchat"===t){if((0,y.isArchived)(e))return i.default.warn('Received a MAM message with type "groupchat"');this.createInfoMessages(e),this.fetchFeaturesIfConfigurationChanged(e)}else if(!t)return this.handleForwardedMentions(e);let s;try{s=await(0,j.parseMUCMessage)(e,this)}catch(e){return i.default.error(e)}const n={stanza:e,attrs:s,chatbox:this};return r.default.trigger("message",n),s&&this.queueMessage(s)},registerHandlers(){const e=this.get("jid"),t=f.Strophe.getDomainFromJid(e);this.removeHandlers(),this.presence_handler=n.default.connection.addHandler((e=>this.onPresence(e)||!0),null,"presence",null,null,e,{ignoreNamespaceFragment:!0,matchBareFromJid:!0}),this.domain_presence_handler=n.default.connection.addHandler((e=>this.onPresenceFromMUCHost(e)||!0),null,"presence",null,null,t),this.message_handler=n.default.connection.addHandler((e=>!!this.handleMessageStanza(e)||!0),null,"message",null,null,e,{matchBareFromJid:!0}),this.domain_message_handler=n.default.connection.addHandler((e=>this.handleMessageFromMUCHost(e)||!0),null,"message",null,null,t),this.affiliation_message_handler=n.default.connection.addHandler((e=>this.handleAffiliationChangedMessage(e)||!0),f.Strophe.NS.MUC_USER,"message",null,null,e)},removeHandlers(){return this.message_handler&&(n.default.connection&&n.default.connection.deleteHandler(this.message_handler),delete this.message_handler),this.domain_message_handler&&(n.default.connection&&n.default.connection.deleteHandler(this.domain_message_handler),delete this.domain_message_handler),this.presence_handler&&(n.default.connection&&n.default.connection.deleteHandler(this.presence_handler),delete this.presence_handler),this.domain_presence_handler&&(n.default.connection&&n.default.connection.deleteHandler(this.domain_presence_handler),delete this.domain_presence_handler),this.affiliation_message_handler&&(n.default.connection&&n.default.connection.deleteHandler(this.affiliation_message_handler),delete this.affiliation_message_handler),this},invitesAllowed(){return r.default.settings.get("allow_muc_invitations")&&(this.features.get("open")||"owner"===this.getOwnAffiliation())},getDisplayName(){const e=this.get("name");return e||("hidden"===r.default.settings.get("locked_muc_domain")?f.Strophe.getNodeFromJid(this.get("jid")):this.get("jid"))},sendTimedMessage(e){"function"==typeof e.tree&&(e=e.tree());let t=e.getAttribute("id");t||(t=this.getUniqueId("sendIQ"),e.setAttribute("id",t));const s=(0,g.getOpenPromise)(),o=r.default.settings.get("stanza_timeout"),i=n.default.connection.addTimedHandler(o,(()=>{n.default.connection.deleteHandler(a);const e=new m.TimeoutError("Timeout Error: No response from server");return s.resolve(e),!1})),a=n.default.connection.addHandler((e=>{i&&n.default.connection.deleteTimedHandler(i),s.resolve(e)}),null,"message",["error","groupchat"],t);return r.default.send(e),s},async retractOwnMessage(e){const t=n.default.__,s=e.get("origin_id");if(!s)throw new Error("Can't retract message without a XEP-0359 Origin ID");const r=e.get("editable"),o=(0,f.$msg)({id:(0,b.getUniqueId)(),to:this.get("jid"),type:"groupchat"}).c("store",{xmlns:f.Strophe.NS.HINTS}).up().c("apply-to",{id:s,xmlns:f.Strophe.NS.FASTEN}).c("retract",{xmlns:f.Strophe.NS.RETRACT});e.set({retracted:(new Date).toISOString(),retracted_id:s,retraction_id:o.tree().getAttribute("id"),editable:!1});const a=await this.sendTimedMessage(o);S.isErrorStanza(a)?i.default.error(a):a instanceof m.TimeoutError&&(i.default.error(a),e.save({editable:r,error_type:"timeout",error:t("A timeout happened while while trying to retract your message."),retracted:void 0,retracted_id:void 0,retraction_id:void 0}))},async retractOtherMessage(e,t){const s=e.get("editable");e.save({moderated:"retracted",moderated_by:n.default.bare_jid,moderated_id:e.get("msgid"),moderation_reason:t,editable:!1});const r=await this.sendRetractionIQ(e,t);return(null===r||S.isErrorStanza(r))&&e.save({editable:s,moderated:void 0,moderated_by:void 0,moderated_id:void 0,moderation_reason:void 0}),r},sendRetractionIQ(e,t){const s=(0,f.$iq)({to:this.get("jid"),type:"set"}).c("apply-to",{id:e.get(`stanza_id ${this.get("jid")}`),xmlns:f.Strophe.NS.FASTEN}).c("moderate",{xmlns:f.Strophe.NS.MODERATE}).c("retract",{xmlns:f.Strophe.NS.RETRACT}).up().c("reason").t(t||"");return r.default.sendIQ(s,null,!1)},sendDestroyIQ(e,t){const s=(0,f.$build)("destroy");t&&s.attrs({jid:t});const n=(0,f.$iq)({to:this.get("jid"),type:"set"}).c("query",{xmlns:f.Strophe.NS.MUC_OWNER}).cnode(s.node);return e&&e.length>0&&n.c("reason",e),r.default.sendIQ(n)},async leave(e){r.default.connection.connected()&&r.default.user.presence.send("unavailable",this.getRoomJIDAndNick(),e),this.features&&await new Promise((e=>this.features.destroy({success:e,error:(t,s)=>{i.default.error(s),e()}})));const t=n.default.disco_entities?.get(this.get("jid"));t&&await new Promise((e=>t.destroy({success:e,error:(t,s)=>{i.default.error(s),e()}}))),(0,b.safeSave)(this.session,{connection_status:h.ROOMSTATUS.DISCONNECTED})},async close(e){const{ENTERED:t,CLOSING:s}=h.ROOMSTATUS,o=this.session.get("connection_status")===t;return(0,b.safeSave)(this.session,{connection_status:s}),o&&this.sendMarkerForLastMessage("received",!0),await this.unregisterNickname(),await this.leave(),this.occupants.clearStore(),"closeAllChatBoxes"!==e?.name&&r.default.settings.get("muc_clear_messages_on_leave")&&this.clearMessages(),await new Promise((e=>this.session.destroy({success:e,error:(t,s)=>{i.default.error(s),e()}}))),n.default.ChatBox.prototype.close.call(this)},canModerateMessages(){const e=this.getOwnOccupant();return e&&e.isModerator()&&r.default.disco.supports(f.Strophe.NS.MODERATE,this.get("jid"))},getAllKnownNicknames(){return[...new Set([...this.occupants.map((e=>e.get("nick"))),...this.messages.map((e=>e.get("nick")))])].filter((e=>e))},getAllKnownNicknamesRegex(){const e=this.getAllKnownNicknames().map((e=>a.default.escapeRegexString(e))).join("|");return RegExp(`(?:\\p{P}|\\p{Z}|^)@(${e})(?![\\w@-])`,"uig")},getOccupantByJID(e){return this.occupants.findOccupant({jid:e})},getOccupantByNickname(e){return this.occupants.findOccupant({nick:e})},getReferenceURIFromNickname(e){const t=this.get("jid"),s=this.getOccupant(e),n=this.features.get("nonanonymous")&&s?.get("jid")||`${t}/${e}`;return encodeURI(`xmpp:${n}`)},parseTextForReferences(e){if(!e||!/(\p{P}|\p{Z}|^)([@][\w_-]+(?:\.\w+)*)/giu.test(e))return[e,[]];const t=a.default.findFirstMatchInArray(this.getAllKnownNicknames()),s=this.getAllKnownNicknamesRegex(),n=[...e.matchAll(s)].filter((e=>!e[0].startsWith("/"))).map((e=>{let s=e[0].indexOf("@");"@"===e[0][s+1]&&(s+=1);const n=e.index+s,r=n+e[0].length-s,o=t(e[1]);return{begin:n,end:r,value:o,type:"mention",uri:this.getReferenceURIFromNickname(o)}})),[r,o]=a.default.reduceTextFromReferences(e,n);return[r,o]},async getOutgoingMessageAttributes(e){await r.default.emojis.initialize();const t=this.get("composing_spoiler");let s,n="";e?.body&&([n,s]=this.parseTextForReferences(e.body));const o=(0,b.getUniqueId)(),i=n?S.shortnamesToUnicode(n):void 0;return e=Object.assign({},e,{body:i,is_spoiler:t,origin_id:o,references:s,id:o,msgid:o,from:`${this.get("jid")}/${this.get("nick")}`,fullname:this.get("nick"),is_only_emojis:!!n&&S.isOnlyEmojis(n),message:i,nick:this.get("nick"),sender:"me",type:"groupchat"},(0,y.getMediaURLsMetadata)(n)),e=await r.default.hook("getOutgoingMessageAttributes",this,e)},getRoomJIDAndNick(){const e=this.get("nick");return f.Strophe.getBareJidFromJid(this.get("jid"))+(null!==e?`/${e}`:"")},sendChatState(){if(!r.default.settings.get("send_chat_state_notifications")||!this.get("chat_state")||!this.isEntered()||this.features.get("moderated")&&"visitor"===this.getOwnRole())return;const e=r.default.settings.get("send_chat_state_notifications");if(Array.isArray(e)&&!e.includes(this.get("chat_state")))return;const t=this.get("chat_state");t!==n.default.GONE&&r.default.send((0,f.$msg)({to:this.get("jid"),type:"groupchat"}).c(t,{xmlns:f.Strophe.NS.CHATSTATES}).up().c("no-store",{xmlns:f.Strophe.NS.HINTS}).up().c("no-permanent-store",{xmlns:f.Strophe.NS.HINTS}))},directInvite(e,t){this.features.get("membersonly")&&this.updateMemberLists([{jid:e,affiliation:"member",reason:t}]);const s={xmlns:"jabber:x:conference",jid:this.get("jid")};null!==t&&(s.reason=t),this.get("password")&&(s.password=this.get("password"));const o=(0,f.$msg)({from:n.default.connection.jid,to:e,id:(0,b.getUniqueId)()}).c("x",s);r.default.send(o),r.default.trigger("roomInviteSent",{room:this,recipient:e,reason:t})},refreshDiscoInfo(){return r.default.disco.refresh(this.get("jid")).then((()=>this.getDiscoInfo())).catch((e=>i.default.error(e)))},getDiscoInfo(){return r.default.disco.getIdentity("conference","text",this.get("jid")).then((e=>this.save({name:e?.get("name")}))).then((()=>this.getDiscoInfoFields())).then((()=>this.getDiscoInfoFeatures())).catch((e=>i.default.error(e)))},async getDiscoInfoFields(){const e=(await r.default.disco.getFields(this.get("jid"))).reduce(((e,t)=>{const s=t.get("var");return s?.startsWith("muc#roominfo_")&&(e[s.replace("muc#roominfo_","")]=t.get("value")),e}),{});this.config.save(e)},async getDiscoInfoFeatures(){const e=await r.default.disco.getFeatures(this.get("jid")),t=r.converse.ROOM_FEATURES.reduce(((e,t)=>(e[t]=!1,e)),{fetched:(new Date).toISOString()});e.each((e=>{const s=e.get("var");s.startsWith("muc_")?t[s.replace("muc_","")]=!0:s===f.Strophe.NS.MAM?t.mam_enabled=!0:t[s]=!0})),this.features.save(t)},addFieldValue(e){const t=e.getAttribute("type");if("fixed"===t)return e;const s=e.getAttribute("var").replace("muc#roomconfig_",""),n=this.get("roomconfig");if(s in n){let r;switch(t){case"boolean":r=[n[s]?1:0];break;case"list-multi":r=n[s];break;default:r=[n[s]]}e.innerHTML=r.map((e=>(0,f.$build)("value").t(e))).join("")}return e},async autoConfigureChatRoom(){const e=await this.fetchRoomConfiguration(),t=d()("field",e).map((e=>this.addFieldValue(e)));if(t.length)return this.sendConfiguration(t)},fetchRoomConfiguration(){return r.default.sendIQ((0,f.$iq)({to:this.get("jid"),type:"get"}).c("query",{xmlns:f.Strophe.NS.MUC_OWNER}))},sendConfiguration(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=(0,f.$iq)({to:this.get("jid"),type:"set"}).c("query",{xmlns:f.Strophe.NS.MUC_OWNER}).c("x",{xmlns:f.Strophe.NS.XFORM,type:"submit"});return e.forEach((e=>t.cnode(e).up())),r.default.sendIQ(t)},onCommandError(e){const{__:t}=n.default;i.default.fatal(e);const s=t("Sorry, an error happened while running the command.")+" "+t("Check your browser's developer console for details.");this.createMessage({message:s,type:"error"})},getNickOrJIDFromCommandArgs(e){const{__:t}=n.default;if(S.isValidJID(e.trim()))return e.trim();e.startsWith("@")||(e="@"+e);const[s,r]=this.parseTextForReferences(e);if(!r.length){const e=t("Error: couldn't find a groupchat participant based on your arguments");return void this.createMessage({message:e,type:"error"})}if(r.length>1){const e=t("Error: found multiple groupchat participant based on your arguments");return void this.createMessage({message:e,type:"error"})}const o=r.pop().value,i=e.split(o,2)[1];if(!i||i.startsWith(" "))return o;{const e=t("Error: couldn't find a groupchat participant based on your arguments");this.createMessage({message:e,type:"error"})}},validateRoleOrAffiliationChangeArgs(e,t){const{__:s}=n.default;if(!t){const t=s('Error: the "%1$s" command takes two arguments, the user\'s nickname and optionally a reason.',e);return this.createMessage({message:t,type:"error"}),!1}return!0},getAllowedCommands(){let e=["clear","help","me","nick","register"];(this.config.get("changesubject")||["owner","admin"].includes(this.getOwnAffiliation()))&&(e=[...e,"subject","topic"]);const t=this.occupants.findWhere({jid:n.default.bare_jid});return this.verifyAffiliations(["owner"],t,!1)?e=e.concat(x).concat(E):this.verifyAffiliations(["admin"],t,!1)&&(e=e.concat(E)),this.verifyRoles(["moderator"],t,!1)?e=e.concat(A).concat(C):this.verifyRoles(["visitor","participant","moderator"],t,!1)||(e=e.concat(C)),e.sort(),Array.isArray(r.default.settings.get("muc_disable_slash_commands"))?e.filter((e=>!r.default.settings.get("muc_disable_slash_commands").includes(e))):e},verifyAffiliations(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{__:r}=n.default;if(!Array.isArray(e))throw new TypeError("affiliations must be an Array");if(!e.length)return!0;if(t=t||this.occupants.findWhere({jid:n.default.bare_jid})){const s=t.get("affiliation");if(e.includes(s))return!0}if(s){const e=r("Forbidden: you do not have the necessary affiliation in order to do that.");this.createMessage({message:e,type:"error"})}return!1},verifyRoles(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{__:r}=n.default;if(!Array.isArray(e))throw new TypeError("roles must be an Array");if(!e.length)return!0;if(t=t||this.occupants.findWhere({jid:n.default.bare_jid})){const s=t.get("role");if(e.includes(s))return!0}if(s){const e=r("Forbidden: you do not have the necessary role in order to do that.");this.createMessage({message:e,type:"error",is_ephemeral:2e4})}return!1},getOwnRole(){return this.getOwnOccupant()?.attributes?.role},getOwnAffiliation(){return this.getOwnOccupant()?.attributes?.affiliation||"none"},getOwnOccupant(){return this.occupants.getOwnOccupant()},async setNickname(e){if(r.default.settings.get("auto_register_muc_nickname")&&await r.default.disco.supports(f.Strophe.NS.MUC_REGISTER,this.get("jid"))){const t=this.get("nick");this.set({nick:e});try{await this.registerNickname()}catch(e){const{__:s}=n.default;i.default.error(e);const r=s("Error: couldn't register new nickname in members only room");return this.createMessage({message:r,type:"error",is_ephemeral:!0}),void this.set({nick:t})}}const t=f.Strophe.getBareJidFromJid(this.get("jid"));r.default.send((0,f.$pres)({from:n.default.connection.jid,to:`${t}/${e}`,id:(0,b.getUniqueId)()}).tree())},setRole(e,t,s,n,o){const i=(0,f.$build)("item",{nick:e.get("nick"),role:t}),a=(0,f.$iq)({to:this.get("jid"),type:"set"}).c("query",{xmlns:f.Strophe.NS.MUC_ADMIN}).cnode(i.node);return null!==s&&a.c("reason",s),r.default.sendIQ(a).then(n).catch(o)},getOccupant(e){return S.isValidJID(e)?this.getOccupantByJID(e):this.getOccupantByNickname(e)},getOccupantsWithRole(e){return this.getOccupantsSortedBy("nick").filter((t=>t.get("role")===e)).map((e=>({jid:e.get("jid"),nick:e.get("nick"),role:e.get("role")})))},getOccupantsWithAffiliation(e){return this.getOccupantsSortedBy("nick").filter((t=>t.get("affiliation")===e)).map((e=>({jid:e.get("jid"),nick:e.get("nick"),affiliation:e.get("affiliation")})))},getOccupantsSortedBy(e){return Array.from(this.occupants.models).sort(((t,s)=>t.get(e)<s.get(e)?-1:t.get(e)>s.get(e)?1:0))},async updateMemberLists(e){const t=this.get("jid"),s=(await Promise.all(["member","admin","owner"].map((e=>(0,p.getAffiliationList)(e,t))))).reduce(((e,t)=>S.isErrorObject(t)?e:[...t,...e]),[]);await(0,p.setAffiliations)(t,(0,p.computeAffiliationsDelta)(!0,!1,e,s)),await this.occupants.fetchMembers()},async getAndPersistNickname(e){return(e=e||this.get("nick")||await this.getReservedNick()||n.default.getDefaultMUCNickname())&&(0,b.safeSave)(this,{nick:e},{silent:!0}),e},async getReservedNick(){const e=(0,f.$iq)({to:this.get("jid"),from:n.default.connection.jid,type:"get"}).c("query",{xmlns:f.Strophe.NS.DISCO_INFO,node:"x-roomuser-item"}),t=await r.default.sendIQ(e,null,!1);if(S.isErrorObject(t))throw t;const s=t?.querySelector('query[node="x-roomuser-item"] identity');return s?s.getAttribute("name"):null},async registerNickname(){const{__:e}=n.default,t=this.get("nick"),s=this.get("jid");let o,a;try{o=await r.default.sendIQ((0,f.$iq)({to:s,type:"get"}).c("query",{xmlns:f.Strophe.NS.MUC_REGISTER}))}catch(t){return d()(`not-allowed[xmlns="${f.Strophe.NS.STANZAS}"]`,t).length?a=e("You're not allowed to register yourself in this groupchat."):d()(`registration-required[xmlns="${f.Strophe.NS.STANZAS}"]`,t).length&&(a=e("You're not allowed to register in this groupchat because it's members-only.")),i.default.error(t),a}const l=d()("field required",o).map((e=>e.parentElement));if(l.length>1&&"muc#register_roomnick"!==l[0].getAttribute("var"))return i.default.error(`Can't register the user register in the groupchat ${s} due to the required fields`);try{await r.default.sendIQ((0,f.$iq)({to:s,type:"set"}).c("query",{xmlns:f.Strophe.NS.MUC_REGISTER}).c("x",{xmlns:f.Strophe.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up().c("field",{var:"muc#register_roomnick"}).c("value").t(t))}catch(t){return d()(`service-unavailable[xmlns="${f.Strophe.NS.STANZAS}"]`,t).length?a=e("Can't register your nickname in this groupchat, it doesn't support registration."):d()(`bad-request[xmlns="${f.Strophe.NS.STANZAS}"]`,t).length&&(a=e("Can't register your nickname in this groupchat, invalid data form supplied.")),i.default.error(a),i.default.error(t),a}},async unregisterNickname(){if("unregister"===r.default.settings.get("auto_register_muc_nickname"))try{await r.default.disco.supports(f.Strophe.NS.MUC_REGISTER,this.get("jid"))&&await this.sendUnregistrationIQ()}catch(e){i.default.error(e)}},sendUnregistrationIQ(){const e=(0,f.$iq)({to:this.get("jid"),type:"set"}).c("query",{xmlns:f.Strophe.NS.MUC_REGISTER}).c("remove");return r.default.sendIQ(e).catch((e=>i.default.error(e)))},updateOccupantsOnPresence(e){const t=(0,j.parseMUCPresence)(e,this);if("error"===t.type||!t.jid&&!t.nick&&!t.occupant_id)return!0;const s=this.occupants.findOccupant(t);if("unavailable"===t.type&&s&&!t.states.includes(r.converse.MUC_NICK_CHANGED_CODE)&&!["admin","owner","member"].includes(t.affiliation))return s.set(t),void s.destroy();const n=t.jid||"",o={...t,jid:f.Strophe.getBareJidFromJid(n)||s?.attributes?.jid,resource:f.Strophe.getResourceFromJid(n)||s?.attributes?.resource};if(t.is_me){let e=!1;t.states.includes(r.converse.MUC_NICK_CHANGED_CODE)&&(e=!0,this.set("nick",t.nick)),this.features.get(f.Strophe.NS.OCCUPANTID)&&this.get("occupant-id")!==t.occupant_id&&(e=!0,this.set("occupant_id",t.occupant_id)),e&&this.save()}s?s.save(o):this.occupants.create(o)},fetchFeaturesIfConfigurationChanged(e){const t=["104","170","171","172","173","174"];d()("status",e).filter((e=>t.includes(e.getAttribute("status")))).length&&this.refreshDiscoInfo()},isSameUser(e,t){const s=f.Strophe.getBareJidFromJid(e),n=f.Strophe.getBareJidFromJid(t),r=f.Strophe.getResourceFromJid(e),o=f.Strophe.getResourceFromJid(t);if(S.isSameBareJID(e,t))return s!==this.get("jid")||r===o;return(s===this.get("jid")?this.occupants.findOccupant({nick:r}):this.occupants.findOccupant({jid:s}))===(n===this.get("jid")?this.occupants.findOccupant({nick:o}):this.occupants.findOccupant({jid:n}))},async isSubjectHidden(){return(await r.default.user.settings.get("mucs_with_hidden_subject",[])).includes(this.get("jid"))},async toggleSubjectHiddenState(){const e=this.get("jid"),t=await r.default.user.settings.get("mucs_with_hidden_subject",[]);t.includes(this.get("jid"))?r.default.user.settings.set("mucs_with_hidden_subject",t.filter((t=>t!==e))):r.default.user.settings.set("mucs_with_hidden_subject",[...t,e])},async handleSubjectChange(e){const t=n.default.__;if("string"==typeof e.subject&&!e.thread&&!e.message){const s=e.subject,n=e.nick;if((0,b.safeSave)(this,{subject:{author:n,text:e.subject||""}}),!e.is_delayed&&n){const r=t(s?"Topic set by %1$s":"Topic cleared by %1$s",n),o=this.messages.last();o?.get("nick")===e.nick&&"info"===o?.get("type")&&o?.get("message")===r||this.createMessage({message:r,nick:e.nick,type:"info",is_ephemeral:!0}),await this.isSubjectHidden()&&this.toggleSubjectHiddenState()}return!0}return!1},setSubject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r.default.send((0,f.$msg)({to:this.get("jid"),from:n.default.connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e).tree())},ignorableCSN(e){return e.chat_state&&!e.body&&(e.is_delayed||this.isOwnMessage(e))},isOwnMessage(e){let t;return t=e instanceof Element?e.getAttribute("from"):e instanceof n.default.Message?e.get("from"):e.from,f.Strophe.getResourceFromJid(t)==this.get("nick")},getUpdatedMessageAttributes(e,t){const s={...n.default.ChatBox.prototype.getUpdatedMessageAttributes.call(this,e,t),...(0,l.default)(t,["from_muc","occupant_id"])};if(this.isOwnMessage(t)){const n=Object.keys(t).filter((e=>e.startsWith("stanza_id")));Object.assign(s,(0,l.default)(t,n)),e.get("received")||(s.received=(new Date).toISOString())}return s},async isJoined(){return this.isEntered()?(r.default.connection.connected()||await new Promise((e=>r.default.listen.once("reconnected",e))),r.default.ping(`${this.get("jid")}/${this.get("nick")}`)):(i.default.info(`isJoined: not pinging MUC ${this.get("jid")} since we're not entered`),!1)},async sendStatusPresence(e,t,s){if(this.session.get("connection_status")===h.ROOMSTATUS.ENTERED){const o=await n.default.xmppstatus.constructPresence(e,this.getRoomJIDAndNick(),t);s?.map((e=>e?.tree()??e)).forEach((e=>o.cnode(e).up())),r.default.send(o)}},async rejoinIfNecessary(){return this.isRAICandidate()?(i.default.debug(`rejoinIfNecessary: not rejoining hidden MUC "${this.get("jid")}" since we're using RAI`),!0):await this.isJoined()?void 0:(this.rejoin(),!0)},async shouldShowErrorMessage(e){if("Decryption"===e.error_type){if("Message key not found. The counter was repeated or the key was not filled."===e.error_message)return!1;if("not-encrypted-for-this-device"===e.error_condition)return!1}else if("not-acceptable"===e.error_condition&&await this.rejoinIfNecessary())return!1;return n.default.ChatBox.prototype.shouldShowErrorMessage.call(this,e)},findDanglingModeration(e){if(!this.messages.length)return null;if(this.messages.last().get("time")>e.time){const t=Array.from(this.messages.models),s=e[`stanza_id ${this.get("jid")}`];return s?(t.reverse(),t.find((e=>{let{attributes:t}=e;return"retracted"===t.moderated&&t.moderated_id===s&&t.moderated_by}))):null}},async handleModeration(e){const t=["editable","moderated","moderated_by","moderated_id","moderation_reason"];if("retracted"===e.moderated){const s={};s[`stanza_id ${this.get("jid")}`]=e.moderated_id;const n=this.messages.findWhere(s);return n?(n.save((0,l.default)(e,t)),!0):(e.dangling_moderation=!0,await this.createMessage(e),!0)}{const s=this.findDanglingModeration(e);if(s){const n=(0,l.default)(s.attributes,t),r=Object.assign({dangling_moderation:!1},e,n);return delete r.id,s.save(r),!0}}return!1},getNotificationsText(){const{__:e}=n.default,t=this.notifications.toJSON(),s=r.default.settings.get("muc_show_info_messages").filter((e=>r.converse.MUC_ROLE_CHANGES_LIST.includes(e))),o=r.default.settings.get("muc_show_info_messages").filter((e=>r.converse.MUC_TRAFFIC_STATES_LIST.includes(e)));return[...r.converse.CHAT_STATES,...o,...s].reduce(((s,r)=>{const o=t[r];if(!o?.length)return s;const i=o.map((e=>this.getOccupant(e)?.getDisplayName()||e));if(1===i.length){if("composing"===r)return`${s}${e("%1$s is typing",i[0])}\n`;if("paused"===r)return`${s}${e("%1$s has stopped typing",i[0])}\n`;if(r===n.default.GONE)return`${s}${e("%1$s has gone away",i[0])}\n`;if("entered"===r)return`${s}${e("%1$s has entered the groupchat",i[0])}\n`;if("exited"===r)return`${s}${e("%1$s has left the groupchat",i[0])}\n`;if("op"===r)return`${s}${e("%1$s is now a moderator",i[0])}\n`;if("deop"===r)return`${s}${e("%1$s is no longer a moderator",i[0])}\n`;if("voice"===r)return`${s}${e("%1$s has been given a voice",i[0])}\n`;if("mute"===r)return`${s}${e("%1$s has been muted",i[0])}\n`}else if(i.length>1){let t;if(i.length>3)t=`${Array.from(i).slice(0,2).join(", ")} and others`;else{const s=i.pop();t=e("%1$s and %2$s",i.join(", "),s)}if("composing"===r)return`${s}${e("%1$s are typing",t)}\n`;if("paused"===r)return`${s}${e("%1$s have stopped typing",t)}\n`;if(r===n.default.GONE)return`${s}${e("%1$s have gone away",t)}\n`;if("entered"===r)return`${s}${e("%1$s have entered the groupchat",t)}\n`;if("exited"===r)return`${s}${e("%1$s have left the groupchat",t)}\n`;if("op"===r)return`${s}${e("%1$s are now moderators",i[0])}\n`;if("deop"===r)return`${s}${e("%1$s are no longer moderators",i[0])}\n`;if("voice"===r)return`${s}${e("%1$s have been given voices",i[0])}\n`;if("mute"===r)return`${s}${e("%1$s have been muted",i[0])}\n`}return s}),"")},removeNotification(e,t){const s=this.notifications.toJSON();(t=Array.isArray(t)?t:[t]).forEach((t=>{const n=Array.from(s[t]||[]);if(n.includes(e)){const s=n.indexOf(e);n.splice(s,1),this.notifications.set(t,Array.from(n))}}))},updateNotifications(e,t){const s=this.notifications.toJSON(),n=s[t]||[];if(n.includes(e))return;const o=(r,o)=>(r[o]=o===t?[...n,e]:(s[o]||[]).filter((t=>t!==e)),r),i=r.converse.CHAT_STATES.reduce(o,{}),a=r.converse.MUC_TRAFFIC_STATES_LIST.reduce(o,{}),l=r.converse.MUC_ROLE_CHANGES_LIST.reduce(o,{});this.notifications.set(Object.assign(i,a,l)),window.setTimeout((()=>this.removeNotification(e,t)),1e4)},handleMetadataFastening(e){if(e.ogp_for_id){if(e.from!==this.get("jid"))return!1;const t=this.messages.findWhere({origin_id:e.ogp_for_id});if(t){const s=t.get("ogp_metadata")||[];if(s.filter((t=>t["og:url"]===e["og:url"])).length)return!1;const n=[...s,(0,l.default)(e,T)];return t.save("ogp_metadata",n),!0}}return!1},handleMEPNotification(e){return!(e.from!==this.get("jid")||!e.activities)&&(e.activities?.forEach((t=>{const s=Object.assign(e,t);this.createMessage(s),r.default.trigger("message",{attrs:s,chatbox:this})})),!!e.activities.length)},getDuplicateMessage(e){return e.activities?.length?this.messages.findWhere({type:"mep",msgid:e.msgid}):n.default.ChatBox.prototype.getDuplicateMessage.call(this,e)},async onMessage(e){if(e=await e,S.isErrorObject(e))return e.stanza&&i.default.error(e.stanza),i.default.error(e.message);if("error"===e.type&&!await this.shouldShowErrorMessage(e))return;const t=this.getDuplicateMessage(e);if(t)"groupchat"===t.get("type")&&this.updateMessage(t,e);else if(!(e.receipt_id||e.is_marker||this.ignorableCSN(e)))if(this.handleMetadataFastening(e)||this.handleMEPNotification(e)||await this.handleRetraction(e)||await this.handleModeration(e)||await this.handleSubjectChange(e))e.nick&&this.removeNotification(e.nick,["composing","paused"]);else if(this.setEditable(e,e.time),e.chat_state&&this.updateNotifications(e.nick,e.chat_state),S.shouldCreateGroupchatMessage(e)){const t=await(0,_.handleCorrection)(this,e)||await this.createMessage(e);this.removeNotification(e.nick,["composing","paused"]),this.handleUnreadMessage(t)}},handleModifyError(e){const t=e.querySelector("error text")?.textContent;if(t)if(this.session.get("connection_status")===h.ROOMSTATUS.CONNECTING)this.setDisconnectionState(t);else{const e={type:"error",message:t,is_ephemeral:!0};this.createMessage(e)}},handleDisconnection(e){const t=null!==e.querySelector("status[code='110']"),s=d()(`x[xmlns="${f.Strophe.NS.MUC_USER}"]`,e).pop();if(!s)return;const r=Object.keys(n.default.muc.disconnect_messages),o=d()("status",s).map((e=>e.getAttribute("code"))).filter((e=>r.includes(e)));if(!(t&&o.length>0))return;const i=s.querySelector("item"),a=i?i.querySelector("reason")?.textContent:void 0,l=i?i.querySelector("actor")?.getAttribute("nick"):void 0,c=n.default.muc.disconnect_messages[o[0]],u=o.includes("301")?h.ROOMSTATUS.BANNED:h.ROOMSTATUS.DISCONNECTED;this.setDisconnectionState(c,a,l,u)},getActionInfoMessage(e,t,s){const r=n.default.__;return"301"===e?s?r("%1$s has been banned by %2$s",t,s):r("%1$s has been banned",t):"303"===e?r("%1$s's nickname has changed",t):"307"===e?s?r("%1$s has been kicked out by %2$s",t,s):r("%1$s has been kicked out",t):"321"===e?r("%1$s has been removed because of an affiliation change",t):"322"===e?r("%1$s has been removed for not being a member",t):void 0},createAffiliationChangeMessage(e){const t=n.default.__,s=e._previousAttributes.affiliation;if(!s)return;const o=e.get("affiliation");"admin"===s&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.EXADMIN)?this.createMessage({type:"info",message:t("%1$s is no longer an admin of this groupchat",e.get("nick"))}):"owner"===s&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.EXOWNER)?this.createMessage({type:"info",message:t("%1$s is no longer an owner of this groupchat",e.get("nick"))}):"outcast"===s&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.EXOUTCAST)&&this.createMessage({type:"info",message:t("%1$s is no longer banned from this groupchat",e.get("nick"))}),"none"===o&&"member"===s&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.EXMEMBER)&&this.createMessage({type:"info",message:t("%1$s is no longer a member of this groupchat",e.get("nick"))}),"member"===o&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.MEMBER)?this.createMessage({type:"info",message:t("%1$s is now a member of this groupchat",e.get("nick"))}):("admin"===o&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.ADMIN)||"owner"==o&&n.default.isInfoVisible(r.converse.AFFILIATION_CHANGES.OWNER))&&this.createMessage({type:"info",message:t("%1$s is now an %2$s of this groupchat",e.get("nick"),o)})},createRoleChangeMessage(e,t){if("none"===t||e.changed.affiliation)return;const s=e._previousAttributes.role;"moderator"===s&&n.default.isInfoVisible(r.converse.MUC_ROLE_CHANGES.DEOP)?this.updateNotifications(e.get("nick"),r.converse.MUC_ROLE_CHANGES.DEOP):"visitor"===s&&n.default.isInfoVisible(r.converse.MUC_ROLE_CHANGES.VOICE)&&this.updateNotifications(e.get("nick"),r.converse.MUC_ROLE_CHANGES.VOICE),"visitor"===e.get("role")&&n.default.isInfoVisible(r.converse.MUC_ROLE_CHANGES.MUTE)?this.updateNotifications(e.get("nick"),r.converse.MUC_ROLE_CHANGES.MUTE):"moderator"===e.get("role")&&!["owner","admin"].includes(e.get("affiliation"))&&n.default.isInfoVisible(r.converse.MUC_ROLE_CHANGES.OP)&&this.updateNotifications(e.get("nick"),r.converse.MUC_ROLE_CHANGES.OP)},createInfoMessage(e,t,s){const r=n.default.__,o={type:"info",is_ephemeral:!0};if(n.default.isInfoVisible(e)&&"110"!==e&&("100"!==e||s)){if(e in n.default.muc.info_messages)o.message=n.default.muc.info_messages[e];else if(!s&&I.includes(e)){const s=f.Strophe.getResourceFromJid(t.getAttribute("from")),n=d()(`x[xmlns="${f.Strophe.NS.MUC_USER}"] item`,t).pop();o.actor=n?n.querySelector("actor")?.getAttribute("nick"):void 0,o.reason=n?n.querySelector("reason")?.textContent:void 0,o.message=this.getActionInfoMessage(e,s,o.actor)}else if(s&&e in n.default.muc.new_nickname_messages){let s;"210"===e?s=f.Strophe.getResourceFromJid(t.getAttribute("from")):"303"===e&&(s=d()(`x[xmlns="${f.Strophe.NS.MUC_USER}"] item`,t).pop().getAttribute("nick")),this.save("nick",s),o.message=r(n.default.muc.new_nickname_messages[e],s)}if(o.message){if("201"===e&&this.messages.findWhere(o))return;this.createMessage(o)}}},createInfoMessages(e){const t=d()(`x[xmlns="${f.Strophe.NS.MUC_USER}"] status`,e).map((e=>e.getAttribute("code")));t.includes("333")&&t.includes("307")&&t.splice(t.indexOf("307"),1);const s=t.includes("110");t.forEach((t=>this.createInfoMessage(t,e,s)))},setDisconnectionState(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.ROOMSTATUS.DISCONNECTED;this.session.save({connection_status:n,disconnection_actor:s,disconnection_message:e,disconnection_reason:t})},onNicknameClash(e){const t=n.default.__;if(r.default.settings.get("muc_nickname_from_jid")){const t=e.getAttribute("from").split("/")[1];if(t===n.default.getDefaultMUCNickname())this.join(t+"-2");else{const e=t.lastIndexOf("-"),s=t.substring(e+1,t.length);this.join(t.substring(0,e+1)+String(Number(s)+1))}}else this.save({nickname_validation_message:t("The nickname you chose is reserved or currently in use, please choose a different one.")}),this.session.save({connection_status:h.ROOMSTATUS.NICKNAME_REQUIRED})},onErrorPresence(e){const t=n.default.__,s=e.querySelector("error"),r=s.getAttribute("type"),o=d()(`text[xmlns="${f.Strophe.NS.STANZAS}"]`,s).pop()?.textContent;if("modify"===r)this.handleModifyError(e);else if("auth"===r)if(d()(`not-authorized[xmlns="${f.Strophe.NS.STANZAS}"]`,s).length&&(this.save({password_validation_message:o||t("Password incorrect")}),this.session.save({connection_status:h.ROOMSTATUS.PASSWORD_REQUIRED})),s.querySelector("registration-required")){const e=t("You are not on the member list of this groupchat.");this.setDisconnectionState(e,o)}else s.querySelector("forbidden")&&this.setDisconnectionState(n.default.muc.disconnect_messages[301],o,null,h.ROOMSTATUS.BANNED);else if("cancel"===r)if(s.querySelector("not-allowed")){const e=t("You are not allowed to create new groupchats.");this.setDisconnectionState(e,o)}else if(s.querySelector("not-acceptable")){const e=t("Your nickname doesn't conform to this groupchat's policies.");this.setDisconnectionState(e,o)}else if(d()(`gone[xmlns="${f.Strophe.NS.STANZAS}"]`,s).length){const e=d()(`gone[xmlns="${f.Strophe.NS.STANZAS}"]`,s).pop()?.textContent.replace(/^xmpp:/,"").replace(/\?join$/,"");this.save({moved_jid:e,destroyed_reason:o}),this.session.save({connection_status:h.ROOMSTATUS.DESTROYED})}else if(s.querySelector("conflict"))this.onNicknameClash(e);else if(s.querySelector("item-not-found")){const e=t("This groupchat does not (yet) exist.");this.setDisconnectionState(e,o)}else if(s.querySelector("service-unavailable")){const e=t("This groupchat has reached its maximum number of participants.");this.setDisconnectionState(e,o)}else if(s.querySelector("remote-server-not-found")){const e=t("Remote server not found");this.setDisconnectionState(e,o)}else if(s.querySelector("forbidden")){const e=t("You're not allowed to enter this groupchat");this.setDisconnectionState(e,o)}else{const e=t("An error happened while trying to enter this groupchat");this.setDisconnectionState(e,o)}},onPresenceFromMUCHost(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error");"wait"===t?.getAttribute("type")&&t?.querySelector("resource-constraint")&&this.session.get("connection_status")===h.ROOMSTATUS.DISCONNECTED&&this.rejoin()}},onPresence(e){if("error"===e.getAttribute("type"))return this.onErrorPresence(e);this.createInfoMessages(e),e.querySelector("status[code='110']")?(this.onOwnPresence(e),"none"!==this.getOwnRole()&&this.session.get("connection_status")===h.ROOMSTATUS.CONNECTING&&this.session.save("connection_status",h.ROOMSTATUS.CONNECTED)):this.updateOccupantsOnPresence(e)},async onOwnPresence(e){if(await this.occupants.fetched,"unavailable"===e.getAttribute("type"))return void this.handleDisconnection(e);const t=this.session.get("connection_status");t!==h.ROOMSTATUS.ENTERED&&t!==h.ROOMSTATUS.CLOSING?(this.session.save("connection_status",h.ROOMSTATUS.ENTERED,{silent:!0}),this.updateOccupantsOnPresence(e),this.session.trigger("change:connection_status",this.session,t)):this.updateOccupantsOnPresence(e);e.querySelector("status[code='201']")&&(this.get("auto_configure")?await this.autoConfigureChatRoom().then((()=>this.refreshDiscoInfo())):r.default.settings.get("muc_instant_rooms")?await this.sendConfiguration().then((()=>this.refreshDiscoInfo())):this.session.save({view:r.converse.MUC.VIEWS.CONFIG}))},isUserMentioned(e){const t=this.get("nick");if(e.get("references").length){return e.get("references").filter((e=>"mention"===e.type)).map((e=>e.value)).includes(t)}return new RegExp(`\\b${t}\\b`).test(e.get("body"))},incrementUnreadMsgsCounter(e){const t={num_unread_general:this.get("num_unread_general")+1};0===this.get("num_unread_general")&&(t.first_unread_id=e.get("id")),this.isUserMentioned(e)&&(t.num_unread=this.get("num_unread")+1),this.save(t)},clearUnreadMsgCounter(){(this.get("num_unread_general")>0||this.get("num_unread")>0||this.get("has_activity"))&&this.sendMarkerForMessage(this.messages.last()),(0,b.safeSave)(this,{has_activity:!1,num_unread:0,num_unread_general:0})}}},"./src/headless/plugins/muc/occupant.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/@converse/skeletor/src/model.js");class r extends n.Model{defaults(){return{hats:[],show:"offline",states:[]}}save(e,t,s){let n;return null==e?super.save(e,t,s):("object"==typeof e?(n=e,s=t):(n={})[e]=t,n.occupant_id&&(n.id=n.occupant_id),super.save(n,s))}getDisplayName(){return this.get("nick")||this.get("jid")}isMember(){return["admin","owner","member"].includes(this.get("affiliation"))}isModerator(){return["admin","owner"].includes(this.get("affiliation"))||"moderator"===this.get("role")}isSelf(){return this.get("states").includes("110")}}const o=r},"./src/headless/plugins/muc/occupants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s("./src/headless/plugins/muc/occupant.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./node_modules/@converse/skeletor/src/collection.js"),a=s("./src/headless/plugins/muc/constants.js"),l=s("./node_modules/@converse/skeletor/src/model.js"),c=s("./node_modules/strophe.js/src/index.js"),d=s("./src/headless/plugins/muc/affiliations/utils.js"),u=s("./src/headless/plugins/muc/utils.js"),h=s("./src/headless/utils/core.js");const{u:f}=o.converse.env;class m extends i.Collection{model=n.default;comparator(e,t){const s=e.get("role")||"none",n=t.get("role")||"none";if(a.MUC_ROLE_WEIGHTS[s]===a.MUC_ROLE_WEIGHTS[n]){const s=e.getDisplayName().toLowerCase(),n=t.getDisplayName().toLowerCase();return s<n?-1:s>n?1:0}return a.MUC_ROLE_WEIGHTS[s]<a.MUC_ROLE_WEIGHTS[n]?-1:1}create(e,t){return e.id||e instanceof l.Model||(e.id=e.occupant_id||(0,h.getUniqueId)()),super.create(e,t)}async fetchMembers(){if(!["member","admin","owner"].includes(this.getOwnOccupant()?.get("affiliation")))return;const e=(0,u.getAutoFetchedAffiliationLists)();if(0===e.length)return;const t=this.chatroom.get("jid"),s=await Promise.all(e.map((e=>(0,d.getAffiliationList)(e,t)))),n=s.reduce(((e,t)=>f.isErrorObject(t)?e:[...t,...e]),[]),i=e.filter((t=>!f.isErrorObject(s[e.indexOf(t)]))),a=n.map((e=>e.jid)).filter((e=>void 0!==e)),l=n.map((e=>!e.jid&&e.nick||void 0)).filter((e=>void 0!==e));this.filter((e=>i.includes(e.get("affiliation"))&&!l.includes(e.get("nick"))&&!a.includes(e.get("jid")))).forEach((e=>{e.get("jid")!==r.default.bare_jid&&("offline"===e.get("show")?e.destroy():e.save("affiliation",null))})),n.forEach((e=>{const t=this.findOccupant(e);t?t.save(e):this.create(e)})),o.default.trigger("membersFetched")}findOccupant(e){if(e.occupant_id)return this.get(e.occupant_id);const t=e.jid&&c.Strophe.getBareJidFromJid(e.jid);return t&&this.findWhere({jid:t})||e.nick&&this.findWhere({nick:e.nick})}getOwnOccupant(){return this.findOccupant({jid:r.default.bare_jid,occupant_id:this.chatroom.get("occupant_id")})}}const p=m},"./src/headless/plugins/muc/parsers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getMEPActivities:()=>h,parseMUCMessage:()=>p,parseMUCPresence:()=>_,parseMemberListIQ:()=>g});var n=s("./node_modules/dayjs/dayjs.min.js"),r=s.n(n),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/shared/api/index.js"),a=s("./src/headless/shared/parsers.js");const{Strophe:l,sizzle:c,u:d}=i.converse.env,{NS:u}=l;function h(e){const t=c(`items[node="${l.NS.CONFINFO}"]`,e).pop();if(!t)return null;const s=e.getAttribute("from"),n=e.getAttribute("id"),r=`item conference-info[xmlns="${l.NS.CONFINFO}"] activity[xmlns="${l.NS.ACTIVITY}"]`;return c(r,t).map((t=>{const r=t.querySelector("text")?.textContent;if(r){const o=(0,a.getReferences)(e),i=t.querySelector("reason")?.textContent;return{from:s,msgid:n,message:r,reason:i,references:o,type:"mep"}}return{}}))}function f(e,t){if(t.features.get(l.NS.OCCUPANTID))return c(`occupant-id[xmlns="${l.NS.OCCUPANTID}"]`,e).pop()?.getAttribute("id")}function m(e,t){let s;const n=t.get("occupant_id");return s=n?e.occupant_id===n:e.from_real_jid?l.getBareJidFromJid(e.from_real_jid)===o.default.bare_jid:e.nick===t.get("nick"),s?"me":"them"}async function p(e,t){(0,a.throwErrorIfInvalidForward)(e);const s=`[xmlns="${u.MAM}"] > forwarded[xmlns="${u.FORWARD}"] > message`,n=e;if(e=c(s,e).pop()||e,c(`message > forwarded[xmlns="${l.NS.FORWARD}"]`,e).length)return new a.StanzaParseError(`Invalid Stanza: Forged MAM groupchat message from ${e.getAttribute("from")}`,e);const p=c(`delay[xmlns="${l.NS.DELAY}"]`,n).pop(),g=e.getAttribute("from"),_=(0,a.getChatMarker)(e);let v=Object.assign({from:g,activities:h(e),body:e.querySelector(":scope > body")?.textContent?.trim(),chat_state:(0,a.getChatState)(e),from_muc:l.getBareJidFromJid(g),is_archived:(0,a.isArchived)(n),is_carbon:(0,a.isCarbon)(n),is_delayed:!!p,is_forwarded:!!e.querySelector("forwarded"),is_headline:(0,a.isHeadline)(e),is_markable:!!c(`markable[xmlns="${l.NS.MARKERS}"]`,e).length,is_marker:!!_,is_unstyled:!!c(`unstyled[xmlns="${l.NS.STYLING}"]`,e).length,marker_id:_&&_.getAttribute("id"),msgid:e.getAttribute("id")||n.getAttribute("id"),nick:l.unescapeNode(l.getResourceFromJid(g)),occupant_id:f(e,t),receipt_id:(0,a.getReceiptId)(e),received:(new Date).toISOString(),references:(0,a.getReferences)(e),subject:e.querySelector("subject")?.textContent,thread:e.querySelector("thread")?.textContent,time:p?r()(p.getAttribute("stamp")).toISOString():(new Date).toISOString(),to:e.getAttribute("to"),type:e.getAttribute("type")},(0,a.getErrorAttributes)(e),(0,a.getOutOfBandAttributes)(e),(0,a.getSpoilerAttributes)(e),(0,a.getCorrectionAttributes)(e,n),(0,a.getStanzaIDs)(e,n),(0,a.getOpenGraphMetadata)(e),(0,a.getRetractionAttributes)(e,n),function(e){const t=c(`apply-to[xmlns="${l.NS.FASTEN}"]`,e).pop();if(t){const e=t.getAttribute("id"),s=c(`moderated[xmlns="${l.NS.MODERATE}"]`,t).pop();if(s&&c(`retract[xmlns="${l.NS.RETRACT}"]`,s).pop())return{editable:!1,moderated:"retracted",moderated_by:s.getAttribute("by"),moderated_id:e,moderation_reason:s.querySelector("reason")?.textContent}}else{const t=c(`> moderated[xmlns="${l.NS.MODERATE}"]`,e).pop();if(t&&c(`retracted[xmlns="${l.NS.RETRACT}"]`,t).pop())return{editable:!1,is_tombstone:!0,moderated_by:t.getAttribute("by"),retracted:t.getAttribute("stamp"),moderation_reason:t.querySelector("reason")?.textContent}}return{}}(e),(0,a.getEncryptionAttributes)(e,o.default));return await i.default.emojis.initialize(),v.from_real_jid=v.is_archived&&function(e){const t=c(`x[xmlns="${l.NS.MUC_USER}"] item`,e).pop();return t?.getAttribute("jid")}(e)||t.occupants.findOccupant(v)?.get("jid"),v=Object.assign({is_only_emojis:!!v.body&&d.isOnlyEmojis(v.body),is_valid_receipt_request:(0,a.isValidReceiptRequest)(e,v),message:v.body||v.error,sender:m(v,t)},v),v.is_archived&&n.getAttribute("from")!==v.from_muc?new a.StanzaParseError(`Invalid Stanza: Forged MAM message from ${n.getAttribute("from")}`,e):v.is_archived&&n.getAttribute("from")!==t.get("jid")?new a.StanzaParseError(`Invalid Stanza: Forged MAM groupchat message from ${e.getAttribute("from")}`,e):v.is_carbon?new a.StanzaParseError("Invalid Stanza: MUC messages SHOULD NOT be XEP-0280 carbon copied",e):(v.id=v.origin_id||v[`stanza_id ${v.from_muc||v.from}`]||d.getUniqueId(),v=await i.default.hook("parseMUCMessage",e,v),Object.assign(v,(0,a.getMediaURLsMetadata)(v.is_encrypted?v.plaintext:v.body)))}function g(e){return c(`query[xmlns="${l.NS.MUC_ADMIN}"] item`,e).map((e=>{const t={affiliation:e.getAttribute("affiliation")},s=e.getAttribute("jid");d.isValidJID(s)?t.jid=s:t.nick=s;const n=e.getAttribute("nick");n&&(t.nick=n);return e.getAttribute("role")&&(t.role=n),t}))}function _(e,t){const s=e.getAttribute("from"),n=e.getAttribute("type"),r={is_me:!!e.querySelector("status[code='110']"),from:s,occupant_id:f(e,t),nick:l.getResourceFromJid(s),type:n,states:[],hats:[],show:"unavailable"!==n?"online":"offline"};return Array.from(e.children).forEach((e=>{e.matches("status")?r.status=e.textContent||null:e.matches("show")?r.show=e.textContent||"online":e.matches("x")&&e.getAttribute("xmlns")===l.NS.MUC_USER?Array.from(e.children).forEach((e=>{"item"===e.nodeName?(r.affiliation=e.getAttribute("affiliation"),r.role=e.getAttribute("role"),r.jid=e.getAttribute("jid"),r.nick=e.getAttribute("nick")||r.nick):"status"==e.nodeName&&e.getAttribute("code")&&r.states.push(e.getAttribute("code"))})):e.matches("x")&&e.getAttribute("xmlns")===l.NS.VCARDUPDATE?r.image_hash=e.querySelector("photo")?.textContent:e.matches("hats")&&e.getAttribute("xmlns")===l.NS.MUC_HATS&&(r.hats=Array.from(e.children).map((e=>e.matches("hat")&&{title:e.getAttribute("title"),uri:e.getAttribute("uri")})))})),r}},"./src/headless/plugins/muc/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{autoJoinRooms:()=>j,disconnectChatRooms:()=>m,getAssignableRoles:()=>h,getAutoFetchedAffiliationLists:()=>u,getDefaultMUCNickname:()=>y,isInfoVisible:()=>b,onAddClientFeatures:()=>w,onBeforeResourceBinding:()=>E,onBeforeTearDown:()=>S,onDirectMUCInvitation:()=>v,onStatusInitialized:()=>x,onWindowStateChanged:()=>p,openChatRoom:()=>_,registerDirectInvitationHandler:()=>f,routeToRoom:()=>g});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./src/headless/plugins/muc/constants.js"),a=s("./src/headless/utils/core.js");const{Strophe:l,sizzle:c,u:d}=r.converse.env;function u(){const e=r.default.settings.get("muc_fetch_members");return Array.isArray(e)?e:e?["member","admin","owner"]:[]}function h(e){let t=r.default.settings.get("modtools_disable_assign");return Array.isArray(t)||(t=t?i.ROLES:[]),"moderator"===e.get("role")?i.ROLES.filter((e=>!t.includes(e))):[]}function f(){n.default.connection.addHandler((e=>(n.default.onDirectMUCInvitation(e),!0)),"jabber:x:conference","message")}function m(){return n.default.chatboxes.filter((e=>e.get("type")===n.default.CHATROOMS_TYPE)).forEach((e=>e.session.save({connection_status:r.converse.ROOMSTATUS.DISCONNECTED})))}async function p(e){if("visible"===e.state&&r.default.connection.connected()){(await r.default.rooms.get()).forEach((e=>e.rejoinIfNecessary()))}}async function g(e){if(!d.isValidMUCJID(e))return o.default.warn(`invalid jid "${e}" provided in url fragment`);await r.default.waitUntil("roomsAutoJoined"),r.default.settings.get("allow_bookmarks")&&await r.default.waitUntil("bookmarksInitialized"),r.default.rooms.open(e)}async function _(e,t){t.type=n.default.CHATROOMS_TYPE,t.id=e;const s=await r.default.rooms.get(e,t,!0);return s.maybeShow(!0),s}async function v(e){const t=c('x[xmlns="jabber:x:conference"]',e).pop(),s=l.getBareJidFromJid(e.getAttribute("from")),o=t.getAttribute("jid"),i=t.getAttribute("reason");let a;if(r.default.settings.get("auto_join_on_invite"))a=!0;else{const e=n.default.roster.get(s)?.getDisplayName()??s;a=await r.default.hook("confirmDirectMUCInvitation",{contact:e,reason:i,jid:o},!1)}if(a){(await _(o,{password:t.getAttribute("password")})).session.get("connection_status")===r.converse.ROOMSTATUS.DISCONNECTED&&n.default.chatboxes.get(o).rejoin()}}function y(){if(!n.default.xmppstatus)throw new Error("Can't call _converse.getDefaultMUCNickname before the statusInitialized has been fired.");const e=n.default.xmppstatus.getNickname();return e||(r.default.settings.get("muc_nickname_from_jid")?l.unescapeNode(l.getNodeFromJid(n.default.bare_jid)):void 0)}function b(e){return!!r.default.settings.get("muc_show_info_messages").includes(e)}async function j(){await Promise.all(r.default.settings.get("auto_join_rooms").map((e=>"string"==typeof e?n.default.chatboxes.where({jid:e}).length?Promise.resolve():r.default.rooms.open(e):e instanceof Object?r.default.rooms.open(e.jid,{...e}):(o.default.error('Invalid muc criteria specified for "auto_join_rooms"'),Promise.resolve())))),r.default.trigger("roomsAutoJoined")}function w(){r.default.disco.own.features.add(l.NS.MUC),r.default.settings.get("allow_muc_invitations")&&r.default.disco.own.features.add("jabber:x:conference")}function S(){n.default.chatboxes.where({type:n.default.CHATROOMS_TYPE}).forEach((e=>(0,a.safeSave)(e.session,{connection_status:r.converse.ROOMSTATUS.DISCONNECTED})))}function x(){window.addEventListener(n.default.unloadevent,(()=>{!r.default.connection.isType("websocket")||r.default.settings.get("enable_smacks")&&n.default.session.get("smacks_stream_id")||m()}))}function E(){n.default.connection.addHandler((e=>{const t=l.getBareJidFromJid(e.getAttribute("from"));return n.default.chatboxes.get(t)||r.default.waitUntil("chatBoxesFetched").then((async()=>{const s=n.default.chatboxes.get(t);s&&(await s.initialized,s.message_handler.run(e))})),!0}),null,"message","groupchat")}Object.assign(n.default,{getAssignableRoles:h})},"./src/headless/plugins/roster/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js");const{Strophe:o}=r.converse.env,i={contacts:{async get(e){await r.default.waitUntil("rosterContactsFetched");const t=e=>n.default.roster.get(o.getBareJidFromJid(e));if(void 0===e)e=n.default.roster.pluck("jid");else if("string"==typeof e)return t(e);return e.map(t)},async add(e,t){if(await r.default.waitUntil("rosterContactsFetched"),"string"!=typeof e||!e.includes("@"))throw new TypeError("contacts.add: invalid jid");return n.default.roster.addAndSubscribe(e,t)}}}},"./src/headless/plugins/roster/contact.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});s("./src/headless/plugins/status/api.js");var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./node_modules/@converse/openpromise/openpromise.js"),a=s("./src/headless/plugins/roster/utils.js");const{Strophe:l,$iq:c,$pres:d}=r.converse.env;class u extends o.Model{get idAttribute(){return"jid"}defaults(){return{chat_state:void 0,groups:[],image:n.default.DEFAULT_IMAGE,image_type:n.default.DEFAULT_IMAGE_TYPE,num_unread:0,status:void 0}}async initialize(e){super.initialize(e),this.initialized=(0,i.getOpenPromise)(),this.setPresence();const{jid:t}=e;this.set({...e,jid:l.getBareJidFromJid(t).toLowerCase(),user_id:l.getNodeFromJid(t)}),this.listenTo(this.presence,"change:show",(()=>r.default.trigger("contactPresenceChanged",this))),this.listenTo(this.presence,"change:show",(()=>this.trigger("presenceChanged"))),await r.default.trigger("rosterContactInitialized",this,{Synchronous:!0}),this.initialized.resolve()}setPresence(){const e=this.get("jid");this.presence=n.default.presences.findWhere(e)||n.default.presences.create({jid:e})}openChat(){const e=this.attributes;r.default.chats.open(e.jid,e,!0)}getFilterCriteria(){const e=this.get("nickname"),t=this.get("jid");let s=this.getDisplayName();return s=s.includes(t)?s:s.concat(`   ${t}`),s=s.includes(e)?s:s.concat(`   ${e}`),s.toLowerCase()}getDisplayName(){return this.get("nickname")?this.get("nickname"):this.get("jid")}getFullname(){return this.get("jid")}subscribe(e){return r.default.user.presence.send("subscribe",this.get("jid"),e),this.save("ask","subscribe"),this}ackSubscribe(){r.default.send(d({type:"subscribe",to:this.get("jid")}))}ackUnsubscribe(){r.default.send(d({type:"unsubscribe",to:this.get("jid")})),this.removeFromRoster(),this.destroy()}unauthorize(e){return(0,a.rejectPresenceSubscription)(this.get("jid"),e),this}authorize(e){const t=d({to:this.get("jid"),type:"subscribed"});return e&&""!==e&&t.c("status").t(e),r.default.send(t),this}removeFromRoster(){const e=c({type:"set"}).c("query",{xmlns:l.NS.ROSTER}).c("item",{jid:this.get("jid"),subscription:"remove"});return r.default.sendIQ(e)}}const h=u},"./src/headless/plugins/roster/contacts.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s("./src/headless/plugins/roster/contact.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/log.js"),a=s("./node_modules/@converse/skeletor/src/collection.js"),l=s("./node_modules/@converse/skeletor/src/model.js"),c=s("./src/headless/utils/storage.js"),d=s("./src/headless/plugins/roster/utils.js");const{Strophe:u,$iq:h,sizzle:f,u:m}=o.converse.env,p=a.Collection.extend({model:n.default,initialize(){const e=`roster.state-${r.default.bare_jid}-${this.get("jid")}`;this.state=new l.Model({id:e,collapsed_groups:[]}),(0,c.initStorage)(this.state,e),this.state.fetch()},onConnected(){this.registerRosterHandler(),this.registerRosterXHandler()},registerRosterHandler(){r.default.connection.addHandler((e=>(r.default.roster.onRosterPush(e),!0)),u.NS.ROSTER,"iq","set")},registerRosterXHandler(){let e=0;r.default.connection.addHandler((function(t){return window.setTimeout((function(){r.default.connection.flush(),r.default.roster.subscribeToSuggestedItems.bind(r.default.roster)(t)}),e),e+=250*t.querySelectorAll("item").length,!0}),u.NS.ROSTERX,"message",null)},async fetchRosterContacts(){const e=await new Promise(((e,t)=>{this.fetch({add:!0,silent:!0,success:e,error:(e,s)=>t(s)})}));if(m.isErrorObject(e)&&(i.default.error(e),r.default.session.save("roster_cached",!1),this.data.save("version",void 0)),!r.default.session.get("roster_cached"))return r.default.send_initial_presence=!0,r.default.roster.fetchFromServer();o.default.trigger("cachedRoster",e)},subscribeToSuggestedItems:e=>(Array.from(e.querySelectorAll("item")).forEach((e=>{"add"===e.getAttribute("action")&&r.default.roster.addAndSubscribe(e.getAttribute("jid"),r.default.xmppstatus.getNickname()||r.default.xmppstatus.getFullname())})),!0),isSelf:e=>m.isSameBareJID(e,r.default.connection.jid),async addAndSubscribe(e,t,s,n,o){const i=await this.addContactToRoster(e,t,s,o);i instanceof r.default.RosterContact&&i.subscribe(n)},sendContactAddIQ(e,t,s){t=t||null;const n=h({type:"set"}).c("query",{xmlns:u.NS.ROSTER}).c("item",{jid:e,name:t});return s.forEach((e=>n.c("group").t(e).up())),o.default.sendIQ(n)},async addContactToRoster(e,t,s,n){await o.default.waitUntil("rosterContactsFetched"),s=s||[];try{await this.sendContactAddIQ(e,t,s)}catch(s){const{__:n}=r.default;return i.default.error(s),alert(n("Sorry, there was an error while trying to add %1$s as a contact.",t||e)),s}return this.create(Object.assign({ask:void 0,nickname:t,groups:s,jid:e,requesting:!1,subscription:"none"},n),{sort:!1})},async subscribeBack(e,t){const s=this.get(e);if(s instanceof r.default.RosterContact)s.authorize().subscribe();else{const s=f(`nick[xmlns="${u.NS.NICK}"]`,t).pop()?.textContent||null,n=await this.addContactToRoster(e,s,[],{subscription:"from"});n instanceof r.default.RosterContact&&n.authorize().subscribe()}},onRosterPush(e){const t=e.getAttribute("id"),s=e.getAttribute("from");if(s&&s!==r.default.bare_jid)return void i.default.warn(`Ignoring roster illegitimate roster push message from ${e.getAttribute("from")}`);o.default.send(h({type:"result",id:t,from:r.default.connection.jid}));const n=f(`query[xmlns="${u.NS.ROSTER}"]`,e).pop();this.data.save("version",n.getAttribute("ver"));const a=f("item",n);if(a.length>1)throw i.default.error(e),new Error('Roster push query may not contain more than one "item" element.');if(0===a.length)return i.default.warn(e),void i.default.warn('Received a roster push stanza without an "item" element.');this.updateContact(a.pop()),o.default.trigger("rosterPush",e)},rosterVersioningSupported(){return o.default.disco.stream.getFeature("ver","urn:xmpp:features:rosterver")&&this.data.get("version")},async fetchFromServer(){const e=h({type:"get",id:m.getUniqueId("roster")}).c("query",{xmlns:u.NS.ROSTER});this.rosterVersioningSupported()&&e.attrs({ver:this.data.get("version")});const t=await o.default.sendIQ(e,null,!1);if("result"===t.getAttribute("type")){const e=f(`query[xmlns="${u.NS.ROSTER}"]`,t).pop();if(e){const t=f("item",e);if(!this.data.get("version")&&this.models.length){const e=t.map((e=>e.getAttribute("jid")));this.forEach((t=>!t.get("requesting")&&!e.includes(t.get("jid"))&&t.destroy()))}t.forEach((e=>this.updateContact(e))),this.data.save("version",e.getAttribute("ver"))}}else if(!m.isServiceUnavailableError(t))return i.default.error(t),void i.default.error("Error while trying to fetch roster from the server");r.default.session.save("roster_cached",!0),o.default.trigger("roster",t)},updateContact(e){const t=e.getAttribute("jid"),s=this.get(t),n=e.getAttribute("subscription");if("remove"===n)return s?.destroy();const r=e.getAttribute("ask"),o=e.getAttribute("name"),i=[...new Set(f("group",e).map((e=>e.textContent)))];s?s.save({subscription:n,ask:r,nickname:o,groups:i,requesting:null}):this.create({nickname:o,ask:r,groups:i,jid:t,subscription:n},{sort:!1})},createRequestingContact(e){const t={jid:u.getBareJidFromJid(e.getAttribute("from")),subscription:"none",ask:null,requesting:!0,nickname:f(`nick[xmlns="${u.NS.NICK}"]`,e).pop()?.textContent||null};o.default.trigger("contactRequest",this.create(t))},handleIncomingSubscription(e){const t=e.getAttribute("from"),s=u.getBareJidFromJid(t),n=this.get(s);if(!o.default.settings.get("allow_contact_requests")){const{__:e}=r.default;(0,d.rejectPresenceSubscription)(t,e("This client does not allow presence subscriptions"))}o.default.settings.get("auto_subscribe")?n&&"to"===n.get("subscription")?n.authorize():this.subscribeBack(s,e):n?("none"!==n.get("subscription")||"subscribe"===n.get("ask"))&&n.authorize():this.createRequestingContact(e)},handleOwnPresence(e){const t=e.getAttribute("from"),s=u.getResourceFromJid(t),n=e.getAttribute("type");if(r.default.connection.jid!==t&&"unavailable"!==n&&(!0===o.default.settings.get("synchronize_availability")||o.default.settings.get("synchronize_availability")===s)){const t=e.querySelector("show")?.textContent||"online";r.default.xmppstatus.save({status:t},{silent:!0});const s=e.querySelector("status")?.textContent;s&&r.default.xmppstatus.save({status_message:s})}r.default.jid===t&&"unavailable"===n&&o.default.user.presence.send()},presenceHandler(e){const t=e.getAttribute("type");if("error"===t)return!0;const s=e.getAttribute("from"),n=u.getBareJidFromJid(s);if(this.isSelf(n))return this.handleOwnPresence(e);if(f(`query[xmlns="${u.NS.MUC}"]`,e).length)return;const r=this.get(n);if(r){const t=e.querySelector("status")?.textContent;r.get("status")!==t&&r.save({status:t})}if("subscribed"===t&&r)r.ackSubscribe();else if("unsubscribed"===t&&r)r.ackUnsubscribe();else{if("unsubscribe"===t)return;if("subscribe"===t)this.handleIncomingSubscription(e);else if("unavailable"===t&&r){const e=u.getResourceFromJid(s);r.presence.removeResource(e)}else r&&r.presence.addResource(e)}}})},"./src/headless/plugins/roster/filter.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{RosterFilter:()=>r});var n=s("./node_modules/@converse/skeletor/src/model.js");class r extends n.Model{initialize(){super.initialize(),this.set({filter_text:"",filter_type:"contacts",chat_state:"online"})}}},"./src/headless/plugins/roster/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/status/index.js");var n=s("./src/headless/plugins/roster/contact.js"),r=s("./src/headless/plugins/roster/contacts.js"),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/shared/api/index.js"),a=s("./src/headless/plugins/roster/api.js"),l=s("./src/headless/plugins/roster/presence.js"),c=s("./src/headless/plugins/roster/utils.js");i.converse.plugins.add("converse-roster",{dependencies:["converse-status"],initialize(){i.default.settings.extend({allow_contact_requests:!0,auto_subscribe:!1,synchronize_availability:!0}),i.default.promises.add(["cachedRoster","roster","rosterContactsFetched","rosterInitialized"]),Object.assign(o.default.api,a.default);const{__:e}=o.default;o.default.HEADER_CURRENT_CONTACTS=e("My contacts"),o.default.HEADER_PENDING_CONTACTS=e("Pending contacts"),o.default.HEADER_REQUESTING_CONTACTS=e("Contact requests"),o.default.HEADER_UNGROUPED=e("Ungrouped"),o.default.HEADER_UNREAD=e("New messages"),o.default.Presence=l.Presence,o.default.Presences=l.Presences,o.default.RosterContact=n.default,o.default.RosterContacts=r.default,i.default.listen.on("beforeTearDown",(()=>(0,c.unregisterPresenceHandler)())),i.default.listen.on("chatBoxesInitialized",c.onChatBoxesInitialized),i.default.listen.on("clearSession",c.onClearSession),i.default.listen.on("presencesInitialized",c.onPresencesInitialized),i.default.listen.on("statusInitialized",c.onStatusInitialized),i.default.listen.on("streamResumptionFailed",(()=>o.default.session.set("roster_cached",!1))),i.default.waitUntil("rosterContactsFetched").then(c.onRosterContactsFetched)}})},"./src/headless/plugins/roster/presence.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Presence:()=>h,Presences:()=>f,Resource:()=>d,Resources:()=>u});var n=s("./node_modules/@converse/skeletor/src/collection.js"),r=s("./node_modules/@converse/skeletor/src/model.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/utils/storage.js");const{Strophe:a,dayjs:l,sizzle:c}=o.converse.env,d=r.Model.extend({idAttribute:"name"}),u=n.Collection.extend({model:d});class h extends r.Model{get idAttribute(){return"jid"}defaults(){return{show:"offline"}}initialize(){super.initialize(),this.resources=new u;const e=`converse.identities-${this.get("jid")}`;(0,i.initStorage)(this.resources,e,"session"),this.listenTo(this.resources,"update",this.onResourcesChanged),this.listenTo(this.resources,"change",this.onResourcesChanged)}onResourcesChanged(){const e=this.getHighestPriorityResource(),t=e?.attributes?.show||"offline";this.get("show")!==t&&this.save({show:t})}getHighestPriorityResource(){return this.resources.sortBy((e=>`${e.get("priority")}-${e.get("timestamp")}`)).reverse()[0]}addResource(e){const t=e.getAttribute("from"),s=a.getResourceFromJid(t),n=c(`delay[xmlns="${a.NS.DELAY}"]`,e).pop(),r=e.querySelector("priority")?.textContent,o=this.resources.get(s),i={name:s,priority:Number.isNaN(parseInt(r,10))?0:parseInt(r,10),show:e.querySelector("show")?.textContent??"online",timestamp:n?l(n.getAttribute("stamp")).toISOString():(new Date).toISOString()};o?o.save(i):this.resources.create(i)}removeResource(e){const t=this.resources.get(e);t?.destroy()}}const f=n.Collection.extend({model:h})},"./src/headless/plugins/roster/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{contactsComparator:()=>j,getGroupsAutoCompleteList:()=>S,groupsComparator:()=>w,onChatBoxesInitialized:()=>v,onClearSession:()=>p,onPresencesInitialized:()=>g,onRosterContactsFetched:()=>y,onStatusInitialized:()=>_,rejectPresenceSubscription:()=>b,unregisterPresenceHandler:()=>f});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./node_modules/@converse/skeletor/src/model.js"),a=s("./src/headless/plugins/roster/filter.js"),l=s("./src/headless/shared/constants.js"),c=s("./src/headless/utils/storage.js"),d=s("./src/headless/utils/core.js");const{$pres:u}=r.converse.env;function h(e){const t=n.default.roster?.get(e.get("jid"));t?.save({num_unread:e.get("num_unread")})}function f(){void 0!==n.default.presence_ref&&(n.default.connection.deleteHandler(n.default.presence_ref),delete n.default.presence_ref)}async function m(){await(n.default.presences?.clearStore())}async function p(){await m(),(0,d.shouldClearCache)()&&(n.default.rostergroups&&(await n.default.rostergroups.clearStore(),delete n.default.rostergroups),n.default.roster&&(n.default.roster.data?.destroy(),await n.default.roster.clearStore(),delete n.default.roster))}function g(e){e?r.default.trigger("rosterReadyAfterReconnection"):function(){const e=n.default.roster=new n.default.RosterContacts;let t=`converse.contacts-${n.default.bare_jid}`;(0,c.initStorage)(e,t);const s=n.default.roster_filter=new a.RosterFilter;s.id=`_converse.rosterfilter-${n.default.bare_jid}`,(0,c.initStorage)(s,s.id),s.fetch(),t=`converse-roster-model-${n.default.bare_jid}`,e.data=new i.Model,e.data.id=t,(0,c.initStorage)(e.data,t),e.data.fetch(),r.default.trigger("rosterInitialized")}(),n.default.roster.onConnected(),f(),n.default.presence_ref=n.default.connection.addHandler((e=>(n.default.roster.presenceHandler(e),!0)),null,"presence",null),async function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(n.default.send_initial_presence=!0);try{await n.default.roster.fetchRosterContacts(),r.default.trigger("rosterContactsFetched")}catch(e){o.default.error(e)}finally{n.default.send_initial_presence&&r.default.user.presence.send()}}(!n.default.connection.restored)}async function _(e){if(e)!n.default.connection.hasResumed()&&await m();else{n.default.presences=new n.default.Presences;const e=`converse.presences-${n.default.bare_jid}`;(0,c.initStorage)(n.default.presences,e,"session"),n.default.presences.fetch()}r.default.trigger("presencesInitialized",e)}function v(){n.default.chatboxes.on("change:num_unread",h),n.default.chatboxes.on("add",(e=>{e.get("type")===n.default.PRIVATE_CHAT_TYPE&&e.setRosterContact(e.get("jid"))}))}function y(){n.default.roster.on("add",(e=>{const t=n.default.chatboxes.findWhere({jid:e.get("jid")});t?.setRosterContact(e.get("jid"))}))}function b(e,t){const s=u({to:e,type:"unsubscribed"});t&&""!==t&&s.c("status").t(t),r.default.send(s)}function j(e,t){const s=e.presence.get("show")||"offline",n=t.presence.get("show")||"offline";if(l.STATUS_WEIGHTS[s]===l.STATUS_WEIGHTS[n]){const s=e.getDisplayName().toLowerCase(),n=t.getDisplayName().toLowerCase();return s<n?-1:s>n?1:0}return l.STATUS_WEIGHTS[s]<l.STATUS_WEIGHTS[n]?-1:1}function w(e,t){const s={};s[n.default.HEADER_UNREAD]=0,s[n.default.HEADER_REQUESTING_CONTACTS]=1,s[n.default.HEADER_CURRENT_CONTACTS]=2,s[n.default.HEADER_UNGROUPED]=3,s[n.default.HEADER_PENDING_CONTACTS]=4;const r=s,o=Object.keys(s),i=o.includes(e),a=o.includes(t);if(!i&&!a)return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0;if(i&&a)return r[e]<r[t]?-1:r[e]>r[t]?1:0;if(!i&&a){const e=n.default.HEADER_CURRENT_CONTACTS;return r[e]<r[t]?-1:r[e]>r[t]?1:0}if(i&&!a){const t=n.default.HEADER_CURRENT_CONTACTS;return r[e]<r[t]?-1:r[e]>r[t]?1:0}}function S(){const{roster:e}=n.default,t=e.reduce(((e,t)=>e.concat(t.get("groups"))),[]);return[...new Set(t.filter((e=>e)))]}},"./src/headless/plugins/status/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/api/index.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/constants.js");const i={status:{get:async()=>(await n.default.waitUntil("statusInitialized"),r.default.xmppstatus.get("status")),async set(e,t){const s={status:e};if(!Object.keys(o.STATUS_WEIGHTS).includes(e))throw new Error("Invalid availability value. See https://xmpp.org/rfcs/rfc3921.html#rfc.section.2.2.2.1");"string"==typeof t&&(s.status_message=t),await n.default.waitUntil("statusInitialized"),r.default.xmppstatus.save(s)},message:{get:async()=>(await n.default.waitUntil("statusInitialized"),r.default.xmppstatus.get("status_message")),async set(e){await n.default.waitUntil("statusInitialized"),r.default.xmppstatus.save({status_message:e})}}}}},"./src/headless/plugins/status/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/plugins/status/status.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/plugins/status/api.js"),a=s("./src/headless/utils/core.js"),l=s("./src/headless/plugins/status/utils.js");const{Strophe:c}=o.converse.env;c.addNamespace("IDLE","urn:xmpp:idle:1"),o.converse.plugins.add("converse-status",{initialize(){o.default.settings.extend({auto_away:0,auto_xa:0,csi_waiting_time:0,default_state:"online",idle_presence_timeout:300,priority:0}),o.default.promises.add(["statusInitialized"]),r.default.XMPPStatus=n.default,r.default.onUserActivity=l.onUserActivity,r.default.onEverySecond=l.onEverySecond,r.default.sendCSI=l.sendCSI,r.default.registerIntervalHandler=l.registerIntervalHandler,Object.assign(r.default.api.user,i.default),o.default.settings.get("idle_presence_timeout")>0&&o.default.listen.on("addClientFeatures",(()=>o.default.disco.own.features.add(c.NS.IDLE))),o.default.listen.on("presencesInitialized",(e=>{e||r.default.registerIntervalHandler()})),o.default.listen.on("clearSession",(()=>{(0,a.shouldClearCache)()&&r.default.xmppstatus&&(r.default.xmppstatus.destroy(),delete r.default.xmppstatus,o.default.promises.add(["statusInitialized"]))})),o.default.listen.on("connected",(()=>(0,l.initStatus)(!1))),o.default.listen.on("reconnected",(()=>(0,l.initStatus)(!0))),o.default.listen.on("constructedMUCPresence",l.addStatusToMUCJoinPresence)}})},"./src/headless/plugins/status/status.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/@converse/skeletor/src/model.js");const{Strophe:i,$pres:a}=r.converse.env;class l extends o.Model{defaults(){return{status:r.default.settings.get("default_state")}}initialize(){this.on("change",(e=>{e.changed instanceof Object&&("status"in e.changed||"status_message"in e.changed)&&r.default.user.presence.send(this.get("status"),null,this.get("status_message"))}))}getDisplayName(){return this.getFullname()||this.getNickname()||n.default.bare_jid}getNickname(){return r.default.settings.get("nickname")}getFullname(){return""}async constructPresence(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2?arguments[2]:void 0;if(e="string"==typeof e?e:this.get("status")||r.default.settings.get("default_state"),o="string"==typeof o?o:this.get("status_message"),"subscribe"===e){t=a({to:s,type:e});const{xmppstatus:r}=n.default,o=r.getNickname();o&&t.c("nick",{xmlns:i.NS.NICK}).t(o).up()}else t="unavailable"===e||"probe"===e||"error"===e||"unsubscribe"===e||"unsubscribed"===e||"subscribed"===e?a({to:s,type:e}):"offline"===e?a({to:s,type:"unavailable"}):"online"===e?a({to:s}):a({to:s}).c("show").t(e).up();o&&t.c("status").t(o).up();const l=r.default.settings.get("priority");t.c("priority").t(Number.isNaN(Number(l))?0:l).up();const{idle:c,idle_seconds:d}=n.default;if(c){const e=new Date;e.setSeconds(e.getSeconds()-d),t.c("idle",{xmlns:i.NS.IDLE,since:e.toISOString()})}return t=await r.default.hook("constructedPresence",null,t),t}}},"./src/headless/plugins/status/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addStatusToMUCJoinPresence:()=>m,initStatus:()=>c,onEverySecond:()=>u,onUserActivity:()=>d,registerIntervalHandler:()=>f,sendCSI:()=>h});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/utils/storage.js");const{Strophe:i,$build:a}=r.converse.env;function l(e){r.default.trigger("statusInitialized",e)}function c(e){if(e=void 0!==n.default.xmppstatus&&e)l(e);else{const t=`converse.xmppstatus-${n.default.bare_jid}`;n.default.xmppstatus=new n.default.XMPPStatus({id:t}),(0,o.initStorage)(n.default.xmppstatus,t,"session"),n.default.xmppstatus.fetch({success:()=>l(e),error:()=>l(e),silent:!0})}}function d(){n.default.idle_seconds>0&&(n.default.idle_seconds=0),n.default.connection?.authenticated&&(n.default.inactive&&n.default.sendCSI(n.default.ACTIVE),n.default.idle&&(n.default.idle=!1,r.default.user.presence.send()),!0===n.default.auto_changed_status&&(n.default.auto_changed_status=!1,n.default.xmppstatus.set("status",r.default.settings.get("default_state"))))}function u(){if(!n.default.connection?.authenticated)return;const e=n.default.xmppstatus.get("status");n.default.idle_seconds++,r.default.settings.get("csi_waiting_time")>0&&n.default.idle_seconds>r.default.settings.get("csi_waiting_time")&&!n.default.inactive&&n.default.sendCSI(n.default.INACTIVE),r.default.settings.get("idle_presence_timeout")>0&&n.default.idle_seconds>r.default.settings.get("idle_presence_timeout")&&!n.default.idle&&(n.default.idle=!0,r.default.user.presence.send()),r.default.settings.get("auto_away")>0&&n.default.idle_seconds>r.default.settings.get("auto_away")&&"away"!==e&&"xa"!==e&&"dnd"!==e?(n.default.auto_changed_status=!0,n.default.xmppstatus.set("status","away")):r.default.settings.get("auto_xa")>0&&n.default.idle_seconds>r.default.settings.get("auto_xa")&&"xa"!==e&&"dnd"!==e&&(n.default.auto_changed_status=!0,n.default.xmppstatus.set("status","xa"))}function h(e){r.default.send(a(e,{xmlns:i.NS.CSI})),n.default.inactive=e===n.default.INACTIVE}function f(){if(r.default.settings.get("auto_away")<1&&r.default.settings.get("auto_xa")<1&&r.default.settings.get("csi_waiting_time")<1&&r.default.settings.get("idle_presence_timeout")<1)return;n.default.idle_seconds=0,n.default.auto_changed_status=!1;const{unloadevent:e}=n.default;window.addEventListener("click",n.default.onUserActivity),window.addEventListener("focus",n.default.onUserActivity),window.addEventListener("keypress",n.default.onUserActivity),window.addEventListener("mousemove",n.default.onUserActivity),window.addEventListener(e,n.default.onUserActivity,{once:!0,passive:!0}),n.default.everySecondTrigger=window.setInterval(n.default.onEverySecond,1e3)}function m(e,t){const{xmppstatus:s}=n.default,r=s.get("status");["away","chat","dnd","xa"].includes(r)&&t.c("show").t(r).up();const o=s.get("status_message");return o&&t.c("status").t(o).up(),t}},"./src/headless/plugins/vcard/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/headless/log.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/plugins/vcard/utils.js");const{dayjs:a,u:l}=o.converse.env,c={vcard:{async set(e,t){if(!e)throw Error("No jid provided for the VCard data");const s=document.createElement("div"),n=l.toStanza(`\n                <vCard xmlns="vcard-temp">\n                    <FN>${t.fn}</FN>\n                    <NICKNAME>${t.nickname}</NICKNAME>\n                    <URL>${t.url}</URL>\n                    <ROLE>${t.role}</ROLE>\n                    <EMAIL><INTERNET/><PREF/><USERID>${t.email}</USERID></EMAIL>\n                    <PHOTO>\n                        <TYPE>${t.image_type}</TYPE>\n                        <BINVAL>${t.image}</BINVAL>\n                    </PHOTO>\n                </vCard>`,s);let r;try{r=await o.default.sendIQ((0,i.createStanza)("set",e,n))}catch(e){throw e}return await o.default.vcard.update(e,!0),r},get(e,t){if("string"==typeof e)return(0,i.getVCard)(e);const s=e.get("vcard_error"),r=s&&a(s).isSame(new Date,"day");if(t||!e.get("vcard_updated")&&!r){const t=e.get("jid");return t||n.default.error("No JID to get vcard for"),(0,i.getVCard)(t)}return Promise.resolve({})},async update(e,t){const s=await this.get(e,t);(e="string"==typeof e?r.default.vcards.get(e):e)?Object.keys(s).length&&(delete s.stanza,e.save(s)):n.default.error(`Could not find a VCard model for ${e}`)}}}},"./src/headless/plugins/vcard/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/status/index.js");var n=s("./src/headless/plugins/vcard/vcard.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/api/index.js"),i=s("./src/headless/plugins/vcard/api.js"),a=s("./node_modules/@converse/skeletor/src/collection.js"),l=s("./src/headless/plugins/vcard/utils.js");const{Strophe:c}=o.converse.env;o.converse.plugins.add("converse-vcard",{dependencies:["converse-status","converse-roster"],overrides:{XMPPStatus:{getNickname(){const{_converse:e}=this.__super__,t=this.__super__.getNickname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("nickname"):t},getFullname(){const{_converse:e}=this.__super__,t=this.__super__.getFullname.apply(this);return!t&&e.xmppstatus.vcard?e.xmppstatus.vcard.get("fullname"):t}},RosterContact:{getDisplayName(){return!this.get("nickname")&&this.vcard?this.vcard.getDisplayName():this.__super__.getDisplayName.apply(this)},getFullname(){return this.vcard?this.vcard.get("fullname"):this.__super__.getFullname.apply(this)}}},initialize(){o.default.promises.add("VCardsInitialized"),r.default.VCard=n.default,r.default.VCards=a.Collection.extend({model:r.default.VCard,initialize(){this.on("add",(e=>e.get("jid")&&o.default.vcard.update(e)))}}),o.default.listen.on("chatRoomInitialized",(e=>{(0,l.setVCardOnModel)(e),e.occupants.forEach(l.setVCardOnOccupant),e.listenTo(e.occupants,"add",l.setVCardOnOccupant),e.listenTo(e.occupants,"change:image_hash",(e=>(0,l.onOccupantAvatarChanged)(e)))})),o.default.listen.on("chatBoxInitialized",(e=>(0,l.setVCardOnModel)(e))),o.default.listen.on("chatRoomMessageInitialized",(e=>(0,l.setVCardOnMUCMessage)(e))),o.default.listen.on("addClientFeatures",(()=>o.default.disco.own.features.add(c.NS.VCARD))),o.default.listen.on("clearSession",(()=>(0,l.clearVCardsSession)())),o.default.listen.on("messageInitialized",(e=>(0,l.setVCardOnModel)(e))),o.default.listen.on("rosterContactInitialized",(e=>(0,l.setVCardOnModel)(e))),o.default.listen.on("statusInitialized",l.initVCardCollection),Object.assign(r.default.api,i.default)}})},"./src/headless/plugins/vcard/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearVCardsSession:()=>_,createStanza:()=>u,getVCard:()=>v,initVCardCollection:()=>g,onOccupantAvatarChanged:()=>h,setVCardOnMUCMessage:()=>p,setVCardOnModel:()=>f,setVCardOnOccupant:()=>m});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js"),o=s("./src/headless/log.js"),i=s("./src/headless/utils/storage.js"),a=s("./src/headless/utils/core.js");const{Strophe:l,$iq:c,u:d}=r.converse.env;function u(e,t,s){const n=c(t?{type:e,to:t}:{type:e});return s?n.cnode(s):n.c("vCard",{xmlns:l.NS.VCARD}),n}function h(e){const t=e.get("image_hash"),s=[];e.get("jid")&&s.push(n.default.vcards.get(e.get("jid"))),s.push(n.default.vcards.get(e.get("from"))),s.forEach((e=>t&&e?.get("image_hash")!==t&&r.default.vcard.update(e,!0)))}async function f(e){let t;if(e instanceof n.default.Message){if(["error","info"].includes(e.get("type")))return;t=e.get("from")}else t=e.get("jid");t?(await r.default.waitUntil("VCardsInitialized"),e.vcard=n.default.vcards.get(t)||n.default.vcards.create({jid:t}),e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add")):o.default.warn("Could not set VCard on model because no JID found!")}async function m(e){await r.default.waitUntil("VCardsInitialized"),e.vcard=function(e){const t=e?.collection?.chatroom,s=e.get("nick");if(s&&t?.get("nick")===s)return n.default.xmppstatus.vcard;{const t=e.get("jid")||e.get("from");return t?n.default.vcards.get(t)||n.default.vcards.create({jid:t}):void o.default.warn("Could not get VCard for occupant because no JID found!")}}(e),e.vcard&&(e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add"))}async function p(e){["error","info"].includes(e.get("type"))||(await r.default.waitUntil("VCardsInitialized"),e.vcard=function(e){const t=e?.collection?.chatbox,s=l.getResourceFromJid(e.get("from"));if(s&&t?.get("nick")===s)return n.default.xmppstatus.vcard;{const t=e.occupant?.get("jid")||e.get("from");return t?n.default.vcards.get(t)||n.default.vcards.create({jid:t}):void o.default.warn(`Could not get VCard for message because no JID found! msgid: ${e.get("msgid")}`)}}(e),e.vcard&&(e.vcard.on("change",(()=>e.trigger("vcard:change"))),e.trigger("vcard:add")))}async function g(){n.default.vcards=new n.default.VCards;const e=`${n.default.bare_jid}-converse.vcards`;(0,i.initStorage)(n.default.vcards,e),await new Promise((e=>{n.default.vcards.fetch({success:e,error:e},{silent:!0})}));const t=n.default.vcards;if(n.default.session){const e=n.default.session.get("bare_jid"),s=n.default.xmppstatus;s.vcard=t.get(e)||t.create({jid:e}),s.vcard&&(s.vcard.on("change",(()=>s.trigger("vcard:change"))),s.trigger("vcard:add"))}r.default.trigger("VCardsInitialized")}function _(){(0,a.shouldClearCache)()&&(r.default.promises.add("VCardsInitialized"),n.default.vcards&&(n.default.vcards.clearStore(),delete n.default.vcards))}async function v(e){const t=l.getBareJidFromJid(e)===n.default.bare_jid?null:e;let s;try{s=await r.default.sendIQ(u("get",t))}catch(s){return{jid:e,stanza:s,vcard_error:(new Date).toISOString()}}return async function(e,t){const s=t.querySelector("vCard");let n={};if(null!==s&&(n={stanza:t,fullname:s.querySelector("FN")?.textContent,nickname:s.querySelector("NICKNAME")?.textContent,image:s.querySelector("PHOTO BINVAL")?.textContent,image_type:s.querySelector("PHOTO TYPE")?.textContent,url:s.querySelector("URL")?.textContent,role:s.querySelector("ROLE")?.textContent,email:s.querySelector("EMAIL USERID")?.textContent,vcard_updated:(new Date).toISOString(),vcard_error:void 0}),n.image){const e=d.base64ToArrayBuffer(n.image),t=await crypto.subtle.digest("SHA-1",e);n.image_hash=d.arrayBufferToHex(t)}return n}(0,s)}},"./src/headless/plugins/vcard/vcard.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./node_modules/@converse/skeletor/src/model.js");class o extends r.Model{get idAttribute(){return"jid"}defaults(){return{image:n.default.DEFAULT_IMAGE,image_type:n.default.DEFAULT_IMAGE_TYPE}}set(e,t,s){let o;return"object"==typeof e?(o=e,s=t):(o={})[e]=t,"image"in o&&!o.image?(o.image=n.default.DEFAULT_IMAGE,o.image_type=n.default.DEFAULT_IMAGE_TYPE,r.Model.prototype.set.call(this,o,s)):r.Model.prototype.set.apply(this,arguments)}getDisplayName(){return this.get("nickname")||this.get("fullname")||this.get("jid")}}const i=o},"./src/headless/shared/_converse.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var n=s("./src/headless/shared/i18n.js"),r=s("./src/headless/log.js"),o=s("./node_modules/pluggable.js/src/pluggable.js"),i=s("./node_modules/@converse/skeletor/src/events.js"),a=s("./node_modules/@converse/skeletor/src/router.js"),l=s("./src/headless/utils/storage.js"),c=s("./src/headless/shared/settings/utils.js"),d=s("./node_modules/@converse/openpromise/openpromise.js"),u=s("./src/headless/utils/core.js"),h=s("./src/headless/shared/constants.js");const f={log:r.default,shouldClearCache:u.shouldClearCache,VERSION_NAME:h.VERSION_NAME,templates:{},promises:{initialized:(0,d.getOpenPromise)()},ANONYMOUS:h.ANONYMOUS,CLOSED:h.CLOSED,EXTERNAL:h.EXTERNAL,LOGIN:h.LOGIN,LOGOUT:h.LOGOUT,OPENED:h.OPENED,PREBIND:h.PREBIND,SUCCESS:h.SUCCESS,FAILURE:h.FAILURE,DEFAULT_IMAGE_TYPE:h.DEFAULT_IMAGE_TYPE,DEFAULT_IMAGE:h.DEFAULT_IMAGE,INACTIVE:h.INACTIVE,ACTIVE:h.ACTIVE,COMPOSING:h.COMPOSING,PAUSED:h.PAUSED,GONE:h.GONE,PRIVATE_CHAT_TYPE:h.PRIVATE_CHAT_TYPE,CHATROOMS_TYPE:h.CHATROOMS_TYPE,HEADLINES_TYPE:h.HEADLINES_TYPE,CONTROLBOX_TYPE:h.CONTROLBOX_TYPE,TIMEOUTS:{PAUSED:1e4,INACTIVE:9e4},default_connection_options:{explicitResourceBinding:!0},router:new a.Router,isTestEnv:()=>"montague.lit/http-bind"===(0,c.getInitSettings)().bosh_service_url,getDefaultStore:l.getDefaultStore,createStore:l.createStore,__:function(){return n.default.__(...arguments)},___:e=>e};Object.assign(f,i.Events),o.default.enable(f,"_converse","pluggable");const m=f},"./src/headless/shared/actions.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{rejectMessage:()=>l,sendMarker:()=>c});var n=s("./src/headless/log.js"),r=s("./node_modules/strophe.js/src/index.js"),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/shared/api/index.js");const a=i.converse.env.utils;function l(e,t){i.default.send((0,r.$msg)({to:e.getAttribute("from"),type:"error",id:e.getAttribute("id")}).c("error",{type:"cancel"}).c("not-allowed",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).up().c("text",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"}).t(t)),n.default.warn(`Rejecting message stanza with the following reason: ${t}`),n.default.warn(e)}function c(e,t,s,n){const l=(0,r.$msg)({from:o.default.connection.jid,id:a.getUniqueId(),to:e,type:n||"chat"}).c(s,{xmlns:r.Strophe.NS.MARKERS,id:t});i.default.send(l)}},"./src/headless/shared/api/events.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/utils/core.js");const o={async trigger(e){if(!n.default._events)return;const t=Array.from(arguments),s=t.pop();if(s&&s.synchronous){const s=n.default._events[e]||[],r=t.splice(1);await Promise.all(s.map((e=>e.callback.apply(e.ctx,r))))}else n.default.trigger.apply(n.default,arguments);const r=n.default.promises[e];void 0!==r&&r.resolve()},hook(e,t,s){const r=n.default._events[e]||[];return r.length?r.reduce(((e,s)=>e.then((e=>s.callback(t,e)))),Promise.resolve(s)):s},listen:{once:n.default.once.bind(n.default),on:n.default.on.bind(n.default),not:n.default.off.bind(n.default),stanza(e,t,s){(0,r.default)(t)?(s=t,t={}):t=t||{},n.default.connection.addHandler(s,t.ns,e,t.type,t.id,t.from,t)}}}},"./src/headless/shared/api/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{converse:()=>c.converse,default:()=>d});var n=s("./src/headless/shared/connection/api.js"),r=s("./src/headless/shared/api/events.js"),o=s("./src/headless/shared/api/promise.js"),i=s("./src/headless/shared/api/send.js"),a=s("./src/headless/shared/api/user.js"),l=s("./src/headless/shared/settings/api.js"),c=s("./src/headless/shared/api/public.js");const d={connection:n.default,settings:l.settings_api,...i.default,...a.default,...r.default,...o.default}},"./src/headless/shared/api/presence.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/index.js");const o={presence:{async send(e,t,s,o){await r.default.waitUntil("statusInitialized"),o&&!Array.isArray(o)&&(o=[o]);const i=n.default.xmppstatus,a=await i.constructPresence(e,t,s);if(o?.map((e=>e?.tree()??e)).forEach((e=>a.cnode(e).up())),r.default.send(a),["away","chat","dnd","online","xa",void 0].includes(e)){(await r.default.rooms.get()).forEach((t=>t.sendStatusPresence(e,s,o)))}}}}},"./src/headless/shared/api/promise.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/shared/_converse.js"),r=s("./node_modules/@converse/openpromise/openpromise.js"),o=s("./src/headless/utils/core.js");const i={promises:{add(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(e=Array.isArray(e)?e:[e]).forEach((e=>{const s=(0,r.getOpenPromise)();s.replace=t,n.default.promises[e]=s}))}},waitUntil(e){if((0,o.isFunction)(e))return(0,o.waitUntil)(e);{const t=n.default.promises[e];return void 0===t?null:t}}}},"./src/headless/shared/api/public.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{converse:()=>E});var n=s("./src/headless/shared/connection/feedback.js"),r=s("./node_modules/urijs/src/URI.js"),o=s.n(r),i=s("./src/headless/shared/_converse.js"),a=s("./node_modules/dayjs/dayjs.min.js"),l=s.n(a),c=s("./src/headless/shared/i18n.js"),d=s("./src/headless/log.js"),u=s("./node_modules/sizzle/dist/sizzle.js"),h=s.n(u),f=s("./src/headless/utils/core.js"),m=s("./src/headless/shared/constants.js"),p=s("./node_modules/@converse/skeletor/src/collection.js"),g=s("./node_modules/@converse/skeletor/src/model.js"),_=s("./node_modules/strophe.js/src/index.js"),v=s("./src/headless/shared/errors.js"),y=s("./node_modules/filesize/dist/filesize.esm.js"),b=s("./node_modules/lit/index.js"),j=s("./src/headless/shared/settings/utils.js"),w=s("./node_modules/sprintf-js/src/sprintf.js"),S=s("./src/headless/utils/stanza.js"),x=s("./src/headless/utils/init.js");const E=Object.assign(window.converse||{},{CHAT_STATES:m.CHAT_STATES,keycodes:m.KEYCODES,async initialize(e){const{api:t}=i.default;if(await(0,x.cleanup)(i.default),(0,f.setUnloadEvent)(),(0,j.initAppSettings)(e),i.default.strict_plugin_dependencies=e.strict_plugin_dependencies,d.default.setLogLevel(t.settings.get("loglevel")),t.settings.get("authentication")===m.ANONYMOUS&&t.settings.get("auto_login")&&!t.settings.get("jid"))throw new Error("Config Error: you need to provide the server's domain via the 'jid' option when using anonymous authentication with auto_login.");i.default.router.route(/^converse\?loglevel=(debug|info|warn|error|fatal)$/,"loglevel",(e=>d.default.setLogLevel(e))),i.default.connfeedback=new n.default,i.default.send_initial_presence=!0,await(0,x.initSessionStorage)(i.default),await(0,x.initClientConfig)(i.default),await c.default.initialize(),(0,x.initPlugins)(i.default),t.elements?.register(),(0,x.registerGlobalEventHandlers)(i.default);try{!History.started&&i.default.router.history.start()}catch(e){d.default.error(e)}const s=i.default.pluggable.plugins;if((t.settings.get("auto_login")||t.settings.get("keepalive")&&s["converse-bosh"]?.enabled())&&await t.user.login(null,null,!0),t.trigger("initialized"),i.default.isTestEnv())return i.default},plugins:{add(e,t){if(t.__name__=e,void 0!==i.default.pluggable.plugins[e])throw new TypeError(`Error: plugin with name "${e}" has already been registered!`);i.default.pluggable.plugins[e]=t}},env:{$build:_.$build,$iq:_.$iq,$msg:_.$msg,$pres:_.$pres,utils:f.default,Collection:p.Collection,Model:g.Model,Promise,Strophe:_.Strophe,TimeoutError:v.TimeoutError,URI:o(),VERSION_NAME:m.VERSION_NAME,dayjs:l(),filesize:y.filesize,html:b.html,log:d.default,sizzle:h(),sprintf:w.sprintf,stx:S.stx,u:f.default}})},"./src/headless/shared/api/send.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/log.js"),o=s("./node_modules/strophe.js/src/index.js"),i=s("./src/headless/shared/errors.js"),a=s("./src/headless/utils/stanza.js");const l={send(e){const{api:t}=n.default;return t.connection.connected()?("string"==typeof e?e=(0,a.toStanza)(e):e?.tree&&(e=e.tree()),"iq"===e.tagName?t.sendIQ(e):(n.default.connection.send(e),void t.trigger("send",e))):(r.default.warn("Not sending stanza because we're not connected!"),void r.default.warn(o.Strophe.serialize(e)))},sendIQ(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{api:r,connection:a}=n.default;let l;return e=e.tree?.()??e,["get","set"].includes(e.getAttribute("type"))?(t=t||r.settings.get("stanza_timeout"),s?(l=new Promise(((s,n)=>a.sendIQ(e,s,n,t))),l.catch((s=>{if(null===s)throw new i.TimeoutError(`Timeout error after ${t}ms for the following IQ stanza: ${o.Strophe.serialize(e)}`)}))):l=new Promise((s=>a.sendIQ(e,s,s,t)))):(n.default.connection.sendIQ(e),l=Promise.resolve()),r.trigger("send",e),l}}},"./src/headless/shared/api/user.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/headless/shared/_converse.js"),r=s("./src/headless/shared/api/presence.js"),o=s("./src/headless/utils/core.js"),i=s("./src/headless/utils/init.js"),a=s("./node_modules/@converse/openpromise/openpromise.js"),l=s("./src/headless/shared/settings/api.js"),c=s("./src/headless/shared/constants.js");const d={user:{settings:l.user_settings_api,...r.default,jid:()=>n.default.connection.jid,async login(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{api:r}=n.default;if(e=e||r.settings.get("jid"),(!n.default.connection?.jid||e&&!o.default.isSameDomain(n.default.connection.jid,e))&&(0,i.initConnection)(),r.settings.get("connection_options")?.worker&&await n.default.connection.restoreWorkerSession())return;e&&(e=await(0,i.setUserJID)(e));const a=n.default.pluggable.plugins["converse-bosh"];if(a?.enabled()){if(await n.default.restoreBOSHSession())return;if(r.settings.get("authentication")===c.PREBIND&&(!s||r.settings.get("auto_login")))return n.default.startNewPreboundBOSHSession()}t=t||r.settings.get("password");const l=e&&t?{jid:e,password:t}:null;(0,i.attemptNonPreboundSession)(l,s)},async logout(){const{api:e}=n.default;await e.trigger("beforeLogout",{synchronous:!0});const t=(0,a.getOpenPromise)(),s=()=>{Object.keys(n.default.promises).forEach(o.replacePromise),delete n.default.jid,localStorage.removeItem("conversejs-session-jid"),e.trigger("logout"),t.resolve()};return n.default.connection.setDisconnectionCause(c.LOGOUT,void 0,!0),void 0!==n.default.connection?(e.listen.once("disconnected",(()=>s())),n.default.connection.disconnect()):s(),t}}}},"./src/headless/shared/chat/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{debouncedPruneHistory:()=>c,getMediaURLs:()=>a,handleCorrection:()=>l,pruneHistory:()=>i});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/headless/shared/api/index.js");const{u:o}=r.converse.env;function i(e){const t=r.default.settings.get("prune_messages_above");if(t&&"number"==typeof t&&e.messages.length>t){const s=e.messages.filter((e=>!o.isEmptyMessage(e)));if(s.length>t){for(;s.length>t;)s.shift().destroy();r.default.trigger("historyPruned",e)}}}function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.map((e=>{const n=e.start-s,r=e.end-s;return n<0||n>=t.length?null:Object.assign({},e,{start:n,end:r,url:t.substring(e.start-s,e.end-s)})})).filter((e=>e))}async function l(e,t){if(!t.replace_id||!t.from)return;const s="groupchat"===t.type&&t.occupant_id?e=>{let{attributes:s}=e;return s.msgid===t.replace_id&&s.occupant_id==t.occupant_id}:e=>{let{attributes:s}=e;return s.msgid===t.replace_id&&s.from===t.from&&null==s.occupant_id},n=e.messages.models.find(s);if(!n)return t.older_versions={},await e.createMessage(t);const r=n.get("older_versions")||{};return t.time<n.get("time")&&n.get("edited")?(r[t.time]=t.message,n.save({older_versions:r})):(Object.keys(r).length?r[n.get("edited")]=n.getMessageText():r[n.get("time")]=n.getMessageText(),delete(t=Object.assign(t,{older_versions:r})).msgid,delete t.id,t.time=n.get("time"),n.save(t)),n}const c=(0,n.default)(i,500)},"./src/headless/shared/connection/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/shared/_converse.js"),r=s("./node_modules/strophe.js/src/index.js");const o={authenticated:()=>n.default?.connection?.authenticated&&!0,connected:()=>n.default?.connection?.connected&&!0,disconnect(){n.default.connection&&n.default.connection.disconnect()},reconnect(){const{__:e,connection:t}=n.default;return t.setConnectionStatus(r.Strophe.Status.RECONNECTING,e("The connection has dropped, attempting to reconnect.")),t?.reconnecting?t.debouncedReconnect():t.reconnect()},isType:e=>n.default.connection.isType(e)}},"./src/headless/shared/connection/feedback.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/headless/shared/_converse.js"),r=s("./node_modules/@converse/skeletor/src/model.js"),o=s("./node_modules/strophe.js/src/index.js");class i extends r.Model{defaults(){return{connection_status:o.Strophe.Status.DISCONNECTED,message:""}}initialize(){super.initialize();const{api:e}=n.default;this.on("change",(()=>e.trigger("connfeedback",n.default.connfeedback)))}}const a=i},"./src/headless/shared/connection/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Connection:()=>p,MockConnection:()=>g});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/headless/log.js"),o=s("./node_modules/sizzle/dist/sizzle.js"),i=s.n(o),a=s("./src/headless/shared/_converse.js"),l=s("./src/headless/shared/api/index.js"),c=s("./src/headless/shared/constants.js"),d=s("./node_modules/strophe.js/src/index.js"),u=s("./src/headless/utils/core.js"),h=s("./node_modules/@converse/openpromise/openpromise.js"),f=s("./src/headless/utils/init.js");const m=Object.keys(d.Strophe.Status).reduce(((e,t)=>Math.max(e,d.Strophe.Status[t])),0);d.Strophe.Status.RECONNECTING=m+1;class p extends d.Strophe.Connection{constructor(e,t){super(e,t),this.debouncedReconnect=(0,n.default)(this.reconnect,3e3)}static generateResource(){return`/converse.js-${Math.floor(139749528*Math.random()).toString()}`}async bind(){await l.default.trigger("beforeResourceBinding",{synchronous:!0}),super.bind()}async onDomainDiscovered(e){const t=await e.text(),s=(new window.DOMParser).parseFromString(t,"text/xml").firstElementChild;if("XRD"!=s.nodeName||"http://docs.oasis-open.org/ns/xri/xrd-1.0"!=s.namespaceURI)return r.default.warn("Could not discover XEP-0156 connection methods");const n=i()('Link[rel="urn:xmpp:alt-connections:xbosh"]',s),o=i()('Link[rel="urn:xmpp:alt-connections:websocket"]',s),a=n.map((e=>e.getAttribute("href"))),c=o.map((e=>e.getAttribute("href")));0===a.length&&0===c.length?r.default.warn("Neither BOSH nor WebSocket connection methods have been specified with XEP-0156."):(l.default.settings.set("websocket_url",c.pop()),l.default.settings.set("bosh_service_url",a.pop()),this.service=l.default.settings.get("websocket_url")||l.default.settings.get("bosh_service_url"),this.setProtocol())}async discoverConnectionMethods(e){const t={mode:"cors",headers:{Accept:"application/xrd+xml, text/xml"}},s=`https://${e}/.well-known/host-meta`;let n;try{n=await fetch(s,t)}catch(e){return r.default.error(`Failed to discover alternative connection methods at ${s}`),void r.default.error(e)}n.status>=200&&n.status<400?await this.onDomainDiscovered(n):r.default.warn("Could not discover XEP-0156 connection methods")}async connect(e,t,s){if(l.default.settings.get("discover_connection_methods")){const t=d.Strophe.getDomainFromJid(e);await this.discoverConnectionMethods(t)}if(!l.default.settings.get("bosh_service_url")&&!l.default.settings.get("websocket_url"))throw new Error("You must supply a value for either the bosh_service_url or websocket_url or both.");super.connect(e,t,s||this.onConnectStatusChanged,c.BOSH_WAIT)}async switchTransport(){l.default.connection.isType("websocket")&&l.default.settings.get("bosh_service_url")?(await(0,f.setUserJID)(a.default.bare_jid),this._proto._doDisconnect(),this._proto=new d.Strophe.Bosh(this),this.service=l.default.settings.get("bosh_service_url")):l.default.connection.isType("bosh")&&l.default.settings.get("websocket_url")&&(l.default.settings.get("authentication")===c.ANONYMOUS?await(0,f.setUserJID)(l.default.settings.get("jid")):await(0,f.setUserJID)(a.default.bare_jid),this._proto._doDisconnect(),this._proto=new d.Strophe.Websocket(this),this.service=l.default.settings.get("websocket_url"))}async reconnect(){r.default.debug("RECONNECTING: the connection has dropped, attempting to reconnect."),this.reconnecting=!0,await(0,u.tearDown)();const e=a.default.connfeedback.get("connection_status");return e===d.Strophe.Status.CONNFAIL?this.switchTransport():e===d.Strophe.Status.AUTHFAIL&&l.default.settings.get("authentication")===c.ANONYMOUS&&await(0,f.setUserJID)(l.default.settings.get("jid")),l.default.trigger("will-reconnect"),l.default.settings.get("authentication")===c.ANONYMOUS&&await(0,u.clearSession)(),l.default.user.login()}async onConnected(e){delete this.reconnecting,this.flush(),await(0,f.setUserJID)(this.jid),a.default.config.get("trusted")&&localStorage.setItem("conversejs-session-jid",a.default.bare_jid),await l.default.trigger("afterResourceBinding",e,{synchronous:!0}),e?l.default.trigger("reconnected"):l.default.trigger("connected")}setDisconnectionCause(e,t,s){void 0===e?(delete this.disconnection_cause,delete this.disconnection_reason):(void 0===this.disconnection_cause||s)&&(this.disconnection_cause=e,this.disconnection_reason=t)}setConnectionStatus(e,t){this.status=e,a.default.connfeedback.set({connection_status:e,message:t})}async finishDisconnection(){r.default.debug("DISCONNECTED"),delete this.reconnecting,this.reset(),(0,u.tearDown)(),await(0,u.clearSession)(),delete a.default.connection,l.default.trigger("disconnected")}onDisconnected(){if(!l.default.settings.get("auto_reconnect"))return this.finishDisconnection();{const e=this.disconnection_reason;if(this.disconnection_cause===d.Strophe.Status.AUTHFAIL)return l.default.settings.get("credentials_url")||l.default.settings.get("authentication")===c.ANONYMOUS?l.default.connection.reconnect():this.finishDisconnection();if(this.status===d.Strophe.Status.CONNECTING){const{__:e}=a.default;return this.setConnectionStatus(d.Strophe.Status.CONNFAIL,e("An error occurred while connecting to the chat server.")),this.finishDisconnection()}if(this.disconnection_cause===c.LOGOUT||e===d.Strophe.ErrorCondition.NO_AUTH_MECH||"host-unknown"===e||"remote-connection-failed"===e)return this.finishDisconnection();l.default.connection.reconnect()}}onConnectStatusChanged(e,t){const{__:s}=a.default;if(r.default.debug(`Status changed to: ${c.CONNECTION_STATUS[e]}`),e===d.Strophe.Status.ATTACHFAIL)this.setConnectionStatus(e),this.worker_attach_promise?.resolve(!1);else if(e===d.Strophe.Status.CONNECTED||e===d.Strophe.Status.ATTACHED){if(this.worker_attach_promise?.isResolved&&this.status===d.Strophe.Status.ATTACHED)return;this.setConnectionStatus(e),this.worker_attach_promise?.resolve(!0),a.default.send_initial_presence=!0,this.setDisconnectionCause(),this.reconnecting?(r.default.debug(e===d.Strophe.Status.CONNECTED?"Reconnected":"Reattached"),this.onConnected(!0)):(r.default.debug(e===d.Strophe.Status.CONNECTED?"Connected":"Attached"),this.restored&&(a.default.send_initial_presence=!1),this.onConnected())}else if(e===d.Strophe.Status.DISCONNECTED)this.setDisconnectionCause(e,t),this.onDisconnected();else if(e===d.Strophe.Status.BINDREQUIRED)this.bind();else if(e===d.Strophe.Status.ERROR)this.setConnectionStatus(e,s("An error occurred while connecting to the chat server."));else if(e===d.Strophe.Status.CONNECTING)this.setConnectionStatus(e);else if(e===d.Strophe.Status.AUTHENTICATING)this.setConnectionStatus(e);else if(e===d.Strophe.Status.AUTHFAIL)t||(t=s("Your XMPP address and/or password is incorrect. Please try again.")),this.setConnectionStatus(e,t),this.setDisconnectionCause(e,t,!0),this.onDisconnected();else if(e===d.Strophe.Status.CONNFAIL){let n=t;"host-unknown"===t||"remote-connection-failed"==t?n=s("Sorry, we could not connect to the XMPP host with domain: %1$s",`"${d.Strophe.getDomainFromJid(this.jid)}"`):void 0!==t&&t===d.Strophe?.ErrorCondition?.NO_AUTH_MECH&&(n=s("The XMPP server did not offer a supported authentication mechanism")),this.setConnectionStatus(e,n),this.setDisconnectionCause(e,t)}else e===d.Strophe.Status.DISCONNECTING&&this.setDisconnectionCause(e,t)}isType(e){return"websocket"===e.toLowerCase()?this._proto instanceof d.Strophe.Websocket:"bosh"===e.toLowerCase()?d.Strophe.Bosh&&this._proto instanceof d.Strophe.Bosh:void 0}hasResumed(){return l.default.settings.get("connection_options")?.worker||this.isType("bosh")?a.default.connfeedback.get("connection_status")===d.Strophe.Status.ATTACHED:!this.do_bind}restoreWorkerSession(){return this.attach(this.onConnectStatusChanged),this.worker_attach_promise=(0,h.getOpenPromise)(),this.worker_attach_promise}}class g extends p{constructor(e,t){super(e,t),this.sent_stanzas=[],this.IQ_stanzas=[],this.IQ_ids=[],this.features=d.Strophe.xmlHtmlNode('<stream:features xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client"><ver xmlns="urn:xmpp:features:rosterver"/><csi xmlns="urn:xmpp:csi:0"/><this xmlns="http://jabber.org/protocol/caps" ver="UwBpfJpEt3IoLYfWma/o/p3FFRo=" hash="sha-1" node="http://prosody.im"/><bind xmlns="urn:ietf:params:xml:ns:xmpp-bind"><required/></bind><sm xmlns=\'urn:xmpp:sm:3\'/><session xmlns="urn:ietf:params:xml:ns:xmpp-session"><optional/></session></stream:features>').firstChild,this._proto._processRequest=()=>{},this._proto._disconnect=()=>this._onDisconnectTimeout(),this._proto._onDisconnectTimeout=()=>{},this._proto._connect=()=>{this.connected=!0,this.mock=!0,this.jid="romeo@montague.lit/orchard",this._changeConnectStatus(d.Strophe.Status.BINDREQUIRED)}}_processRequest(){}sendIQ(e,t,s){e=e.tree?.()??e,this.IQ_stanzas.push(e);const n=super.sendIQ(e,t,s);return this.IQ_ids.push(n),n}send(e){return e=e.tree?.()??e,this.sent_stanzas.push(e),super.send(e)}async bind(){await l.default.trigger("beforeResourceBinding",{synchronous:!0}),this.authenticated=!0,a.default.no_connection_on_bind||this._changeConnectStatus(d.Strophe.Status.CONNECTED)}}},"./src/headless/shared/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ACTIVE:()=>y,ANONYMOUS:()=>a,BOSH_WAIT:()=>r,CHATROOMS_TYPE:()=>x,CHAT_STATES:()=>k,CLOSED:()=>l,COMPOSING:()=>b,CONNECTION_STATUS:()=>C,CONTROLBOX_TYPE:()=>A,CORE_PLUGINS:()=>T,DEFAULT_IMAGE:()=>_,DEFAULT_IMAGE_TYPE:()=>g,EXTERNAL:()=>c,FAILURE:()=>p,GONE:()=>w,HEADLINES_TYPE:()=>E,INACTIVE:()=>v,KEYCODES:()=>N,LOGIN:()=>d,LOGOUT:()=>u,OPENED:()=>h,PAUSED:()=>j,PREBIND:()=>f,PRIVATE_CHAT_TYPE:()=>S,STATUS_WEIGHTS:()=>i,SUCCESS:()=>m,URL_PARSE_OPTIONS:()=>I,VERSION_NAME:()=>o});var n=s("./node_modules/strophe.js/src/index.js");const r=59,o="v10.1.5",i={offline:6,unavailable:5,xa:4,away:3,dnd:2,chat:1,online:1},a="anonymous",l="closed",c="external",d="login",u="logout",h="opened",f="prebind",m="success",p="failure",g="image/svg+xml",_="PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+CiA8cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzU1NSIvPgogPGNpcmNsZSBjeD0iNjQiIGN5PSI0MSIgcj0iMjQiIGZpbGw9IiNmZmYiLz4KIDxwYXRoIGQ9Im0yOC41IDExMiB2LTEyIGMwLTEyIDEwLTI0IDI0LTI0IGgyMyBjMTQgMCAyNCAxMiAyNCAyNCB2MTIiIGZpbGw9IiNmZmYiLz4KPC9zdmc+Cg==",v="inactive",y="active",b="composing",j="paused",w="gone",S="chatbox",x="chatroom",E="headline",A="controlbox",C={};C[n.Strophe.Status.ATTACHED]="ATTACHED",C[n.Strophe.Status.AUTHENTICATING]="AUTHENTICATING",C[n.Strophe.Status.AUTHFAIL]="AUTHFAIL",C[n.Strophe.Status.CONNECTED]="CONNECTED",C[n.Strophe.Status.CONNECTING]="CONNECTING",C[n.Strophe.Status.CONNFAIL]="CONNFAIL",C[n.Strophe.Status.DISCONNECTED]="DISCONNECTED",C[n.Strophe.Status.DISCONNECTING]="DISCONNECTING",C[n.Strophe.Status.ERROR]="ERROR",C[n.Strophe.Status.RECONNECTING]="RECONNECTING",C[n.Strophe.Status.REDIRECT]="REDIRECT",n.Strophe.addNamespace("ACTIVITY","http://jabber.org/protocol/activity"),n.Strophe.addNamespace("CARBONS","urn:xmpp:carbons:2"),n.Strophe.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),n.Strophe.addNamespace("CSI","urn:xmpp:csi:0"),n.Strophe.addNamespace("DELAY","urn:xmpp:delay"),n.Strophe.addNamespace("EME","urn:xmpp:eme:0"),n.Strophe.addNamespace("FASTEN","urn:xmpp:fasten:0"),n.Strophe.addNamespace("FORWARD","urn:xmpp:forward:0"),n.Strophe.addNamespace("HINTS","urn:xmpp:hints"),n.Strophe.addNamespace("HTTPUPLOAD","urn:xmpp:http:upload:0"),n.Strophe.addNamespace("MAM","urn:xmpp:mam:2"),n.Strophe.addNamespace("MARKERS","urn:xmpp:chat-markers:0"),n.Strophe.addNamespace("MENTIONS","urn:xmpp:mmn:0"),n.Strophe.addNamespace("MESSAGE_CORRECT","urn:xmpp:message-correct:0"),n.Strophe.addNamespace("MODERATE","urn:xmpp:message-moderate:0"),n.Strophe.addNamespace("NICK","http://jabber.org/protocol/nick"),n.Strophe.addNamespace("OCCUPANTID","urn:xmpp:occupant-id:0"),n.Strophe.addNamespace("OMEMO","eu.siacs.conversations.axolotl"),n.Strophe.addNamespace("OUTOFBAND","jabber:x:oob"),n.Strophe.addNamespace("PUBSUB","http://jabber.org/protocol/pubsub"),n.Strophe.addNamespace("RAI","urn:xmpp:rai:0"),n.Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts"),n.Strophe.addNamespace("REFERENCE","urn:xmpp:reference:0"),n.Strophe.addNamespace("REGISTER","jabber:iq:register"),n.Strophe.addNamespace("RETRACT","urn:xmpp:message-retract:0"),n.Strophe.addNamespace("ROSTERX","http://jabber.org/protocol/rosterx"),n.Strophe.addNamespace("RSM","http://jabber.org/protocol/rsm"),n.Strophe.addNamespace("SID","urn:xmpp:sid:0"),n.Strophe.addNamespace("SPOILER","urn:xmpp:spoiler:0"),n.Strophe.addNamespace("STANZAS","urn:ietf:params:xml:ns:xmpp-stanzas"),n.Strophe.addNamespace("STYLING","urn:xmpp:styling:0"),n.Strophe.addNamespace("VCARD","vcard-temp"),n.Strophe.addNamespace("VCARDUPDATE","vcard-temp:x:update"),n.Strophe.addNamespace("XFORM","jabber:x:data"),n.Strophe.addNamespace("XHTML","http://www.w3.org/1999/xhtml");const T=["converse-adhoc","converse-bookmarks","converse-bosh","converse-caps","converse-chat","converse-chatboxes","converse-disco","converse-emoji","converse-headlines","converse-mam","converse-muc","converse-ping","converse-pubsub","converse-roster","converse-smacks","converse-status","converse-vcard"],I={start:/(\b|_)(?:([a-z][a-z0-9.+-]*:\/\/)|xmpp:|mailto:|www\.)/gi},k=["active","composing","gone","inactive","paused"],N={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,FORWARD_SLASH:47,AT:50,META:91,META_RIGHT:93}},"./src/headless/shared/errors.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{TimeoutError:()=>n});class n extends Error{}},"./src/headless/shared/i18n.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/sprintf-js/src/sprintf.js");const r={initialize(){},__(){return(0,n.sprintf)(...arguments)}}},"./src/headless/shared/parsers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{StanzaParseError:()=>v,getAttributes:()=>L,getChatMarker:()=>$,getChatState:()=>N,getCorrectionAttributes:()=>w,getEncryptionAttributes:()=>b,getErrorAttributes:()=>C,getMediaURLsMetadata:()=>x,getOpenGraphMetadata:()=>S,getOutOfBandAttributes:()=>A,getReceiptId:()=>I,getReferences:()=>T,getRetractionAttributes:()=>j,getSpoilerAttributes:()=>E,getStanzaIDs:()=>y,isArchived:()=>P,isCarbon:()=>k,isHeadline:()=>R,isServerMessage:()=>D,isValidReceiptRequest:()=>O,throwErrorIfInvalidForward:()=>M});var n=s("./node_modules/urijs/src/URI.js"),r=s.n(n),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/shared/api/index.js"),a=s("./node_modules/dayjs/dayjs.min.js"),l=s.n(a),c=s("./src/headless/log.js"),d=s("./node_modules/sizzle/dist/sizzle.js"),u=s.n(d),h=s("./node_modules/strophe.js/src/index.js"),f=s("./src/headless/shared/constants.js"),m=s("./src/headless/utils/core.js"),p=s("./src/headless/shared/actions.js"),g=s("./src/headless/utils/url.js");const{NS:_}=h.Strophe;class v extends Error{constructor(e,t){super(e,t),this.name="StanzaParseError",this.stanza=t}}function y(e,t){const s={},n=u()(`stanza-id[xmlns="${h.Strophe.NS.SID}"]`,e).reduce(((e,t)=>(e[`stanza_id ${t.getAttribute("by")}`]=t.getAttribute("id"),e)),{});Object.assign(s,n);const r=u()(`message > result[xmlns="${h.Strophe.NS.MAM}"]`,t).pop();if(r){s[`stanza_id ${t.getAttribute("from")||o.default.bare_jid}`]=r.getAttribute("id")}const i=u()(`origin-id[xmlns="${h.Strophe.NS.SID}"]`,e).pop();return i&&(s.origin_id=i.getAttribute("id")),s}function b(e){const t=u()(`encryption[xmlns="${h.Strophe.NS.EME}"]`,e).pop(),s=t?.getAttribute("namespace"),n={};return s?(n.is_encrypted=!0,n.encryption_namespace=s):u()(`encrypted[xmlns="${h.Strophe.NS.OMEMO}"]`,e).pop()&&(n.is_encrypted=!0,n.encryption_namespace=h.Strophe.NS.OMEMO),n}function j(e,t){const s=u()(`> apply-to[xmlns="${h.Strophe.NS.FASTEN}"]`,e).pop();if(s){const e=s.getAttribute("id");if(u()(`> retract[xmlns="${h.Strophe.NS.RETRACT}"]`,s).pop()){const s=u()(`delay[xmlns="${h.Strophe.NS.DELAY}"]`,t).pop();return{editable:!1,retracted:s?l()(s.getAttribute("stamp")).toISOString():(new Date).toISOString(),retracted_id:e}}}else{const t=u()(`> retracted[xmlns="${h.Strophe.NS.RETRACT}"]`,e).pop();if(t)return{editable:!1,is_tombstone:!0,retracted:t.getAttribute("stamp")}}return{}}function w(e,t){const s=u()(`replace[xmlns="${h.Strophe.NS.MESSAGE_CORRECT}"]`,e).pop();if(s){const e=s.getAttribute("id");if(e){const s=u()(`delay[xmlns="${h.Strophe.NS.DELAY}"]`,t).pop();return{replace_id:e,edited:s?l()(s.getAttribute("stamp")).toISOString():(new Date).toISOString()}}}return{}}function S(e){const t=u()(`> apply-to[xmlns="${h.Strophe.NS.FASTEN}"]`,e).pop();if(t){const e=t.getAttribute("id"),s=u()(`> meta[xmlns="${h.Strophe.NS.XHTML}"]`,t);if(s.length){const t=i.default.settings.get("message_limit"),n=s.reduce(((e,s)=>{const n=s.getAttribute("property");if(n){let r=(0,m.decodeHTMLEntities)(s.getAttribute("content")||"");t&&"og:description"===n&&r.length>=t&&(r=`${r.slice(0,t)}${(0,m.decodeHTMLEntities)("&#8230;")}`),e[n]=r}return e}),{ogp_for_id:e});if("og:description"in n||"og:title"in n||"og:image"in n)return n}}return{}}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const s=[];if(!e)return{};try{r().withinString(e,((e,n,r)=>(e.startsWith("_")&&(e=e.slice(1),n+=1),e.endsWith("_")&&(e=e.slice(0,e.length-1),r-=1),s.push({url:e,start:n+t,end:r+t}),e)),f.URL_PARSE_OPTIONS)}catch(e){c.default.debug(e)}const n=s.map((e=>({end:e.end,is_audio:(0,g.isAudioURL)(e.url),is_image:(0,g.isImageURL)(e.url),is_video:(0,g.isVideoURL)(e.url),is_encrypted:(0,g.isEncryptedFileURL)(e.url),start:e.start})));return n.length?{media_urls:n}:{}}function E(e){const t=u()(`spoiler[xmlns="${h.Strophe.NS.SPOILER}"]`,e).pop();return{is_spoiler:!!t,spoiler_hint:t?.textContent}}function A(e){const t=u()(`x[xmlns="${h.Strophe.NS.OUTOFBAND}"]`,e).pop();return t?{oob_url:t.querySelector("url")?.textContent,oob_desc:t.querySelector("desc")?.textContent}:{}}function C(e){if("error"===e.getAttribute("type")){const t=e.querySelector("error"),s=u()(`text[xmlns="${h.Strophe.NS.STANZAS}"]`,t).pop();return{is_error:!0,error_text:s?.textContent,error_type:t.getAttribute("type"),error_condition:t.firstElementChild.nodeName}}return{}}function T(e){return u()(`reference[xmlns="${h.Strophe.NS.REFERENCE}"]`,e).map((t=>{const s=t.getAttribute("anchor"),n=e.querySelector(s?`#${s}`:"body")?.textContent;if(!n)return c.default.warn(`Could not find referenced text for ${t}`),null;const r=t.getAttribute("begin"),o=t.getAttribute("end");return{begin:r,end:o,type:t.getAttribute("type"),value:n.slice(r,o),uri:t.getAttribute("uri")}})).filter((e=>e))}function I(e){const t=u()(`received[xmlns="${h.Strophe.NS.RECEIPTS}"]`,e).pop();return t?.getAttribute("id")}function k(e){const t=h.Strophe.NS.CARBONS;return u()(`message > received[xmlns="${t}"]`,e).length>0||u()(`message > sent[xmlns="${t}"]`,e).length>0}function N(e){return u()(`\n        composing[xmlns="${_.CHATSTATES}"],\n        paused[xmlns="${_.CHATSTATES}"],\n        inactive[xmlns="${_.CHATSTATES}"],\n        active[xmlns="${_.CHATSTATES}"],\n        gone[xmlns="${_.CHATSTATES}"]`,e).pop()?.nodeName}function O(e,t){return"me"!==t.sender&&!t.is_carbon&&!t.is_archived&&u()(`request[xmlns="${h.Strophe.NS.RECEIPTS}"]`,e).length}function M(e){if(u()(`message > forwarded[xmlns="${h.Strophe.NS.FORWARD}"]`,e).length){(0,p.rejectMessage)(e,"Forwarded messages not part of an encapsulating protocol are not supported");const t=e.getAttribute("from");throw new v(`Ignoring unencapsulated forwarded message from ${t}`,e)}}function $(e){return u()(`\n        acknowledged[xmlns="${h.Strophe.NS.MARKERS}"],\n        displayed[xmlns="${h.Strophe.NS.MARKERS}"],\n        received[xmlns="${h.Strophe.NS.MARKERS}"]`,e).pop()}function R(e){return"headline"===e.getAttribute("type")}function D(e){if(u()(`mentions[xmlns="${h.Strophe.NS.MENTIONS}"]`,e).pop())return!1;const t=e.getAttribute("from");return!("error"===e.getAttribute("type")||!t||t.includes("@"))}function P(e){return!!u()(`message > result[xmlns="${h.Strophe.NS.MAM}"]`,e).pop()}function L(e){return e.getAttributeNames().reduce(((t,s)=>(t[s]=h.Strophe.xmlunescape(e.getAttribute(s)),t)),{})}},"./src/headless/shared/settings/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{settings_api:()=>o,user_settings_api:()=>i});var n=s("./src/headless/log.js"),r=s("./src/headless/shared/settings/utils.js");const o={extend:e=>(0,r.extendAppSettings)(e),update(e){return n.default.warn("The api.settings.update method has been deprecated and will be removed. Please use api.settings.extend instead."),this.extend(e)},get:e=>(0,r.getAppSetting)(e),set(e,t){(0,r.updateAppSettings)(e,t)},listen:{on(e,t,s){(0,r.registerListener)(e,t,s)},not(e,t){(0,r.unregisterListener)(e,t)}}},i={getModel:()=>(0,r.getUserSettings)(),async get(e,t){const s=await(0,r.getUserSettings)();return void 0===s.get(e)?t:s.get(e)},set(e,t){if(e instanceof Object)return(0,r.updateUserSettings)(e,{promise:!0});{const s={};return s[e]=t,(0,r.updateUserSettings)(s,{promise:!0})}},clear:()=>(0,r.clearUserSettings)()}},"./src/headless/shared/settings/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{DEFAULT_SETTINGS:()=>n});const n={allow_non_roster_messaging:!1,allow_url_history_change:!0,assets_path:"/dist",authentication:"login",auto_login:!1,reuse_scram_keys:!1,auto_reconnect:!0,blacklisted_plugins:[],clear_cache_on_logout:!1,connection_options:{},credentials_url:null,discover_connection_methods:!0,geouri_regex:/https\:\/\/www.openstreetmap.org\/.*#map=[0-9]+\/([\-0-9.]+)\/([\-0-9.]+)\S*/g,geouri_replacement:"https://www.openstreetmap.org/?mlat=$1&mlon=$2#map=18/$1/$2",i18n:void 0,jid:void 0,keepalive:!0,loglevel:"info",locales:["af","ar","bg","ca","cs","da","de","el","en","eo","es","eu","fa","fi","fr","gl","he","hi","hu","id","it","ja","lt","mr","nb","nl","oc","pl","pt","pt_BR","ro","ru","sv","th","tr","ug","uk","vi","zh_CN","zh_TW"],nickname:void 0,password:void 0,persistent_store:"IndexedDB",rid:void 0,root:window.document,sid:void 0,singleton:!1,strict_plugin_dependencies:!1,stanza_timeout:2e4,view_mode:"overlayed",websocket_url:void 0,whitelisted_plugins:[]}},"./src/headless/shared/settings/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearUserSettings:()=>A,extendAppSettings:()=>y,getAppSetting:()=>v,getAppSettings:()=>p,getInitSettings:()=>_,getUserSettings:()=>x,initAppSettings:()=>g,registerListener:()=>b,unregisterListener:()=>j,updateAppSettings:()=>w,updateUserSettings:()=>E});var n=s("./src/headless/shared/_converse.js"),r=s("./node_modules/lodash-es/isEqual.js"),o=s("./src/headless/log.js"),i=s("./node_modules/lodash-es/pick.js"),a=s("./src/headless/utils/core.js"),l=s("./src/headless/shared/settings/constants.js"),c=s("./node_modules/@converse/skeletor/src/events.js"),d=s("./node_modules/@converse/skeletor/src/model.js"),u=s("./src/headless/utils/storage.js");let h,f,m={};function p(){return h}function g(e){m=e,h={},Object.assign(h,c.Events);const t=(0,i.default)(e,Object.keys(l.DEFAULT_SETTINGS));Object.assign(h,l.DEFAULT_SETTINGS,t)}function _(){return m}function v(e){if(Object.keys(l.DEFAULT_SETTINGS).includes(e))return h[e]}function y(e){a.default.merge(l.DEFAULT_SETTINGS,e);const t=Object.keys(e).filter((e=>e in l.DEFAULT_SETTINGS)),s=(0,i.default)(m,t),n=Object.assign((0,i.default)(e,t),s);a.default.merge(h,n)}function b(e,t,s){h.on(e,t,s)}function j(e,t){h.off(e,t)}function w(e,t){if(null==e)return this;let s;e instanceof Object?s=e:"string"==typeof e&&(s={},s[e]=t);const n=Object.keys(s).filter((e=>e in l.DEFAULT_SETTINGS)),o={};n.forEach((e=>{const t=s[e];(0,r.default)(h[e],t)||(o[e]=t,h[e]=t)})),Object.keys(o).forEach((e=>h.trigger("change:"+e,o[e]))),h.trigger("change",o)}function S(){if(!n.default.bare_jid){const e="No JID to fetch user settings for";throw o.default.error(e),Error(e)}if(!f?.fetched){const e=`converse.user-settings.${n.default.bare_jid}`;f=new d.Model({id:e}),(0,u.initStorage)(f,e),f.fetched=f.fetch({promise:!0})}return f.fetched}async function x(){return await S(),f}async function E(e,t){return await S(),f.save(e,t)}async function A(){return await S(),f.clear()}},"./src/headless/utils/arraybuffer.js":(e,t,s)=>{"use strict";function n(e,t){const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer}function r(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}function o(e){return new TextDecoder("utf-8").decode(e)}function i(e){return new TextEncoder("utf-8").encode(e).buffer}function a(e){return btoa(new Uint8Array(e).reduce(((e,t)=>e+String.fromCharCode(t)),""))}function l(e){const t=window.atob(e),s=t.length,n=new Uint8Array(s);for(let e=0;e<s;e++)n[e]=t.charCodeAt(e);return n.buffer}function c(e){return new Uint8Array(e.match(/[\da-f]{2}/gi).map((e=>parseInt(e,16)))).buffer}s.r(t),s.d(t,{appendArrayBuffer:()=>n,arrayBufferToBase64:()=>a,arrayBufferToHex:()=>r,arrayBufferToString:()=>o,base64ToArrayBuffer:()=>l,hexToArrayBuffer:()=>c,stringToArrayBuffer:()=>i})},"./src/headless/utils/core.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearSession:()=>E,decodeHTMLEntities:()=>L,default:()=>F,getRandomInt:()=>N,getUniqueId:()=>O,isEmptyMessage:()=>j,isError:()=>y,isErrorObject:()=>T,isFunction:()=>b,isUniView:()=>w,isValidJID:()=>C,merge:()=>I,prefixMentions:()=>A,replacePromise:()=>D,safeSave:()=>k,saveWindowState:()=>z,setUnloadEvent:()=>R,shouldClearCache:()=>S,tearDown:()=>x,waitUntil:()=>$});var n=s("./node_modules/dompurify/dist/purify.js"),r=s.n(n),o=s("./src/headless/shared/_converse.js"),i=s("./src/headless/log.js"),a=s("./node_modules/sizzle/dist/sizzle.js"),l=s.n(a),c=s("./node_modules/@converse/skeletor/src/model.js"),d=s("./node_modules/strophe.js/src/index.js"),u=s("./node_modules/@converse/openpromise/openpromise.js"),h=s("./src/headless/shared/settings/api.js"),f=s("./src/headless/utils/stanza.js"),m=s("./src/headless/utils/form.js"),p=s("./src/headless/utils/html.js"),g=s("./src/headless/utils/arraybuffer.js"),_=s("./src/headless/utils/url.js");const v={arrayBufferToBase64:g.arrayBufferToBase64,arrayBufferToHex:g.arrayBufferToHex,arrayBufferToString:g.arrayBufferToString,base64ToArrayBuffer:g.base64ToArrayBuffer,checkFileTypes:_.checkFileTypes,getSelectValues:m.getSelectValues,getURI:_.getURI,isAllowedProtocolForMedia:_.isAllowedProtocolForMedia,isAudioURL:_.isAudioURL,isGIFURL:_.isGIFURL,isImageURL:_.isImageURL,isURLWithImageExtension:_.isURLWithImageExtension,isVideoURL:_.isVideoURL,shouldRenderMediaFromURL:_.shouldRenderMediaFromURL,stringToArrayBuffer:g.stringToArrayBuffer,webForm2xForm:m.webForm2xForm};function y(e){return"[object Error]"===Object.prototype.toString.call(e)}function b(e){return"function"==typeof e}function j(e){return e instanceof c.Model&&(e=e.attributes),!(e.oob_url||e.file||e.is_encrypted&&e.plaintext||e.message||e.body)}function w(){return["mobile","fullscreen","embedded"].includes(h.settings_api.get("view_mode"))}function S(){const{api:e}=o.default;return!o.default.config.get("trusted")||e.settings.get("clear_cache_on_logout")||o.default.isTestEnv()}async function x(){const{api:e}=o.default;return await e.trigger("beforeTearDown",{synchronous:!0}),window.removeEventListener("click",o.default.onUserActivity),window.removeEventListener("focus",o.default.onUserActivity),window.removeEventListener("keypress",o.default.onUserActivity),window.removeEventListener("mousemove",o.default.onUserActivity),window.removeEventListener(o.default.unloadevent,o.default.onUserActivity),window.clearInterval(o.default.everySecondTrigger),e.trigger("afterTearDown"),o.default}function E(){return o.default.session?.destroy(),delete o.default.session,S()&&o.default.api.user.settings.clear(),o.default.api.trigger("clearSession",{synchronous:!0})}function A(e){let t=e.getMessageText();return(e.get("references")||[]).sort(((e,t)=>t.begin-e.begin)).forEach((e=>{t=`${t.slice(0,e.begin)}@${t.slice(e.begin)}`})),t}function C(e){return"string"==typeof e&&(2===e.split("@").filter((e=>!!e)).length&&!e.startsWith("@")&&!e.endsWith("@"))}function T(e){return e instanceof Error}function I(e,t){for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&"__proto__"!==s&&"constructor"!==s&&(e[s]instanceof Object?I(e[s],t[s]):e[s]=t[s])}function k(e,t,s){v.isPersistableModel(e)?e.save(t,s):e.set(t,s)}function N(e){return Math.random()*e|0}function O(e){const t=crypto.randomUUID?.()??"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=N(16);return("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?t+":"+e:t}function M(e,t){clearTimeout(e),clearInterval(t)}function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;try{const t=e();if(t)return Promise.resolve(t)}catch(e){return Promise.reject(e)}const n=(0,u.getOpenPromise)(),r=new Error;const o=setInterval((function(){try{const t=e();t&&(M(a,o),n.resolve(t))}catch(e){M(a,o),n.reject(e)}}),s);const a=setTimeout((function(){M(a,o);const e=`Wait until promise timed out: \n\n${r.stack}`;console.trace(),i.default.error(e),n.reject(new Error(e))}),t);return n}function R(){"onpagehide"in window?o.default.unloadevent="pagehide":"onbeforeunload"in window?o.default.unloadevent="beforeunload":"onunload"in window&&(o.default.unloadevent="unload")}function D(e){const t=o.default.promises[e];if(!t)throw new Error(`Tried to replace non-existing promise: ${e}`);if(t.replace){const s=(0,u.getOpenPromise)();s.replace=t.replace,o.default.promises[e]=s}else i.default.debug(`Not replacing promise "${e}"`)}v.getJIDFromURI=function(e){return e.startsWith("xmpp:")&&e.endsWith("?join")?e.replace(/^xmpp:/,"").replace(/\?join$/,""):e},v.getLongestSubstring=function(e,t){return t.reduce((function(t,s){return e.startsWith(s)&&s.length>t.length?s:t}),"")},v.isValidMUCJID=function(e){return!e.startsWith("@")&&!e.endsWith("@")},v.isSameBareJID=function(e,t){return"string"==typeof e&&"string"==typeof t&&d.Strophe.getBareJidFromJid(e).toLowerCase()===d.Strophe.getBareJidFromJid(t).toLowerCase()},v.isSameDomain=function(e,t){return"string"==typeof e&&"string"==typeof t&&d.Strophe.getDomainFromJid(e).toLowerCase()===d.Strophe.getDomainFromJid(t).toLowerCase()},v.isNewMessage=function(e){return e instanceof Element?!(l()(`result[xmlns="${d.Strophe.NS.MAM}"]`,e).length&&l()(`delay[xmlns="${d.Strophe.NS.DELAY}"]`,e).length):(e instanceof c.Model&&(e=e.attributes),!(e.is_delayed&&e.is_archived))},v.shouldCreateMessage=function(e){return e.retracted||!j(e)},v.shouldCreateGroupchatMessage=function(e){return e.nick&&(v.shouldCreateMessage(e)||e.is_tombstone)},v.isChatRoom=function(e){return e&&"chatroom"===e.get("type")},v.isErrorStanza=function(e){return!!(0,p.isElement)(e)&&"error"===e.getAttribute("type")},v.isForbiddenError=function(e){return!!(0,p.isElement)(e)&&l()(`error[type="auth"] forbidden[xmlns="${d.Strophe.NS.STANZAS}"]`,e).length>0},v.isServiceUnavailableError=function(e){return!!(0,p.isElement)(e)&&l()(`error[type="cancel"] service-unavailable[xmlns="${d.Strophe.NS.STANZAS}"]`,e).length>0},v.contains=function(e,t){const s=(e,s)=>e.get(s).toLowerCase().includes(t.toLowerCase());return function(t){if("object"==typeof e)return Object.keys(e).reduce(((e,n)=>e||s(t,n)),!1);if("string"==typeof e)return s(t,e);throw new TypeError("contains: wrong attribute type. Must be string or array.")}},v.getAttribute=function(e,t){return t.get(e)},v.contains.not=function(e,t){return function(s){return!v.contains(e,t)(s)}},v.isPersistableModel=function(e){return e.collection&&e.collection.browserStorage},v.getResolveablePromise=u.getOpenPromise,v.getOpenPromise=u.getOpenPromise,v.onMultipleEvents=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=[];function n(n){s.push(n),e.length===s.length&&(t(s),s=[])}e.forEach((e=>e.object.on(e.event,n)))},v.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t};const P=document.createElement("div");function L(e){return e&&"string"==typeof e&&(P.innerHTML=r().sanitize(e),e=P.textContent,P.textContent=""),e}function z(e){let t;const s={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};t=(e=e||document.createEvent("Events")).type in s?s[e.type]:document.hidden?"hidden":"visible",o.default.windowState=t,o.default.api.trigger("windowStateChanged",{state:t})}const F=Object.assign({getCurrentWord:m.getCurrentWord,getOuterWidth:p.getOuterWidth,getRandomInt:N,isMentionBoundary:m.isMentionBoundary,getUniqueId:O,isElement:p.isElement,isEmptyMessage:j,isErrorObject:T,isTagEqual:p.isTagEqual,isValidJID:C,merge:I,placeCaretAtEnd:m.placeCaretAtEnd,prefixMentions:A,queryChildren:p.queryChildren,replaceCurrentWord:m.replaceCurrentWord,safeSave:k,saveWindowState:z,shouldClearCache:S,stringToElement:p.stringToElement,stx:f.stx,toStanza:f.toStanza,triggerEvent:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Event",n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=document.createEvent(s);o.initEvent(t,n,r),e.dispatchEvent(o)},waitUntil:$},v)},"./src/headless/utils/form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getCurrentWord:()=>l,getSelectValues:()=>i,isMentionBoundary:()=>c,placeCaretAtEnd:()=>u,replaceCurrentWord:()=>d,webForm2xForm:()=>a});var n=s("./src/headless/utils/stanza.js");const r=(e,t)=>`<field var="${e}">${t}</field>`,o=e=>`<value>${e}</value>`;function i(e){const t=[],s=e?.options;for(let e=0,n=s.length;e<n;e++){const n=s[e];n.selected&&t.push(n.value||n.text)}return t}function a(e){const t=e.getAttribute("name");if(!t)return null;let s;return s="checkbox"===e.getAttribute("type")?e.checked?"1":"0":"TEXTAREA"==e.tagName?e.value.split("\n").filter((e=>e.trim())):"SELECT"==e.tagName?i(e):e.value,(0,n.toStanza)(r(t,Array.isArray(s)?s.map(o):o(s)))}function l(e,t,s){t||(t=e.selectionEnd||void 0);let[n]=e.value.slice(0,t).split(/\s/).slice(-1);return s&&([n]=n.split(s).slice(-1)),n}function c(e){return"@"!==e&&RegExp("(\\p{Z}|\\p{P})","u").test(e)}function d(e,t){const s=e.selectionEnd||void 0,n=e.value.slice(0,s).split(/\s/).pop(),r=e.value,o=c(n[0])?n[0]:"";e.value=r.slice(0,s-n.length)+o+`${t} `+r.slice(s);const i=s-n.length+t.length+1;e.selectionEnd=o?i+1:i}function u(e){e!==document.activeElement&&e.focus();const t=2*e.value.length;setTimeout((()=>e.setSelectionRange(t,t)),1),e.scrollTop=999999}},"./src/headless/utils/html.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getOuterWidth:()=>i,isElement:()=>r,isTagEqual:()=>o,queryChildren:()=>l,stringToElement:()=>a});var n=s("./node_modules/strophe.js/src/index.js");function r(e){return e instanceof Element||e instanceof HTMLDocument}function o(e,t){if(e instanceof n.Strophe.Builder)return o(e.tree(),t);if(e instanceof Element)return n.Strophe.isTagEqual(e,t);throw Error("isTagEqual called with value which isn't an element or Strophe.Builder instance")}function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.offsetWidth;if(!t)return s;const n=window.getComputedStyle(e);return s+=parseInt(n.marginLeft?n.marginLeft:"0",10)+parseInt(n.marginRight?n.marginRight:"0",10),s}function a(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function l(e,t){return Array.from(e.childNodes).filter((e=>e instanceof Element&&e.matches(t)))}},"./src/headless/utils/init.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{attemptNonPreboundSession:()=>A,cleanup:()=>x,initClientConfig:()=>v,initConnection:()=>g,initPlugins:()=>_,initSession:()=>w,initSessionStorage:()=>y,registerGlobalEventHandlers:()=>S,savedLoginInfo:()=>C,setUserJID:()=>j});var n=s("./node_modules/@converse/skeletor/src/storage.js"),r=s("./src/headless/shared/_converse.js"),o=s("./node_modules/lodash-es/debounce.js"),i=s("./node_modules/localforage-webextensionstorage-driver/local.js"),a=s("./src/headless/log.js"),l=s("./node_modules/localforage-webextensionstorage-driver/sync.js"),c=s("./src/headless/shared/constants.js"),d=s("./src/headless/shared/connection/index.js"),u=s("./node_modules/@converse/skeletor/src/model.js"),h=s("./node_modules/strophe.js/src/index.js"),f=s("./src/headless/utils/storage.js"),m=s("./src/headless/utils/core.js");function p(){const{api:e}=r.default;return("WebSocket"in window||"MozWebSocket"in window)&&e.settings.get("websocket_url")?e.settings.get("websocket_url"):e.settings.get("bosh_service_url")?e.settings.get("bosh_service_url"):""}function g(){const e=r.default.api;if(!e.settings.get("bosh_service_url")&&e.settings.get("authentication")===c.PREBIND)throw new Error("authentication is set to 'prebind' but we don't have a BOSH connection");const t=r.default.isTestEnv()?d.MockConnection:d.Connection;r.default.connection=new t(p(),Object.assign(r.default.default_connection_options,e.settings.get("connection_options"),{keepalive:e.settings.get("keepalive")})),function(){const e={};e[h.Strophe.LogLevel.DEBUG]="debug",e[h.Strophe.LogLevel.INFO]="info",e[h.Strophe.LogLevel.WARN]="warn",e[h.Strophe.LogLevel.ERROR]="error",e[h.Strophe.LogLevel.FATAL]="fatal",h.Strophe.log=(t,s)=>a.default.log(s,e[t]),h.Strophe.error=e=>a.default.error(e),r.default.connection.xmlInput=e=>a.default.debug(e.outerHTML,"color: darkgoldenrod"),r.default.connection.xmlOutput=e=>a.default.debug(e.outerHTML,"color: darkcyan")}(),e.trigger("connectionInitialized")}function _(e){e.pluggable.initialized_plugins=[];const t=c.CORE_PLUGINS.concat(e.api.settings.get("whitelisted_plugins"));e.api.settings.get("singleton")&&["converse-bookmarks","converse-controlbox","converse-headline","converse-register"].forEach((t=>e.api.settings.get("blacklisted_plugins").push(t))),e.pluggable.initializePlugins({_converse:e},t,e.api.settings.get("blacklisted_plugins")),e.api.trigger("pluginsInitialized")}async function v(e){const t="converse.client-config";e.config=new u.Model({id:t,trusted:!0}),e.config.browserStorage=(0,f.createStore)(t,"session"),await new Promise((t=>e.config.fetch({success:t,error:t}))),e.api.trigger("clientConfigInitialized")}async function y(e){await n.default.sessionStorageInitialized,e.storage={session:n.default.localForage.createInstance({name:e.isTestEnv()?"converse-test-session":"converse-session",description:"sessionStorage instance",driver:["sessionStorageWrapper"]})}}function b(e,t){t=e.session.get("jid")||t,e.api.settings.get("authentication")===c.ANONYMOUS||h.Strophe.getResourceFromJid(t)||(t=t.toLowerCase()+d.Connection.generateResource()),e.jid=t,e.bare_jid=h.Strophe.getBareJidFromJid(t),e.resource=h.Strophe.getResourceFromJid(t),e.domain=h.Strophe.getDomainFromJid(t),e.session.save({jid:t,bare_jid:e.bare_jid,resource:e.resource,domain:e.domain,active:!0}),e.connection.jid=t}async function j(e){return await w(r.default,e),r.default.api.trigger("setUserJID"),e}async function w(e,t){const s=e.api.settings.get("connection_options").worker,r=h.Strophe.getBareJidFromJid(t).toLowerCase(),o=`converse.session-${r}`;e.session?.get("id")!==o?(!function(e,t){if("sessionStorage"===e.api.settings.get("persistent_store"))return;if("BrowserExtLocal"===e.api.settings.get("persistent_store"))return n.default.localForage.defineDriver(i.default).then((()=>n.default.localForage.setDriver("webExtensionLocalStorage"))),void(e.storage.persistent=n.default.localForage);if("BrowserExtSync"===e.api.settings.get("persistent_store"))return n.default.localForage.defineDriver(l.default).then((()=>n.default.localForage.setDriver("webExtensionSyncStorage"))),void(e.storage.persistent=n.default.localForage);const s={name:e.isTestEnv()?"converse-test-persistent":"converse-persistent",storeName:t};"localStorage"===e.api.settings.get("persistent_store")?(s.description="localStorage instance",s.driver=[n.default.localForage.LOCALSTORAGE]):"IndexedDB"===e.api.settings.get("persistent_store")&&(s.description="indexedDB instance",s.driver=[n.default.localForage.INDEXEDDB]),e.storage.persistent=n.default.localForage.createInstance(s)}(e,r),e.session=new u.Model({id:o}),(0,f.initStorage)(e.session,o,s?"persistent":"session"),await new Promise((t=>e.session.fetch({success:t,error:t}))),!s&&e.session.get("active")&&(e.session.clear(),e.session.save({id:o})),b(e,t),window.addEventListener(e.unloadevent,(()=>e.session?.save("active",!1))),e.api.trigger("userSessionInitialized")):b(e,t)}function S(e){document.addEventListener("visibilitychange",m.saveWindowState),(0,m.saveWindowState)({type:document.hidden?"blur":"focus"}),e.api.trigger("registeredGlobalEventHandlers")}async function x(e){const{api:t}=e;await t.trigger("cleanup",{synchronous:!0}),e.router.history.stop(),function(e){const{api:t}=e;document.removeEventListener("visibilitychange",m.saveWindowState),t.trigger("unregisteredGlobalEventHandlers")}(e),e.connection?.reset(),e.stopListening(),e.off(),e.promises.initialized.isResolved&&t.promises.add("initialized")}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((0,o.default)((async(e,t)=>{let s=new XMLHttpRequest;s.open("GET",r.default.api.settings.get("credentials_url"),!0),s.setRequestHeader("Accept","application/json, text/javascript"),s.onload=()=>{if(s.status>=200&&s.status<400){const t=JSON.parse(s.responseText);j(t.jid).then((()=>{e({jid:t.jid,password:t.password})}))}else t(new Error(`${s.status}: ${s.responseText}`))},s.onerror=t,s=await r.default.api.hook("beforeFetchLoginCredentials",this,s),s.send()}),e))}async function A(e,t){const{api:s}=r.default;if(s.settings.get("authentication")===c.LOGIN){if(e)return T(e);if(s.settings.get("credentials_url"))return T(await async function(){let e,t=0;for(;!e;){try{e=await E(t)}catch(e){a.default.error("Could not fetch login credentials"),a.default.error(e)}t=2e3}return e}());if(r.default.jid&&(s.settings.get("password")||r.default.connection.pass))return T();if(s.settings.get("reuse_scram_keys")){const e=await async function(){const e=localStorage.getItem("conversejs-session-jid");if(!e)return null;await j(e);const t=(await C(e)).get("scram_keys");return t?{jid:e,password:t}:null}();if(e)return T(e)}if(!r.default.isTestEnv()&&"credentials"in navigator){const e=await async function(){if(!localStorage.getItem("conversejs-session-jid"))return null;try{const e=await navigator.credentials.get({password:!0});if(e&&"password"==e.type&&(0,m.isValidJID)(e.id))return await j(e.id),{jid:e.id,password:e.password}}catch(e){return a.default.error(e),null}}();if(e)return T(e)}r.default.isTestEnv()||a.default.warn("attemptNonPreboundSession: Couldn't find credentials to log in with")}else![c.ANONYMOUS,c.EXTERNAL].includes(s.settings.get("authentication"))||t&&!s.settings.get("auto_login")||T()}async function C(e){const t=`converse.scram-keys-${h.Strophe.getBareJidFromJid(e)}`,s=new u.Model({id:t});return(0,f.initStorage)(s,t,"persistent"),await new Promise((e=>s.fetch({success:e,error:e}))),s}async function T(e){const{api:t}=r.default;if([c.ANONYMOUS,c.EXTERNAL].includes(t.settings.get("authentication"))){if(!r.default.jid)throw new Error("Config Error: when using anonymous login you need to provide the server's domain via the 'jid' option. Either when calling converse.initialize, or when calling _converse.api.user.login.");r.default.connection.reconnecting||r.default.connection.reset(),r.default.connection.connect(r.default.jid.toLowerCase())}else if(t.settings.get("authentication")===c.LOGIN){const s=e?.password??(r.default.connection?.pass||t.settings.get("password"));if(!s){if(t.settings.get("auto_login"))throw new Error("autoLogin: If you use auto_login and authentication='login' then you also need to provide a password.");return r.default.connection.setDisconnectionCause(h.Strophe.Status.AUTHFAIL,void 0,!0),void t.connection.disconnect()}let n;if(r.default.connection.reconnecting||(r.default.connection.reset(),r.default.connection.service=p()),r.default.config.get("trusted")&&r.default.jid&&t.settings.get("reuse_scram_keys")&&!s?.ck){const e=await C(r.default.jid);n=t=>{const{scram_keys:s}=r.default.connection;s&&e.save({scram_keys:s}),r.default.connection.onConnectStatusChanged(t)}}r.default.connection.connect(r.default.jid,s,n)}}},"./src/headless/utils/parse-helpers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});const n={},r=(e,t)=>e.replace(RegExp("\\"+t,"ig"),"\\"+t);n.escapeCharacters=e=>t=>e.split("").reduce(r,t),n.escapeRegexString=n.escapeCharacters("[\\^$.?*+(){}|"),n.findFirstMatchInArray=e=>t=>{for(let s=0;s<e.length;s++)if(0===t.localeCompare(e[s],void 0,{sensitivity:"base"}))return e[s];return null};const o=(e,t,s)=>{let[n,r]=e,o=n,{begin:i,end:a}=t;const{value:l}=t;return i-=s,a=a-s-1,o=`${o.slice(0,i)}${l}${o.slice(a+1)}`,[o,[...r,{...t,begin:i,end:a}]]};n.reduceTextFromReferences=(e,t)=>t.reduce(o,[e,[]]);const i=n},"./src/headless/utils/stanza.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{stx:()=>l,toStanza:()=>i});var n=s("./src/headless/log.js"),r=s("./node_modules/strophe.js/src/index.js");const o="http://www.w3.org/1999/xhtml";function i(e,t){const s=r.Strophe.xmlHtmlNode(e);if(s.getElementsByTagNameNS(o,"parsererror").length)throw new Error(`Parser Error: ${e}`);const i=s.firstElementChild;if(["message","iq","presence"].includes(i.nodeName.toLowerCase())&&"jabber:client"!==i.namespaceURI&&"jabber:server"!==i.namespaceURI){const e=`Invalid namespaceURI ${i.namespaceURI}`;if(n.default.error(e),t)throw new Error(e)}return i}class a{constructor(e,t){this.strings=e,this.values=t}toString(){return this.string=this.string||this.strings.reduce(((e,t)=>{const s=this.strings.indexOf(t);return e+t+(this.values.length>s?this.values[s].toString():"")}),""),this.string}tree(){return this.node=this.node??i(this.toString(),!0),this.node}}function l(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return new a(e,s)}},"./src/headless/utils/storage.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{createStore:()=>l,getDefaultStore:()=>i,initStorage:()=>c});var n=s("./node_modules/@converse/skeletor/src/storage.js"),r=s("./src/headless/shared/_converse.js"),o=s("./src/headless/shared/settings/api.js");function i(){if(r.default.config.get("trusted")){return"sessionStorage"===o.settings_api.get("persistent_store")?"session":"persistent"}return"session"}function a(e){return"persistent"===e&&"IndexedDB"===o.settings_api.get("persistent_store")}function l(e,t){const s=t||i(),o=r.default.storage[s];if(void 0===o)throw new TypeError(`createStore: Could not find store for ${e}`);return new n.default(e,o,a(t))}function c(e,t,s){const n=s||i();if(e.browserStorage=l(t,n),a(n)){const t=()=>e.browserStorage.flush();window.addEventListener(r.default.unloadevent,t),e.on("destroy",(()=>window.removeEventListener(r.default.unloadevent,t))),e.listenTo(r.default,"beforeLogout",t)}}},"./src/headless/utils/url.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{checkFileTypes:()=>c,filterQueryParamsFromURL:()=>h,getURI:()=>l,isAllowedProtocolForMedia:()=>a,isAudioURL:()=>_,isDomainAllowed:()=>f,isDomainWhitelisted:()=>d,isEncryptedFileURL:()=>b,isGIFURL:()=>g,isImageURL:()=>y,isMediaURLDomainAllowed:()=>m,isURLWithImageExtension:()=>p,isVideoURL:()=>v,shouldRenderMediaFromURL:()=>u});var n=s("./node_modules/urijs/src/URI.js"),r=s.n(n),o=s("./src/headless/log.js"),i=s("./src/headless/shared/api/index.js");function a(e){const t=l(e),{protocol:s}=window.location;return!!["chrome-extension:","file:"].includes(s)||("http:"===s||"https:"===s&&["https","aesgcm"].includes(t.protocol().toLowerCase()))}function l(e){try{return e instanceof r()?e:new(r())(e)}catch(e){return o.default.debug(e),null}}function c(e,t){const s=l(t);if(null===s)throw new Error(`checkFileTypes: could not parse url ${t}`);const n=s.filename().toLowerCase();return!!e.filter((e=>n.endsWith(e))).length}function d(e,t){const s=l(t),n=s.subdomain(),r=s.domain(),o=`${n?`${n}.`:""}${r}`;return e.includes(r)||e.includes(o)}function u(e,t){if(!a(e))return!1;const s=i.default.settings.get("render_media"),n=f(e,`allowed_${t}_domains`);return Array.isArray(s)?n&&d(s,e):n&&s}function h(e){const t=i.default.settings.get("filter_url_query_params");if(!t)return e;return l(e).removeQuery(t).toString()}function f(e,t){const s=i.default.settings.get(t);if(!Array.isArray(s))return!0;try{return d(s,e)}catch(e){return o.default.debug(e),!1}}function m(e){return e.is_audio&&f(e.url,"allowed_audio_domains")||e.is_video&&f(e.url,"allowed_video_domains")||e.is_image&&f(e.url,"allowed_image_domains")}function p(e){return c([".jpg",".jpeg",".png",".gif",".bmp",".tiff",".svg"],e)}function g(e){return c([".gif"],e)}function _(e){return c([".ogg",".mp3",".m4a"],e)}function v(e){return c([".mp4",".webm"],e)}function y(e){const t=i.default.settings.get("image_urls_regex");return t?.test(e)||p(e)}function b(e){return e.startsWith("aesgcm://")}},"./src/i18n/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{__:()=>u});var n=s("./node_modules/jed/jed.js"),r=s.n(n),o=s("./src/headless/dist/converse-headless.js");const{dayjs:i}=o.converse.env;let a;function l(e,t){return"string"==typeof e&&t.includes(e)}function c(e,t){if("en"===e||t(e))return e;const{languages:s}=window.navigator;let n;for(let e=0;e<s.length&&!n;e++)n=d(s[e],t);return n||"en"}function d(e,t){if(t(e))return e;var s=e.split("-")[0];return s!==e&&t(s)?s:void 0}Object.assign(o.i18n,{getLocale:(e,t)=>c(e,(e=>l(e,t))),translate(e){if(!a)return r().sprintf.apply(r(),arguments);const t=a.translate(e);return arguments.length>1?t.fetch.apply(t,[].slice.call(arguments,1)):t.fetch()},async initialize(){if(o._converse.isTestEnv())o._converse.locale="en";else try{const e=o.api.settings.get("i18n");o._converse.locale=o.i18n.getLocale(e,o.api.settings.get("locales")),a=await async function(){const{api:e,locale:t}=o._converse,n=function(e){const t=e.toLowerCase().replace("_","-");return"ug"===t?"ug-cn":t}(t);if(!l(t,e.settings.get("locales"))||"en"===t)return;const{default:a}=await s("./src/i18n lazy recursive ^\\.\\/.*\\/LC_MESSAGES\\/converse\\.po$ referencedExports: default")(`./${t}/LC_MESSAGES/converse.po`);return await s("./node_modules/dayjs/locale lazy recursive ^\\.\\/.*\\.js$")(`./${n}.js`),i.locale(c(n,(e=>i.locale(e)))),new(r())(a)}()}catch(e){o.log.fatal(e.message),o._converse.locale="en"}},__(){return o.i18n.translate(...arguments)}});const u=o.i18n.__},"./src/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/i18n/index.js"),s("./src/shared/registry.js");var n=s("./src/shared/components/element.js"),r=s("./src/shared/constants.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/shared/styles/index.scss"),s("./src/plugins/modal/index.js"),s("./src/plugins/adhoc-views/index.js"),s("./src/plugins/bookmark-views/index.js"),s("./src/plugins/chatview/index.js"),s("./src/plugins/controlbox/index.js"),s("./src/plugins/headlines-view/index.js"),s("./src/plugins/mam-views/index.js"),s("./src/plugins/muc-views/index.js"),s("./src/plugins/minimize/index.js"),s("./src/plugins/notifications/index.js"),s("./src/plugins/profile/index.js"),s("./src/plugins/omemo/index.js"),s("./src/plugins/push/index.js"),s("./src/plugins/register/index.js"),s("./src/plugins/roomslist/index.js"),s("./src/plugins/rootview/index.js"),s("./src/plugins/rosterview/index.js"),s("./src/plugins/singleton/index.js"),s("./src/plugins/dragresize/index.js"),s("./src/plugins/fullscreen/index.js");o._converse.CustomElement=n.CustomElement;const i=o.converse.initialize;o.converse.initialize=function(e,t){return Array.isArray(e.whitelisted_plugins)?e.whitelisted_plugins=e.whitelisted_plugins.concat(r.VIEW_PLUGINS):e.whitelisted_plugins=r.VIEW_PLUGINS,i(e,t)};const a=o.converse},"./src/plugins/adhoc-views/adhoc-commands.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});s("./src/shared/autocomplete/index.js");var n=s("./src/plugins/adhoc-views/templates/ad-hoc.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/utils/html.js");const{Strophe:l,sizzle:c}=i.converse.env;class d extends r.CustomElement{static get properties(){return{alert:{type:String},alert_type:{type:String},commands:{type:Array},fetching:{type:Boolean},showform:{type:String},view:{type:String}}}constructor(){super(),this.view="choose-service",this.fetching=!1,this.showform="",this.commands=[]}render(){return(0,n.default)(this)}async fetchCommands(e){e.preventDefault(),delete this.alert_type,delete this.alert,this.fetching=!0;const t=new FormData(e.target).get("jid").trim();let s;try{s=await i.api.disco.supports(l.NS.ADHOC,t)}catch(e){i.log.error(e)}finally{this.fetching=!1}if(s)try{this.commands=await i.api.adhoc.getCommands(t),this.view="list-commands"}catch(e){return i.log.error(e),this.alert_type="danger",this.alert=(0,o.__)("Sorry, an error occurred while looking for commands on that entity."),this.commands=[],void i.log.error(e)}else this.alert_type="danger",this.alert=(0,o.__)("The specified entity doesn't support ad-hoc commands")}async toggleCommandForm(e){e.preventDefault();const t=e.target.getAttribute("data-command-node"),s=this.commands.filter((e=>e.node===t))[0];if(this.showform===t)this.showform="",this.requestUpdate();else{const e=await i.api.adhoc.fetchCommandForm(s);s.sessionid=e.sessionid,s.instructions=e.instructions,s.fields=e.fields,s.actions=e.actions,this.showform=t}}executeAction(e){e.preventDefault();const t=e.target.getAttribute("data-action");["execute","next","prev","complete"].includes(t)?this.runCommand(e.target.form,t):i.log.error(`Unknown action: ${t}`)}clearCommand(e){delete e.alert,delete e.instructions,delete e.sessionid,delete e.alert_type,e.fields=[],e.acions=[],this.showform=""}async runCommand(e,t){const s=new FormData(e),n=s.get("command_jid").trim(),r=s.get("command_node").trim(),l=this.commands.filter((e=>e.node===r))[0];delete l.alert,this.requestUpdate();const d="prev"===t?[]:c(":input:not([type=button]):not([type=submit])",e).filter((e=>!["command_jid","command_node"].includes(e.getAttribute("name")))).map(a.getNameAndValue).filter((e=>e)),u=await i.api.adhoc.runCommand(n,l.sessionid,l.node,t,d),{fields:h,status:f,note:m,instructions:p,actions:g}=u;if("error"===f)return l.alert_type="danger",l.alert=(0,o.__)("Sorry, an error occurred while trying to execute the command. See the developer console for details"),this.requestUpdate();"executing"===f?(l.alert=(0,o.__)("Executing"),l.fields=h,l.instructions=p,l.alert_type="primary",l.actions=g):"completed"===f?(this.alert_type="primary",this.alert=(0,o.__)("Completed"),this.note=m,this.clearCommand(l)):(i.log.error(`Unexpected status for ad-hoc command: ${f}`),l.alert=(0,o.__)("Completed"),l.alert_type="primary"),this.requestUpdate()}async cancel(e){e.preventDefault(),this.showform="",this.requestUpdate();const t=new FormData(e.target.form),s=t.get("command_jid").trim(),n=t.get("command_node").trim(),r=this.commands.filter((e=>e.node===n))[0];delete r.alert,this.requestUpdate();const{status:a}=await i.api.adhoc.runCommand(s,r.sessionid,r.node,"cancel",[]);"error"===a?(r.alert_type="danger",r.alert=(0,o.__)("An error occurred while trying to cancel the command. See the developer console for details")):"canceled"===a?(this.alert_type="",this.alert="",this.clearCommand(r)):(i.log.error(`Unexpected status for ad-hoc command: ${a}`),r.alert=(0,o.__)("Error: unexpected result"),r.alert_type="danger"),this.requestUpdate()}}i.api.elements.define("converse-adhoc-commands",d)},"./src/plugins/adhoc-views/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/adhoc-views/adhoc-commands.js");var n=s("./src/headless/dist/converse-headless.js");n.converse.plugins.add("converse-adhoc-views",{dependencies:["converse-controlbox","converse-muc"],initialize(){n.api.settings.extend({allow_adhoc_commands:!0})}})},"./src/plugins/adhoc-views/templates/ad-hoc-command-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o={execute:(0,n.__)("Execute"),prev:(0,n.__)("Previous"),next:(0,n.__)("Next"),complete:(0,n.__)("Complete")},i=(e,t)=>{const s=(0,n.__)("Cancel");return r.html`
        <span> <!-- Don't remove this <span>,
                    this is a workaround for a lit bug where a <form> cannot be removed
                    if it contains an <input> with name "remove" -->
            <form>
            ${t.alert?r.html`<div class="alert alert-${t.alert_type}" role="alert">${t.alert}</div>`:""}
            <fieldset class="form-group">
                <input type="hidden" name="command_node" value="${t.node}"/>
                <input type="hidden" name="command_jid" value="${t.jid}"/>

                <p class="form-instructions">${t.instructions}</p>
                ${t.fields}
            </fieldset>
            <fieldset>
                ${t.actions.map((t=>r.html`<input data-action="${t}"
                        @click=${t=>e.executeAction(t)}
                        type="button"
                        class="btn btn-primary"
                        value="${o[t]}">`))}<input type="button"
                       class="btn btn-secondary button-cancel"
                       value="${s}"
                       @click=${t=>e.cancel(t)}>
            </fieldset>
        </form>
        </span>
    `}},"./src/plugins/adhoc-views/templates/ad-hoc-command.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/plugins/adhoc-views/templates/ad-hoc-command-form.js");const o=(e,t)=>n.html`
    <li class="room-item list-group-item">
        <div class="available-chatroom d-flex flex-row">
            <a class="open-room available-room w-100"
               @click=${t=>e.toggleCommandForm(t)}
               data-command-node="${t.node}"
               data-command-jid="${t.jid}"
               data-command-name="${t.name}"
               title="${t.name}"
               href="#">${t.name||t.jid}</a>
        </div>
        ${t.node===e.showform?(0,r.default)(e,t):""}
    </li>
`},"./src/plugins/adhoc-views/templates/ad-hoc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/adhoc-views/templates/ad-hoc-command.js"),r=s("./src/templates/spinner.js"),o=s("./src/i18n/index.js"),i=s("./src/plugins/muc-views/utils.js"),a=s("./node_modules/lit/index.js");const l=e=>{const t=(0,o.__)("On which entity do you want to run commands?"),s=(0,o.__)("Certain XMPP services and entities allow privileged users to execute ad-hoc commands on them."),l=(0,o.__)("Commands found"),c=(0,o.__)("List available commands"),d=(0,o.__)("XMPP Address"),u=(0,o.__)("No commands found");return a.html`
        ${e.alert?a.html`<div class="alert alert-${e.alert_type}" role="alert">${e.alert}</div>`:""}
        ${e.note?a.html`<p class="form-help">${e.note}</p>`:""}

        <form class="converse-form" @submit=${e.fetchCommands}>
            <fieldset class="form-group">
                <label>
                    ${t}
                    <p class="form-help">${s}</p>
                    <converse-autocomplete
                        .getAutoCompleteList="${i.getAutoCompleteList}"
                        required
                        placeholder="${d}"
                        name="jid">
                    </converse-autocomplete>
                </label>
            </fieldset>
            <fieldset class="form-group">
                ${e.fetching?(0,r.default)():a.html`<input type="submit" class="btn btn-primary" value="${c}">`}
            </fieldset>
            ${"list-commands"===e.view?a.html`
            <fieldset class="form-group">
                <ul class="list-group">
                    <li class="list-group-item active">${e.commands.length?l:u}:</li>
                    ${e.commands.map((t=>(0,n.default)(e,t)))}
                </ul>
            </fieldset>`:""}

        </form>
    `}},"./src/plugins/bookmark-views/components/bookmark-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/bookmark-views/components/templates/form.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}willUpdate(e){e.has("jid")&&(this.model=o._converse.chatboxes.get(this.jid),this.bookmark=o._converse.bookmarks.get(this.jid))}render(){return(0,n.default)(this)}onBookmarkFormSubmitted(e){e.preventDefault(),o._converse.bookmarks.createBookmark({jid:this.jid,autojoin:e.target.querySelector('input[name="autojoin"]')?.checked||!1,name:e.target.querySelector("input[name=name]")?.value,nick:e.target.querySelector("input[name=nick]")?.value}),this.closeBookmarkForm(e)}removeBookmark(e){this.bookmark?.destroy(),this.closeBookmarkForm(e)}closeBookmarkForm(e){e.preventDefault();const t=document.createEvent("Event");t.initEvent("hide.bs.modal",!0,!0),this.dispatchEvent(t)}}o.api.elements.define("converse-muc-bookmark-form",i);const a=i},"./src/plugins/bookmark-views/components/bookmarks-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/plugins/bookmark-views/components/templates/list.js"),o=s("./src/templates/spinner.js"),i=s("./src/shared/components/element.js"),a=s("./node_modules/@converse/skeletor/src/model.js"),l=s("./src/headless/dist/converse-headless.js"),c=s("./src/headless/utils/storage.js");s("./src/plugins/bookmark-views/styles/bookmarks.scss");class d extends i.CustomElement{async initialize(){await l.api.waitUntil("bookmarksInitialized");const{bookmarks:e,chatboxes:t}=l._converse;this.liveFilter=(0,n.default)((e=>this.model.set({filter_text:e.target.value})),100),this.listenTo(e,"add",(()=>this.requestUpdate())),this.listenTo(e,"remove",(()=>this.requestUpdate())),this.listenTo(t,"add",(()=>this.requestUpdate())),this.listenTo(t,"remove",(()=>this.requestUpdate()));const s=`converse.bookmarks-list-model-${l._converse.bare_jid}`;this.model=new a.Model({id:s}),(0,c.initStorage)(this.model,s),this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.model.fetch({success:()=>this.requestUpdate(),error:()=>this.requestUpdate()})}render(){return l._converse.bookmarks&&this.model?(0,r.default)(this):(0,o.default)()}clearFilter(e){e?.stopPropagation?.(),this.model.set("filter_text","")}}l.api.elements.define("converse-bookmarks",d)},"./src/plugins/bookmark-views/components/templates/form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=e.model.getDisplayName(),s=e.bookmark?.get("nick")??e.model.get("nick"),o=(0,r.__)('Bookmark for "%1$s"',t),i=(0,r.__)("Would you like this groupchat to be automatically joined upon startup?"),a=(0,r.__)("Remove"),l=(0,r.__)("The name for this bookmark:"),c=(0,r.__)("What should your nickname for this groupchat be?"),d=e.bookmark?(0,r.__)("Update"):(0,r.__)("Save");return n.html`
        <form class="converse-form chatroom-form" @submit=${t=>e.onBookmarkFormSubmitted(t)}>
            <legend>${o}</legend>
            <fieldset class="form-group">
                <label for="converse_muc_bookmark_name">${l}</label>
                <input class="form-control" type="text" value="${t}" name="name" required="required" id="converse_muc_bookmark_name"/>
            </fieldset>
            <fieldset class="form-group">
                <label for="converse_muc_bookmark_nick">${c}</label>
                <input class="form-control" type="text" name="nick" value="${s||""}" id="converse_muc_bookmark_nick"/>
            </fieldset>
            <fieldset class="form-group form-check">
                <input class="form-check-input" id="converse_muc_bookmark_autojoin" type="checkbox" ?checked=${e.bookmark?.get("autojoin")} name="autojoin"/>
                <label class="form-check-label" for="converse_muc_bookmark_autojoin">${i}</label>
            </fieldset>
            <fieldset class="form-group">
                <input class="btn btn-primary" type="submit" value="${d}">
                    ${e.bookmark?n.html`<input class="btn btn-secondary button-remove" type="button" value="${a}" @click=${t=>e.removeBookmark(t)}>`:""}
            </fieldset>
        </form>
    `}},"./src/plugins/bookmark-views/components/templates/item.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./src/plugins/bookmark-views/utils.js");const i=e=>{const t=e.get("jid"),s=(0,n.__)("Unbookmark this groupchat"),i=(0,n.__)("Click to open this groupchat");return r.html`
        <div class="list-item room-item available-chatroom d-flex flex-row" data-room-jid="${t}">
            <a class="list-item-link open-room w-100" data-room-jid="${t}"
                title="${i}"
                @click=${o.openRoomViaEvent}>${e.getDisplayName()}</a>

            <a class="list-item-action remove-bookmark align-self-center ${e.get("bookmarked")?"button-on":""}"
                data-room-jid="${t}"
                data-bookmark-name="${e.getDisplayName()}"
                title="${s}"
                @click=${o.removeBookmarkViaEvent}>
            <converse-icon class="fa fa-bookmark" size="1em"></converse-icon>
            </a>
        </div>
    `}},"./src/plugins/bookmark-views/components/templates/list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/bookmark-views/components/templates/item.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");const a=e=>{const t=(0,r.__)("Filter"),s=e.model.get("filter_text"),{bookmarks:a}=o._converse,l=s?a.filter((e=>((e,t)=>e.get("name")?.includes(t)||e.get("jid")?.includes(t))(e,s))):a;return i.html`
        <form class="converse-form bookmarks-filter">
            <div class="btn-group w-100">
                <input
                    .value=${s??""}
                    @keydown="${t=>e.liveFilter(t)}"
                    class="form-control"
                    placeholder="${t}"/>

                <converse-icon size="1em" class="fa fa-times clear-input ${s?"":"hidden"}"
                    @click=${e.clearFilter}>
                </converse-icon>
            </div>
        </form>

        <div class="list-container list-container--bookmarks">
            <div class="items-list bookmarks rooms-list">
                ${l.map((e=>(0,n.default)(e)))}
            </div>
        </div>
    `}},"./src/plugins/bookmark-views/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/bookmark-views/modals/bookmark-list.js"),s("./src/plugins/bookmark-views/modals/bookmark-form.js"),s("./src/headless/plugins/muc/index.js");var n=s("./src/plugins/bookmark-views/components/bookmark-form.js"),r=s("./src/plugins/bookmark-views/components/bookmarks-list.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/plugins/bookmark-views/mixins.js"),a=s("./src/plugins/bookmark-views/utils.js");s("./src/plugins/bookmark-views/styles/bookmarks.scss");o.converse.plugins.add("converse-bookmark-views",{dependencies:["converse-chatboxes","converse-muc","converse-muc-views"],initialize(){o.api.settings.extend({hide_open_bookmarks:!0}),o._converse.removeBookmarkViaEvent=a.removeBookmarkViaEvent,o._converse.addBookmarkViaEvent=a.addBookmarkViaEvent,Object.assign(o._converse.ChatRoomView.prototype,i.bookmarkableChatRoomView),o._converse.MUCBookmarkForm=n.default,o._converse.BookmarksView=r.default,o.api.listen.on("getHeadingButtons",a.getHeadingButtons),o.api.listen.on("chatRoomViewInitialized",(e=>e.setBookmarkState()))}})},"./src/plugins/bookmark-views/mixins.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{bookmarkableChatRoomView:()=>o});var n=s("./src/headless/dist/converse-headless.js");const{u:r}=n.converse.env,o={setBookmarkState(){if(void 0!==n._converse.bookmarks){n._converse.bookmarks.where({jid:this.model.get("jid")}).length?this.model.save("bookmarked",!0):this.model.save("bookmarked",!1)}},renderBookmarkForm(){if(!this.bookmark_form){this.bookmark_form=new n._converse.MUCBookmarkForm({model:this.model,chatroomview:this});this.querySelector(".chatroom-body").insertAdjacentElement("beforeend",this.bookmark_form.el)}r.showElement(this.bookmark_form.el)},showBookmarkModal(e){e?.preventDefault();const t=this.model.get("jid");n.api.modal.show("converse-bookmark-form-modal",{jid:t},e)}}},"./src/plugins/bookmark-views/modals/bookmark-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/plugins/bookmark-views/components/bookmark-form.js");var n=s("./src/plugins/modal/modal.js"),r=s("./node_modules/lit/index.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{renderModal(){return r.html`
            <converse-muc-bookmark-form class="muc-form-container" jid="${this.jid}">
            </converse-muc-bookmark-form>`}getModalTitle(){return(0,o.__)("Bookmark")}}i.api.elements.define("converse-bookmark-form-modal",a)},"./src/plugins/bookmark-views/modals/bookmark-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/plugins/bookmark-views/components/bookmarks-list.js");var n=s("./src/plugins/modal/modal.js"),r=s("./node_modules/lit/index.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{renderModal(){return r.html`<converse-bookmarks></converse-bookmarks>`}getModalTitle(){return(0,o.__)("Bookmarks")}}i.api.elements.define("converse-bookmark-list-modal",a)},"./src/plugins/bookmark-views/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addBookmarkViaEvent:()=>l,getHeadingButtons:()=>i,openRoomViaEvent:()=>c,removeBookmarkViaEvent:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/headless/plugins/bookmarks/utils.js");function i(e,t){if(r.api.settings.get("allow_bookmarks")&&e.model.get("type")===r._converse.CHATROOMS_TYPE){const s={i18n_title:(0,n.__)("Bookmark this groupchat"),i18n_text:(0,n.__)("Bookmark"),handler:t=>e.showBookmarkModal(t),a_class:"toggle-bookmark",icon_class:"fa-bookmark",name:"bookmark"},r=t.map((e=>e.name)).indexOf("details"),i=(0,o.checkBookmarksSupport)().then((e=>e?s:null));return r>-1?[...t.slice(0,r),i,...t.slice(r)]:[i,...t]}return t}async function a(e){e.preventDefault();const t=e.currentTarget.getAttribute("data-bookmark-name"),s=e.currentTarget.getAttribute("data-room-jid");await r.api.confirm((0,n.__)('Are you sure you want to remove the bookmark "%1$s"?',t))&&r._converse.bookmarks.where({jid:s}).forEach((e=>e.destroy()))}function l(e){e.preventDefault();const t=e.currentTarget.getAttribute("data-room-jid");r.api.modal.show("converse-bookmark-form-modal",{jid:t},e)}function c(e){e.preventDefault();const{Strophe:t}=r.converse.env,s=e.target.textContent,n=e.target.getAttribute("data-room-jid"),o={name:s||t.unescapeNode(t.getNodeFromJid(n))||n};r.api.rooms.open(n,o,!0)}},"./src/plugins/chatboxviews/container.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=class{constructor(){this.views={}}add(e,t){this.views[e]=t}get(e){return this.views[e]}xget(e){return this.keys().filter((t=>t!==e)).reduce(((e,t)=>(e[t]=this.views[t],e)),{})}getAll(){return Object.values(this.views)}keys(){return Object.keys(this.views)}remove(e){delete this.views[e]}map(e){return Object.values(this.views).map(e)}forEach(e){return Object.values(this.views).forEach(e)}filter(e){return Object.values(this.views).filter(e)}closeAllChatBoxes(){return Promise.all(Object.values(this.views).map((e=>e.close({name:"closeAllChatBoxes"}))))}}},"./src/plugins/chatboxviews/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/chatboxviews/view.js"),s("./src/headless/plugins/chatboxes/index.js");var n=s("./src/plugins/chatboxviews/container.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/chatboxviews/utils.js");s("./src/plugins/chatboxviews/styles/chats.scss");r.converse.plugins.add("converse-chatboxviews",{dependencies:["converse-chatboxes","converse-vcard"],initialize(){r.api.promises.add(["chatBoxViewsInitialized"]),r.api.settings.extend({animate:!0}),r._converse.chatboxviews=new n.default,r.api.listen.on("chatBoxesInitialized",(()=>{r._converse.chatboxes.on("destroy",(e=>r._converse.chatboxviews.remove(e.get("jid"))))})),r.api.listen.on("cleanup",(()=>delete r._converse.chatboxviews)),r.api.listen.on("clearSession",(()=>r._converse.chatboxviews.closeAllChatBoxes())),r.api.listen.on("chatBoxViewsInitialized",o.calculateViewportHeightUnit),window.addEventListener("resize",o.calculateViewportHeightUnit),Object.assign(r.converse,{insertInto(e){const t=r._converse.chatboxviews?.el;if(t&&!e.contains(t))e.insertAdjacentElement("afterBegin",t);else if(!t)throw new Error("Cannot insert non-existing #conversejs element into the DOM")}})}})},"./src/plugins/chatboxviews/templates/chats.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lit/index.js"),r=s("./node_modules/lit/directives/repeat.js"),o=s("./src/headless/dist/converse-headless.js");function i(e){const{CONTROLBOX_TYPE:t}=o._converse,s="overlayed"===o.api.settings.get("view_mode")&&e.get("minimized");return e.get("type")===t||!(e.get("hidden")||s)}const a=()=>{const{chatboxes:e,CONTROLBOX_TYPE:t,CHATROOMS_TYPE:s,HEADLINES_TYPE:a}=o._converse,l=o.api.settings.get("view_mode"),c=o._converse?.connection,d=!c?.connected||!c?.authenticated||c?.disconnecting;return n.html`
        ${d||"overlayed"!==l?"":n.html`<converse-minimized-chats></converse-minimized-chats>`}
        ${(0,r.repeat)(e.filter(i),(e=>e.get("jid")),(e=>e.get("type")===t?n.html`
                    ${"overlayed"===l?n.html`<converse-controlbox-toggle class="${e.get("closed")?"":"hidden"}"></converse-controlbox-toggle>`:""}
                    <converse-controlbox
                        id="controlbox"
                        class="chatbox ${"overlayed"===l&&e.get("closed")?"hidden":""} ${d?"logged-out":""}"
                        style="${e.get("width")?`width: ${e.get("width")}`:""}"></converse-controlbox>
                `:e.get("type")===s?n.html`
                    <converse-muc jid="${e.get("jid")}" class="chatbox chatroom"></converse-muc>
                `:e.get("type")===a?n.html`
                    <converse-headlines jid="${e.get("jid")}" class="chatbox headlines"></converse-headlines>
                `:n.html`
                    <converse-chat jid="${e.get("jid")}" class="chatbox"></converse-chat>
                `))}
    `}},"./src/plugins/chatboxviews/utils.js":(e,t,s)=>{"use strict";function n(){const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}s.r(t),s.d(t,{calculateViewportHeightUnit:()=>n})},"./src/plugins/chatboxviews/view.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/templates/background_logo.js"),r=s("./src/plugins/chatboxviews/templates/chats.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/shared/settings/utils.js"),l=s("./node_modules/lit/index.js");class c extends o.CustomElement{initialize(){this.model=i._converse.chatboxes,this.listenTo(this.model,"add",(()=>this.requestUpdate())),this.listenTo(this.model,"change:closed",(()=>this.requestUpdate())),this.listenTo(this.model,"change:hidden",(()=>this.requestUpdate())),this.listenTo(this.model,"change:jid",(()=>this.requestUpdate())),this.listenTo(this.model,"change:minimized",(()=>this.requestUpdate())),this.listenTo(this.model,"destroy",(()=>this.requestUpdate())),this.listenTo(i._converse,"connected",(()=>this.requestUpdate())),this.listenTo(i._converse,"reconnected",(()=>this.requestUpdate())),this.listenTo(i._converse,"disconnected",(()=>this.requestUpdate()));const e=(0,a.getAppSettings)();this.listenTo(e,"change:view_mode",(()=>this.requestUpdate())),this.listenTo(e,"change:singleton",(()=>this.requestUpdate()));const t=document.getElementById("conversejs-bg");t&&!t.innerHTML.trim()&&(0,l.render)((0,n.default)(),t);document.querySelector("body").classList.add(`converse-${i.api.settings.get("view_mode")}`),i.api.trigger("chatBoxViewsInitialized")}render(){return(0,r.default)()}}i.api.elements.define("converse-chats",c)},"./src/plugins/chatview/bottom-panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});s("./src/plugins/chatview/message-form.js");var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/plugins/chatview/templates/bottom-panel.js"),o=s("./node_modules/@converse/skeletor/src/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/plugins/chatview/utils.js"),l=s("./node_modules/lit/index.js");s("./src/plugins/chatview/styles/chat-bottom-panel.scss");class c extends o.ElementView{events={"click .send-button":"sendButtonClicked","click .toggle-clear":"clearMessages"};constructor(){super(),this.debouncedRender=(0,n.default)(this.render,100)}async connectedCallback(){super.connectedCallback(),await this.initialize(),this.render()}async initialize(){this.model=await i.api.chatboxes.get(this.getAttribute("jid")),await this.model.initialized,this.listenTo(this.model,"change:num_unread",this.debouncedRender),this.listenTo(this.model,"emoji-picker-autocomplete",this.autocompleteInPicker),this.addEventListener("focusin",(e=>this.emitFocused(e))),this.addEventListener("focusout",(e=>this.emitBlurred(e)))}render(){(0,l.render)((0,r.default)({model:this.model,viewUnreadMessages:e=>this.viewUnreadMessages(e)}),this)}sendButtonClicked(e){this.querySelector("converse-message-form")?.onFormSubmitted(e)}viewUnreadMessages(e){e?.preventDefault?.(),this.model.ui.set({scrolled:!1})}emitFocused(e){i._converse.chatboxviews.get(this.getAttribute("jid"))?.emitFocused(e)}emitBlurred(e){i._converse.chatboxviews.get(this.getAttribute("jid"))?.emitBlurred(e)}onDrop(e){0!=e.dataTransfer.files.length&&(e.preventDefault(),this.model.sendFiles(e.dataTransfer.files))}onDragOver(e){e.preventDefault()}clearMessages(e){e?.preventDefault?.(),(0,a.clearMessages)(this.model)}async autocompleteInPicker(e,t){await i.api.emojis.initialize();const s=this.querySelector("converse-emoji-picker");if(s){s.model.set({ac_position:e.selectionStart,autocompleting:t,query:t});const n=this.querySelector("converse-emoji-dropdown");n?.showMenu()}}}i.api.elements.define("converse-chat-bottom-panel",c)},"./src/plugins/chatview/chat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/plugins/chatview/heading.js"),s("./src/plugins/chatview/bottom-panel.js");var n=s("./src/shared/chat/baseview.js"),r=s("./src/plugins/chatview/templates/chat.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{length=200;async initialize(){i._converse.chatboxviews.add(this.jid,this),this.model=i._converse.chatboxes.get(this.jid),this.listenTo(i._converse,"windowStateChanged",this.onWindowStateChanged),this.listenTo(this.model,"change:hidden",(()=>!this.model.get("hidden")&&this.afterShown())),this.listenTo(this.model,"change:show_help_messages",(()=>this.requestUpdate())),await this.model.messages.fetched,!this.model.get("hidden")&&this.afterShown(),i.api.trigger("chatBoxViewInitialized",this)}render(){return(0,r.default)(Object.assign({model:this.model,help_messages:this.getHelpMessages(),show_help_messages:this.model.get("show_help_messages")},this.model.toJSON()))}getHelpMessages(){return[`<strong>/clear</strong>: ${(0,o.__)("Remove messages")}`,`<strong>/close</strong>: ${(0,o.__)("Close this chat")}`,`<strong>/me</strong>: ${(0,o.__)("Write in the third person")}`,`<strong>/help</strong>: ${(0,o.__)("Show this menu")}`]}afterShown(){this.model.setChatState(i._converse.ACTIVE),this.model.clearUnreadMsgCounter(),this.maybeFocus()}}i.api.elements.define("converse-chat",a)},"./src/plugins/chatview/heading.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/modals/user-details.js");var n=s("./src/plugins/chatview/templates/chat-head.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");s("./src/plugins/chatview/styles/chat-head.scss");class a extends r.CustomElement{static get properties(){return{jid:{type:String}}}initialize(){this.model=i._converse.chatboxes.get(this.jid),this.listenTo(this.model,"change:status",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:add",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:change",(()=>this.requestUpdate())),this.model.contact&&this.listenTo(this.model.contact,"destroy",(()=>this.requestUpdate())),this.model.rosterContactAdded?.then((()=>{this.listenTo(this.model.contact,"change:nickname",(()=>this.requestUpdate())),this.requestUpdate()}))}render(){return(0,n.default)(Object.assign(this.model.toJSON(),{heading_buttons_promise:this.getHeadingButtons(),model:this.model,showUserDetailsModal:e=>this.showUserDetailsModal(e)}))}showUserDetailsModal(e){e.preventDefault(),i.api.modal.show("converse-user-details-modal",{model:this.model},e)}close(e){e.preventDefault(),this.model.close()}getHeadingButtons(){const e=[{a_class:"show-user-details-modal",handler:e=>this.showUserDetailsModal(e),i18n_text:(0,o.__)("Details"),i18n_title:(0,o.__)("See more information about this person"),icon_class:"fa-id-card",name:"details",standalone:"overlayed"===i.api.settings.get("view_mode")}];i.api.settings.get("singleton")||e.push({a_class:"close-chatbox-button",handler:e=>this.close(e),i18n_text:(0,o.__)("Close"),i18n_title:(0,o.__)("Close and end this conversation"),icon_class:"fa-times",name:"close",standalone:"overlayed"===i.api.settings.get("view_mode")});const t=i._converse.chatboxviews.get(this.getAttribute("jid"));return t?i._converse.api.hook("getHeadingButtons",t,e):e}}i.api.elements.define("converse-chat-heading",a)},"./src/plugins/chatview/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/chatboxviews/index.js"),s("./src/shared/chat/chat-content.js"),s("./src/shared/chat/help-messages.js"),s("./src/shared/chat/toolbar.js");var n=s("./src/plugins/chatview/chat.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/chatview/utils.js");s("./src/plugins/chatview/styles/index.scss");const{Strophe:i}=r.converse.env;r.converse.plugins.add("converse-chatview",{dependencies:["converse-chatboxviews","converse-chat","converse-disco","converse-modal"],initialize(){r.api.settings.extend({allowed_audio_domains:null,allowed_image_domains:null,allowed_video_domains:null,auto_focus:!0,debounced_content_rendering:!0,filter_url_query_params:null,image_urls_regex:null,message_limit:0,muc_hats:["xep317"],render_media:!0,show_message_avatar:!0,show_retraction_warning:!0,show_send_button:!0,show_toolbar:!0,time_format:"HH:mm",use_system_emojis:!0,visible_toolbar_buttons:{call:!1,clear:!0,emoji:!0,spoiler:!0}}),r._converse.ChatBoxView=n.default,r.api.listen.on("connected",(()=>r.api.disco.own.features.add(i.NS.SPOILER))),r.api.listen.on("chatBoxClosed",(e=>(0,o.clearHistory)(e.get("jid"))))}})},"./src/plugins/chatview/message-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/plugins/chatview/templates/message-form.js"),r=s("./node_modules/@converse/skeletor/src/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/plugins/chatview/utils.js"),l=s("./src/headless/utils/core.js");const{u:c}=i.converse.env;class d extends r.ElementView{async connectedCallback(){super.connectedCallback(),this.model=i._converse.chatboxes.get(this.getAttribute("jid")),await this.model.initialized,this.listenTo(this.model.messages,"change:correcting",this.onMessageCorrecting),this.listenTo(this.model,"change:composing_spoiler",(()=>this.render())),this.handleEmojiSelection=e=>{let{detail:t}=e;this.model.get("jid")===t.jid&&this.insertIntoTextArea(t.value,t.autocompleting,!1,t.ac_position)},document.addEventListener("emojiSelected",this.handleEmojiSelection),this.render()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("emojiSelected",this.handleEmojiSelection)}toHTML(){return(0,n.default)(Object.assign(this.model.toJSON(),{onDrop:e=>this.onDrop(e),hint_value:this.querySelector(".spoiler-hint")?.value,message_value:this.querySelector(".chat-textarea")?.value,onChange:e=>this.model.set({draft:e.target.value}),onKeyDown:e=>this.onKeyDown(e),onKeyUp:e=>this.onKeyUp(e),onPaste:e=>this.onPaste(e),viewUnreadMessages:e=>this.viewUnreadMessages(e)}))}insertIntoTextArea(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;const r=this.querySelector(".chat-textarea");if(s?c.addClass("correcting",r):c.removeClass("correcting",r),t)r.value=n&&"string"==typeof t?r.value.replace(new RegExp(t,"g"),((s,r)=>r==n-t.length?e+" ":s)):e;else{let t=r.value;t&&" "!==t[t.length-1]&&(t+=" "),r.value=t+e+" "}const o=document.createEvent("HTMLEvents");o.initEvent("change",!1,!0),r.dispatchEvent(o),c.placeCaretAtEnd(r)}onMessageCorrecting(e){if(e.get("correcting"))this.insertIntoTextArea((0,l.prefixMentions)(e),!0,!0);else{const t=this.model.messages.findWhere("correcting");t&&t!==e?this.insertIntoTextArea((0,l.prefixMentions)(e),!0,!0):this.insertIntoTextArea("",!0,!1)}}onEscapePressed(e){const t=this.model.messages.findLastIndex("correcting"),s=t>=0?this.model.messages.at(t):null;s&&(e.preventDefault(),s.save("correcting",!1),this.insertIntoTextArea("",!0,!1))}onPaste(e){if(e.stopPropagation(),0!==e.clipboardData.files.length)return e.preventDefault(),void this.model.sendFiles(Array.from(e.clipboardData.files));this.model.set({draft:e.clipboardData.getData("text/plain")})}onKeyUp(e){this.model.set({draft:e.target.value})}onKeyDown(e){if(!e.ctrlKey){if(!e.shiftKey&&!e.altKey&&!e.metaKey)if(e.keyCode===i.converse.keycodes.TAB){const t=c.getCurrentWord(e.target,null,/(:.*?:)/g);t.startsWith(":")&&(e.preventDefault(),e.stopPropagation(),this.model.trigger("emoji-picker-autocomplete",e.target,t))}else{if(e.keyCode===i.converse.keycodes.FORWARD_SLASH)return;if(e.keyCode===i.converse.keycodes.ESCAPE)return this.onEscapePressed(e,this);if(e.keyCode===i.converse.keycodes.ENTER)return this.onFormSubmitted(e);if(e.keyCode!==i.converse.keycodes.UP_ARROW||e.target.selectionEnd){if(e.keyCode===i.converse.keycodes.DOWN_ARROW&&e.target.selectionEnd===e.target.value.length&&c.hasClass("correcting",this.querySelector(".chat-textarea")))return this.model.editLaterMessage()}else{const e=this.querySelector(".chat-textarea");if(!e.value||c.hasClass("correcting",e))return this.model.editEarlierMessage()}}[i.converse.keycodes.SHIFT,i.converse.keycodes.META,i.converse.keycodes.META_RIGHT,i.converse.keycodes.ESCAPE,i.converse.keycodes.ALT].includes(e.keyCode)||this.model.get("chat_state")!==i._converse.COMPOSING&&this.model.setChatState(i._converse.COMPOSING)}}async onFormSubmitted(e){e?.preventDefault?.();const t=this.querySelector(".chat-textarea"),s=t.value.trim();if(i.api.settings.get("message_limit")&&s.length>i.api.settings.get("message_limit")||!s.replace(/\s/g,"").length)return;if(!i._converse.connection.authenticated){const e=(0,o.__)("Sorry, the connection has been lost, and your message could not be sent");return i.api.alert("error",(0,o.__)("Error"),e),void i.api.connection.reconnect()}let n,r={};this.model.get("composing_spoiler")&&(r=this.querySelector("form.sendXMPPMessage input.spoiler-hint"),n=r.value),c.addClass("disabled",t),t.setAttribute("disabled","disabled"),this.querySelector("converse-emoji-dropdown")?.hideMenu();const l=await(0,a.parseMessageForCommands)(this.model,s),d=l?null:await this.model.sendMessage({body:s,spoiler_hint:n});if((l||d)&&(r.value="",t.value="",c.removeClass("correcting",t),t.style.height="auto",this.model.set({draft:""})),"overlayed"===i.api.settings.get("view_mode")){i._converse.chatboxviews.get(this.getAttribute("jid")).querySelector(".chat-content__messages").parentElement.style.display="none"}if(t.removeAttribute("disabled"),c.removeClass("disabled",t),"overlayed"===i.api.settings.get("view_mode")){i._converse.chatboxviews.get(this.getAttribute("jid")).querySelector(".chat-content__messages").parentElement.style.display=""}this.model.setChatState(i._converse.ACTIVE,{silent:!0}),t.focus()}}i.api.elements.define("converse-message-form",d)},"./src/plugins/chatview/templates/bottom-panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=(0,n.__)("You have unread messages"),s=r.api.settings.get("message_limit"),i=r.api.settings.get("visible_toolbar_buttons").call,a=r.api.settings.get("visible_toolbar_buttons").emoji,l=r.api.settings.get("show_send_button"),c=r.api.settings.get("visible_toolbar_buttons").spoiler,d=r.api.settings.get("show_toolbar");return o.html`
        ${e.model.ui.get("scrolled")&&e.model.get("num_unread")?o.html`<div class="new-msgs-indicator" @click=${t=>e.viewUnreadMessages(t)}> ${t} </div>`:""}
        ${r.api.settings.get("show_toolbar")?o.html`
            <converse-chat-toolbar
                class="chat-toolbar no-text-select"
                .model=${e.model}
                ?composing_spoiler="${e.model.get("composing_spoiler")}"
                ?show_call_button="${i}"
                ?show_emoji_button="${a}"
                ?show_send_button="${l}"
                ?show_spoiler_button="${c}"
                ?show_toolbar="${d}"
                message_limit="${s}"></converse-chat-toolbar>`:""}
        <converse-message-form jid="${e.model.get("jid")}"></converse-message-form>
    `}},"./src/plugins/chatview/templates/chat-head.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/shared/chat/utils.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/until.js");const l=e=>{const t=(0,n.__)("The User's Profile Image"),s=i.html`<span title="${t}">
        <converse-avatar
            class="avatar chat-msg__avatar"
            .data=${e.model.vcard?.attributes}
            nonce=${e.model.vcard?.get("vcard_updated")}
            height="40" width="40"></converse-avatar></span>`,l=e.model.getDisplayName();return i.html`
        <div class="chatbox-title ${e.status?"":"chatbox-title--no-desc"}">
            <div class="chatbox-title--row">
                ${r._converse.api.settings.get("singleton")?"":i.html`<converse-controlbox-navback jid="${e.jid}"></converse-controlbox-navback>`}
                ${e.type!==r._converse.HEADLINES_TYPE?i.html`<a class="show-msg-author-modal" @click=${e.showUserDetailsModal}>${s}</a>`:""}
                <div class="chatbox-title__text" title="${e.jid}">
                    ${e.type!==r._converse.HEADLINES_TYPE?i.html`<a class="user show-msg-author-modal" @click=${e.showUserDetailsModal}>${l}</a>`:l}
                </div>
            </div>
            <div class="chatbox-title__buttons row no-gutters">
                ${(0,a.until)((0,o.getDropdownButtons)(e.heading_buttons_promise),"")}
                ${(0,a.until)((0,o.getStandaloneButtons)(e.heading_buttons_promise),"")}
            </div>
        </div>
        ${e.status?i.html`<p class="chat-head__desc">${e.status}</p>`:""}
    `}},"./src/plugins/chatview/templates/chat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/headless/dist/converse-headless.js");const o=e=>n.html`
    <div class="flyout box-flyout">
        <converse-dragresize></converse-dragresize>
        ${e.model?n.html`
            <converse-chat-heading jid="${e.jid}" class="chat-head chat-head-chatbox row no-gutters"></converse-chat-heading>
            <div class="chat-body">
                <div class="chat-content ${e.show_send_button?"chat-content-sendbutton":""}" aria-live="polite">
                    <converse-chat-content
                        class="chat-content__messages"
                        jid="${e.jid}"></converse-chat-content>

                    ${e.show_help_messages?n.html`<div class="chat-content__help">
                            <converse-chat-help
                                .model=${e.model}
                                .messages=${e.help_messages}
                                ?hidden=${!e.show_help_messages}
                                type="info"
                                chat_type="${r._converse.CHATROOMS_TYPE}"
                            ></converse-chat-help></div>`:""}
                </div>
                <converse-chat-bottom-panel jid="${e.jid}" class="bottom-panel"> </converse-chat-bottom-panel>
            </div>
        `:""}
    </div>
`},"./src/plugins/chatview/templates/message-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/plugins/chatview/utils.js");const a=e=>{const t=e.composing_spoiler?(0,n.__)("Hidden message"):(0,n.__)("Message"),s=(0,n.__)("Optional hint"),a=r.api.settings.get("show_send_button");return o.html`
        <form class="sendXMPPMessage">
            <input type="text"
                   enterkeyhint="send"
                   placeholder="${s||""}"i
                   value="${e.hint_value||""}"
                   class="${e.composing_spoiler?"":"hidden"} spoiler-hint"/>
            <textarea
                autofocus
                type="text"
                enterkeyhint="send"
                @drop=${e.onDrop}
                @input=${i.resetElementHeight}
                @keydown=${e.onKeyDown}
                @keyup=${e.onKeyUp}
                @paste=${e.onPaste}
                @change=${e.onChange}
                class="chat-textarea
                    ${a?"chat-textarea-send-button":""}
                    ${e.composing_spoiler?"spoiler":""}"
                placeholder="${t}">${e.message_value||""}</textarea>
        </form>`}},"./src/plugins/chatview/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearHistory:()=>o,clearMessages:()=>i,parseMessageForCommands:()=>a,resetElementHeight:()=>l});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js");function o(e){r._converse.router.history.getFragment()===`converse/chat?jid=${e}`&&r._converse.router.navigate("")}async function i(e){await r.api.confirm((0,n.__)("Are you sure you want to clear the messages from this conversation?"))&&await e.clearMessages()}async function a(e,t){const s=t.replace(/^\s*/,"").match(/^\/(.*)\s*$/);if(s){let n=!1;if(n=await r.api.hook("parseMessageForCommands",{model:e,text:t},n),n)return!0;if("clear"===s[1])return i(e),!0;if("close"===s[1])return r._converse.chatboxviews.get(e.get("jid"))?.close(),!0;if("help"===s[1])return e.set({show_help_messages:!1},{silent:!0}),e.set({show_help_messages:!0}),!0}return!1}function l(e){if(e.target.value){const t=e.target.scrollHeight+"px";e.target.style.height!=t&&(e.target.style.height="auto",e.target.style.height=t)}else e.target.style=""}},"./src/plugins/controlbox/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/dist/converse-headless.js");const{u:r}=n.converse.env,o={controlbox:{async open(){await n.api.waitUntil("chatBoxesFetched");const e=await n.api.chatboxes.get("controlbox")||n.api.chatboxes.create("controlbox",{},n._converse.Controlbox);return r.safeSave(e,{closed:!1}),e},get:()=>n._converse.chatboxviews.get("controlbox")}}},"./src/plugins/controlbox/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CONNECTION_STATUS_CSS_CLASS:()=>a,PRETTY_CONNECTION_STATUS:()=>i,REPORTABLE_STATUSES:()=>o});var n=s("./src/headless/dist/converse-headless.js");const{Strophe:r}=n.converse.env,o=[r.Status.ERROR,r.Status.CONNECTING,r.Status.CONNFAIL,r.Status.AUTHENTICATING,r.Status.AUTHFAIL,r.Status.DISCONNECTING,r.Status.RECONNECTING],i=Object.fromEntries([[r.Status.ERROR,"Error"],[r.Status.CONNECTING,"Connecting"],[r.Status.CONNFAIL,"Connection failure"],[r.Status.AUTHENTICATING,"Authenticating"],[r.Status.AUTHFAIL,"Authentication failure"],[r.Status.CONNECTED,"Connected"],[r.Status.DISCONNECTED,"Disconnected"],[r.Status.DISCONNECTING,"Disconnecting"],[r.Status.ATTACHED,"Attached"],[r.Status.REDIRECT,"Redirect"],[r.Status.CONNTIMEOUT,"Connection timeout"],[r.Status.RECONNECTING,"Reconnecting"]]),a=Object.fromEntries([[r.Status.ERROR,"error"],[r.Status.CONNECTING,"info"],[r.Status.CONNFAIL,"error"],[r.Status.AUTHENTICATING,"info"],[r.Status.AUTHFAIL,"error"],[r.Status.CONNECTED,"info"],[r.Status.DISCONNECTED,"error"],[r.Status.DISCONNECTING,"warn"],[r.Status.ATTACHED,"info"],[r.Status.REDIRECT,"info"],[r.Status.RECONNECTING,"warn"]])},"./src/plugins/controlbox/controlbox.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/controlbox/templates/controlbox.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/shared/constants.js");const a=o.converse.env.utils;class l extends r.CustomElement{initialize(){this.setModel(),o._converse.chatboxviews.add("controlbox",this),this.model.get("connected")&&void 0===this.model.get("closed")&&this.model.set("closed",!o.api.settings.get("show_controlbox_by_default")),this.requestUpdate(),o.api.trigger("controlBoxInitialized",this)}setModel(){this.model=o._converse.chatboxes.get("controlbox"),this.listenTo(o._converse.connfeedback,"change:connection_status",(()=>this.requestUpdate())),this.listenTo(this.model,"change:active-form",(()=>this.requestUpdate())),this.listenTo(this.model,"change:connected",(()=>this.requestUpdate())),this.listenTo(this.model,"change:closed",(()=>!this.model.get("closed")&&this.afterShown())),this.requestUpdate()}render(){return this.model?(0,n.default)(this):""}close(e){if(e?.preventDefault?.(),("closeAllChatBoxes"!==e?.name||o._converse.disconnection_cause===i.LOGOUT&&!o.api.settings.get("show_controlbox_by_default"))&&!o.api.settings.get("sticky_controlbox"))return a.safeSave(this.model,{closed:!0}),o.api.trigger("controlBoxClosed",this),this}afterShown(){return o.api.trigger("controlBoxOpened",this),this}}o.api.elements.define("converse-controlbox",l);const c=l},"./src/plugins/controlbox/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/shared/components/brand-heading.js"),s("./src/plugins/chatview/index.js"),s("./src/plugins/controlbox/loginform.js"),s("./src/plugins/controlbox/navback.js");var n=s("./src/plugins/controlbox/model.js"),r=s("./src/plugins/controlbox/toggle.js"),o=s("./src/plugins/controlbox/controlbox.js"),i=s("./src/plugins/controlbox/api.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/plugins/controlbox/utils.js");s("./src/plugins/controlbox/styles/_controlbox.scss"),s("./src/plugins/controlbox/styles/controlbox-head.scss");a.converse.plugins.add("converse-controlbox",{dependencies:["converse-modal","converse-chatboxes","converse-chat","converse-rosterview","converse-chatview"],enabled:e=>!e.api.settings.get("singleton"),overrides:{ChatBoxes:{model(e,t){return e&&"controlbox"==e.id?new n.default(e,t):this.__super__.model.apply(this,arguments)}}},initialize(){a.api.settings.extend({allow_logout:!0,allow_user_trust_override:!0,default_domain:void 0,locked_domain:void 0,show_connection_url_input:!1,show_controlbox_by_default:!1,sticky_controlbox:!1}),a.api.promises.add("controlBoxInitialized",!1),Object.assign(a.api,i.default),a._converse.ControlBoxView=o.default,a._converse.ControlBox=n.default,a._converse.ControlBoxToggle=r.default,a.api.listen.on("chatBoxesFetched",l.onChatBoxesFetched),a.api.listen.on("clearSession",l.clearSession),a.api.listen.on("will-reconnect",l.disconnect),a.api.waitUntil("chatBoxViewsInitialized").then(l.addControlBox).catch((e=>a.log.fatal(e)))}})},"./src/plugins/controlbox/loginform.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./node_modules/bootstrap.native/dist/bootstrap-native.js"),r=s.n(n),o=s("./src/plugins/controlbox/templates/loginform.js"),i=s("./src/headless/shared/constants.js"),a=s("./src/shared/components/element.js"),l=s("./src/headless/dist/converse-headless.js"),c=s("./src/headless/utils/init.js"),d=s("./src/plugins/controlbox/utils.js");const{Strophe:u,u:h}=l.converse.env;class f extends a.CustomElement{initialize(){this.listenTo(l._converse.connfeedback,"change",(()=>this.requestUpdate())),this.handler=()=>this.requestUpdate()}connectedCallback(){super.connectedCallback(),l.api.settings.listen.on("change",this.handler)}disconnectedCallback(){super.disconnectedCallback(),l.api.settings.listen.not("change",this.handler)}render(){return(0,o.default)(this)}firstUpdated(){this.initPopovers()}async onLoginFormSubmitted(e){if(e?.preventDefault(),l.api.settings.get("authentication")===i.ANONYMOUS)return this.connect(l._converse.jid);(0,d.validateJID)(e.target)&&((0,d.updateSettingsWithFormData)(e.target),l.api.settings.get("bosh_service_url")||l.api.settings.get("websocket_url")||await this.discoverConnectionMethods(e),l.api.settings.get("bosh_service_url")||l.api.settings.get("websocket_url")?this.connect():l.api.settings.set("show_connection_url_input",!0))}discoverConnectionMethods(e){if(!l.api.settings.get("discover_connection_methods"))return;const t=new FormData(e.target).get("jid"),s=u.getDomainFromJid(t);return(!l._converse.connection?.jid||t&&!h.isSameDomain(l._converse.connection.jid,t))&&(0,c.initConnection)(),l._converse.connection.discoverConnectionMethods(s)}initPopovers(){Array.from(this.querySelectorAll("[data-title]")).forEach((e=>{new(r().Popover)(e,{trigger:"mobile"===l.api.settings.get("view_mode")?"click":"hover",dismissible:"mobile"===l.api.settings.get("view_mode"),container:this.parentElement.parentElement.parentElement})}))}connect(e){["converse/login","converse/register"].includes(l._converse.router.history.getFragment())&&l._converse.router.navigate("",{replace:!0}),l._converse.connection?.reset(),l.api.user.login(e)}}l.api.elements.define("converse-login-form",f)},"./src/plugins/controlbox/model.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/@converse/skeletor/src/model.js");const{dayjs:o}=n.converse.env;class i extends r.Model{defaults(){return{bookmarked:!1,box_id:"controlbox",chat_state:void 0,closed:!n.api.settings.get("show_controlbox_by_default"),num_unread:0,time_opened:o(0).valueOf(),type:n._converse.CONTROLBOX_TYPE,url:""}}validate(e){return e.type===n._converse.CONTROLBOX_TYPE?"embedded"===n.api.settings.get("view_mode")&&n.api.settings.get("singleton")?"Controlbox not relevant in embedded view mode":void 0:n._converse.ChatBox.prototype.validate.call(this,e)}maybeShow(e){return e||"controlbox"!==this.get("id")?n._converse.ChatBox.prototype.maybeShow.call(this,e):this}onReconnection(){this.save("connected",!0)}}const a=i},"./src/plugins/controlbox/navback.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/controlbox/templates/navback.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}render(){return(0,n.default)(this.jid)}}o.api.elements.define("converse-controlbox-navback",i);const a=i},"./src/plugins/controlbox/templates/controlbox.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/templates/spinner.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const{Strophe:i}=r.converse.env;const a=e=>{const t=e.model.toJSON(),s=r.api.settings.get("sticky_controlbox");return o.html`
        <div class="flyout box-flyout">
            <converse-dragresize></converse-dragresize>
            <div class="chat-head controlbox-head">
                ${s?"":o.html`
                        <a class="chatbox-btn close-chatbox-button" @click=${t=>e.close(t)}>
                            <converse-icon class="fa fa-times" size="1em"></converse-icon>
                        </a>
                    `}
            </div>
            <div class="controlbox-panes">
                <div class="controlbox-pane">
                    ${t.connected?o.html`
                            <converse-user-profile></converse-user-profile>
                            <converse-headlines-feeds-list class="controlbox-section"></converse-headlines-feeds-list>
                            <div id="chatrooms" class="controlbox-section"><converse-rooms-list></converse-rooms-list></div>
                            ${r.api.settings.get("authentication")===r._converse.ANONYMOUS?"":o.html`<div id="converse-roster" class="controlbox-section"><converse-roster></converse-roster></div>`}`:function(e){const t=r._converse.connfeedback.get("connection_status");return[i.Status.RECONNECTING,i.Status.CONNECTING].includes(t)?(0,n.default)():"register"===e["active-form"]?o.html`<converse-register-panel></converse-register-panel>`:o.html`<converse-login-form id="converse-login-panel" class="controlbox-pane fade-in row no-gutters"></converse-login-form>`}(t)}
                </div>
            </div>
        </div>`}},"./src/plugins/controlbox/templates/loginform.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});s("./src/shared/components/brand-heading.js");var n=s("./src/templates/spinner.js"),r=s("./src/headless/shared/constants.js"),o=s("./src/plugins/controlbox/constants.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./node_modules/lit/index.js");const c=e=>{const t=a.api.settings.get("authentication"),s=(0,i.__)("Log in"),n=(0,i.__)("XMPP Address"),o=a.api.settings.get("locked_domain"),c=a.api.settings.get("default_domain"),d=(o||c)&&(0,i.__)("Username")||(0,i.__)("user@domain"),u=a.api.settings.get("allow_user_trust_override");return l.html`
        <div class="form-group">
            <label for="converse-login-jid">${n}:</label>
            <input
                id="converse-login-jid"
                ?autofocus=${!!a.api.settings.get("auto_focus")}
                @changed=${e.validate}
                value="${a.api.settings.get("jid")??""}"
                required
                class="form-control"
                type="text"
                name="jid"
                placeholder="${d}"
            />
        </div>
        ${t!==r.EXTERNAL?(()=>{const e=(0,i.__)("Password");return l.html`
        <div class="form-group">
            <label for="converse-login-password">${e}</label>
            <input
                id="converse-login-password"
                class="form-control"
                required="required"
                value="${a.api.settings.get("password")??""}"
                type="password"
                name="password"
                placeholder="${e}"
            />
        </div>
    `})():""}
        ${a.api.settings.get("show_connection_url_input")?(()=>{const e=(0,i.__)("Connection URL"),t=(0,i.__)("HTTP or websocket URL that is used to connect to your XMPP server"),s=(0,i.__)("e.g. wss://example.org/xmpp-websocket");return l.html`
        <div class="form-group fade-in">
            <label for="converse-conn-url">${e}</label>
            <p class="form-help instructions">${t}</p>
            <input
                id="converse-conn-url"
                class="form-control"
                type="url"
                name="connection-url"
                placeholder="${s}"
            />
        </div>
    `})():""}
        ${u?(e=>{const t=(0,i.__)("To improve performance, we cache your data in this browser. Uncheck this box if this is a public computer or if you want your data to be deleted when you log out. It's important that you explicitly log out, otherwise not all cached data might be deleted. Please note, when using an untrusted device, OMEMO encryption is NOT available."),s=(0,i.__)("This is a trusted device");return l.html`
        <div class="form-group form-check login-trusted">
            <input
                id="converse-login-trusted"
                type="checkbox"
                class="form-check-input"
                name="trusted"
                ?checked=${e}
            />
            <label for="converse-login-trusted" class="form-check-label login-trusted__desc">${s}</label>

            <converse-icon
                class="fa fa-info-circle"
                data-toggle="popover"
                data-title="Trusted device?"
                data-content="${t}"
                size="1.2em"
                title="${t}"
            ></converse-icon>
        </div>
    `})("off"!==u):""}
        <fieldset class="form-group buttons">
            <input class="btn btn-primary" type="submit" value="${s}" />
        </fieldset>
        ${a.api.settings.get("allow_registration")&&!a.api.settings.get("auto_login")&&a._converse.pluggable.plugins["converse-register"].enabled(a._converse)?(()=>{const e=(0,i.__)("Create an account"),t=(0,i.__)("Don't have a chat account?");return l.html`
        <fieldset class="switch-form">
            <p>${t}</p>
            <p>
                <a class="register-account toggle-register-login" href="#converse/register">${e}</a>
            </p>
        </fieldset>
    `})():""}
    `},d=e=>{const t=a._converse.connfeedback.get("connection_status");let s,d;o.REPORTABLE_STATUSES.includes(t)&&(d=o.PRETTY_CONNECTION_STATUS[t],s=o.CONNECTION_STATUS_CSS_CLASS[t]);const u=a._converse.connfeedback.get("message");return l.html` <converse-brand-heading></converse-brand-heading>
        <form id="converse-login" class="converse-form" method="post" @submit=${e.onLoginFormSubmitted}>
            <div class="conn-feedback fade-in ${d?s:"hidden"}">
                <p class="feedback-subject">${d}</p>
                <p class="feedback-message ${u?"":"hidden"}">${u}</p>
            </div>
            ${"CONNECTING"===r.CONNECTION_STATUS[t]?(0,n.default)({classes:"hor_centered"}):(e=>{const t=a.api.settings.get("authentication"),s=(0,i.__)("Disconnected"),n=(0,i.__)("Click here to log in anonymously");return l.html`
        ${t==r.LOGIN||t==r.EXTERNAL?c(e):""}
        ${t==r.ANONYMOUS?l.html`<input class="btn btn-primary login-anon" type="submit" value="${n}" />`:""}
        ${t==r.PREBIND?l.html`<p>${s}</p>`:""}
    `})(e)}
        </form>`}},"./src/plugins/controlbox/templates/navback.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/plugins/controlbox/utils.js");const o=e=>n.html`<converse-icon size="1em" class="fa fa-arrow-left" @click=${()=>(0,r.navigateToControlBox)(e)}></converse-icon>`},"./src/plugins/controlbox/templates/toggle.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=r.api.connection.connected()?(0,n.__)("Chat Contacts"):(0,n.__)("Toggle chat");return o.html`<a id="toggle-controlbox" class="toggle-controlbox ${e.hide?"hidden":""}" @click=${e.onClick}><span class="toggle-feedback">${t}</span></a>`}},"./src/plugins/controlbox/toggle.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/controlbox/templates/toggle.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/plugins/controlbox/utils.js");class a extends r.CustomElement{async connectedCallback(){super.connectedCallback(),await o.api.waitUntil("initialized"),this.model=o._converse.chatboxes.get("controlbox"),this.listenTo(this.model,"change:closed",(()=>this.requestUpdate())),this.requestUpdate()}render(){return(0,n.default)({onClick:i.showControlBox,hide:!this.model?.get("closed")})}}o.api.elements.define("converse-controlbox-toggle",a);const l=a},"./src/plugins/controlbox/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addControlBox:()=>a,clearSession:()=>u,disconnect:()=>d,navigateToControlBox:()=>c,onChatBoxesFetched:()=>h,showControlBox:()=>l,updateSettingsWithFormData:()=>f,validateJID:()=>m});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js");const{Strophe:o,u:i}=r.converse.env;function a(){const e=r._converse.chatboxes.add(new r._converse.ControlBox({id:"controlbox"}));return r._converse.chatboxviews.get("controlbox")?.setModel(),e}function l(e){e?.preventDefault?.();const t=r._converse.chatboxes.get("controlbox")||a();i.safeSave(t,{closed:!1})}function c(e){l();const t=r._converse.chatboxes.get(e);i.safeSave(t,{hidden:!0})}function d(){const e=r._converse.chatboxviews.get("controlbox");return e.model.set({connected:!1}),e}function u(){const e=r._converse?.chatboxviews,t=e&&e.get("controlbox");t&&(i.safeSave(t.model,{connected:!1}),t?.controlbox_pane&&(t.controlbox_pane.remove(),delete t.controlbox_pane))}function h(){(r._converse.chatboxes.get("controlbox")||a()).save({connected:!0})}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new FormData(e),n=s.get("connection-url");n?.startsWith("ws")?t.websocket_url=n:n?.startsWith("http")&&(t.bosh_service_url=n);let i=s.get("jid");if(r.api.settings.get("locked_domain")){const e="@"+r.api.settings.get("locked_domain");i.endsWith(e)&&(i=i.substr(0,i.length-e.length)),i=o.escapeNode(i)+e}else r.api.settings.get("default_domain")&&!i.includes("@")&&(i=i+"@"+r.api.settings.get("default_domain"));t.jid=i,t.password=s.get("password"),r.api.settings.set(t),r._converse.config.save({trusted:!!s.get("trusted")})}function m(e){const t=e.querySelector("input[name=jid]");return!t.value||r.api.settings.get("locked_domain")||r.api.settings.get("default_domain")||i.isValidJID(t.value)?(t.setCustomValidity(""),!0):(t.setCustomValidity((0,n.__)("Please enter a valid XMPP address")),!1)}},"./src/plugins/dragresize/components/dragresize.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/dragresize/templates/dragresize.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{render(){return(0,n.default)()}}o.api.elements.define("converse-dragresize",i)},"./src/plugins/dragresize/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/dragresize/components/dragresize.js");var n=s("./src/plugins/dragresize/utils.js"),r=s("./src/plugins/dragresize/mixin.js"),o=s("./src/headless/dist/converse-headless.js");o.converse.plugins.add("converse-dragresize",{dependencies:["converse-chatview","converse-headlines-view","converse-muc-views"],enabled:e=>"overlayed"==e.api.settings.get("view_mode"),overrides:{ChatBox:{initialize(){const e=this.__super__.initialize.apply(this,arguments),t=this.get("height"),s=this.get("width");return("controlbox"===this.get("id")?e=>this.set(e):e=>this.save(e))({height:(0,n.applyDragResistance)(t,this.get("default_height")),width:(0,n.applyDragResistance)(s,this.get("default_width"))}),e}}},initialize(){function e(e){const t=document.getElementsByTagName("iframe");for(let s of t)e.addEventListener("mousedown",(()=>{s.style.pointerEvents="none"}),{once:!0}),e.addEventListener("mouseup",(()=>{s.style.pointerEvents="initial"}),{once:!0})}o.api.settings.extend({allow_dragresize:!0}),Object.assign(o._converse.ChatBoxView.prototype,r.default),Object.assign(o._converse.ChatRoomView.prototype,r.default),o._converse.ControlBoxView&&Object.assign(o._converse.ControlBoxView.prototype,r.default),o.api.listen.on("registeredGlobalEventHandlers",(function(){document.addEventListener("mousemove",n.onMouseMove),document.addEventListener("mouseup",n.onMouseUp)})),o.api.listen.on("unregisteredGlobalEventHandlers",(function(){document.removeEventListener("mousemove",n.onMouseMove),document.removeEventListener("mouseup",n.onMouseUp)})),o.api.listen.on("beforeShowingChatView",(e=>e.initDragResize().setDimensions())),o.api.listen.on("startDiagonalResize",e),o.api.listen.on("startHorizontalResize",e),o.api.listen.on("startVerticalResize",e)}})},"./src/plugins/dragresize/mixin.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/dragresize/utils.js");const i={initDragResize(){const e=this,t=(0,n.default)((()=>e.setDimensions()));window.addEventListener("resize",e.debouncedSetDimensions),this.listenTo(this.model,"destroy",(()=>window.removeEventListener("resize",t)));const s=this.querySelector(".box-flyout"),o=window.getComputedStyle(s);if(void 0===this.model.get("height")){const e=parseInt(o.height.replace(/px$/,""),10),t=parseInt(o.width.replace(/px$/,""),10);this.model.set("height",e),this.model.set("default_height",e),this.model.set("width",t),this.model.set("default_width",t)}const i=o["min-width"],a=o["min-height"];return this.model.set("min_width",i.endsWith("px")?Number(i.replace(/px$/,"")):0),this.model.set("min_height",a.endsWith("px")?Number(a.replace(/px$/,"")):0),this.prev_pageY=0,this.prev_pageX=0,r._converse.connection?.connected&&(this.height=this.model.get("height"),this.width=this.model.get("width")),this},resizeChatBox(e){let t;0===r._converse.resizing.direction.indexOf("top")&&(t=e.pageY-this.prev_pageY,t&&(this.height=this.height-t>(this.model.get("min_height")||0)?this.height-t:this.model.get("min_height"),this.prev_pageY=e.pageY,this.setChatBoxHeight(this.height))),r._converse.resizing.direction.includes("left")&&(t=this.prev_pageX-e.pageX,t&&(this.width=this.width+t>(this.model.get("min_width")||0)?this.width+t:this.model.get("min_width"),this.prev_pageX=e.pageX,this.setChatBoxWidth(this.width)))},setDimensions(){this.adjustToViewport(),this.setChatBoxHeight(this.model.get("height")),this.setChatBoxWidth(this.model.get("width"))},setChatBoxHeight(e){e=e?(0,o.applyDragResistance)(e,this.model.get("default_height"))+"px":"";const t=this.querySelector(".box-flyout");null!==t&&(t.style.height=e)},setChatBoxWidth(e){e=e?(0,o.applyDragResistance)(e,this.model.get("default_width"))+"px":"",this.style.width=e;const t=this.querySelector(".box-flyout");null!==t&&(t.style.width=e)},adjustToViewport(){const e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0);e<=480?(this.model.set("height",void 0),this.model.set("width",void 0)):e<=this.model.get("width")?this.model.set("width",void 0):t<=this.model.get("height")&&this.model.set("height",void 0)}}},"./src/plugins/dragresize/templates/dragresize.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/plugins/dragresize/utils.js");const o=()=>n.html`
    <div class="dragresize dragresize-top" @mousedown="${r.onStartVerticalResize}"></div>
    <div class="dragresize dragresize-topleft" @mousedown="${r.onStartDiagonalResize}"></div>
    <div class="dragresize dragresize-left" @mousedown="${r.onStartHorizontalResize}"></div>
`},"./src/plugins/dragresize/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{applyDragResistance:()=>l,onMouseMove:()=>c,onMouseUp:()=>d,onStartDiagonalResize:()=>a,onStartHorizontalResize:()=>i,onStartVerticalResize:()=>o});var n=s("./src/headless/dist/converse-headless.js");const{u:r}=n.converse.env;function o(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n.api.settings.get("allow_dragresize"))return!0;e.preventDefault();const s=r.ancestor(e.target,".box-flyout"),o=window.getComputedStyle(s),i=s.parentElement;i.height=parseInt(o.height.replace(/px$/,""),10),n._converse.resizing={chatbox:i,direction:"top"},i.prev_pageY=e.pageY,t&&n.api.trigger("startVerticalResize",i)}function i(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n.api.settings.get("allow_dragresize"))return!0;e.preventDefault();const s=r.ancestor(e.target,".box-flyout"),o=window.getComputedStyle(s),i=s.parentElement;i.width=parseInt(o.width.replace(/px$/,""),10),n._converse.resizing={chatbox:i,direction:"left"},i.prev_pageX=e.pageX,t&&n.api.trigger("startHorizontalResize",i)}function a(e){i(e,!1),o(e,!1),n._converse.resizing.direction="topleft",n.api.trigger("startDiagonalResize",this)}function l(e,t){if(void 0===e)return;if(void 0===t)return e;return e!==t&&Math.abs(e-t)<10?t:e}function c(e){if(!n._converse.resizing||!n.api.settings.get("allow_dragresize"))return!0;e.preventDefault(),n._converse.resizing.chatbox.resizeChatBox(e)}function d(e){if(!n._converse.resizing||!n.api.settings.get("allow_dragresize"))return!0;e.preventDefault();const t=l(n._converse.resizing.chatbox.height,n._converse.resizing.chatbox.model.get("default_height")),s=l(n._converse.resizing.chatbox.width,n._converse.resizing.chatbox.model.get("default_width"));n.api.connection.connected()?(n._converse.resizing.chatbox.model.save({height:t}),n._converse.resizing.chatbox.model.save({width:s})):(n._converse.resizing.chatbox.model.set({height:t}),n._converse.resizing.chatbox.model.set({width:s})),n._converse.resizing=null}},"./src/plugins/fullscreen/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/headless/utils/core.js");s("./src/plugins/fullscreen/styles/fullscreen.scss");n.converse.plugins.add("converse-fullscreen",{enabled:()=>(0,r.isUniView)(),initialize(){n.api.settings.extend({chatview_avatar_height:50,chatview_avatar_width:50,hide_open_bookmarks:!0,show_controlbox_by_default:!0,sticky_controlbox:!0})}})},"./src/plugins/headlines-view/feed-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{HeadlinesFeedsList:()=>i});var n=s("./src/plugins/headlines-view/templates/feeds-list.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{initialize(){this.model=o._converse.chatboxes,this.listenTo(this.model,"add",(e=>this.renderIfHeadline(e))),this.listenTo(this.model,"remove",(e=>this.renderIfHeadline(e))),this.listenTo(this.model,"destroy",(e=>this.renderIfHeadline(e))),this.requestUpdate()}render(){return(0,n.default)(this)}renderIfHeadline(e){return e?.get("type")===o._converse.HEADLINES_TYPE&&this.requestUpdate()}async openHeadline(e){e.preventDefault();const t=e.target.getAttribute("data-headline-jid");(await o.api.headlines.get(t)).maybeShow(!0)}}o.api.elements.define("converse-headlines-feeds-list",i)},"./src/plugins/headlines-view/heading.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/headlines-view/templates/chat-head.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends r.CustomElement{static get properties(){return{jid:{type:String}}}async initialize(){this.model=i._converse.chatboxes.get(this.jid),await this.model.initialized,this.requestUpdate()}render(){return(0,n.default)({...this.model.toJSON(),display_name:this.model.getDisplayName(),heading_buttons_promise:this.getHeadingButtons()})}getHeadingButtons(){const e=[];return i.api.settings.get("singleton")||e.push({a_class:"close-chatbox-button",handler:e=>this.close(e),i18n_text:(0,o.__)("Close"),i18n_title:(0,o.__)("Close these announcements"),icon_class:"fa-times",name:"close",standalone:"overlayed"===i.api.settings.get("view_mode")}),i._converse.api.hook("getHeadingButtons",this,e)}close(e){e.preventDefault(),this.model.close()}}i.api.elements.define("converse-headlines-heading",a)},"./src/plugins/headlines-view/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/chatview/index.js"),s("./src/plugins/headlines-view/view.js");var n=s("./src/plugins/headlines-view/feed-list.js"),r=s("./src/headless/dist/converse-headless.js");s("./src/plugins/headlines-view/styles/headlines.scss"),s("./src/plugins/headlines-view/styles/headlines-head.scss");r.converse.plugins.add("converse-headlines-view",{dependencies:["converse-headlines","converse-chatview"],initialize(){r._converse.HeadlinesFeedsList=n.HeadlinesFeedsList,r._converse.HeadlinesPanel=n.HeadlinesFeedsList}})},"./src/plugins/headlines-view/templates/chat-head.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/index.js"),o=s("./node_modules/lit/directives/until.js"),i=s("./src/shared/chat/utils.js");const a=e=>r.html`
        <div class="chatbox-title ${e.status?"":"chatbox-title--no-desc"}">
            <div class="chatbox-title--row">
                ${n._converse.api.settings.get("singleton")?"":r.html`<converse-controlbox-navback jid="${e.jid}"></converse-controlbox-navback>`}
                <div class="chatbox-title__text" title="${e.jid}">${e.display_name}</div>
            </div>
            <div class="chatbox-title__buttons row no-gutters">
                ${(0,o.until)((0,i.getDropdownButtons)(e.heading_buttons_promise),"")}
                ${(0,o.until)((0,i.getStandaloneButtons)(e.heading_buttons_promise),"")}
            </div>
        </div>
        ${e.status?r.html`<p class="chat-head__desc">${e.status}</p>`:""}
    `},"./src/plugins/headlines-view/templates/feeds-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=e.model.filter((e=>e.get("type")===r._converse.HEADLINES_TYPE)),s=(0,n.__)("Announcements");return o.html`
        <div class="controlbox-section" id="headline">
            <div class="d-flex controlbox-padded ${t.length?"":"hidden"}">
                <span class="w-100 controlbox-heading controlbox-heading--headline">${s}</span>
            </div>
        </div>
        <div class="list-container list-container--headline ${t.length?"":"hidden"}">
            <div class="items-list rooms-list headline-list">
                ${t.map((t=>function(e,t){const s=(0,n.__)("Click to open this server message");return o.html`
        <div class="list-item controlbox-padded d-flex flex-row"
            data-headline-jid="${t.get("jid")}">
        <a class="list-item-link open-headline available-room w-100"
            data-headline-jid="${t.get("jid")}"
            title="${s}"
            @click=${t=>e.openHeadline(t)}
            href="#">${t.get("jid")}</a>
        </div>
    `}(e,t)))}
            </div>
        </div>`}},"./src/plugins/headlines-view/templates/headlines.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});s("./src/plugins/headlines-view/heading.js");var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="flyout box-flyout">
        <converse-dragresize></converse-dragresize>
        ${e?n.html`
            <converse-headlines-heading jid="${e.get("jid")}" class="chat-head chat-head-chatbox row no-gutters">
            </converse-headlines-heading>
            <div class="chat-body">
                <div class="chat-content" aria-live="polite">
                    <converse-chat-content
                        class="chat-content__messages"
                        jid="${e.get("jid")}"></converse-chat-content>
                </div>
            </div>`:""}
    </div>
`},"./src/plugins/headlines-view/view.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/shared/chat/baseview.js"),r=s("./src/plugins/headlines-view/templates/headlines.js"),o=s("./src/headless/dist/converse-headless.js");class i extends n.default{async initialize(){o._converse.chatboxviews.add(this.jid,this),this.model=o._converse.chatboxes.get(this.jid),this.model.disable_mam=!0,this.listenTo(o._converse,"windowStateChanged",this.onWindowStateChanged),this.listenTo(this.model,"change:hidden",(()=>this.afterShown())),this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model.messages,"add",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"remove",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"reset",(()=>this.requestUpdate())),await this.model.messages.fetched,this.model.maybeShow(),o.api.trigger("headlinesBoxViewInitialized",this)}render(){return(0,r.default)(this.model)}async close(e){return e?.preventDefault?.(),o._converse.router.history.getFragment()==="converse/chat?jid="+this.model.get("jid")&&o._converse.router.navigate(""),await this.model.close(e),this}getNotifications(){return[]}afterShown(){this.model.clearUnreadMsgCounter()}}o.api.elements.define("converse-headlines",i)},"./src/plugins/mam-views/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/mam-views/placeholder.js");var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/plugins/mam-views/utils.js");n.converse.plugins.add("converse-mam-views",{dependencies:["converse-mam","converse-chatview","converse-muc-views"],initialize(){n.api.listen.on("chatBoxScrolledUp",r.fetchMessagesOnScrollUp),n.api.listen.on("getMessageTemplate",r.getPlaceholderTemplate)}})},"./src/plugins/mam-views/placeholder.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/shared/components/element.js"),r=s("./src/plugins/mam-views/templates/placeholder.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/plugins/mam/utils.js");s("./src/plugins/mam-views/styles/placeholder.scss");class a extends n.CustomElement{static get properties(){return{model:{type:Object}}}render(){return(0,r.default)(this)}async fetchMissingMessages(e){e?.preventDefault?.(),this.model.set("fetching",!0);const t={before:this.model.get("before"),start:this.model.get("start")};await(0,i.fetchArchivedMessages)(this.model.collection.chatbox,t),this.model.destroy()}}o.api.elements.define("converse-mam-placeholder",a)},"./src/plugins/mam-views/templates/placeholder.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/templates/spinner.js"),r=s("./src/i18n/index.js"),o=s("./node_modules/lit/html.js");const i=e=>e.model.get("fetching")?(0,n.default)({classes:"hor_centered"}):o.html`<a @click="${t=>e.fetchMissingMessages(t)}" title="${(0,r.__)("Click to load missing messages")}">
            <div class="message mam-placeholder"></div>
        </a>`},"./src/plugins/mam-views/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{fetchMessagesOnScrollUp:()=>l,getPlaceholderTemplate:()=>a});var n=s("./src/headless/plugins/mam/placeholder.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/headless/plugins/mam/utils.js"),i=s("./node_modules/lit/html.js");function a(e,t){return e instanceof n.default?i.html`<converse-mam-placeholder .model=${e}></converse-mam-placeholder>`:t}async function l(e){if(!e.model.ui.get("chat-content-spinner-top")&&e.model.messages.length){const t=e.model.get("type")===r._converse.CHATROOMS_TYPE,s=e.model.getOldestMessage();if(s){const n=t?e.model.get("jid"):r._converse.bare_jid,i=s&&s.get(`stanza_id ${n}`);e.model.ui.set("chat-content-spinner-top",!0);try{i?await(0,o.fetchArchivedMessages)(e.model,{before:i}):await(0,o.fetchArchivedMessages)(e.model,{end:s.get("time")})}catch(t){return r.log.error(t),void e.model.ui.set("chat-content-spinner-top",!1)}r.api.settings.get("allow_url_history_change")&&r._converse.router.history.navigate(`#${s.get("msgid")}`),setTimeout((()=>e.model.ui.set("chat-content-spinner-top",!1)),250)}}}},"./src/plugins/minimize/components/minimized-chat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/minimize/templates/trimmed_chat.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/plugins/minimize/utils.js");class a extends r.CustomElement{static get properties(){return{model:{type:Object},title:{type:String},type:{type:String},num_unread:{type:Number}}}render(){const e={close:e=>this.close(e),num_unread:this.num_unread,restore:e=>this.restore(e),title:this.title,type:this.type};return(0,n.default)(e)}close(e){e?.preventDefault(),this.model.close()}restore(e){e?.preventDefault(),(0,i.maximize)(this.model)}}o.api.elements.define("converse-minimized-chat",a)},"./src/plugins/minimize/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/minimize/view.js"),s("./src/plugins/minimize/components/minimized-chat.js");var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/plugins/minimize/toggle.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/plugins/minimize/utils.js");s("./src/plugins/minimize/styles/minimize.scss");o.converse.plugins.add("converse-minimize",{dependencies:["converse-chatview","converse-controlbox","converse-muc-views","converse-headlines-view","converse-dragresize"],enabled:e=>"overlayed"===e.api.settings.get("view_mode"),overrides:{ChatBox:{maybeShow(e){return!e&&this.get("minimized")?this:this.__super__.maybeShow.apply(this,arguments)},isHidden(){return this.__super__.isHidden.call(this)||this.get("minimized")}},ChatBoxView:{isNewMessageHidden(){return this.model.get("minimized")||this.__super__.isNewMessageHidden.apply(this,arguments)},setChatBoxHeight(e){if(!this.model.get("minimized"))return this.__super__.setChatBoxHeight.call(this,e)},setChatBoxWidth(e){if(!this.model.get("minimized"))return this.__super__.setChatBoxWidth.call(this,e)}}},initialize(){function e(e){(0,i.initializeChat)(e),e.on("change:minimized",(()=>(0,i.onMinimizedChanged)(e)))}o.api.settings.extend({no_trimming:!1}),o.api.promises.add("minimizedChatsInitialized"),o._converse.MinimizedChatsToggle=r.default,o._converse.minimize={trimChats:i.trimChats,minimize:i.minimize,maximize:i.maximize},o.api.listen.on("chatBoxViewInitialized",(e=>o._converse.minimize.trimChats(e))),o.api.listen.on("chatRoomViewInitialized",(e=>o._converse.minimize.trimChats(e))),o.api.listen.on("controlBoxOpened",(e=>o._converse.minimize.trimChats(e))),o.api.listen.on("chatBoxInitialized",e),o.api.listen.on("chatRoomInitialized",e),o.api.listen.on("getHeadingButtons",((e,t)=>e.model.get("type")===o._converse.CHATROOMS_TYPE?(0,i.addMinimizeButtonToMUC)(e,t):(0,i.addMinimizeButtonToChat)(e,t)));const t=(0,n.default)((()=>o._converse.minimize.trimChats()),250);o.api.listen.on("registeredGlobalEventHandlers",(()=>window.addEventListener("resize",t))),o.api.listen.on("unregisteredGlobalEventHandlers",(()=>window.removeEventListener("resize",t)))}})},"./src/plugins/minimize/templates/chats-panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>n.html`<div id="minimized-chats" class="${e.chats.length?"":"hidden"}">
        <a id="toggle-minimized-chats" class="row no-gutters" @click=${e.toggle}>
            ${e.num_minimized} ${(0,r.__)("Minimized")}
            <span class="unread-message-count ${e.num_unread?"":"unread-message-count-hidden"}" href="#">${e.num_unread}</span>
        </a>
        <div class="flyout minimized-chats-flyout row no-gutters ${e.collapsed?"hidden":""}">
            ${e.chats.map((e=>n.html`<converse-minimized-chat
                        .model=${e}
                        title=${e.getDisplayName()}
                        type=${e.get("type")}
                        num_unread=${e.get("num_unread")}></converse-minimized-chat>`))}
        </div>
    </div>`},"./src/plugins/minimize/templates/trimmed_chat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("Click to restore this chat");let s;return s="chatroom"===e.type?"var(--chatroom-head-color)":"headline"===e.type?"var(--headlines-head-text-color)":"var(--chat-head-text-color)",n.html`
    <div class="chat-head-${e.type} chat-head row no-gutters">
        <a class="restore-chat w-100 align-self-center" title="${t}" @click=${e.restore}>
            ${e.num_unread?n.html`<span class="message-count badge badge-light">${e.num_unread}</span>`:""}
            ${e.title}
        </a>
        <a class="chatbox-btn close-chatbox-button" @click=${e.close}>
            <converse-icon color=${s} class="fas fa-times" @click=${e.close} size="1em"></converse-icon>
        </a>
    </div>`}},"./src/plugins/minimize/toggle.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/@converse/skeletor/src/model.js");class r extends n.Model{defaults(){return{collapsed:!1}}}const o=r},"./src/plugins/minimize/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addMinimizeButtonToChat:()=>f,addMinimizeButtonToMUC:()=>m,initializeChat:()=>a,maximize:()=>p,minimize:()=>g,onMinimizedChanged:()=>_,trimChats:()=>u});var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/i18n/index.js");const{dayjs:o,u:i}=n.converse.env;function a(e){e.on("change:hidden",(t=>!t.get("hidden")&&p(e)),e),"controlbox"!==e.get("id")&&e.save({minimized:e.get("minimized")||!1,time_minimized:e.get("time_minimized")||o()})}function l(e){if("controlbox"===e.model.get("id")){if(i.isVisible(e))return i.getOuterWidth(e,!0);{const e=document.querySelector("converse-controlbox-toggle");return e?i.getOuterWidth(e,!0):0}}return!e.model.get("minimized")&&i.isVisible(e)?i.getOuterWidth(e,!0):0}function c(){const e=document.querySelector("converse-minimized-chats");return n._converse.chatboxes.pluck("minimized").includes(!0)?i.getOuterWidth(e,!0):0}function d(e){const t=e?e.model.get("id"):null,s=e?i.getOuterWidth(e,!0):0;return Object.values(n._converse.chatboxviews.xget(t)).reduce(((e,t)=>e+l(t)),s)}function u(e){if(n._converse.isTestEnv()||n.api.settings.get("no_trimming")||"overlayed"!==n.api.settings.get("view_mode"))return;const t=n._converse.chatboxviews.filter((e=>!e.model.get("minimized")&&!e.model.get("closed")&&i.isVisible(e)));if(t.length<=1)return;const s=i.getOuterWidth(document.querySelector("body"),!0);if(l(t[0])===s)return;if(document.querySelector("converse-minimized-chats"))for(;c()+d(e)>s;){const t=h([e?e.model.get("id"):null]);if(!t)break;{const e=n._converse.chatboxes.get(t.get("id"));e?.save("hidden",!0),g(t)}}}function h(e){e.push("controlbox");let t=0,s=n._converse.chatboxes.sort().at(t);for(;e.includes(s.get("id"))||!0===s.get("minimized");)if(t++,s=n._converse.chatboxes.at(t),!s)return null;return s}function f(e,t){const s={a_class:"toggle-chatbox-button",handler:t=>g(t,e.model),i18n_text:(0,r.__)("Minimize"),i18n_title:(0,r.__)("Minimize this chat"),icon_class:"fa-minus",name:"minimize",standalone:"overlayed"===n._converse.api.settings.get("view_mode")},o=t.map((e=>e.name)).indexOf("close");return o>-1?[...t.slice(0,o),s,...t.slice(o)]:[s,...t]}function m(e,t){const s={a_class:"toggle-chatbox-button",handler:t=>g(t,e.model),i18n_text:(0,r.__)("Minimize"),i18n_title:(0,r.__)("Minimize this groupchat"),icon_class:"fa-minus",name:"minimize",standalone:"overlayed"===n._converse.api.settings.get("view_mode")},o=t.map((e=>e.name)).indexOf("signout");return o>-1?[...t.slice(0,o),s,...t.slice(o)]:[s,...t]}function p(e,t){e?.preventDefault?e.preventDefault():t=e,i.safeSave(t,{hidden:!1,minimized:!1,time_opened:(new Date).getTime()})}function g(e,t){e?.preventDefault?e.preventDefault():t=e,t.setChatState(n._converse.INACTIVE),i.safeSave(t,{hidden:!0,minimized:!0,time_minimized:(new Date).toISOString()})}function _(e){e.get("minimized")?function(e){n.api.trigger("chatBoxMinimized",e)}(e):function(e){e.isScrolledUp()||e.clearUnreadMsgCounter(),e.setChatState(n._converse.ACTIVE),n.api.trigger("chatBoxMaximized",e)}(e)}},"./src/plugins/minimize/view.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/minimize/toggle.js"),r=s("./src/plugins/minimize/templates/chats-panel.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/storage.js");class l extends o.CustomElement{async initialize(){this.model=i._converse.chatboxes,await this.initToggle(),this.listenTo(this.minchats,"change:collapsed",(()=>this.requestUpdate())),this.listenTo(this.model,"add",(()=>this.requestUpdate())),this.listenTo(this.model,"change:fullname",(()=>this.requestUpdate())),this.listenTo(this.model,"change:jid",(()=>this.requestUpdate())),this.listenTo(this.model,"change:minimized",(()=>this.requestUpdate())),this.listenTo(this.model,"change:name",(()=>this.requestUpdate())),this.listenTo(this.model,"change:num_unread",(()=>this.requestUpdate())),this.listenTo(this.model,"remove",(()=>this.requestUpdate())),this.listenTo(i._converse,"connected",(()=>this.requestUpdate())),this.listenTo(i._converse,"reconnected",(()=>this.requestUpdate())),this.listenTo(i._converse,"disconnected",(()=>this.requestUpdate()))}render(){const e=this.model.where({minimized:!0}),t=e.reduce(((e,t)=>e+t.get("num_unread")),0),s=e.reduce(((e,t)=>e+(t.get("minimized")?1:0)),0),n={chats:e,num_unread:t,num_minimized:s,collapsed:this.minchats.get("collapsed")};return n.toggle=e=>this.toggle(e),(0,r.default)(n)}async initToggle(){const e=`converse.minchatstoggle-${i._converse.bare_jid}`;this.minchats=new n.default({id:e}),(0,a.initStorage)(this.minchats,e,"session"),await new Promise((e=>this.minchats.fetch({success:e,error:e})))}toggle(e){e?.preventDefault(),this.minchats.save({collapsed:!this.minchats.get("collapsed")})}}i.api.elements.define("converse-minimized-chats",l)},"./src/plugins/modal/alert.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/modal/templates/alert.js"),o=s("./src/headless/dist/converse-headless.js");class i extends n.default{initialize(){super.initialize(),this.listenTo(this.model,"change",(()=>this.render())),this.addEventListener("hide.bs.modal",(()=>this.remove()),!1)}renderModal(){return(0,r.default)(this.model.toJSON())}getModalTitle(){return this.model.get("title")}}o.api.elements.define("converse-alert-modal",i)},"./src/plugins/modal/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});s("./src/plugins/modal/alert.js");var n=s("./src/plugins/modal/confirm.js"),r=s("./node_modules/@converse/skeletor/src/model.js");let o=[],i={};const a={modal:{show(e,t,s){let n;if("string"==typeof e)n=this.get(e)??this.create(e,t),Object.assign(n,t);else{const s=e,r=s.id??t.id;n=this.get(r)??this.create(s,t)}return n.show(s),n},get:e=>i[e]??o.filter((t=>t.id==e)).pop(),create(e,t){let s;if("string"==typeof e){const n=customElements.get(e);s=i[e]=new n(t)}else{s=new e(t),o.push(s)}return s},remove(e){let t;"string"==typeof e?(t=i[e],delete i[e]):(t=e,o=o.filter((e=>e!==t))),t?.remove()},removeAll(){o.forEach((e=>e.remove())),o=[],i={}}},async confirm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];"string"==typeof t&&(t=[t]);const o=new r.Model({title:e,messages:t,fields:s,type:"confirm"}),i=new n.default({model:o});let a;i.show();try{a=await i.confirmation}catch(e){a=!1}return i.remove(),a},async prompt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"string"==typeof t&&(t=[t]);const o=new r.Model({title:e,messages:t,fields:[{name:"reason",placeholder:s}],type:"prompt"}),i=new n.default({model:o});let a;i.show();try{a=(await i.confirmation).pop()?.value}catch(e){a=!1}return i.remove(),a},alert(e,t,s){let n;"string"==typeof s&&(s=[s]),"error"===e?n="alert-danger":"info"===e?n="alert-info":"warn"===e&&(n="alert-warning");const o=new r.Model({title:t,messages:s,level:n,type:"alert"});a.modal.show("converse-alert-modal",{model:o})}},l=a},"./src/plugins/modal/confirm.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/modal/templates/prompt.js"),o=s("./node_modules/@converse/openpromise/openpromise.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{constructor(e){super(e),this.confirmation=(0,o.getOpenPromise)()}initialize(){super.initialize(),this.listenTo(this.model,"change",(()=>this.render())),this.addEventListener("hide.bs.modal",(()=>{this.confirmation.isResolved||this.confirmation.reject()}),!1)}renderModal(){return(0,r.default)(this)}getModalTitle(){return this.model.get("title")}onConfimation(e){e.preventDefault();const t=new FormData(e.target),s=(this.model.get("fields")||[]).map((e=>{const s=t.get(e.name).trim();return e.value=s,e.challenge&&(e.challenge_failed=s!==e.challenge),e}));if(s.filter((e=>e.challenge_failed)).length)return this.model.set("fields",s),void this.model.trigger("change");this.confirmation.resolve(s),this.modal.hide()}renderModalFooter(){return""}}i.api.elements.define("converse-confirm-modal",a)},"./src/plugins/modal/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/modal/api.js"),o=s("./src/headless/dist/converse-headless.js");Object.assign(o.converse.env,{BaseModal:n.default}),o.converse.plugins.add("converse-modal",{initialize(){o.api.listen.on("disconnect",(()=>{const e=document.querySelector("#converse-modals");e&&(e.innerHTML="")})),o.api.listen.on("clearSession",(()=>o.api.modal.removeAll())),Object.assign(o._converse.api,r.default)}})},"./src/plugins/modal/modal.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/bootstrap.native/dist/bootstrap-native.js"),r=s.n(n),o=s("./src/plugins/modal/templates/modal.js"),i=s("./node_modules/@converse/skeletor/src/element.js"),a=s("./node_modules/@converse/openpromise/openpromise.js");s("./src/plugins/modal/styles/_modal.scss");class l extends i.ElementView{constructor(e){super(),this.className="modal",this.initialized=(0,a.getOpenPromise)(),Object.assign(this,e),setTimeout((()=>this.insertIntoDOM())),this.addEventListener("hide.bs.modal",(()=>this.onHide()),!1)}initialize(){this.modal=new(r().Modal)(this,{backdrop:!0,keyboard:!0}),this.initialized.resolve(),this.render()}toHTML(){return(0,o.default)(this)}getModalTitle(){return""}switchTab(e){e?.stopPropagation(),e?.preventDefault(),this.tab=e.target.getAttribute("data-name"),this.render()}onHide(){this.modal.hide()}insertIntoDOM(){document.querySelector("#converse-modals").insertAdjacentElement("beforeEnd",this)}alert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"primary";this.model.set("alert",{message:e,type:t}),setTimeout((()=>{this.model.set("alert",void 0)}),5e3)}async show(){await this.initialized,this.modal.show(),this.render()}}const c=l},"./src/plugins/modal/templates/alert.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="modal-body">
        <span class="modal-alert"></span>
        ${e.messages.map((e=>n.html`<p>${e}</p>`))}
    </div>`},"./src/plugins/modal/templates/buttons.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{modal_close_button:()=>o,modal_header_close_button:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=r.html`<button type="button" class="btn btn-secondary" data-dismiss="modal">${(0,n.__)("Close")}</button>`,i=r.html`<button type="button" class="close" data-dismiss="modal" aria-label="${(0,n.__)("Close")}"><span aria-hidden="true"></span></button>`},"./src/plugins/modal/templates/modal-alert.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`<div class="alert ${e.type}" role="alert"><p>${e.message}</p></div>`},"./src/plugins/modal/templates/modal.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/plugins/modal/templates/modal-alert.js"),r=s("./node_modules/lit/index.js"),o=s("./src/plugins/modal/templates/buttons.js");const i=e=>{const t=e.model?.get("alert"),s=e.model?.get("level")??"";return r.html`
        <div class="modal-dialog" role="document" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-content">
                <div class="modal-header ${s}">
                    <h5 class="modal-title">${e.getModalTitle()}</h5>
                    ${o.modal_header_close_button}
                </div>
                <div class="modal-body">
                    <span class="modal-alert">
                        ${t?(0,n.default)({type:`alert-${t.type}`,message:t.message}):""}
                    </span>
                    ${e.renderModal?.()??""}
                </div>
                ${e.renderModalFooter?.()??r.html`<div class="modal-footer">${o.modal_close_button}</div>`}
            </div>
        </div>
    `}},"./src/plugins/modal/templates/prompt.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>n.html`
        <form class="converse-form converse-form--modal confirm" action="#" @submit=${t=>e.onConfimation(t)}>
            <div class="form-group">
                ${e.model.get("messages")?.map((e=>n.html`<p>${e}</p>`))}
            </div>
            ${e.model.get("fields")?.map((e=>(e=>n.html`
    <div class="form-group">
        <label>
            ${e.label||""}
            <input type="text"
                name="${e.name}"
                class="${e.challenge_failed?"error":""} form-control form-control--labeled"
                ?required="${e.required}"
                placeholder="${e.placeholder}" />
        </label>
    </div>
`)(e)))}
            <div class="form-group">
                <button type="submit" class="btn btn-primary">${(0,r.__)("OK")}</button>
                <input type="button" class="btn btn-secondary" data-dismiss="modal" value="${(0,r.__)("Cancel")}"/>
            </div>
        </form>`},"./src/plugins/muc-views/affiliation-form.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/muc-views/templates/affiliation-form.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/plugins/muc/affiliations/utils.js");const{Strophe:l,sizzle:c}=i.converse.env;class d extends r.CustomElement{static get properties(){return{muc:{type:Object},jid:{type:String},affiliation:{type:String},alert_message:{type:String,attribute:!1},alert_type:{type:String,attribute:!1}}}render(){return(0,n.default)(this)}alert(e,t){this.alert_message=e,this.alert_type=t}async assignAffiliation(e){e.stopPropagation(),e.preventDefault(),this.alert();const t=new FormData(e.target),s=t.get("affiliation"),n={jid:this.jid,reason:t.get("reason")},r=this.muc.get("jid");try{await(0,a.setAffiliation)(s,r,[n])}catch(e){return null===e?this.alert((0,o.__)("Timeout error while trying to set the affiliation"),"danger"):c(`not-allowed[xmlns="${l.NS.STANZAS}"]`,e).length?this.alert((0,o.__)("Sorry, you're not allowed to make that change"),"danger"):this.alert((0,o.__)("Sorry, something went wrong while trying to set the affiliation"),"danger"),void i.log.error(e)}await this.muc.occupants.fetchMembers();const d=new CustomEvent("affiliationChanged",{bubbles:!0});this.dispatchEvent(d)}}i.api.elements.define("converse-muc-affiliation-form",d)},"./src/plugins/muc-views/bottom-panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/autocomplete/index.js");var n=s("./src/plugins/chatview/bottom-panel.js"),r=s("./src/plugins/muc-views/templates/muc-bottom-panel.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");s("./src/plugins/muc-views/styles/muc-bottom-panel.scss");class a extends n.default{events={"click .hide-occupants":"hideOccupants","click .send-button":"sendButtonClicked"};async initialize(){await super.initialize(),this.listenTo(this.model,"change:hidden_occupants",this.debouncedRender),this.listenTo(this.model,"change:num_unread_general",this.debouncedRender),this.listenTo(this.model.features,"change:moderated",this.debouncedRender),this.listenTo(this.model.occupants,"add",this.renderIfOwnOccupant),this.listenTo(this.model.occupants,"change:role",this.renderIfOwnOccupant),this.listenTo(this.model.session,"change:connection_status",this.debouncedRender)}render(){const e=this.model.session.get("connection_status")===o.converse.ROOMSTATUS.ENTERED,t=e&&!(this.model.features.get("moderated")&&"visitor"===this.model.getOwnRole());(0,i.render)((0,r.default)({can_edit:t,entered:e,model:this.model,is_groupchat:!0,viewUnreadMessages:e=>this.viewUnreadMessages(e)}),this)}renderIfOwnOccupant(e){e.get("jid")===o._converse.bare_jid&&this.debouncedRender()}sendButtonClicked(e){this.querySelector("converse-muc-message-form")?.onFormSubmitted(e)}hideOccupants(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.model.save({hidden_occupants:!0})}}o.api.elements.define("converse-muc-bottom-panel",a)},"./src/plugins/muc-views/chatarea.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/muc-views/templates/muc-chatarea.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");const{u:a}=i.converse.env;class l extends r.CustomElement{static get properties(){return{jid:{type:String},show_help_messages:{type:Boolean},type:{type:String}}}async initialize(){this.model=await i.api.rooms.get(this.jid),this.listenTo(this.model,"change:show_help_messages",(()=>this.requestUpdate())),this.listenTo(this.model,"change:hidden_occupants",(()=>this.requestUpdate())),this.listenTo(this.model.session,"change:connection_status",(()=>this.requestUpdate())),this.onMouseMove=this._onMouseMove.bind(this),this.onMouseUp=this._onMouseUp.bind(this),this.requestUpdate()}render(){return(0,n.default)({getHelpMessages:()=>this.getHelpMessages(),jid:this.jid,model:this.model,onMousedown:e=>this.onMousedown(e),show_send_button:i.api.settings.get("show_send_button"),shouldShowSidebar:()=>this.shouldShowSidebar(),type:this.type})}shouldShowSidebar(){return!this.model.get("hidden_occupants")&&this.model.session.get("connection_status")===i.converse.ROOMSTATUS.ENTERED}getHelpMessages(){const e=i.api.settings.get("muc_disable_slash_commands"),t=Array.isArray(e)?e:[];return[`<strong>/admin</strong>: ${(0,o.__)("Change user's affiliation to admin")}`,`<strong>/ban</strong>: ${(0,o.__)("Ban user by changing their affiliation to outcast")}`,`<strong>/clear</strong>: ${(0,o.__)("Clear the chat area")}`,`<strong>/close</strong>: ${(0,o.__)("Close this groupchat")}`,`<strong>/deop</strong>: ${(0,o.__)("Change user role to participant")}`,`<strong>/destroy</strong>: ${(0,o.__)("Remove this groupchat")}`,`<strong>/help</strong>: ${(0,o.__)("Show this menu")}`,`<strong>/kick</strong>: ${(0,o.__)("Kick user from groupchat")}`,`<strong>/me</strong>: ${(0,o.__)("Write in 3rd person")}`,`<strong>/member</strong>: ${(0,o.__)("Grant membership to a user")}`,`<strong>/modtools</strong>: ${(0,o.__)("Opens up the moderator tools GUI")}`,`<strong>/mute</strong>: ${(0,o.__)("Remove user's ability to post messages")}`,`<strong>/nick</strong>: ${(0,o.__)("Change your nickname")}`,`<strong>/op</strong>: ${(0,o.__)("Grant moderator role to user")}`,`<strong>/owner</strong>: ${(0,o.__)("Grant ownership of this groupchat")}`,`<strong>/register</strong>: ${(0,o.__)("Register your nickname")}`,`<strong>/revoke</strong>: ${(0,o.__)("Revoke the user's current affiliation")}`,`<strong>/subject</strong>: ${(0,o.__)("Set groupchat subject")}`,`<strong>/topic</strong>: ${(0,o.__)("Set groupchat subject (alias for /subject)")}`,`<strong>/voice</strong>: ${(0,o.__)("Allow muted user to post messages")}`].filter((e=>t.every((t=>!e.startsWith(t+"<",9))))).filter((e=>this.model.getAllowedCommands().some((t=>e.startsWith(t+"<",9)))))}onMousedown(e){a.hasClass("dragresize-occupants-left",e.target)&&this.onStartResizeOccupants(e)}onStartResizeOccupants(e){this.resizing=!0,this.addEventListener("mousemove",this.onMouseMove),this.addEventListener("mouseup",this.onMouseUp);const t=this.querySelector("converse-muc-sidebar"),s=window.getComputedStyle(t);this.width=parseInt(s.width.replace(/px$/,""),10),this.prev_pageX=e.pageX}_onMouseMove(e){if(this.resizing){e.preventDefault();const t=this.prev_pageX-e.pageX;this.resizeSidebarView(t,e.pageX),this.prev_pageX=e.pageX}}_onMouseUp(e){if(this.resizing){e.preventDefault(),this.resizing=!1,this.removeEventListener("mousemove",this.onMouseMove),this.removeEventListener("mouseup",this.onMouseUp);const t=this.querySelector("converse-muc-sidebar").getBoundingClientRect(),s=this.calculateSidebarWidth(t,0);a.safeSave(this.model,{occupants_width:s})}}calculateSidebarWidth(e,t){let s=e.width+t;const n=this.clientWidth;return s<.2*n?(s=.2*n,this.is_minimum=!0):s>.75*n?(s=.75*n,this.is_maximum=!0):n-s<250?(s=n-250,this.is_maximum=!0):(this.is_maximum=!1,this.is_minimum=!1),s}resizeSidebarView(e,t){const s=this.querySelector("converse-muc-sidebar"),n=s.getBoundingClientRect();if(this.is_minimum)this.is_minimum=n.left<t;else if(this.is_maximum)this.is_maximum=n.left>t;else{const t=this.calculateSidebarWidth(n,e);s.style.flex="0 0 "+t+"px"}}}i.api.elements.define("converse-muc-chatarea",l)},"./src/plugins/muc-views/config-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/plugins/muc-views/templates/muc-config-form.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");const{sizzle:a}=i.converse.env,l=i.converse.env.utils;class c extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=i._converse.chatboxes.get(this.jid),this.listenTo(this.model.features,"change:passwordprotected",(()=>this.requestUpdate())),this.listenTo(this.model.session,"change:config_stanza",(()=>this.requestUpdate())),this.getConfig()}render(){return(0,n.default)({model:this.model,closeConfigForm:e=>this.closeForm(e),submitConfigForm:e=>this.submitConfigForm(e)})}async getConfig(){const e=await this.model.fetchRoomConfiguration();this.model.session.set("config_stanza",e.outerHTML)}async submitConfigForm(e){e.preventDefault();const t=a(":input:not([type=button]):not([type=submit])",e.target).map(l.webForm2xForm).filter((e=>e));try{await this.model.sendConfiguration(t)}catch(e){i.log.error(e);const t=(0,o.__)("Sorry, an error occurred while trying to submit the config form.")+" "+(0,o.__)("Check your browser's developer console for details.");i.api.alert("error",(0,o.__)("Error"),t)}await this.model.refreshDiscoInfo(),this.closeForm()}closeForm(e){e?.preventDefault?.(),this.model.session.set("view",null)}}i.api.elements.define("converse-muc-config-form",c);const d=c},"./src/plugins/muc-views/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{PRETTY_CHAT_STATUS:()=>n});const n={offline:"Offline",unavailable:"Unavailable",xa:"Extended Away",away:"Away",dnd:"Do not disturb",chat:"Chattty",online:"Online"}},"./src/plugins/muc-views/destroyed.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/muc-views/templates/muc-destroyed.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=o._converse.chatboxes.get(this.jid)}render(){const e=this.model.get("destroyed_reason"),t=this.model.get("moved_jid");return(0,n.default)({moved_jid:t,reason:e,onSwitch:e=>this.onSwitch(e)})}async onSwitch(e){e.preventDefault();const t=this.model.get("moved_jid");(await o.api.rooms.get(t,{},!0)).maybeShow(!0),this.model.destroy()}}o.api.elements.define("converse-muc-destroyed",i)},"./src/plugins/muc-views/disconnected.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/muc-views/templates/muc-disconnect.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=i._converse.chatboxes.get(this.jid)}render(){const e=this.model.session.get("disconnection_message");if(!e)return;const t=[e],s=this.model.session.get("disconnection_actor");s&&t.push((0,o.__)("This action was done by %1$s.",s));const r=this.model.session.get("disconnection_reason");return r&&t.push((0,o.__)('The reason given is: "%1$s".',r)),(0,n.default)(t)}}i.api.elements.define("converse-muc-disconnected",a)},"./src/plugins/muc-views/heading.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});s("./src/plugins/muc-views/modals/muc-details.js"),s("./src/plugins/muc-views/modals/muc-invite.js"),s("./src/plugins/muc-views/modals/nickname.js");var n=s("./src/plugins/muc-views/templates/muc-head.js"),r=s("./src/shared/components/element.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/plugins/muc-views/utils.js");s("./src/plugins/muc-views/styles/muc-head.scss");class c extends r.CustomElement{async initialize(){this.model=a._converse.chatboxes.get(this.getAttribute("jid")),this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:add",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:change",(()=>this.requestUpdate())),this.user_settings=await a._converse.api.user.settings.getModel(),this.listenTo(this.user_settings,"change:mucs_with_hidden_subject",(()=>this.requestUpdate())),await this.model.initialized,this.listenTo(this.model.features,"change:open",(()=>this.requestUpdate())),this.model.occupants.forEach((e=>this.onOccupantAdded(e))),this.listenTo(this.model.occupants,"add",this.onOccupantAdded),this.listenTo(this.model.occupants,"change:affiliation",this.onOccupantAffiliationChanged),this.requestUpdate()}render(){return this.model&&this.user_settings?(0,n.default)(this):""}onOccupantAdded(e){e.get("jid")===a._converse.bare_jid&&this.requestUpdate()}onOccupantAffiliationChanged(e){e.get("jid")===a._converse.bare_jid&&this.requestUpdate()}showRoomDetailsModal(e){e.preventDefault(),a.api.modal.show("converse-muc-details-modal",{model:this.model},e)}showInviteModal(e){e.preventDefault(),a.api.modal.show("converse-muc-invite-modal",{model:new o.Model,chatroomview:this},e)}toggleTopic(e){e?.preventDefault?.(),this.model.toggleSubjectHiddenState()}getAndRenderConfigurationForm(){this.model.session.set("view",a.converse.MUC.VIEWS.CONFIG)}close(e){e.preventDefault(),this.model.close()}destroy(e){e.preventDefault(),(0,l.destroyMUC)(this.model)}getHeadingButtons(e){const t=[];t.push({i18n_text:(0,i.__)("Details"),i18n_title:(0,i.__)("Show more information about this groupchat"),handler:e=>this.showRoomDetailsModal(e),a_class:"show-muc-details-modal",icon_class:"fa-info-circle",name:"details"}),"owner"===this.model.getOwnAffiliation()&&t.push({i18n_text:(0,i.__)("Configure"),i18n_title:(0,i.__)("Configure this groupchat"),handler:()=>this.getAndRenderConfigurationForm(),a_class:"configure-chatroom-button",icon_class:"fa-wrench",name:"configure"}),t.push({i18n_text:(0,i.__)("Nickname"),i18n_title:(0,i.__)("Change the nickname you're using in this groupchat"),handler:e=>a.api.modal.show("converse-muc-nickname-modal",{model:this.model},e),a_class:"open-nickname-modal",icon_class:"fa-smile",name:"nickname"}),this.model.invitesAllowed()&&t.push({i18n_text:(0,i.__)("Invite"),i18n_title:(0,i.__)("Invite someone to join this groupchat"),handler:e=>this.showInviteModal(e),a_class:"open-invite-modal",icon_class:"fa-user-plus",name:"invite"});const s=this.model.get("subject");s&&s.text&&t.push({i18n_text:e?(0,i.__)("Show topic"):(0,i.__)("Hide topic"),i18n_title:e?(0,i.__)("Show the topic message in the heading"):(0,i.__)("Hide the topic in the heading"),handler:e=>this.toggleTopic(e),a_class:"hide-topic",icon_class:"fa-minus-square",name:"toggle-topic"});if(this.model.session.get("connection_status")===a.converse.ROOMSTATUS.ENTERED){const e=this.model.getAllowedCommands();e.includes("modtools")&&t.push({i18n_text:(0,i.__)("Moderate"),i18n_title:(0,i.__)("Moderate this groupchat"),handler:()=>(0,l.showModeratorToolsModal)(this.model),a_class:"moderate-chatroom-button",icon_class:"fa-user-cog",name:"moderate"}),e.includes("destroy")&&t.push({i18n_text:(0,i.__)("Destroy"),i18n_title:(0,i.__)("Remove this groupchat"),handler:e=>this.destroy(e),a_class:"destroy-chatroom-button",icon_class:"fa-trash",name:"destroy"})}a.api.settings.get("singleton")||t.push({i18n_text:(0,i.__)("Leave"),i18n_title:(0,i.__)("Leave and close this groupchat"),handler:async e=>{e.stopPropagation();const t=[(0,i.__)("Are you sure you want to leave this groupchat?")];await a.api.confirm((0,i.__)("Confirm"),t)&&this.close(e)},a_class:"close-chatbox-button",standalone:"overlayed"===a.api.settings.get("view_mode"),icon_class:"fa-sign-out-alt",name:"signout"});const n=a._converse.chatboxviews.get(this.getAttribute("jid"));return n?a._converse.api.hook("getHeadingButtons",n,t):Promise.resolve(t)}}a.api.elements.define("converse-muc-heading",c)},"./src/plugins/muc-views/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/chatboxviews/index.js"),s("./src/plugins/muc-views/affiliation-form.js"),s("./src/plugins/muc-views/role-form.js");var n=s("./src/plugins/muc-views/muc.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/muc-views/utils.js");s("./src/plugins/muc-views/styles/index.scss");const{Strophe:i}=r.converse.env;r.converse.MUC.VIEWS={CONFIG:"config-form"},r.converse.plugins.add("converse-muc-views",{dependencies:["converse-modal","converse-controlbox","converse-chatview"],initialize(){const{_converse:e}=this;r.api.settings.extend({auto_list_rooms:!1,cache_muc_messages:!0,locked_muc_nickname:!1,modtools_disable_query:[],muc_disable_slash_commands:!1,muc_mention_autocomplete_filter:"contains",muc_mention_autocomplete_min_chars:0,muc_mention_autocomplete_show_avatar:!0,muc_roomid_policy:null,muc_roomid_policy_hint:null,roomconfig_whitelist:[],show_retraction_warning:!0,visible_toolbar_buttons:{toggle_occupants:!0}}),e.ChatRoomView=n.default,r.api.settings.get("muc_domain")||r.api.listen.on("serviceDiscovered",(async e=>{if(e?.get("var")===i.NS.MUC){if(e.entity.get("jid").includes("@"))return;await e.entity.getIdentity("conference","text")&&r.api.settings.set("muc_domain",i.getDomainFromJid(e.get("from")))}})),r.api.listen.on("clearsession",(()=>{const t=e.chatboxviews.get("controlbox");t&&t.roomspanel&&(t.roomspanel.model.destroy(),t.roomspanel.remove(),delete t.roomspanel)})),r.api.listen.on("chatBoxClosed",(t=>{t.get("type")===e.CHATROOMS_TYPE&&(0,o.clearHistory)(t.get("jid"))})),r.api.listen.on("parseMessageForCommands",o.parseMessageForMUCCommands),r.api.listen.on("confirmDirectMUCInvitation",o.confirmDirectMUCInvitation)}})},"./src/plugins/muc-views/message-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/chatview/message-form.js"),r=s("./src/plugins/muc-views/templates/message-form.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/plugins/muc-views/utils.js");class a extends n.default{async connectedCallback(){super.connectedCallback(),await this.model.initialized}toHTML(){return(0,r.default)(Object.assign(this.model.toJSON(),{hint_value:this.querySelector(".spoiler-hint")?.value,message_value:this.querySelector(".chat-textarea")?.value,onChange:e=>this.model.set({draft:e.target.value}),onDrop:e=>this.onDrop(e),onKeyDown:e=>this.onKeyDown(e),onKeyUp:e=>this.onKeyUp(e),onPaste:e=>this.onPaste(e),scrolled:this.model.ui.get("scrolled"),viewUnreadMessages:e=>this.viewUnreadMessages(e)}))}afterRender(){const e=this.model.session.get("connection_status")===o.converse.ROOMSTATUS.ENTERED,t=e&&!(this.model.features.get("moderated")&&"visitor"===this.model.getOwnRole());e&&t&&this.initMentionAutoComplete()}initMentionAutoComplete(){this.mention_auto_complete=new o._converse.AutoComplete(this,{auto_first:!0,auto_evaluate:!1,min_chars:o.api.settings.get("muc_mention_autocomplete_min_chars"),match_current_word:!0,list:()=>this.getAutoCompleteList(),filter:"contains"==o.api.settings.get("muc_mention_autocomplete_filter")?o._converse.FILTER_CONTAINS:o._converse.FILTER_STARTSWITH,ac_triggers:["Tab","@"],include_triggers:[],item:i.getAutoCompleteListItem}),this.mention_auto_complete.on("suggestion-box-selectcomplete",(()=>this.auto_completing=!1))}getAutoCompleteList(){return this.model.getAllKnownNicknames().map((e=>({label:e,value:`@${e}`})))}onKeyDown(e){this.mention_auto_complete.onKeyDown(e)||super.onKeyDown(e)}onKeyUp(e){this.mention_auto_complete.evaluate(e),super.onKeyUp(e)}}o.api.elements.define("converse-muc-message-form",a)},"./src/plugins/muc-views/modals/add-muc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/muc-views/modals/templates/add-muc.js"),r=s("./src/plugins/modal/modal.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");s("./src/plugins/muc-views/styles/add-muc-modal.scss");const a=i.converse.env.utils,{Strophe:l}=i.converse.env;class c extends r.default{initialize(){super.initialize(),this.listenTo(this.model,"change:muc_domain",(()=>this.render())),this.muc_roomid_policy_error_msg=null,this.render(),this.addEventListener("shown.bs.modal",(()=>{this.querySelector('input[name="chatroom"]').focus()}),!1)}renderModal(){return(0,n.default)(this)}getModalTitle(){return(0,o.__)("Enter a new Groupchat")}parseRoomDataFromEvent(e){const t=new FormData(e),s=t.get("chatroom")?.trim();let n;if(i.api.settings.get("locked_muc_nickname")){if(n=i._converse.getDefaultMUCNickname(),!n)throw new Error("Using locked_muc_nickname but no nickname found!")}else n=t.get("nickname").trim();return{jid:s,nick:n}}openChatRoom(e){if(e.preventDefault(),this.checkRoomidPolicy())return;const t=this.parseRoomDataFromEvent(e.target);let s;""===t.nick&&(t.nick=void 0),i.api.settings.get("locked_muc_domain")||i.api.settings.get("muc_domain")&&!a.isValidJID(t.jid)?s=`${l.escapeNode(t.jid)}@${i.api.settings.get("muc_domain")}`:(s=t.jid,this.model.setDomain(s)),i.api.rooms.open(s,Object.assign(t,{jid:s}),!0),e.target.reset(),this.modal.hide()}checkRoomidPolicy(){if(i.api.settings.get("muc_roomid_policy")&&i.api.settings.get("muc_domain")){let e=this.querySelector("converse-autocomplete input").value;!i.api.settings.get("locked_muc_domain")&&a.isValidJID(e)||(e=`${l.escapeNode(e)}@${i.api.settings.get("muc_domain")}`);const t=l.getNodeFromJid(e),s=l.getDomainFromJid(e);if(i.api.settings.get("muc_domain")===s&&!i.api.settings.get("muc_roomid_policy").test(t))return this.muc_roomid_policy_error_msg=(0,o.__)("Groupchat id is invalid."),!0;this.muc_roomid_policy_error_msg=null,this.render()}}}i.api.elements.define("converse-add-muc-modal",c)},"./src/plugins/muc-views/modals/moderator-tools.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/plugins/muc-views/modtools.js");var n=s("./src/plugins/modal/modal.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");class a extends n.default{constructor(e){super(e),this.id="converse-modtools-modal"}renderModal(){return i.html`<converse-modtools jid=${this.jid} affiliation=${this.affiliation}></converse-modtools>`}getModalTitle(){return(0,r.__)("Moderator Tools")}}o.api.elements.define("converse-modtools-modal",a)},"./src/plugins/muc-views/modals/muc-details.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/muc-views/modals/templates/muc-details.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");s("./src/plugins/muc-views/styles/muc-details-modal.scss");class a extends n.default{initialize(){super.initialize(),this.listenTo(this.model,"change",(()=>this.render())),this.listenTo(this.model.features,"change",(()=>this.render())),this.listenTo(this.model.occupants,"add",(()=>this.render())),this.listenTo(this.model.occupants,"change",(()=>this.render()))}renderModal(){return(0,r.default)(this.model)}getModalTitle(){return(0,o.__)("Groupchat info for %1$s",this.model.getDisplayName())}}i.api.elements.define("converse-muc-details-modal",a)},"./src/plugins/muc-views/modals/muc-invite.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});s("./src/shared/autocomplete/index.js");var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/muc-views/modals/templates/muc-invite.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");const a=i.converse.env.utils;class l extends n.default{initialize(){super.initialize(),this.listenTo(this.model,"change",(()=>this.render()))}renderModal(){return(0,r.default)(this)}getModalTitle(){return(0,o.__)("Invite someone to this groupchat")}getAutoCompleteList(){return i._converse.roster.map((e=>({label:e.getDisplayName(),value:e.get("jid")})))}submitInviteForm(e){e.preventDefault();const t=new FormData(e.target),s=t.get("invitee_jids")?.trim(),n=t.get("reason");a.isValidJID(s)?(this.chatroomview.model.directInvite(s,n),this.modal.hide()):this.model.set({invalid_invite_jid:!0})}}i.api.elements.define("converse-muc-invite-modal",l)},"./src/plugins/muc-views/modals/muc-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/muc-views/templates/muc-description.js"),o=s("./src/plugins/muc-views/templates/muc-list.js"),i=s("./src/templates/spinner.js"),a=s("./src/i18n/index.js"),l=s("./src/headless/dist/converse-headless.js"),c=s("./src/headless/shared/parsers.js");const{Strophe:d,$iq:u,sizzle:h}=l.converse.env,f=l.converse.env.utils;function m(e){const t=f.ancestor(e.target,".room-item"),s=t.querySelector("div.room-info");s?(f.slideIn(s).then(f.removeElement),t.querySelector("a.room-info").classList.remove("selected")):(t.insertAdjacentElement("beforeend",f.getElementFromTemplateResult((0,i.default)())),l.api.disco.info(e.target.getAttribute("data-room-jid"),null).then((e=>function(e,t){e.querySelector("span.spinner").remove(),e.querySelector("a.room-info").classList.add("selected"),e.insertAdjacentHTML("beforeEnd",f.getElementFromTemplateResult((0,r.default)({jid:t.getAttribute("from"),desc:h('field[var="muc#roominfo_description"] value',t).shift()?.textContent,occ:h('field[var="muc#roominfo_occupants"] value',t).shift()?.textContent,hidden:h('feature[var="muc_hidden"]',t).length,membersonly:h('feature[var="muc_membersonly"]',t).length,moderated:h('feature[var="muc_moderated"]',t).length,nonanonymous:h('feature[var="muc_nonanonymous"]',t).length,open:h('feature[var="muc_open"]',t).length,passwordprotected:h('feature[var="muc_passwordprotected"]',t).length,persistent:h('feature[var="muc_persistent"]',t).length,publicroom:h('feature[var="muc_publicroom"]',t).length,semianonymous:h('feature[var="muc_semianonymous"]',t).length,temporary:h('feature[var="muc_temporary"]',t).length,unmoderated:h('feature[var="muc_unmoderated"]',t).length})))}(t,e))).catch((e=>l.log.error(e))))}class p extends n.default{constructor(e){super(e),this.items=[],this.loading_items=!1}initialize(){super.initialize(),this.listenTo(this.model,"change:muc_domain",this.onDomainChange),this.listenTo(this.model,"change:feedback_text",(()=>this.render())),this.addEventListener("shown.bs.modal",(()=>l.api.settings.get("locked_muc_domain")&&this.updateRoomsList())),this.model.save("feedback_text","")}renderModal(){return(0,o.default)(Object.assign(this.model.toJSON(),{show_form:!l.api.settings.get("locked_muc_domain"),server_placeholder:this.model.get("muc_domain")||(0,a.__)("conference.example.org"),items:this.items,loading_items:this.loading_items,openRoom:e=>this.openRoom(e),setDomainFromEvent:e=>this.setDomainFromEvent(e),submitForm:e=>this.showRooms(e),toggleRoomInfo:e=>this.toggleRoomInfo(e)}))}getModalTitle(){return(0,a.__)("Query for Groupchats")}openRoom(e){e.preventDefault();const t=e.target.getAttribute("data-room-jid"),s=e.target.getAttribute("data-room-name");this.modal.hide(),l.api.rooms.open(t,{name:s},!0)}toggleRoomInfo(e){e.preventDefault(),m(e)}onDomainChange(){l.api.settings.get("auto_list_rooms")&&this.updateRoomsList()}onRoomsFound(e){this.loading_items=!1;const t=e?h("query item",e):[];return t.length?(this.model.set({feedback_text:(0,a.__)("Groupchats found")},{silent:!0}),this.items=t.map(c.getAttributes)):(this.items=[],this.model.set({feedback_text:(0,a.__)("No groupchats found")},{silent:!0})),this.render(),!0}updateRoomsList(){const e=u({to:this.model.get("muc_domain"),from:l._converse.connection.jid,type:"get"}).c("query",{xmlns:d.NS.DISCO_ITEMS});l.api.sendIQ(e).then((e=>this.onRoomsFound(e))).catch((()=>this.onRoomsFound()))}showRooms(e){e.preventDefault(),this.loading_items=!0,this.render();const t=new FormData(e.target);this.model.setDomain(t.get("server")),this.updateRoomsList()}setDomainFromEvent(e){this.model.setDomain(e.target.value)}setNick(e){this.model.save({nick:e.target.value})}}l.api.elements.define("converse-muc-list-modal",p)},"./src/plugins/muc-views/modals/nickname.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/modal/modal.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");class a extends n.default{renderModal(){return i.html`<converse-muc-nickname-form jid="${this.model.get("jid")}"></converse-muc-nickname-form>`}getModalTitle(){return(0,r.__)("Change your nickname")}}o.api.elements.define("converse-muc-nickname-modal",a)},"./src/plugins/muc-views/modals/occupant.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/muc-views/modals/templates/occupant.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js");const{u:l}=a.converse.env;class c extends n.default{constructor(){super(),this.addEventListener("affiliationChanged",(()=>this.alert((0,i.__)("Affiliation changed")))),this.addEventListener("roleChanged",(()=>this.alert((0,i.__)("role changed"))))}initialize(){super.initialize();const e=this.model??this.message;this.listenTo(e,"change",(()=>this.render())),a.api.trigger("occupantModalInitialized",{model:this.model,message:this.message})}getVcard(){const e=this.model??this.message;if(e.vcard)return e.vcard;const t=e?.get("jid")||e?.get("from");return t?a._converse.vcards.get(t):null}renderModal(){return(0,r.default)(this)}getModalTitle(){const e=this.model??this.message;return e?.getDisplayName()}addToContacts(){const e=(this.model??this.message).get("jid");e&&a.api.modal.show("converse-add-contact-modal",{model:new o.Model({jid:e})})}toggleForm(e){"row-form"===l.ancestor(e.target,".toggle-form").getAttribute("data-form")?this.show_role_form=!this.show_role_form:this.show_affiliation_form=!this.show_affiliation_form,this.render()}}a.api.elements.define("converse-muc-occupant-modal",c)},"./src/plugins/muc-views/modals/templates/add-muc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/dompurify/dist/purify.js"),r=s.n(n),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/unsafe-html.js"),c=s("./src/plugins/muc-views/search.js");const d=e=>{const t=(0,o.__)("Join"),s=e.model.get("muc_domain")||i.api.settings.get("muc_domain");let n="";i.api.settings.get("locked_muc_domain")||(n=s?`name@${s}`:(0,o.__)("name@conference.example.org"));const d=s?(0,o.__)("Groupchat name"):(0,o.__)("Groupchat address"),u=e.muc_roomid_policy_error_msg,h=i.api.settings.get("muc_roomid_policy_hint");return a.html`
        <form class="converse-form add-chatroom" @submit=${t=>e.openChatRoom(t)}>
            <div class="form-group">
                <label for="chatroom">${d}:</label>
                ${u?a.html`<label class="roomid-policy-error">${u}</label>`:""}
                <converse-autocomplete
                    .getAutoCompleteList=${c.getAutoCompleteList}
                    ?autofocus=${!0}
                    min_chars="3"
                    position="below"
                    placeholder="${n}"
                    class="add-muc-autocomplete"
                    name="chatroom">
                </converse-autocomplete>
            </div>
            ${h?a.html`<div class="form-group">${(0,l.unsafeHTML)(r().sanitize(h,{ALLOWED_TAGS:["b","br","em"]}))}</div>`:""}
            ${i.api.settings.get("locked_muc_nickname")?"":(e=>{const t=(0,o.__)("Nickname"),s=(0,o.__)("This field is required");return a.html`
            <div class="form-group" >
                <label for="nickname">${t}:</label>
                <input type="text"
                    title="${s}"
                    required="required"
                    name="nickname"
                    value="${e.model.get("nick")||""}"
                    class="form-control"/>
            </div>
    `})(e)}
            <input type="submit" class="btn btn-primary" name="join" value="${t||""}" ?disabled=${u}/>
        </form>
    `}},"./src/plugins/muc-views/modals/templates/muc-details.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=e=>{const t=e.toJSON(),s=e.config.toJSON(),o=e.features.toJSON(),i=e.occupants.filter((e=>"offline"!==e.get("show"))).length,a=(0,n.__)("XMPP address"),l=(0,n.__)("Message archiving"),c=(0,n.__)("Messages are archived on the server"),d=(0,n.__)("Description"),u=(0,n.__)("Features"),h=(0,n.__)("Hidden"),f=(0,n.__)("This groupchat is not publicly searchable"),m=(0,n.__)("This groupchat is restricted to members only"),p=(0,n.__)("Members only"),g=(0,n.__)("Moderated"),_=(0,n.__)("Participants entering this groupchat need to request permission to write"),v=(0,n.__)("Name"),y=(0,n.__)("This groupchat does not require a password upon entry"),b=(0,n.__)("No password required"),j=(0,n.__)("Not anonymous"),w=(0,n.__)("All other groupchat participants can see your XMPP address"),S=(0,n.__)("Not moderated"),x=(0,n.__)("Participants entering this groupchat can write right away"),E=(0,n.__)("Online users"),A=(0,n.__)("Open"),C=(0,n.__)("Anyone can join this groupchat"),T=(0,n.__)("This groupchat requires a password before entry"),I=(0,n.__)("Password protected"),k=(0,n.__)("Persistent"),N=(0,n.__)("This groupchat persists even if it's unoccupied"),O=(0,n.__)("Public"),M=(0,n.__)("Semi-anonymous"),$=(0,n.__)("Only moderators can see your XMPP address"),R=(0,n.__)("Temporary"),D=(0,n.__)("This groupchat will disappear once the last person leaves");return r.html`
        <div class="room-info">
            <p class="room-info"><strong>${v}</strong>: ${t.name}</p>
            <p class="room-info"><strong>${a}</strong>: <converse-rich-text text="xmpp:${t.jid}?join"></converse-rich-text></p>
            <p class="room-info"><strong>${d}</strong>: <converse-rich-text text="${s.description}" render_styling></converse-rich-text></p>
            ${t.subject?(e=>{const t=(0,n.__)("Topic"),s=(0,n.__)("Topic author");return r.html`
        <p class="room-info"><strong>${t}</strong>: <converse-rich-text text=${e.subject.text} render_styling></converse-rich-text></p>
        <p class="room-info"><strong>${s}</strong>: ${e.subject&&e.subject.author}</p>
    `})(t):""}
            <p class="room-info"><strong>${E}</strong>: ${i}</p>
            <p class="room-info"><strong>${u}</strong>:
                <div class="chatroom-features">
                <ul class="features-list">
                    ${o.passwordprotected?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-lock"></converse-icon>${I} - <em>${T}</em></li>`:""}
                    ${o.unsecured?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-unlock"></converse-icon>${b} - <em>${y}</em></li>`:""}
                    ${o.hidden?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-eye-slash"></converse-icon>${h} - <em>${f}</em></li>`:""}
                    ${o.public_room?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-eye"></converse-icon>${O} - <em>${t.__("This groupchat is publicly searchable")}</em></li>`:""}
                    ${o.membersonly?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-address-book"></converse-icon>${p} - <em>${m}</em></li>`:""}
                    ${o.open?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-globe"></converse-icon>${A} - <em>${C}</em></li>`:""}
                    ${o.persistent?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-save"></converse-icon>${k} - <em>${N}</em></li>`:""}
                    ${o.temporary?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-snowflake"></converse-icon>${R} - <em>${D}</em></li>`:""}
                    ${o.nonanonymous?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-id-card"></converse-icon>${j} - <em>${w}</em></li>`:""}
                    ${o.semianonymous?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-user-secret"></converse-icon>${M} - <em>${$}</em></li>`:""}
                    ${o.moderated?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-gavel"></converse-icon>${g} - <em>${_}</em></li>`:""}
                    ${o.unmoderated?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-info-circle"></converse-icon>${S} - <em>${x}</em></li>`:""}
                    ${o.mam_enabled?r.html`<li class="feature" ><converse-icon size="1em" class="fa fa-database"></converse-icon>${l} - <em>${c}</em></li>`:""}
                </ul>
                </div>
            </p>
    `}},"./src/plugins/muc-views/modals/templates/muc-invite.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("Invite"),s=(0,r.__)("user@example.org"),o=(0,r.__)("Please enter a valid XMPP address"),i=(0,r.__)("XMPP Address"),a=(0,r.__)("Optional reason for the invitation");return n.html`
        <form class="converse-form" @submit=${t=>e.submitInviteForm(t)}>
            <div class="form-group">
                <label class="clearfix" for="invitee_jids">${i}:</label>
                ${e.model.get("invalid_invite_jid")?n.html`<div class="error error-feedback">${o}</div>`:""}
                <converse-autocomplete
                    .getAutoCompleteList=${()=>e.getAutoCompleteList()}
                    ?autofocus=${!0}
                    min_chars="1"
                    position="below"
                    required="required"
                    name="invitee_jids"
                    id="invitee_jids"
                    placeholder="${s}">
                </converse-autocomplete>
            </div>
            <div class="form-group">
                <label>${a}:</label>
                <textarea class="form-control" name="reason"></textarea>
            </div>
            <div class="form-group">
                <input type="submit" class="btn btn-primary" value="${t}"/>
            </div>
        </form>
    `}},"./src/plugins/muc-views/modals/templates/occupant.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/avatar/avatar.js");var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./node_modules/lit/directives/until.js"),i=s("./src/headless/dist/converse-headless.js");const a=e=>{const t=e.model??e.message,s=t?.get("jid"),a=e.getVcard(),l=t.get("nick"),c=t.get("occupant_id"),d=e.model?.get("role"),u=e.model?.get("affiliation"),h=e.model?.get("hats")?.length?e.model.get("hats"):null,f=e.model.collection.chatroom,m=f.getAllowedCommands().includes("modtools"),p=(0,n.__)("Add to Contacts"),g=f.features.get("nonanonymous")||"moderator"===f.getOwnRole(),_=s!=i._converse.bare_jid,v=i.api.contacts.get(s).then((e=>!e&&_&&g)).then((t=>t?r.html`<li><button class="btn btn-primary" type="button" @click=${()=>e.addToContacts()}>${p}</button></li>`:""));return r.html`
        <div class="row">
            <div class="col-auto">
                <converse-avatar
                    class="avatar modal-avatar"
                    .data=${a?.attributes}
                    nonce=${a?.get("vcard_updated")}
                    height="120" width="120"></converse-avatar>
            </div>
            <div class="col">
                <ul class="occupant-details">
                    <li>
                        ${l?r.html`<div class="row"><strong>${(0,n.__)("Nickname")}:</strong></div><div class="row">${l}</div>`:""}
                    </li>
                    <li>
                        ${s?r.html`<div class="row"><strong>${(0,n.__)("XMPP Address")}:</strong></div><div class="row">${s}</div>`:""}
                    </li>
                    <li>
                        <div class="row"><strong>${(0,n.__)("Affiliation")}:</strong></div>
                        <div class="row">${u}&nbsp;
                            ${m?r.html`
                                <a href="#"
                                data-form="affiliation-form"
                                class="toggle-form right"
                                color="var(--subdued-color)"
                                @click=${t=>e.toggleForm(t)}><converse-icon class="fa fa-wrench" size="1em"></converse-icon>
                                </a>
                                ${e.show_affiliation_form?r.html`<converse-muc-affiliation-form jid=${s} .muc=${f} affiliation=${u}></converse-muc-affiliation-form>`:""}`:""}
                        </div>
                    </li>
                    <li>
                        <div class="row"><strong>${(0,n.__)("Role")}:</strong></div>
                        <div class="row">${d}&nbsp;
                            ${m&&d?r.html`
                                <a href="#"
                                   data-form="row-form"
                                   class="toggle-form right"
                                   color="var(--subdued-color)"
                                   @click=${t=>e.toggleForm(t)}><converse-icon class="fa fa-wrench" size="1em"></converse-icon>
                                </a>
                                ${e.show_role_form?r.html`<converse-muc-role-form jid=${s} .muc=${f} role=${d}></converse-muc-role-form>`:""}`:""}
                        </div>
                    </li>
                    <li>
                        ${h?r.html`<div class="row"><strong>${(0,n.__)("Hats")}:</strong></div><div class="row">${h}</div>`:""}
                    </li>
                    <li>
                        ${c?r.html`<div class="row"><strong>${(0,n.__)("Occupant Id")}:</strong></div><div class="row">${c}</div>`:""}
                    </li>
                    ${(0,o.until)(v,"")}
                </ul>
            </div>
        </div>
    `}},"./src/plugins/muc-views/modtools.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s("./src/plugins/muc-views/templates/moderator-tools.js"),r=s("./src/headless/plugins/muc/constants.js"),o=s("./src/shared/components/element.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/headless/plugins/muc/affiliations/utils.js"),c=s("./src/headless/plugins/muc/utils.js"),d=s("./node_modules/@converse/openpromise/openpromise.js");s("./src/plugins/muc-views/styles/moderator-tools.scss");const{u}=a.converse.env;class h extends o.CustomElement{static get properties(){return{affiliation:{type:String},affiliations_filter:{type:String,attribute:!1},alert_message:{type:String,attribute:!1},alert_type:{type:String,attribute:!1},jid:{type:String},muc:{type:Object,attribute:!1},role:{type:String},roles_filter:{type:String,attribute:!1},tab:{type:String},users_with_affiliation:{type:Array,attribute:!1},users_with_role:{type:Array,attribute:!1}}}constructor(){super(),this.tab="affiliations",this.affiliation="",this.affiliations_filter="",this.role="",this.roles_filter="",this.addEventListener("affiliationChanged",(()=>{this.alert((0,i.__)("Affiliation changed"),"primary"),this.onSearchAffiliationChange(),this.requestUpdate()})),this.addEventListener("roleChanged",(()=>{this.alert((0,i.__)("Role changed"),"primary"),this.requestUpdate()}))}updated(e){e.has("role")&&this.onSearchRoleChange(),e.has("affiliation")&&this.onSearchAffiliationChange(),e.has("jid")&&e.get("jid")&&this.initialize()}async initialize(){this.initialized=(0,d.getOpenPromise)();const e=await a.api.rooms.get(this.jid);await e.initialized,this.muc=e,this.initialized.resolve()}render(){if(this.muc?.occupants){const e=this.muc.occupants.getOwnOccupant();return(0,n.default)(this,{affiliations_filter:this.affiliations_filter,alert_message:this.alert_message,alert_type:this.alert_type,assignRole:e=>this.assignRole(e),assignable_affiliations:(0,l.getAssignableAffiliations)(e),assignable_roles:(0,c.getAssignableRoles)(e),filterAffiliationResults:e=>this.filterAffiliationResults(e),filterRoleResults:e=>this.filterRoleResults(e),loading_users_with_affiliation:this.loading_users_with_affiliation,queryAffiliation:e=>this.queryAffiliation(e),queryRole:e=>this.queryRole(e),queryable_affiliations:r.AFFILIATIONS.filter((e=>!a.api.settings.get("modtools_disable_query").includes(e))),queryable_roles:r.ROLES.filter((e=>!a.api.settings.get("modtools_disable_query").includes(e))),roles_filter:this.roles_filter,switchTab:e=>this.switchTab(e),tab:this.tab,toggleForm:e=>this.toggleForm(e),users_with_affiliation:this.users_with_affiliation,users_with_role:this.users_with_role})}return""}switchTab(e){e.stopPropagation(),e.preventDefault(),this.tab=e.target.getAttribute("data-name"),this.requestUpdate()}async onSearchAffiliationChange(){if(this.affiliation){if(await this.initialized,this.clearAlert(),this.loading_users_with_affiliation=!0,this.users_with_affiliation=null,this.shouldFetchAffiliationsList()){const e=await(0,l.getAffiliationList)(this.affiliation,this.jid);e instanceof Error?(this.alert(e.message,"danger"),this.users_with_affiliation=[]):this.users_with_affiliation=e}else this.users_with_affiliation=this.muc.getOccupantsWithAffiliation(this.affiliation);this.loading_users_with_affiliation=!1}}async onSearchRoleChange(){this.role&&(await this.initialized,this.clearAlert(),this.users_with_role=this.muc.getOccupantsWithRole(this.role))}shouldFetchAffiliationsList(){const e=this.affiliation;if("none"===e)return!1;return!(0,c.getAutoFetchedAffiliationLists)().includes(e)}toggleForm(e){e.stopPropagation(),e.preventDefault();const t=u.ancestor(e.target,".toggle-form"),s=t.getAttribute("data-form"),n=u.ancestor(t,".list-group-item").querySelector(s);u.hasClass("hidden",n)?u.removeClass("hidden",n):u.addClass("hidden",n)}filterRoleResults(e){this.roles_filter=e.target.value,this.render()}filterAffiliationResults(e){this.affiliations_filter=e.target.value}queryRole(e){e.stopPropagation(),e.preventDefault();const t=new FormData(e.target).get("role");this.role=null,this.role=t}queryAffiliation(e){e.stopPropagation(),e.preventDefault();const t=new FormData(e.target).get("affiliation");this.affiliation=null,this.affiliation=t}alert(e,t){this.alert_message=e,this.alert_type=t}clearAlert(){this.alert_message=void 0,this.alert_type=void 0}}a.api.elements.define("converse-modtools",h)},"./src/plugins/muc-views/muc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/chat/baseview.js"),r=s("./src/plugins/muc-views/templates/muc.js"),o=s("./src/headless/dist/converse-headless.js");class i extends n.default{length=300;is_chatroom=!0;async initialize(){this.model=await o.api.rooms.get(this.jid),o._converse.chatboxviews.add(this.jid,this),this.setAttribute("id",this.model.get("box_id")),this.listenTo(o._converse,"windowStateChanged",this.onWindowStateChanged),this.listenTo(this.model,"change:composing_spoiler",this.requestUpdateMessageForm),this.listenTo(this.model.session,"change:connection_status",this.onConnectionStatusChanged),this.listenTo(this.model.session,"change:view",(()=>this.requestUpdate())),this.onConnectionStatusChanged(),this.model.maybeShow(),o.api.trigger("chatRoomViewInitialized",this)}render(){return(0,r.default)({model:this.model})}onConnectionStatusChanged(){this.model.session.get("connection_status")===o.converse.ROOMSTATUS.CONNECTING&&(this.model.session.save({disconnection_actor:void 0,disconnection_message:void 0,disconnection_reason:void 0}),this.model.save({moved_jid:void 0,password_validation_message:void 0,reason:void 0})),this.requestUpdate()}}o.api.elements.define("converse-muc",i)},"./src/plugins/muc-views/nickname-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/muc-views/templates/muc-nickname-form.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/plugins/muc-views/styles/nickname-form.scss");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=o._converse.chatboxes.get(this.jid)}render(){return(0,n.default)(this)}submitNickname(e){e.preventDefault();const t=e.target.nick.value.trim();t&&(this.model.isEntered()?(this.model.setNickname(t),this.closeModal()):this.model.join(t))}closeModal(){const e=document.createEvent("Event");e.initEvent("hide.bs.modal",!0,!0),this.dispatchEvent(e)}}o.api.elements.define("converse-muc-nickname-form",i);const a=i},"./src/plugins/muc-views/password-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/muc-views/templates/muc-password-form.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=o._converse.chatboxes.get(this.jid),this.listenTo(this.model,"change:password_validation_message",this.render),this.render()}render(){return(0,n.default)({jid:this.model.get("jid"),submitPassword:e=>this.submitPassword(e),validation_message:this.model.get("password_validation_message")})}submitPassword(e){e.preventDefault();const t=this.querySelector("input[type=password]").value;this.model.join(this.model.get("nick"),t),this.model.set("password_validation_message",null)}}o.api.elements.define("converse-muc-password-form",i);const a=i},"./src/plugins/muc-views/role-form.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/muc-views/templates/role-form.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/core.js");const{Strophe:l,sizzle:c}=i.converse.env;class d extends r.CustomElement{static get properties(){return{muc:{type:Object},jid:{type:String},role:{type:String},alert_message:{type:String,attribute:!1},alert_type:{type:String,attribute:!1}}}render(){return(0,n.default)(this)}alert(e,t){this.alert_message=e,this.alert_type=t}assignRole(e){e.stopPropagation(),e.preventDefault(),this.alert();const t=new FormData(e.target),s=this.muc.getOccupant(t.get("jid")||t.get("nick")),n=t.get("role"),r=t.get("reason");this.muc.setRole(s,n,r,(()=>{const e=new CustomEvent("roleChanged",{bubbles:!0});this.dispatchEvent(e)}),(e=>{c(`not-allowed[xmlns="${l.NS.STANZAS}"]`,e).length?this.alert((0,o.__)("You're not allowed to make that change"),"danger"):(this.alert((0,o.__)("Sorry, something went wrong while trying to set the role"),"danger"),(0,a.isErrorObject)(e)&&i.log.error(e))}))}}i.api.elements.define("converse-muc-role-form",d)},"./src/plugins/muc-views/search.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getAutoCompleteList:()=>l});var n=s("./src/headless/dist/converse-headless.js");const{Strophe:r,$iq:o,sizzle:i}=n.converse.env;r.addNamespace("MUCSEARCH","https://xmlns.zombofant.net/muclumbus/search/1.0");const a={};function l(e){return a[e]||(a[e]=async function(e){const t=o({type:"get",from:n._converse.bare_jid,to:"api@search.jabber.network"}).c("search",{xmlns:r.NS.MUCSEARCH}).c("set",{xmlns:r.NS.RSM}).c("max").t(10).up().up().c("x",{xmlns:r.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t("https://xmlns.zombofant.net/muclumbus/search/1.0#params").up().up().c("field",{var:"q",type:"text-single"}).c("value").t(e).up().up().c("field",{var:"sinname",type:"boolean"}).c("value").t("true").up().up().c("field",{var:"sindescription",type:"boolean"}).c("value").t("false").up().up().c("field",{var:"sinaddr",type:"boolean"}).c("value").t("true").up().up().c("field",{var:"min_users",type:"text-single"}).c("value").t("1").up().up().c("field",{var:"key",type:"list-single"}).c("value").t("address").up().c("option").c("value").t("nusers").up().up().c("option").c("value").t("address");let s;try{s=await n.api.sendIQ(t)}catch(e){return n.log.error(e),[]}const a=`result[xmlns="${r.NS.MUCSEARCH}"] item`;return i(a,s).map((e=>{const t=e.getAttribute("address");return{label:`${e.querySelector("name")?.textContent} (${t})`,value:t}}))}(e)),a[e]}},"./src/plugins/muc-views/sidebar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/autocomplete/index.js");var n=s("./src/plugins/muc-views/templates/muc-sidebar.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/shared/styles/status.scss"),s("./src/plugins/muc-views/styles/muc-occupants.scss");const{u:i}=o.converse.env;class a extends r.CustomElement{static get properties(){return{jid:{type:String}}}connectedCallback(){super.connectedCallback(),this.model=o._converse.chatboxes.get(this.jid),this.listenTo(this.model.occupants,"add",(()=>this.requestUpdate())),this.listenTo(this.model.occupants,"remove",(()=>this.requestUpdate())),this.listenTo(this.model.occupants,"change",(()=>this.requestUpdate())),this.listenTo(this.model.occupants,"vcard:change",(()=>this.requestUpdate())),this.listenTo(this.model.occupants,"vcard:add",(()=>this.requestUpdate())),this.model.initialized.then((()=>this.requestUpdate()))}render(){return(0,n.default)(Object.assign(this.model.toJSON(),{occupants:[...this.model.occupants.models],closeSidebar:e=>this.closeSidebar(e),onOccupantClicked:e=>this.onOccupantClicked(e)}))}closeSidebar(e){e?.preventDefault?.(),e?.stopPropagation?.(),i.safeSave(this.model,{hidden_occupants:!0})}onOccupantClicked(e){e?.preventDefault?.();const t=o._converse.chatboxviews.get(this.getAttribute("jid"));t?.getMessageForm().insertIntoTextArea(`@${e.target.textContent}`)}}o.api.elements.define("converse-muc-sidebar",a)},"./src/plugins/muc-views/templates/affiliation-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./src/headless/plugins/muc/affiliations/utils.js");const i=e=>{const t=(0,n.__)("Change affiliation"),s=(0,n.__)("New affiliation"),i=(0,n.__)("Reason"),a=e.muc.getOwnOccupant(),l=(0,o.getAssignableAffiliations)(a);return r.html`
        <form class="affiliation-form" @submit=${t=>e.assignAffiliation(t)}>
            ${e.alert_message?r.html`<div class="alert alert-${e.alert_type}" role="alert">${e.alert_message}</div>`:""}
            <div class="form-group">
                <div class="row">
                    <div class="col">
                        <label><strong>${s}:</strong></label>
                        <select class="custom-select select-affiliation" name="affiliation">
                            ${l.map((t=>r.html`<option value="${t}" ?selected=${t===e.affiliation}>${t}</option>`))}
                        </select>
                    </div>
                    <div class="col">
                        <label><strong>${i}:</strong></label>
                        <input class="form-control" type="text" name="reason"/>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col">
                    <input type="submit" class="btn btn-primary" name="change" value="${t}"/>
                </div>
            </div>
        </form>
    `}},"./src/plugins/muc-views/templates/mep-message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/index.js");const{dayjs:o}=n.converse.env,i=e=>{const t=o(e.model.get("time")).toISOString();return r.html`
        <div class="message chat-info message--mep ${e.getExtraMessageClasses()}"
            data-isodate="${t}"
            data-type="${e.data_name}"
            data-value="${e.data_value}">

            <div class="chat-msg__content">
                <div class="chat-msg__body chat-msg__body--${e.model.get("type")} ${e.model.get("is_delayed")?"chat-msg__body--delayed":""}">
                    <div class="chat-info__message">
                        ${e.isRetracted()?e.renderRetraction():r.html`
                            <converse-rich-text
                                .mentions=${e.model.get("references")}
                                render_styling
                                text=${e.model.getMessageText()}>
                            </converse-rich-text>
                            ${e.model.get("reason")?r.html`<q class="reason"><converse-rich-text text=${e.model.get("reason")}></converse-rich-text></q>`:""}
                        `}
                    </div>
                    <converse-message-actions
                        ?is_retracted=${e.isRetracted()}
                        .model=${e.model}></converse-message-actions>
                </div>
            </div>
        </div>`}},"./src/plugins/muc-views/templates/message-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/plugins/chatview/utils.js");const a=e=>{const t=e.composing_spoiler?(0,n.__)("Hidden message"):(0,n.__)("Message"),s=(0,n.__)("Optional hint"),a=r.api.settings.get("show_send_button");return o.html`
        <form class="setNicknameButtonForm hidden">
            <input type="submit" class="btn btn-primary" name="join" value="Join"/>
        </form>
        <form class="sendXMPPMessage">
            <input type="text" placeholder="${s||""}" value="${e.hint_value||""}" class="${e.composing_spoiler?"":"hidden"} spoiler-hint"/>
            <div class="suggestion-box">
                <ul class="suggestion-box__results suggestion-box__results--above" hidden=""></ul>
                <textarea
                    autofocus
                    type="text"
                    @drop=${e.onDrop}
                    @input=${i.resetElementHeight}
                    @keydown=${e.onKeyDown}
                    @keyup=${e.onKeyUp}
                    @paste=${e.onPaste}
                    @change=${e.onChange}
                    class="chat-textarea suggestion-box__input
                        ${a?"chat-textarea-send-button":""}
                        ${e.composing_spoiler?"spoiler":""}"
                    placeholder="${t}">${e.message_value||""}</textarea>
                <span class="suggestion-box__additions visually-hidden" role="status" aria-live="assertive" aria-relevant="additions"></span>
            </div>
        </form>`}},"./src/plugins/muc-views/templates/moderator-tools.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/templates/spinner.js"),r=s("./src/i18n/index.js"),o=s("./node_modules/lit/index.js");function i(e){return"moderator"===e?(0,r.__)("Moderators are privileged users who can change the roles of other users (except those with admin or owner affiliations."):"participant"===e?(0,r.__)("The default role, implies that you can read and write messages."):"visitor"==e?(0,r.__)("Visitors aren't allowed to write messages in a moderated multi-user chat."):void 0}function a(e){return"owner"===e?(0,r.__)("Owner is the highest affiliation. Owners can modify roles and affiliations of all other users."):"admin"===e?(0,r.__)("Admin is the 2nd highest affiliation. Admins can modify roles and affiliations of all other users except owners."):"outcast"===e?(0,r.__)('To ban a user, you give them the affiliation of "outcast".'):void 0}const l=(e,t)=>o.html`
    <li class="list-group-item" data-nick="${t.item.nick}">
        <ul class="list-group">
            <li class="list-group-item active">
                <div><strong>JID:</strong> ${t.item.jid}</div>
            </li>
            <li class="list-group-item">
                <div><strong>Nickname:</strong> ${t.item.nick}</div>
            </li>
            <li class="list-group-item">
                <div><strong>Role:</strong> ${t.item.role} ${t.assignable_roles.length?(e=>o.html`
    <a href="#" data-form="converse-muc-role-form" class="toggle-form right" color="var(--subdued-color)" @click=${e.toggleForm}>
        <converse-icon class="fa fa-wrench" size="1em"></converse-icon>
    </a>`)(t):""}</div>
                ${t.assignable_roles.length?o.html`<converse-muc-role-form class="hidden" .muc=${e.muc} jid=${t.item.jid} role=${t.item.role}></converse-muc-role-form>`:""}
            </li>
        </ul>
    </li>
`,c=(e,t)=>o.html`
    <li class="list-group-item" data-nick="${t.item.nick}">
        <ul class="list-group">
            <li class="list-group-item active">
                <div><strong>JID:</strong> ${t.item.jid}</div>
            </li>
            <li class="list-group-item">
                <div><strong>Nickname:</strong> ${t.item.nick}</div>
            </li>
            <li class="list-group-item">
                <div><strong>Affiliation:</strong> ${t.item.affiliation} ${t.assignable_affiliations.length?(e=>o.html`
    <a href="#" data-form="converse-muc-affiliation-form" class="toggle-form right" color="var(--subdued-color)" @click=${e.toggleForm}>
        <converse-icon class="fa fa-wrench" size="1em"></converse-icon>
    </a>`)(t):""}</div>
                ${t.assignable_affiliations.length?o.html`<converse-muc-affiliation-form class="hidden" .muc=${e.muc} jid=${t.item.jid} affiliation=${t.item.affiliation}></converse-muc-affiliation-form>`:""}
            </li>
        </ul>
    </li>
`,d=(e,t)=>{const s=(0,r.__)("Affiliation"),d=(0,r.__)("No users with that affiliation found."),u=(0,r.__)("No users with that role found."),h=(0,r.__)("Type here to filter the search results"),f=(0,r.__)("Role"),m=(0,r.__)("Show users"),p=(0,r.__)("Roles are assigned to users to grant or deny them certain abilities in a multi-user chat. They're assigned either explicitly or implicitly as part of an affiliation. A role that's not due to an affiliation, is only valid for the duration of the user's session."),g=(0,r.__)("An affiliation is a long-lived entitlement which typically implies a certain role and which grants privileges and responsibilities. For example admins and owners automatically have the moderator role."),_=t.queryable_roles.length&&t.queryable_affiliations.length;return o.html`
        ${t.alert_message?o.html`<div class="alert alert-${t.alert_type}" role="alert">${t.alert_message}</div>`:""}
        ${_?(e=>o.html`
    <ul class="nav nav-pills justify-content-center">
        <li role="presentation" class="nav-item">
            <a class="nav-link ${"affiliations"===e.tab?"active":""}"
               id="affiliations-tab"
               href="#affiliations-tabpanel"
               aria-controls="affiliations-tabpanel"
               role="tab"
               data-name="affiliations"
               @click=${e.switchTab}>Affiliations</a>
        </li>
        <li role="presentation" class="nav-item">
            <a class="nav-link ${"roles"===e.tab?"active":""}"
               id="roles-tab"
               href="#roles-tabpanel"
               aria-controls="roles-tabpanel"
               role="tab"
               data-name="roles"
               @click=${e.switchTab}>Roles</a>
        </li>
    </ul>
`)(t):""}

        <div class="tab-content">

            ${t.queryable_affiliations.length?o.html`
            <div class="tab-pane tab-pane--columns ${"affiliations"===t.tab?"active":""}" id="affiliations-tabpanel" role="tabpanel" aria-labelledby="affiliations-tab">
                <form class="converse-form query-affiliation" @submit=${t.queryAffiliation}>
                    <p class="helptext pb-3">${g}</p>
                    <div class="form-group">
                        <label for="affiliation">
                            <strong>${s}:</strong>
                        </label>
                        <div class="row">
                            <div class="col">
                                <select class="custom-select select-affiliation" name="affiliation">
                                    ${t.queryable_affiliations.map((e=>(e=>o.html`
    <option value="${e.item||""}"
            ?selected=${e.item===e.affiliation}
            title="${a(e.item)}">${e.item}</option>
`)(Object.assign({item:e},t))))}
                                </select>
                            </div>
                            <div class="col">
                                <input type="submit" class="btn btn-primary" name="users_with_affiliation" value="${m}"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col mt-3">
                                ${Array.isArray(t.users_with_affiliation)&&t.users_with_affiliation.length>5?o.html`<input class="form-control" .value="${t.affiliations_filter}" @keyup=${t.filterAffiliationResults} type="text" name="filter" placeholder="${h}"/>`:""}
                            </div>
                        </div>

                        ${a(t.affiliation)?o.html`<div class="row"><div class="col pt-2"><p class="helptext pb-3">${a(t.affiliation)}</p></div></div>`:""}
                    </div>
                </form>
                <div class="scrollable-container">
                    <ul class="list-group list-group--users">
                        ${t.loading_users_with_affiliation?o.html`<li class="list-group-item"> ${(0,n.default)()} </li>`:""}
                        ${Array.isArray(t.users_with_affiliation)&&0===t.users_with_affiliation.length?o.html`<li class="list-group-item">${d}</li>`:""}

                        ${t.users_with_affiliation instanceof Error?o.html`<li class="list-group-item">${t.users_with_affiliation.message}</li>`:(t.users_with_affiliation||[]).map((s=>(s.nick||s.jid).match(new RegExp(t.affiliations_filter,"i"))?c(e,Object.assign({item:s},t)):""))}
                    </ul>
                </div>
            </div>`:""}

            ${t.queryable_roles.length?o.html`
            <div class="tab-pane tab-pane--columns ${"roles"===t.tab?"active":""}" id="roles-tabpanel" role="tabpanel" aria-labelledby="roles-tab">
                <form class="converse-form query-role" @submit=${t.queryRole}>
                    <p class="helptext pb-3">${p}</p>
                    <div class="form-group">
                        <label for="role"><strong>${f}:</strong></label>
                        <div class="row">
                            <div class="col">
                                <select class="custom-select select-role" name="role">
                                    ${t.queryable_roles.map((e=>(e=>o.html`
    <option value="${e.item||""}"
            ?selected=${e.item===e.role}
            title="${i(e.item)}">${e.item}</option>
`)(Object.assign({item:e},t))))}
                                </select>
                            </div>
                            <div class="col">
                                <input type="submit" class="btn btn-primary" name="users_with_role" value="${m}"/>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col mt-3">
                                ${Array.isArray(t.users_with_role)&&t.users_with_role.length>5?o.html`<input class="form-control" .value="${t.roles_filter}" @keyup=${t.filterRoleResults} type="text" name="filter" placeholder="${h}"/>`:""}
                            </div>
                        </div>

                        ${i(t.role)?o.html`<div class="row"><div class="col pt-2"><p class="helptext pb-3">${i(t.role)}</p></div></div>`:""}
                    </div>
                </form>
                <div class="scrollable-container">
                    <ul class="list-group list-group--users">
                        ${t.loading_users_with_role?o.html`<li class="list-group-item"> ${(0,n.default)()} </li>`:""}
                        ${t.users_with_role&&0===t.users_with_role.length?o.html`<li class="list-group-item">${u}</li>`:""}
                        ${(t.users_with_role||[]).map((s=>s.nick.match(t.roles_filter)?l(e,Object.assign({item:s},t)):""))}
                    </ul>
                </div>
            </div>`:""}
        </div>`}},"./src/plugins/muc-views/templates/muc-bottom-panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});s("./src/plugins/muc-views/message-form.js"),s("./src/plugins/muc-views/nickname-form.js"),s("./src/shared/chat/toolbar.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=(0,n.__)("You have unread messages"),s=e.model.session.get("connection_status"),i=(0,n.__)("You're not allowed to send messages in this room");return s===r.converse.ROOMSTATUS.ENTERED?o.html`
            ${e.model.ui.get("scrolled")&&e.model.get("num_unread_general")?o.html`<div class="new-msgs-indicator" @click=${t=>e.viewUnreadMessages(t)}> ${t} </div>`:""}
            ${e.can_edit?(e=>{const t=(0,n.__)("You have unread messages"),s=r.api.settings.get("message_limit"),i=r.api.settings.get("visible_toolbar_buttons").call,a=r.api.settings.get("visible_toolbar_buttons").emoji,l=r.api.settings.get("show_send_button"),c=r.api.settings.get("visible_toolbar_buttons").spoiler,d=r.api.settings.get("show_toolbar");return o.html`
        ${e.model.ui.get("scrolled")&&e.model.get("num_unread")?o.html`<div class="new-msgs-indicator" @click=${t=>e.viewUnreadMessages(t)}> ${t} </div>`:""}
        ${d?o.html`
            <converse-chat-toolbar
                class="chat-toolbar no-text-select"
                .model=${e.model}
                ?hidden_occupants="${e.model.get("hidden_occupants")}"
                ?is_groupchat="${e.is_groupchat}"
                ?show_call_button="${i}"
                ?show_emoji_button="${a}"
                ?show_send_button="${l}"
                ?show_spoiler_button="${c}"
                ?show_toolbar="${d}"
                message_limit="${s}"></converse-chat-toolbar>`:""}
        <converse-muc-message-form jid=${e.model.get("jid")}></converse-muc-message-form>`})(e):o.html`<span class="muc-bottom-panel muc-bottom-panel--muted">${i}</span>`}`:s!=r.converse.ROOMSTATUS.NICKNAME_REQUIRED?"":r.api.settings.get("muc_show_logs_before_join")?o.html`<span class="muc-bottom-panel muc-bottom-panel--nickname">
                <converse-muc-nickname-form jid="${e.model.get("jid")}"></converse-muc-nickname-form>
            </span>`:void 0}},"./src/plugins/muc-views/templates/muc-chatarea.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});s("./src/plugins/muc-views/bottom-panel.js"),s("./src/plugins/muc-views/sidebar.js"),s("./src/shared/chat/chat-content.js"),s("./src/shared/chat/help-messages.js");var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/index.js");const o=e=>r.html`
    <div class="chat-area">
        <div class="chat-content ${e.show_send_button?"chat-content-sendbutton":""}" aria-live="polite">
            <converse-chat-content
                class="chat-content__messages"
                jid="${e.jid}"></converse-chat-content>

            ${e.model?.get("show_help_messages")?r.html`<div class="chat-content__help">
                    <converse-chat-help
                        .model=${e.model}
                        .messages=${e.getHelpMessages()}
                        type="info"
                        chat_type="${n._converse.CHATROOMS_TYPE}"
                    ></converse-chat-help></div>`:""}
        </div>
        <converse-muc-bottom-panel jid="${e.jid}" class="bottom-panel"></converse-muc-bottom-panel>
    </div>
    <div class="disconnect-container hidden"></div>
    ${e.model?r.html`
        <converse-muc-sidebar
            class="occupants col-md-3 col-4 ${e.shouldShowSidebar()?"":"hidden"}"
            style="flex: 0 0 ${e.model.get("occupants_width")}px"
            jid=${e.jid}
            @mousedown=${e.onMousedown}></converse-muc-sidebar>`:""}
`},"./src/plugins/muc-views/templates/muc-config-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/templates/spinner.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");const{sizzle:a}=o.converse.env,l=o.converse.env.utils,c=e=>{const t=o.api.settings.get("roomconfig_whitelist"),s=e.model.session.get("config_stanza");let c,d=[],u="";if(s){const n=l.toStanza(s);d=a("field",n),t.length&&(d=d.filter((e=>t.includes(e.getAttribute("var")))));const r={new_password:!e.model.features.get("passwordprotected"),fixed_username:e.model.get("jid")};d=d.map((e=>l.xForm2TemplateResult(e,n,r))),u=n.querySelector("instructions")?.textContent,c=n.querySelector("title")?.textContent}else c=(0,r.__)("Loading configuration form");const h=(0,r.__)("Save"),f=(0,r.__)("Cancel");return i.html`
        <form class="converse-form chatroom-form ${d.length?"":"converse-form--spinner"}"
                autocomplete="off"
                @submit=${e.submitConfigForm}>

            <fieldset class="form-group">
                <legend class="centered">${c}</legend>
                ${c!==u?i.html`<p class="form-help">${u}</p>`:""}
                ${d.length?d:(0,n.default)({classes:"hor_centered"})}
            </fieldset>
            ${d.length?i.html`
                <fieldset>
                    <input type="submit" class="btn btn-primary" value="${h}">
                    <input type="button" class="btn btn-secondary button-cancel" value="${f}" @click=${e.closeConfigForm}>
                </fieldset>`:""}
        </form>
    `}},"./src/plugins/muc-views/templates/muc-description.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("Description:"),s=(0,r.__)("Groupchat XMPP Address:"),o=(0,r.__)("Participants:"),i=(0,r.__)("Features:"),a=(0,r.__)("Requires authentication"),l=(0,r.__)("Hidden"),c=(0,r.__)("Requires an invitation"),d=(0,r.__)("Moderated"),u=(0,r.__)("Non-anonymous"),h=(0,r.__)("Open"),f=(0,r.__)("Permanent"),m=(0,r.__)("Public"),p=(0,r.__)("Semi-anonymous"),g=(0,r.__)("Temporary"),_=(0,r.__)("Unmoderated");return n.html`
    <div class="room-info">
        <p class="room-info"><strong>${s}</strong> ${e.jid}</p>
        <p class="room-info"><strong>${t}</strong> ${e.desc}</p>
        <p class="room-info"><strong>${o}</strong> ${e.occ}</p>
        <p class="room-info"><strong>${i}</strong>
            <ul>
                ${e.passwordprotected?n.html`<li class="room-info locked">${a}</li>`:""}
                ${e.hidden?n.html`<li class="room-info">${l}</li>`:""}
                ${e.membersonly?n.html`<li class="room-info">${c}</li>`:""}
                ${e.moderated?n.html`<li class="room-info">${d}</li>`:""}
                ${e.nonanonymous?n.html`<li class="room-info">${u}</li>`:""}
                ${e.open?n.html`<li class="room-info">${h}</li>`:""}
                ${e.persistent?n.html`<li class="room-info">${f}</li>`:""}
                ${e.publicroom?n.html`<li class="room-info">${m}</li>`:""}
                ${e.semianonymous?n.html`<li class="room-info">${p}</li>`:""}
                ${e.temporary?n.html`<li class="room-info">${g}</li>`:""}
                ${e.unmoderated?n.html`<li class="room-info">${_}</li>`:""}
            </ul>
        </p>
    </div>
`}},"./src/plugins/muc-views/templates/muc-destroyed.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=e=>{const t=(0,n.__)("This groupchat no longer exists"),s=(0,n.__)('The following reason was given: "%1$s"',e.reason||"");return r.html`
        <div class="alert alert-danger">
            <h3 class="alert-heading disconnect-msg">${t}</h3>
        </div>
        ${e.reason?r.html`<p class="destroyed-reason">${s}</p>`:""}
        ${e.moved_jid?(e=>{const t=(0,n.__)("The conversation has moved to a new address. Click the link below to enter.");return r.html`
        <p class="moved-label">${t}</p>
        <p class="moved-link">
            <a class="switch-chat" @click=${t=>e.onSwitch(t)}>${e.moved_jid}</a>
        </p>`})(e):""}
    `}},"./src/plugins/muc-views/templates/muc-disconnect.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
        <div class="alert alert-danger">
            <h3 class="alert-heading disconnect-msg">${e[0]}</h3>
            ${e.slice(1).map((e=>n.html`<p class="disconnect-msg">${e}</p>`))}
        </div>`},"./src/plugins/muc-views/templates/muc-head.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});s("./src/shared/components/dropdown.js"),s("./src/shared/components/rich-text.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/shared/chat/utils.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/until.js");const l=e=>{const t=e.model.toJSON(),s=e.user_settings?.get("mucs_with_hidden_subject",[])?.includes(e.model.get("jid")),l=e.getHeadingButtons(s),c=(0,n.__)("Hide the groupchat topic"),d=(0,n.__)("This groupchat is bookmarked"),u=t.subject?t.subject.text:"",h=u&&!s,f=e.model.vcard?.get("image");return i.html`
        <div class="chatbox-title ${h?"":"chatbox-title--no-desc"}">

            ${f&&f!==r._converse.DEFAULT_IMAGE?i.html`
                <converse-avatar class="avatar align-self-center"
                    .data=${e.model.vcard?.attributes}
                    nonce=${e.model.vcard?.get("vcard_updated")}
                    height="40" width="40"></converse-avatar>`:""}

            <div class="chatbox-title--row">
                ${r._converse.api.settings.get("singleton")?"":i.html`<converse-controlbox-navback jid="${t.jid}"></converse-controlbox-navback>`}
                <div class="chatbox-title__text" title="${"hidden"!==r.api.settings.get("locked_muc_domain")?t.jid:""}">${e.model.getDisplayName()}
                ${t.bookmarked?i.html`<converse-icon
                            class="fa fa-bookmark chatbox-title__text--bookmarked"
                            size="1em"
                            color="var(--chatroom-head-color)"
                            title="${d}">
                        </converse-icon>`:""}
                </div>
            </div>
            <div class="chatbox-title__buttons row no-gutters">
                ${(0,a.until)((0,o.getStandaloneButtons)(l),"")}
                ${(0,a.until)((0,o.getDropdownButtons)(l),"")}
            </div>
        </div>
        ${h?i.html`<p class="chat-head__desc" title="${c}">
            <converse-rich-text text=${u} render_styling></converse-rich-text>
          </p>`:""}
    `}},"./src/plugins/muc-views/templates/muc-list.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./node_modules/lit/directives/repeat.js"),i=s("./src/templates/spinner.js");const a=e=>r.html`
        ${e.show_form?(e=>{const t=(0,n.__)("Show groupchats"),s=(0,n.__)("Server address");return r.html`
        <form class="converse-form list-chatrooms"
            @submit=${e.submitForm}>
            <div class="form-group">
                <label for="chatroom">${s}:</label>
                <input type="text"
                    autofocus
                    @change=${e.setDomainFromEvent}
                    value="${e.muc_domain||""}"
                    required="required"
                    name="server"
                    class="form-control"
                    placeholder="${e.server_placeholder}"/>
            </div>
            <input type="submit" class="btn btn-primary" name="list" value="${t}"/>
        </form>
    `})(e):""}
        <ul class="available-chatrooms list-group">
            ${e.loading_items?r.html`<li class="list-group-item"> ${(0,i.default)()} </li>`:""}
            ${e.feedback_text?r.html`<li class="list-group-item active">${e.feedback_text}</li>`:""}
            ${(0,o.repeat)(e.items,(e=>e.jid),(t=>((e,t)=>{const s=(0,n.__)("Show more information on this groupchat"),o=(0,n.__)("Click to open this groupchat");return r.html`
        <li class="room-item list-group-item">
            <div class="available-chatroom d-flex flex-row">
                <a class="open-room available-room w-100"
                    @click=${e.openRoom}
                    data-room-jid="${t.jid}"
                    data-room-name="${t.name}"
                    title="${o}"
                    href="#">${t.name||t.jid}</a>
                    <a class="right room-info icon-room-info"
                    @click=${e.toggleRoomInfo}
                    data-room-jid="${t.jid}"
                    title="${s}"
                    href="#"></a>
            </div>
        </li>
    `})(e,t)))}
        </ul>
    `},"./src/plugins/muc-views/templates/muc-nickname-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=(0,n.__)("Nickname"),s=e.model?.isEntered()?(0,n.__)("Change nickname"):(0,n.__)("Enter groupchat"),i=r.api.settings.get("muc_show_logs_before_join")?(0,n.__)("Choose a nickname to enter"):(0,n.__)("Please choose your nickname"),a=e.model?.get("nickname_validation_message");return o.html`
        <div class="chatroom-form-container muc-nickname-form">
                <form class="converse-form chatroom-form converse-centered-form"
                        @submit=${t=>e.submitNickname(t)}>
                <fieldset class="form-group">
                    <label>${i}</label>
                    <p class="validation-message">${a}</p>
                    <input type="text"
                        required="required"
                        name="nick"
                        value="${e.model?.get("nick")||""}"
                        class="form-control ${a?"error":""}"
                        placeholder="${t}"/>
                </fieldset>
                <fieldset class="form-group">
                    <input type="submit"
                        class="btn btn-primary"
                        name="join"
                        value="${s}"/>
                </fieldset>
            </form>
        </div>`}},"./src/plugins/muc-views/templates/muc-password-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("This groupchat requires a password"),s=(0,r.__)("Password: "),o=(0,r.__)("Submit");return n.html`
        <form class="converse-form chatroom-form converse-centered-form" @submit=${e.submitPassword}>
            <fieldset class="form-group">
                <label>${t}</label>
                <p class="validation-message">${e.validation_message}</p>
                <input class="hidden-username" type="text" autocomplete="username" value="${e.jid}"></input>
                <input type="password"
                    name="password"
                    required="required"
                    class="form-control ${e.validation_message?"error":""}"
                    placeholder="${s}"/>
            </fieldset>
            <fieldset class="form-group">
                <input class="btn btn-primary" type="submit" value="${o}"/>
            </fieldset>
        </form>
    `}},"./src/plugins/muc-views/templates/muc-sidebar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/muc-views/templates/occupant.js"),r=s("./src/i18n/index.js"),o=s("./node_modules/lit/index.js"),i=s("./node_modules/lit/directives/repeat.js");const a=e=>{const t=1===e.occupants.length?(0,r.__)("Participant"):(0,r.__)("Participants");return o.html`
        <div class="occupants-header">
            <div class="occupants-header--title">
                <span class="occupants-heading">${e.occupants.length} ${t}</span>
                <i class="hide-occupants" @click=${e.closeSidebar}>
                    <converse-icon class="fa fa-times" size="1em"></converse-icon>
                </i>
            </div>
        </div>
        <div class="dragresize dragresize-occupants-left"></div>
        <ul class="occupant-list">${(0,i.repeat)(e.occupants,(e=>e.get("jid")),(t=>(0,n.default)(t,e)))}</ul>
    `}},"./src/plugins/muc-views/templates/muc.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});s("./src/plugins/muc-views/chatarea.js"),s("./src/plugins/muc-views/config-form.js"),s("./src/plugins/muc-views/destroyed.js"),s("./src/plugins/muc-views/disconnected.js"),s("./src/plugins/muc-views/heading.js"),s("./src/plugins/muc-views/nickname-form.js"),s("./src/plugins/muc-views/password-form.js");var n=s("./node_modules/lit/index.js"),r=s("./src/plugins/muc-views/utils.js");const o=e=>n.html`
        <div class="flyout box-flyout">
            <converse-dragresize></converse-dragresize>
            ${e.model?n.html`
                <converse-muc-heading jid="${e.model.get("jid")}" class="chat-head chat-head-chatroom row no-gutters">
                </converse-muc-heading>
                <div class="chat-body chatroom-body row no-gutters">${(0,r.getChatRoomBodyTemplate)(e)}</div>
            `:""}
        </div>`},"./src/plugins/muc-views/templates/occupant.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/muc-views/constants.js"),r=s("./src/i18n/index.js"),o=s("./node_modules/lit/index.js"),i=s("./src/plugins/muc-views/utils.js");const a=e=>{const t=e.get("role"),s=(e=>(0,r.__)("Click to mention %1$s in your message.",e.get("nick")))(e),n=(0,r.__)("This user is a moderator."),o=(0,r.__)("This user can send messages in this groupchat."),i=(0,r.__)("This user can NOT send messages in this groupchat."),a=e.get("jid")?`${e.get("jid")} `:"";return"moderator"===t?`${a}${n} ${s}`:"participant"===t?`${a}${o} ${s}`:"visitor"===t?`${a}${i} ${s}`:["visitor","participant","moderator"].includes(t)?void 0:`${a}${s}`},l=(e,t)=>{const s=e.get("affiliation"),l=n.PRETTY_CHAT_STATUS[e.get("show")],c=(0,r.__)("Admin"),d=(0,r.__)("Member"),u=(0,r.__)("Moderator"),h=(0,r.__)("Owner"),f=(0,r.__)("Visitor"),m=e.get("role"),p=e.get("show");let g,_;return[g,_]="online"===p?["fa fa-circle","chat-status-online"]:"dnd"===p?["fa fa-minus-circle","chat-status-busy"]:"away"===p?["fa fa-circle","chat-status-away"]:["fa fa-circle","subdued-color"],o.html`
        <li class="occupant" id="${e.id}" title="${a(e)}">
            <div class="row no-gutters">
                <div class="col-auto">
                    <a class="show-msg-author-modal" @click=${t=>(0,i.showOccupantModal)(t,e)}>
                        <converse-avatar
                            class="avatar chat-msg__avatar"
                            .data=${e.vcard?.attributes}
                            nonce=${e.vcard?.get("vcard_updated")}
                            height="30" width="30"></converse-avatar>
                        <converse-icon
                           title="${l}"
                           color="var(--${_})"
                           style="margin-top: -0.1em"
                           size="0.82em"
                           class="${g} chat-status chat-status--avatar"></converse-icon>
                    </a>
                </div>
                <div class="col occupant-nick-badge">
                    <span class="occupant-nick" @click=${t.onOccupantClicked}>${e.getDisplayName()}</span>
                    <span class="occupant-badges">
                        ${"owner"===s?o.html`<span class="badge badge-groupchat">${h}</span>`:""}
                        ${"admin"===s?o.html`<span class="badge badge-info">${c}</span>`:""}
                        ${"member"===s?o.html`<span class="badge badge-info">${d}</span>`:""}
                        ${"moderator"===m?o.html`<span class="badge badge-info">${u}</span>`:""}
                        ${"visitor"===m?o.html`<span class="badge badge-secondary">${f}</span>`:""}
                    </span>
                </div>
            </div>
        </li>
    `}},"./src/plugins/muc-views/templates/role-form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./src/headless/plugins/muc/utils.js");const i=e=>{const t=(0,n.__)("Change role"),s=(0,n.__)("New Role"),i=(0,n.__)("Reason"),a=e.muc.getOwnOccupant(),l=(0,o.getAssignableRoles)(a);return r.html`
        <form class="role-form" @submit=${e.assignRole}>
            <div class="form-group">
                <input type="hidden" name="jid" value="${e.jid}"/>
                <input type="hidden" name="nick" value="${e.nick}"/>
                <div class="row">
                    <div class="col">
                        <label><strong>${s}:</strong></label>
                        <select class="custom-select select-role" name="role">
                        ${l.map((t=>r.html`<option value="${t}" ?selected=${t===e.role}>${t}</option>`))}
                        </select>
                    </div>
                    <div class="col">
                        <label><strong>${i}:</strong></label>
                        <input class="form-control" type="text" name="reason"/>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col">
                    <input type="submit" class="btn btn-primary" value="${t}"/>
                </div>
            </div>
        </form>
    `}},"./src/plugins/muc-views/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{clearHistory:()=>f,confirmDirectMUCInvitation:()=>h,destroyMUC:()=>m,getAutoCompleteList:()=>v,getAutoCompleteListItem:()=>_,getChatRoomBodyTemplate:()=>g,getNicknameRequiredTemplate:()=>p,parseMessageForMUCCommands:()=>S,showModeratorToolsModal:()=>j,showOccupantModal:()=>w});s("./src/plugins/muc-views/modals/occupant.js"),s("./src/plugins/muc-views/modals/moderator-tools.js");var n=s("./src/templates/spinner.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js"),a=s("./src/headless/plugins/muc/affiliations/utils.js");const{Strophe:l,u:c}=o.converse.env,d={admin:"admin",ban:"outcast",member:"member",owner:"owner",revoke:"none"},u={deop:"participant",kick:"none",mute:"visitor",op:"moderator",voice:"participant"};function h(e){let{contact:t,jid:s,reason:n}=e;return n?o.api.confirm((0,r.__)('%1$s has invited you to join a groupchat: %2$s, and left the following reason: "%3$s"',t,s,n)):o.api.confirm((0,r.__)("%1$s has invited you to join a groupchat: %2$s",t,s))}function f(e){o._converse.router.history.getFragment()===`converse/room?jid=${e}`&&o._converse.router.navigate("")}async function m(e){const t=[(0,r.__)("Are you sure you want to destroy this groupchat?")];let s=[{name:"challenge",label:(0,r.__)("Please enter the XMPP address of this groupchat to confirm"),challenge:e.get("jid"),placeholder:(0,r.__)("name@example.org"),required:!0},{name:"reason",label:(0,r.__)("Optional reason for destroying this groupchat"),placeholder:(0,r.__)("Reason")},{name:"newjid",label:(0,r.__)("Optional XMPP address for a new groupchat that replaces this one"),placeholder:(0,r.__)("replacement@example.org")}];try{s=await o.api.confirm((0,r.__)("Confirm"),t,s);const n=s.filter((e=>"reason"===e.name)).pop()?.value,i=s.filter((e=>"newjid"===e.name)).pop()?.value;return e.sendDestroyIQ(n,i).then((()=>e.close()))}catch(e){o.log.error(e)}}function p(e){const t=e.get("jid");return o.api.settings.get("muc_show_logs_before_join")?i.html`<converse-muc-chatarea jid="${t}"></converse-muc-chatarea>`:i.html`<converse-muc-nickname-form jid="${t}"></converse-muc-nickname-form>`}function g(e){const t=e.model.session.get("view"),s=e.model.get("jid"),r=o.converse.ROOMSTATUS,a=e.model.session.get("connection_status");return t===o.converse.MUC.VIEWS.CONFIG?i.html`<converse-muc-config-form class="muc-form-container" jid="${s}"></converse-muc-config-form>`:i.html`
            ${a==r.PASSWORD_REQUIRED?i.html`<converse-muc-password-form class="muc-form-container" jid="${s}"></converse-muc-password-form>`:""}
            ${a==r.ENTERED?i.html`<converse-muc-chatarea jid="${s}"></converse-muc-chatarea>`:""}
            ${a==r.CONNECTING?(0,n.default)():""}
            ${a==r.NICKNAME_REQUIRED?p(e.model):""}
            ${a==r.DISCONNECTED?i.html`<converse-muc-disconnected jid="${s}"></converse-muc-disconnected>`:""}
            ${a==r.BANNED?i.html`<converse-muc-disconnected jid="${s}"></converse-muc-disconnected>`:""}
            ${a==r.DESTROYED?i.html`<converse-muc-destroyed jid="${s}"></converse-muc-destroyed>`:""}
        `}function _(e,t){t=t.trim();const s=document.createElement("li");if(s.setAttribute("aria-selected","false"),o.api.settings.get("muc_mention_autocomplete_show_avatar")){const t=document.createElement("img");let n="data:"+o._converse.DEFAULT_IMAGE_TYPE+";base64,"+o._converse.DEFAULT_IMAGE;if(o._converse.vcards){const t=o._converse.vcards.findWhere({nickname:e});t&&(n="data:"+t.get("image_type")+";base64,"+t.get("image"))}t.setAttribute("src",n),t.setAttribute("width","22"),t.setAttribute("class","avatar avatar-autocomplete"),s.appendChild(t)}const n=new RegExp("("+t+")","ig");return(t?e.split(n):[e]).forEach((e=>{if(t&&e.match(n)){const t=document.createElement("mark");t.textContent=e,s.appendChild(t)}else s.appendChild(document.createTextNode(e))})),s}async function v(){const e=[...await o.api.rooms.get(),...await o.api.contacts.get()];return[...new Set(e.map((e=>l.getDomainFromJid(e.get("jid")))))]}function y(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];const o=u[t];if(!o)throw Error(`ChatRoomView#setRole called with invalid command: ${t}`);if(!e.verifyAffiliations(n)||!e.verifyRoles(r))return!1;if(!e.validateRoleOrAffiliationChangeArgs(t,s))return!1;const i=e.getNickOrJIDFromCommandArgs(s);if(!i)return!1;const a=s.split(i,2)[1].trim(),l=e.getOccupant(i);return e.setRole(l,o,a,void 0,(t=>e.onCommandError(t))),!0}function b(e,t,s,n){const i=d[t];if(!i)throw Error(`verifyAffiliations called with invalid command: ${t}`);if(!e.verifyAffiliations(n))return!1;if(!e.validateRoleOrAffiliationChangeArgs(t,s))return!1;const l=e.getNickOrJIDFromCommandArgs(s);if(!l)return!1;let u;const h=s.split(l,2)[1].trim(),f=e.getOccupant(l);if(f)u=f.get("jid");else{if(!c.isValidJID(l)){const t=(0,r.__)("Couldn't find a participant with that nickname. They might have left the groupchat.");return void e.createMessage({message:t,type:"error"})}u=l}const m={jid:u,reason:h};f&&o.api.settings.get("auto_register_muc_nickname")&&(m.nick=f.get("nick")),(0,a.setAffiliation)(i,e.get("jid"),[m]).then((()=>e.occupants.fetchMembers())).catch((t=>e.onCommandError(t)))}function j(e,t){if(!e.verifyRoles(["moderator"]))return;let s=o.api.modal.get("converse-modtools-modal");s?(s.affiliation=t,s.render()):s=o.api.modal.create("converse-modtools-modal",{affiliation:t,jid:e.get("jid")}),s.show()}function w(e,t){o.api.modal.show("converse-muc-occupant-modal",{model:t},e)}function S(e,t){const s=e.model;if(t||s.get("type")!==o._converse.CHATROOMS_TYPE||o.api.settings.get("muc_disable_slash_commands")&&!Array.isArray(o.api.settings.get("muc_disable_slash_commands")))return t;let n=e.text;n=n.replace(/^\s*/,"");const i=(n.match(/^\/([a-zA-Z]*) ?/)||[""]).pop().toLowerCase();if(!i)return!1;const a=n.slice(("/"+i).length+1).trim(),l=s.getAllowedCommands()??[];if("admin"===i&&l.includes(i))return b(s,i,a,["owner"]),!0;if("ban"===i&&l.includes(i))return b(s,i,a,["admin","owner"]),!0;if("modtools"===i&&l.includes(i))return j(s,a),!0;if("deop"===i&&l.includes(i))return y(s,i,a,["admin","owner"]),!0;if("destroy"===i&&l.includes(i))return!s.verifyAffiliations(["owner"])||(m(s).catch((e=>s.onCommandError(e))),!0);if("help"===i&&l.includes(i))return s.set({show_help_messages:!1},{silent:!0}),s.set({show_help_messages:!0}),!0;if("kick"===i&&l.includes(i))return y(s,i,a,[],["moderator"]),!0;if("mute"===i&&l.includes(i))return y(s,i,a,[],["moderator"]),!0;if("member"===i&&l.includes(i))return b(s,i,a,["admin","owner"]),!0;if("nick"===i&&l.includes(i)){if(!s.verifyRoles(["visitor","participant","moderator"]))return!0;if(0===a.length){const e=(0,r.__)('Your nickname is "%1$s"',s.get("nick"));s.createMessage({message:e,type:"error"})}else s.setNickname(a);return!0}return"owner"===i&&l.includes(i)?(b(s,i,a,["owner"]),!0):"op"===i&&l.includes(i)?(y(s,i,a,["admin","owner"]),!0):"register"===i&&l.includes(i)?(a.length>1?s.createMessage({message:(0,r.__)("Error: invalid number of arguments"),type:"error"}):s.registerNickname().then((e=>{e&&s.createMessage({message:e,type:"error"})})),!0):"revoke"===i&&l.includes(i)?(b(s,i,a,["admin","owner"]),!0):"topic"===i&&l.includes(i)||"subject"===i&&l.includes(i)?(s.setSubject(a),!0):!("voice"!==i||!l.includes(i))&&(y(s,i,a,[],["moderator"]),!0)}},"./src/plugins/notifications/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/plugins/notifications/utils.js");n.converse.plugins.add("converse-notification",{dependencies:["converse-chatboxes"],initialize(){n.api.settings.extend({chatstate_notification_blacklist:[],notification_delay:5e3,notification_icon:"/images/logo/conversejs-filled.svg",notify_all_room_messages:!1,notify_nicknames_without_references:!1,play_sounds:!0,show_chat_state_notifications:!1,show_desktop_notifications:!0,show_tab_notifications:!0,sounds_path:n.api.settings.get("assets_path")+"/sounds/"}),n.api.listen.on("clearSession",r.clearFavicon),n.api.waitUntil("chatBoxesInitialized").then((()=>n._converse.chatboxes.on("change:num_unread",r.updateUnreadFavicon))),n.api.listen.on("pluginsInitialized",(function(){n.api.listen.on("contactRequest",r.handleContactRequestNotification),n.api.listen.on("contactPresenceChanged",r.handleChatStateNotification),n.api.listen.on("message",r.handleMessageNotification),n.api.listen.on("feedback",r.handleFeedback),n.api.listen.on("connected",r.requestPermission)}))}})},"./src/plugins/notifications/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{areDesktopNotificationsEnabled:()=>h,clearFavicon:()=>f,handleChatStateNotification:()=>j,handleContactRequestNotification:()=>w,handleFeedback:()=>b,handleMessageNotification:()=>y,isMessageToHiddenChat:()=>u,requestPermission:()=>S,shouldNotifyOfGroupMessage:()=>g,showFeedbackNotification:()=>v,updateUnreadFavicon:()=>m});var n=s("./node_modules/favico.js-slevomat/favico.js"),r=s.n(n),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/core.js");const{Strophe:l}=i.converse.env,c="Notification"in window;let d;function u(e){return i._converse.isTestEnv()||(i._converse.chatboxes.get(e.from)?.isHidden()??!1)}function h(){return i._converse.isTestEnv()||c&&i.api.settings.get("show_desktop_notifications")&&"granted"===Notification.permission}function f(){d=null,navigator.clearAppBadge?.().catch((e=>i.log.error("Could not clear unread count in app badge "+e)))}function m(){if(i.api.settings.get("show_tab_notifications")){d=d??new i.converse.env.Favico({type:"circle",animation:"pop"});const e=i._converse.chatboxes.models.reduce(((e,t)=>e+(t.get("num_unread")||0)),0);d.badge(e),navigator.setAppBadge?.(e).catch((e=>i.log.error("Could set unread count in app badge - "+e)))}}function p(e,t,s){return e.reduce(((e,n)=>e||(e=>[i._converse.bare_jid,`${t}/${s}`].includes(e.uri.replace(/^xmpp:/,"")))(n)),!1)}async function g(e){if(!e?.body&&!e?.message)return!1;const t=e.from,s=e.from_muc,n=i.api.settings.get("notify_all_room_messages"),r=i._converse.chatboxes.get(s),o=l.getResourceFromJid(t),a=o&&l.unescapeNode(o)||"";let c=!1;const d=r.get("nick");i.api.settings.get("notify_nicknames_without_references")&&(c=new RegExp(`\\b${d}\\b`).test(e.body));const u=a!==d,h=!0===n||Array.isArray(n)&&n.includes(s)||p(e.references,s,d)||c;if(u&&h){return await i.api.hook("shouldNotifyOfGroupMessage",e,!0)}return!1}function _(e){const{attrs:t}=e;if(!t||t.is_forwarded)return!1;if("groupchat"===t.type)return g(t);if("info"===t.type)return async function(e){if(!e.from_muc)return!1;const t=await i.api.rooms.get(e.from_muc);if(!t)return!1;const s=t.get("nick"),n=e.from_muc,r=i.api.settings.get("notify_all_room_messages");return!0===r||Array.isArray(r)&&r.includes(n)||p(e.references,n,s)}(t);if(t.is_headline)return u(t);const s=l.getBareJidFromJid(t.from)===i._converse.bare_jid;return!(0,a.isEmptyMessage)(t)&&!s&&("all"===i.api.settings.get("show_desktop_notifications")||u(t))}function v(e){if("error"===e.klass||"warn"===e.klass){const t=new Notification(e.subject,{body:e.message,lang:i._converse.locale,icon:i.api.settings.get("notification_icon")});setTimeout(t.close.bind(t),5e3)}}async function y(e){if(!await _(e))return!1;i.api.trigger("messageNotification",e),function(){if(i.api.settings.get("play_sounds")&&void 0!==window.Audio){const e=new Audio(i.api.settings.get("sounds_path")+"msg_received.ogg"),t=e.canPlayType("audio/ogg");if("probably"===t)return e.play();const s=new Audio(i.api.settings.get("sounds_path")+"msg_received.mp3"),n=s.canPlayType("audio/mp3");"probably"===n?s.play():"maybe"===t?e.play():"maybe"===n&&s.play()}}(),function(e){const{attrs:t}=e;if(t.is_error)return;if(!h())return;let s,n;const r=t.from,a=l.getBareJidFromJid(r);if("info"==t.type)s=t.message;else if("headline"===t.type){if(a.includes("@")&&!i.api.settings.get("allow_non_roster_messaging"))return;s=(0,o.__)("Notification from %1$s",a)}else if(a.includes("@"))if("groupchat"===t.type)s=(0,o.__)("%1$s says",l.getResourceFromJid(r));else{if(void 0===i._converse.roster)return void i.log.error("Could not send notification, because roster is undefined");if(n=i._converse.roster.get(a),void 0!==n)s=(0,o.__)("%1$s says",n.getDisplayName());else{if(!i.api.settings.get("allow_non_roster_messaging"))return;s=(0,o.__)("%1$s says",a)}}else s=(0,o.__)("Notification from %1$s",a);let c;if("info"==t.type)c=t.reason;else if(c=t.is_encrypted?t.plaintext:t.body,!c)return;const d=new Notification(s,{body:c,lang:i._converse.locale,icon:i.api.settings.get("notification_icon"),requireInteraction:!i.api.settings.get("notification_delay")});i.api.settings.get("notification_delay")&&setTimeout((()=>d.close()),i.api.settings.get("notification_delay")),d.onclick=function(e){e.preventDefault(),window.focus(),i._converse.chatboxes.get(a).maybeShow(!0)}}(e)}function b(e){h()&&v(e)}function j(e){h()&&i.api.settings.get("show_chat_state_notifications")&&function(e){if(i.api.settings.get("chatstate_notification_blacklist")?.includes(e.jid))return;const t=e.presence.get("show");let s=null;if("offline"===t?s=(0,o.__)("has gone offline"):"away"===t?s=(0,o.__)("has gone away"):"dnd"===t?s=(0,o.__)("is busy"):"online"===t&&(s=(0,o.__)("has come online")),null===s)return;const n=new Notification(e.getDisplayName(),{body:s,lang:i._converse.locale,icon:i.api.settings.get("notification_icon")});setTimeout((()=>n.close()),5e3)}(e)}function w(e){h()&&function(e){const t=new Notification(e.getDisplayName(),{body:(0,o.__)("wants to be your contact"),lang:i._converse.locale,icon:i.api.settings.get("notification_icon")});setTimeout((()=>t.close()),5e3)}(e)}function S(){c&&!["denied","granted"].includes(Notification.permission)&&Notification.requestPermission()}i.converse.env.Favico=r()},"./src/plugins/omemo/api.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/plugins/omemo/utils.js");const o={omemo:{getDeviceID:async()=>(await n.api.waitUntil("OMEMOInitialized"),n._converse.omemo_store.get("device_id")),devicelists:{async get(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=n._converse.devicelists.get(e)||(t?n._converse.devicelists.create({jid:e}):null);return await(s?.initialized),s}},bundle:{generate:async()=>{await n.api.waitUntil("OMEMOInitialized");const e=await n.api.omemo.devicelists.get(n._converse.bare_jid),t=n._converse.omemo_store.get("device_id");if(t){const s=e.devices.get(t);n._converse.omemo_store.unset(t),s&&await new Promise((e=>s.destroy({success:e,error:e}))),e.devices.trigger("remove")}await n._converse.omemo_store.generateBundle(),await e.publishDevices();const s=e.devices.get(n._converse.omemo_store.get("device_id")),o=(0,r.generateFingerprint)(s);return await n._converse.omemo_store.publishBundle(),o}}}}},"./src/plugins/omemo/consts.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{KEY_ALGO:()=>a,TAG_LENGTH:()=>i,TRUSTED:()=>r,UNDECIDED:()=>n,UNTRUSTED:()=>o});const n=0,r=1,o=-1,i=128,a={name:"AES-GCM",length:128}},"./src/plugins/omemo/device.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./src/plugins/omemo/errors.js"),r=s("./node_modules/@converse/skeletor/src/model.js"),o=s("./src/plugins/omemo/consts.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/core.js"),l=s("./src/plugins/omemo/utils.js");const{Strophe:c,sizzle:d,$iq:u}=i.converse.env;class h extends r.Model{defaults(){return{trusted:o.UNDECIDED,active:!0}}getRandomPreKey(){const e=this.get("bundle");return e.prekeys[(0,a.getRandomInt)(e.prekeys.length)]}async fetchBundleFromServer(){const e=u({type:"get",from:i._converse.bare_jid,to:this.get("jid")}).c("pubsub",{xmlns:c.NS.PUBSUB}).c("items",{node:`${c.NS.OMEMO_BUNDLES}:${this.get("id")}`});let t;try{t=await i.api.sendIQ(e)}catch(t){return i.log.error(`Could not fetch bundle for device ${this.get("id")} from ${this.get("jid")}`),i.log.error(t),null}if(t.querySelector("error"))throw new n.IQError("Could not fetch bundle",t);const s=d(`items[node="${c.NS.OMEMO_BUNDLES}:${this.get("id")}"]`,t).pop(),r=d(`bundle[xmlns="${c.NS.OMEMO}"]`,s).pop(),o=(0,l.parseBundle)(r);return this.save("bundle",o),o}getBundle(){return this.get("bundle")?Promise.resolve(this.get("bundle"),this):this.fetchBundleFromServer()}}const f=h},"./src/plugins/omemo/devicelist.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./node_modules/@converse/skeletor/src/model.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/@converse/openpromise/openpromise.js"),i=s("./src/headless/utils/storage.js"),a=s("./src/plugins/omemo/utils.js");const{Strophe:l,$build:c,$iq:d,sizzle:u}=r.converse.env;class h extends n.Model{get idAttribute(){return"jid"}async initialize(){super.initialize(),this.initialized=(0,o.getOpenPromise)(),await this.initDevices(),this.initialized.resolve()}initDevices(){this.devices=new r._converse.Devices;const e=`converse.devicelist-${r._converse.bare_jid}-${this.get("jid")}`;return(0,i.initStorage)(this.devices,e),this.fetchDevices()}async onDevicesFound(e){if(0===e.length){let e=[];try{e=await this.fetchDevicesFromServer()}catch(e){null===e?r.log.error(`Timeout error while fetching devices for ${this.get("jid")}`):(r.log.error(`Could not fetch devices for ${this.get("jid")}`),r.log.error(e)),this.destroy()}this.get("jid")===r._converse.bare_jid&&this.publishCurrentDevice(e)}}fetchDevices(){return void 0===this._devices_promise&&(this._devices_promise=new Promise((e=>{this.devices.fetch({success:t=>e(this.onDevicesFound(t)),error:(t,s)=>{r.log.error(s),e()}})}))),this._devices_promise}async getOwnDeviceId(){let e=r._converse.omemo_store.get("device_id");return this.devices.get(e)||(await r._converse.omemo_store.generateBundle(),e=r._converse.omemo_store.get("device_id")),e}async publishCurrentDevice(e){if(this.get("jid")===r._converse.bare_jid){if(await(0,a.restoreOMEMOSession)(),r._converse.omemo_store)return e.includes(await this.getOwnDeviceId())?void 0:this.publishDevices();r.log.warn("publishCurrentDevice: omemo_store is not defined, likely a timing issue")}}async fetchDevicesFromServer(){const e=d({type:"get",from:r._converse.bare_jid,to:this.get("jid")}).c("pubsub",{xmlns:l.NS.PUBSUB}).c("items",{node:l.NS.OMEMO_DEVICELIST}),t=await r.api.sendIQ(e),s=`list[xmlns="${l.NS.OMEMO}"] device`,n=u(s,t).map((e=>e.getAttribute("id"))),o=this.get("jid");return Promise.all(n.map((e=>this.devices.create({id:e,jid:o},{promise:!0}))))}publishDevices(){const e=c("item",{id:"current"}).c("list",{xmlns:l.NS.OMEMO});this.devices.filter((e=>e.get("active"))).forEach((t=>e.c("device",{id:t.get("id")}).up()));return r.api.pubsub.publish(null,l.NS.OMEMO_DEVICELIST,e,{"pubsub#access_model":"open"},!1)}async removeOwnDevices(e){if(this.get("jid")!==r._converse.bare_jid)throw new Error("Cannot remove devices from someone else's device list");return await Promise.all(e.map((e=>this.devices.get(e))).map((e=>new Promise((t=>e.destroy({success:t,error:(e,s)=>{r.log.error(s),t()}})))))),this.publishDevices()}}const f=h},"./src/plugins/omemo/devicelists.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./src/plugins/omemo/devicelist.js");const r=s("./node_modules/@converse/skeletor/src/collection.js").Collection.extend({model:n.default})},"./src/plugins/omemo/devices.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./src/plugins/omemo/device.js");const r=s("./node_modules/@converse/skeletor/src/collection.js").Collection.extend({model:n.default})},"./src/plugins/omemo/errors.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{IQError:()=>n});class n extends Error{constructor(e,t){super(e,t),this.name="IQError",this.iq=t}}},"./src/plugins/omemo/fingerprints.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Fingerprints:()=>i});var n=s("./src/plugins/omemo/templates/fingerprints.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{jid:{type:String}}}async initialize(){this.devicelist=await o.api.omemo.devicelists.get(this.jid,!0),this.listenTo(this.devicelist.devices,"change:bundle",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"change:trusted",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"remove",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"add",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"reset",(()=>this.requestUpdate())),this.requestUpdate()}render(){return this.devicelist?(0,n.default)(this):""}toggleDeviceTrust(e){const t=e.target;this.devicelist.devices.get(t.getAttribute("name")).save("trusted",parseInt(t.value,10))}}o.api.elements.define("converse-omemo-fingerprints",i)},"./src/plugins/omemo/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/omemo/fingerprints.js"),s("./src/plugins/omemo/profile.js"),s("./src/shared/modals/user-details.js");var n=s("./src/plugins/omemo/mixins/converse.js"),r=s("./src/plugins/omemo/device.js"),o=s("./src/plugins/omemo/devicelist.js"),i=s("./src/plugins/omemo/devicelists.js"),a=s("./src/plugins/omemo/devices.js"),l=s("./src/plugins/omemo/store.js"),c=s("./src/plugins/omemo/api.js"),d=s("./src/headless/dist/converse-headless.js"),u=s("./src/headless/utils/core.js"),h=s("./src/plugins/omemo/utils.js");const{Strophe:f}=d.converse.env;d.converse.env.omemo=h.omemo,f.addNamespace("OMEMO_DEVICELIST",f.NS.OMEMO+".devicelist"),f.addNamespace("OMEMO_VERIFICATION",f.NS.OMEMO+".verification"),f.addNamespace("OMEMO_WHITELISTED",f.NS.OMEMO+".whitelisted"),f.addNamespace("OMEMO_BUNDLES",f.NS.OMEMO+".bundles"),d.converse.plugins.add("converse-omemo",{enabled:e=>window.libsignal&&e.config.get("trusted")&&!d.api.settings.get("clear_cache_on_logout")&&!e.api.settings.get("blacklisted_plugins").includes("converse-omemo"),dependencies:["converse-chatview","converse-pubsub","converse-profile"],initialize(){d.api.settings.extend({omemo_default:!1}),d.api.promises.add(["OMEMOInitialized"]),d._converse.NUM_PREKEYS=100,Object.assign(d._converse,n.default),Object.assign(d._converse.api,c.default),d._converse.OMEMOStore=l.default,d._converse.Device=r.default,d._converse.Devices=a.default,d._converse.DeviceList=o.default,d._converse.DeviceLists=i.default,d.api.waitUntil("chatBoxesInitialized").then(h.onChatBoxesInitialized),d.api.listen.on("getOutgoingMessageAttributes",h.getOutgoingMessageAttributes),d.api.listen.on("createMessageStanza",(async(e,t)=>{try{t=await(0,h.createOMEMOMessageStanza)(e,t)}catch(t){(0,h.handleMessageSendError)(t,e)}return t})),d.api.listen.on("afterFileUploaded",((e,t)=>e.file.xep454_ivkey?(0,h.setEncryptedFileURL)(e,t):t)),d.api.listen.on("beforeFileUpload",((e,t)=>e.get("omemo_active")?(0,h.encryptFile)(t):t)),d.api.listen.on("parseMessage",h.parseEncryptedMessage),d.api.listen.on("parseMUCMessage",h.parseEncryptedMessage),d.api.listen.on("chatBoxViewInitialized",h.onChatInitialized),d.api.listen.on("chatRoomViewInitialized",h.onChatInitialized),d.api.listen.on("connected",h.registerPEPPushHandler),d.api.listen.on("getToolbarButtons",h.getOMEMOToolbarButton),d.api.listen.on("statusInitialized",h.initOMEMO),d.api.listen.on("addClientFeatures",(()=>d.api.disco.own.features.add(`${f.NS.OMEMO_DEVICELIST}+notify`))),d.api.listen.on("afterMessageBodyTransformed",h.handleEncryptedFiles),d.api.listen.on("userDetailsModalInitialized",(e=>{const t=e.get("jid");d._converse.generateFingerprints(t).catch((e=>d.log.error(e)))})),d.api.listen.on("profileModalInitialized",(()=>{d._converse.generateFingerprints(d._converse.bare_jid).catch((e=>d.log.error(e)))})),d.api.listen.on("clearSession",(()=>{delete d._converse.omemo_store,(0,u.shouldClearCache)()&&d._converse.devicelists&&(d._converse.devicelists.clearStore(),delete d._converse.devicelists)}))}})},"./src/plugins/omemo/mixins/converse.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./src/plugins/omemo/utils.js");const r={async generateFingerprints(e){const t=await(0,n.getDevicesForContact)(e);return Promise.all(t.map((e=>(0,n.generateFingerprint)(e))))},getDeviceForContact:(e,t)=>(0,n.getDevicesForContact)(e).then((e=>e.get(t))),contactHasOMEMOSupport:async e=>(await(0,n.getDevicesForContact)(e)).length>0}},"./src/plugins/omemo/profile.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Profile:()=>u});var n=s("./src/plugins/omemo/templates/profile.js"),r=s("./src/templates/spinner.js"),o=s("./src/shared/components/element.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js");const{Strophe:l,sizzle:c,u:d}=a.converse.env;class u extends o.CustomElement{async initialize(){this.devicelist=await a.api.omemo.devicelists.get(a._converse.bare_jid,!0),await this.setAttributes(),this.listenTo(this.devicelist.devices,"change:bundle",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"reset",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"reset",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"remove",(()=>this.requestUpdate())),this.listenTo(this.devicelist.devices,"add",(()=>this.requestUpdate())),this.requestUpdate()}async setAttributes(){this.device_id=await a.api.omemo.getDeviceID(),this.current_device=this.devicelist.devices.get(this.device_id),this.other_devices=this.devicelist.devices.filter((e=>e.get("id")!==this.device_id))}render(){return this.devicelist?(0,n.default)(this):(0,r.default)()}selectAll(e){let t=d.ancestor(e.target,"li");for(;t;)t.querySelector('input[type="checkbox"]').checked=e.target.checked,t=t.nextElementSibling}async removeSelectedFingerprints(e){e.preventDefault(),e.stopPropagation(),e.target.querySelector(".select-all").checked=!1;const t=c('.fingerprint-removal-item input[type="checkbox"]:checked',e.target).map((e=>e.value));try{await this.devicelist.removeOwnDevices(t)}catch(e){a.log.error(e),a._converse.api.alert(l.LogLevel.ERROR,(0,i.__)("Error"),[(0,i.__)("Sorry, an error occurred while trying to remove the devices.")])}await this.setAttributes(),this.requestUpdate()}async generateOMEMODeviceBundle(e){e.preventDefault();await a.api.confirm((0,i.__)("Are you sure you want to generate new OMEMO keys? This will remove your old keys and all previously encrypted messages will no longer be decryptable on this device."))&&(await a.api.omemo.bundle.generate(),await this.setAttributes(),this.requestUpdate())}}a.api.elements.define("converse-omemo-profile",u)},"./src/plugins/omemo/store.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/range.js"),r=s("./node_modules/@converse/skeletor/src/model.js"),o=s("./src/plugins/omemo/utils.js"),i=s("./src/headless/dist/converse-headless.js");const{Strophe:a,$build:l,u:c}=i.converse.env;class d extends r.Model{get Direction(){return{SENDING:1,RECEIVING:2}}getIdentityKeyPair(){const e=this.get("identity_keypair");return Promise.resolve({privKey:c.base64ToArrayBuffer(e.privKey),pubKey:c.base64ToArrayBuffer(e.pubKey)})}getLocalRegistrationId(){return Promise.resolve(parseInt(this.get("device_id"),10))}isTrustedIdentity(e,t,s){if(null==e)throw new Error("Can't check identity key for invalid key");if(!(t instanceof ArrayBuffer))throw new Error("Expected identity_key to be an ArrayBuffer");const n=this.get("identity_key"+e);return void 0===n?Promise.resolve(!0):Promise.resolve(c.arrayBufferToBase64(t)===n)}loadIdentityKey(e){if(null==e)throw new Error("Can't load identity_key for invalid identifier");return Promise.resolve(c.base64ToArrayBuffer(this.get("identity_key"+e)))}saveIdentity(e,t){if(null==e)throw new Error("Can't save identity_key for invalid identifier");const s=new libsignal.SignalProtocolAddress.fromString(e),n=this.get("identity_key"+s.getName()),r=c.arrayBufferToBase64(t);return this.save("identity_key"+s.getName(),r),n&&r!==n?Promise.resolve(!0):Promise.resolve(!1)}getPreKeys(){return this.get("prekeys")||{}}loadPreKey(e){const t=this.getPreKeys()[e];return t?Promise.resolve({privKey:c.base64ToArrayBuffer(t.privKey),pubKey:c.base64ToArrayBuffer(t.pubKey)}):Promise.resolve()}storePreKey(e,t){const s={};return s[e]={pubKey:c.arrayBufferToBase64(t.pubKey),privKey:c.arrayBufferToBase64(t.privKey)},this.save("prekeys",Object.assign(this.getPreKeys(),s)),Promise.resolve()}removePreKey(e){const t={...this.getPreKeys()};return delete t[e],this.save("prekeys",t),Promise.resolve()}loadSignedPreKey(e){const t=this.get("signed_prekey");return t?Promise.resolve({privKey:c.base64ToArrayBuffer(t.privKey),pubKey:c.base64ToArrayBuffer(t.pubKey)}):Promise.resolve()}storeSignedPreKey(e){if("object"!=typeof e)throw new Error("storeSignedPreKey: expected an object");return this.save("signed_prekey",{id:e.keyId,privKey:c.arrayBufferToBase64(e.keyPair.privKey),pubKey:c.arrayBufferToBase64(e.keyPair.pubKey),signature:c.arrayBufferToBase64(e.signature)}),Promise.resolve()}removeSignedPreKey(e){return this.get("signed_prekey").id===e&&(this.unset("signed_prekey"),this.save()),Promise.resolve()}loadSession(e){return Promise.resolve(this.get("session"+e))}storeSession(e,t){return Promise.resolve(this.save("session"+e,t))}removeSession(e){return Promise.resolve(this.unset("session"+e))}removeAllSessions(e){const t=Object.keys(this.attributes).filter((t=>!!t.startsWith("session"+e)&&t)),s={};return t.forEach((e=>{s[e]=void 0})),this.save(s),Promise.resolve()}publishBundle(){const e=this.get("signed_prekey"),t=`${a.NS.OMEMO_BUNDLES}:${this.get("device_id")}`,s=l("item").c("bundle",{xmlns:a.NS.OMEMO}).c("signedPreKeyPublic",{signedPreKeyId:e.id}).t(e.pubKey).up().c("signedPreKeySignature").t(e.signature).up().c("identityKey").t(this.get("identity_keypair").pubKey).up().c("prekeys");Object.values(this.get("prekeys")).forEach(((e,t)=>s.c("preKeyPublic",{preKeyId:t}).t(e.pubKey).up()));return i.api.pubsub.publish(null,t,s,{"pubsub#access_model":"open"},!1)}async generateMissingPreKeys(){const e=Object.keys(this.getPreKeys()),t=(0,n.default)(0,i._converse.NUM_PREKEYS).map((e=>e.toString())).filter((t=>!e.includes(t)));if(t.length<1)return i.log.warn("No missing prekeys to generate for our own device"),Promise.resolve();(await Promise.all(t.map((e=>libsignal.KeyHelper.generatePreKey(parseInt(e,10)))))).forEach((e=>this.storePreKey(e.keyId,e.keyPair)));const s=Object.keys(this.getPreKeys()).map((e=>({id:e.keyId,key:c.arrayBufferToBase64(e.pubKey)}))),r=(await i.api.omemo.devicelists.get(i._converse.bare_jid)).devices.get(this.get("device_id")),o=await r.getBundle();r.save("bundle",Object.assign(o,{prekeys:s}))}async generatePreKeys(){const e=i._converse.NUM_PREKEYS,{KeyHelper:t}=libsignal,s=await Promise.all((0,n.default)(0,e).map((e=>t.generatePreKey(e))));return s.forEach((e=>this.storePreKey(e.keyId,e.keyPair))),s.map((e=>({id:e.keyId,key:c.arrayBufferToBase64(e.keyPair.pubKey)})))}async generateBundle(){const e=await libsignal.KeyHelper.generateIdentityKeyPair(),t=c.arrayBufferToBase64(e.pubKey),s=await(0,o.generateDeviceID)();this.save({device_id:s,identity_keypair:{privKey:c.arrayBufferToBase64(e.privKey),pubKey:t},identity_key:t});const n=await libsignal.KeyHelper.generateSignedPreKey(e,0);this.storeSignedPreKey(n);const r={identity_key:t,device_id:s,prekeys:await this.generatePreKeys()};r.signed_prekey={id:n.keyId,public_key:c.arrayBufferToBase64(n.keyPair.pubKey),signature:c.arrayBufferToBase64(n.signature)};const a=await i.api.omemo.devicelists.get(i._converse.bare_jid);(await a.devices.create({id:r.device_id,jid:i._converse.bare_jid},{promise:!0})).save("bundle",r)}fetchSession(){return void 0===this._setup_promise&&(this._setup_promise=new Promise(((e,t)=>{this.fetch({success:()=>{this.get("device_id")?e():this.generateBundle().then(e).catch(t)},error:(s,n)=>{i.log.warn("Could not fetch OMEMO session from cache, we'll generate a new one."),i.log.warn(n),this.generateBundle().then(e).catch(t)}})}))),this._setup_promise}}const u=d},"./src/plugins/omemo/templates/fingerprints.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./src/plugins/omemo/utils.js");const i=e=>{const t=(0,n.__)("OMEMO Fingerprints"),s=(0,n.__)("No OMEMO-enabled devices found"),i=e.devicelist.devices;return r.html`
        <hr/>
        <ul class="list-group fingerprints">
            <li class="list-group-item active">${t}</li>
            ${i.length?i.map((t=>((e,t)=>{const s=(0,n.__)("Trusted"),i=(0,n.__)("Untrusted");return t.get("bundle")&&t.get("bundle").fingerprint?r.html`
            <li class="list-group-item">
                <form class="fingerprint-trust">
                    <div class="btn-group btn-group-toggle">
                        <label class="btn btn--small ${1===t.get("trusted")?"btn-primary active":"btn-secondary"}"
                                @click=${e.toggleDeviceTrust}>
                            <input type="radio" name="${t.get("id")}" value="1"
                                ?checked=${-1!==t.get("trusted")}>${s}
                        </label>
                        <label class="btn btn--small ${-1===t.get("trusted")?"btn-primary active":"btn-secondary"}"
                                @click=${e.toggleDeviceTrust}>
                            <input type="radio" name="${t.get("id")}" value="-1"
                                ?checked=${-1===t.get("trusted")}>${i}
                        </label>
                    </div>
                    <code class="fingerprint">${(0,o.formatFingerprint)(t.get("bundle").fingerprint)}</code>
                </form>
            </li>
        `:""})(e,t))):r.html`<li class="list-group-item"> ${s} </li>`}
        </ul>
    `}},"./src/plugins/omemo/templates/profile.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/templates/spinner.js"),r=s("./src/plugins/omemo/utils.js"),o=s("./node_modules/lit/index.js"),i=s("./src/i18n/index.js");const a=e=>o.html`
    ${e.device.get("bundle")&&e.device.get("bundle").fingerprint?(e=>{const t=(0,i.__)("Checkbox for selecting the following fingerprint");return o.html`
        <li class="fingerprint-removal-item list-group-item">
            <label>
            <input type="checkbox" value="${e.device.get("id")}"
                aria-label="${t}"/>
            <span class="fingerprint">${(0,r.formatFingerprint)(e.device.get("bundle").fingerprint)}</span>
            </label>
        </li>
    `})(e):(e=>{const t=(0,i.__)("Device without a fingerprint"),s=(0,i.__)("Checkbox for selecting the following device");return o.html`
        <li class="fingerprint-removal-item list-group-item">
            <label>
            <input type="checkbox" value="${e.device.get("id")}"
                aria-label="${s}"/>
            <span>${t}</span>
            </label>
        </li>
    `})(e)}
`,l=e=>{const t=(0,i.__)("This device's OMEMO fingerprint"),s=(0,i.__)("Generate new keys and fingerprint");return o.html`
        <form class="converse-form fingerprint-removal" @submit=${e.removeSelectedFingerprints}>
            <ul class="list-group fingerprints">
                <li class="list-group-item active">${t}</li>
                <li class="list-group-item">
                    ${e.current_device&&e.current_device.get("bundle")&&e.current_device.get("bundle").fingerprint?(e=>o.html`
    <span class="fingerprint">${(0,r.formatFingerprint)(e.current_device.get("bundle").fingerprint)}</span>`)(e):(0,n.default)()}
                </li>
            </ul>
            <div class="form-group">
                <button type="button" class="generate-bundle btn btn-danger" @click=${e.generateOMEMODeviceBundle}>${s}</button>
            </div>
            ${e.other_devices?.length?(e=>{const t=(0,i.__)("Other OMEMO-enabled devices"),s=(0,i.__)("Checkbox to select fingerprints of all other OMEMO devices"),n=(0,i.__)("Remove checked devices and close"),r=(0,i.__)("Select all");return o.html`
        <ul class="list-group fingerprints">
            <li class="list-group-item active">
                <label>
                    <input type="checkbox" class="select-all" @change=${e.selectAll} title="${r}" aria-label="${s}"/>
                    ${t}
                </label>
            </li>
            ${e.other_devices?.map((t=>a(Object.assign({device:t},e))))}
        </ul>
        <div class="form-group"><button type="submit" class="save-form btn btn-primary">${n}</button></div>
    `})(e):""}
        </form>`}},"./src/plugins/omemo/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addKeysToMessageStanza:()=>D,createOMEMOMessageStanza:()=>J,encryptFile:()=>x,formatFingerprint:()=>j,generateDeviceID:()=>F,generateFingerprint:()=>L,getDevicesForContact:()=>z,getOMEMOToolbarButton:()=>V,getOutgoingMessageAttributes:()=>S,getSession:()=>U,getSessionCipher:()=>O,handleEncryptedFiles:()=>T,handleMessageSendError:()=>w,initOMEMO:()=>H,omemo:()=>Q,onChatBoxesInitialized:()=>k,onChatInitialized:()=>N,parseBundle:()=>P,parseEncryptedMessage:()=>I,registerPEPPushHandler:()=>B,restoreOMEMOSession:()=>q,setEncryptedFileURL:()=>E});var n=s("./src/templates/audio.js"),r=s("./src/templates/file.js"),o=s("./src/templates/image.js"),i=s("./src/templates/video.js"),a=s("./src/plugins/omemo/consts.js"),l=s("./src/utils/file.js"),c=s("./src/i18n/index.js"),d=s("./src/headless/dist/converse-headless.js"),u=s("./node_modules/lit/index.js"),h=s("./src/headless/utils/storage.js"),f=s("./src/headless/utils/core.js"),m=s("./src/headless/utils/url.js"),p=s("./node_modules/lit/directives/until.js"),g=s("./src/headless/utils/arraybuffer.js");const{Strophe:_,URI:v,sizzle:y,u:b}=d.converse.env;function j(e){e=e.replace(/^05/,"");for(let t=1;t<8;t++){const s=8*t+t-1;e=e.slice(0,s)+" "+e.slice(s)}return e}function w(e,t){if("IQError"===e.name){t.save("omemo_supported",!1);const s=[];y(`presence-subscription-required[xmlns="${_.NS.PUBSUB_ERROR}"]`,e.iq).length?s.push((0,c.__)("Sorry, we're unable to send an encrypted message because %1$s requires you to be subscribed to their presence in order to see their OMEMO information",e.iq.getAttribute("from"))):y('remote-server-not-found[xmlns="urn:ietf:params:xml:ns:xmpp-stanzas"]',e.iq).length?s.push((0,c.__)("Sorry, we're unable to send an encrypted message because the remote server for %1$s could not be found",e.iq.getAttribute("from"))):(s.push((0,c.__)("Unable to send an encrypted message due to an unexpected error.")),s.push(e.iq.outerHTML)),d.api.alert("error",(0,c.__)("Error"),s)}else e.user_facing&&d.api.alert("error",(0,c.__)("Error"),[e.message]);throw e}function S(e,t){return e.get("omemo_active")&&t.body&&(t.is_encrypted=!0,t.plaintext=t.body,t.body=(0,c.__)("This is an OMEMO encrypted message which your client doesnt seem to support. Find more information on https://conversations.im/omemo")),t}async function x(e){const t=crypto.getRandomValues(new Uint8Array(12)),s=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),n=await crypto.subtle.encrypt({name:"AES-GCM",iv:t},s,await e.arrayBuffer()),r=await window.crypto.subtle.exportKey("raw",s),o=new File([n],e.name,{type:e.type,lastModified:e.lastModified});return o.xep454_ivkey=(0,g.arrayBufferToHex)(t)+(0,g.arrayBufferToHex)(r),o}function E(e,t){const s=t.oob_url.replace(/^https?:/,"aesgcm:")+"#"+e.file.xep454_ivkey;return Object.assign(t,{oob_url:null,message:s,body:s})}async function A(e){const t="localhost"===window.location.hostname&&"localhost"===e.domain()?"http":"https",s=e.toString().replace(/^aesgcm/,t),n=await async function(e){let t;try{t=await fetch(e)}catch(t){return d.log.error(`${t.name}: Failed to download encrypted media: ${e}`),d.log.error(t),null}if(t.status>=200&&t.status<400)return t.arrayBuffer()}(s);if(null===n)return d.log.error(`Could not decrypt a received encrypted file ${e.toString()} since it could not be downloaded`),new Error((0,c.__)("Error: could not decrypt a received encrypted file, because it could not be downloaded"));const r=e.hash().slice(1),o=r.substring(r.length-64),i=r.replace(o,"");let a;try{a=await async function(e,t,s){const n=await crypto.subtle.importKey("raw",(0,g.hexToArrayBuffer)(t),"AES-GCM",!1,["decrypt"]),r={name:"AES-GCM",iv:(0,g.hexToArrayBuffer)(e)};return crypto.subtle.decrypt(r,n,s)}(i,o,n)}catch(t){return d.log.error(`Could not decrypt file ${e.toString()}`),d.log.error(t),null}const[u,h]=e.filename().split("."),f=l.MIMETYPES_MAP[h];try{const e=new File([a],u,{type:f});return URL.createObjectURL(e)}catch(t){return d.log.error(`Could not decrypt file ${e.toString()}`),d.log.error(t),null}}function C(e,t,s){const a=[];try{const t={start:/\b(aesgcm:\/\/)/gi};v.withinString(e,((e,t,s)=>(a.push({url:e,start:t,end:s}),e)),t)}catch(e){return void d.log.debug(e)}a.forEach((a=>{const l=(0,m.getURI)(e.slice(a.start,a.end)),c=A(l).then((e=>function(e,t,s){if((0,f.isError)(t))return u.html`<p class="error">${t.message}</p>`;const a=e.toString();return(0,m.isImageURL)(a)?(0,o.default)({src:t,onClick:s.onImgClick,onLoad:s.onImgLoad}):(0,m.isAudioURL)(a)?(0,n.default)(t):(0,m.isVideoURL)(a)?(0,i.default)(t):(0,r.default)(t,e.filename())}(l,e,s))),d=u.html`${(0,p.until)(c,"")}`;s.addTemplateResult(a.start+t,a.end+t,d)}))}function T(e){d._converse.config.get("trusted")&&e.addAnnotations(((t,s)=>C(t,s,e)))}async function I(e,t){if(d.api.settings.get("clear_cache_on_logout")||!t.is_encrypted||t.encryption_namespace!==_.NS.OMEMO)return t;const s=y(`encrypted[xmlns="${_.NS.OMEMO}"]`,e).pop(),n=s.querySelector("header");t.encrypted={device_id:n.getAttribute("sid")};const r=await(d.api.omemo?.getDeviceID()),o=r&&y(`key[rid="${r}"]`,s).pop();return o?(Object.assign(t.encrypted,{iv:n.querySelector("iv").textContent,key:o.textContent,payload:s.querySelector("payload")?.textContent||null,prekey:["true","1"].includes(o.getAttribute("prekey"))}),!0===t.encrypted.prekey?async function(e){const t=M(e),s=O(t,parseInt(e.encrypted.device_id,10)),n=(0,g.base64ToArrayBuffer)(e.encrypted.key);let r;try{r=await s.decryptPreKeyWhisperMessage(n,"binary")}catch(t){return d.log.error(`${t.name} ${t.message}`),Object.assign(e,R(t))}try{const t=await $(e,r);return await d._converse.omemo_store.generateMissingPreKeys(),await d._converse.omemo_store.publishBundle(),t?Object.assign(e,{plaintext:t}):Object.assign(e,{is_only_key:!0})}catch(t){return d.log.error(`${t.name} ${t.message}`),Object.assign(e,R(t))}}(t):async function(e){const t=M(e),s=O(t,parseInt(e.encrypted.device_id,10)),n=(0,g.base64ToArrayBuffer)(e.encrypted.key);try{const t=await s.decryptWhisperMessage(n,"binary"),r=await $(e,t);return Object.assign(e,{plaintext:r})}catch(t){return d.log.error(`${t.name} ${t.message}`),Object.assign(e,R(t))}}(t)):Object.assign(t,{error_condition:"not-encrypted-for-this-device",error_type:"Decryption",is_ephemeral:!0,is_error:!0,type:"error"})}function k(){d._converse.chatboxes.on("add",(e=>{G(e),e.get("type")===d._converse.CHATROOMS_TYPE&&(e.occupants.on("add",(t=>async function(e,t){if(t.isSelf()||!e.features.get("nonanonymous")||!e.features.get("membersonly"))return;if(e.get("omemo_active")){await d._converse.contactHasOMEMOSupport(t.get("jid"))||(e.createMessage({message:(0,c.__)("%1$s doesn't appear to have a client that supports OMEMO. Encrypted chat will no longer be possible in this grouchat.",t.get("nick")),type:"error"}),e.save({omemo_active:!1,omemo_supported:!1}))}}(e,t))),e.features.on("change",(()=>G(e))))}))}function N(e){e.listenTo(e.model.messages,"add",(t=>{t.get("is_encrypted")&&!t.get("is_error")&&e.model.save("omemo_supported",!0)})),e.listenTo(e.model,"change:omemo_supported",(()=>{!e.model.get("omemo_supported")&&e.model.get("omemo_active")?e.model.set("omemo_active",!1):e.querySelector("converse-chat-toolbar")?.requestUpdate()})),e.listenTo(e.model,"change:omemo_active",(()=>{e.querySelector("converse-chat-toolbar").requestUpdate()}))}function O(e,t){const s=new libsignal.SignalProtocolAddress(e,t);return new window.libsignal.SessionCipher(d._converse.omemo_store,s)}function M(e){const t=e.from_muc?e.from_real_jid:e.from;if(!t)throw Object.assign(e,{error_text:(0,c.__)("Sorry, could not decrypt a received OMEMO message because we don't have the XMPP address for that user."),error_type:"Decryption",is_ephemeral:!0,is_error:!0,type:"error"}),new Error("Could not find JID to decrypt OMEMO message for");return t}async function $(e,t){const s=M(e),n=await d.api.omemo.devicelists.get(s,!0),r=e.encrypted;let o=n.devices.get(r.device_id);if(o||(o=await n.devices.create({id:r.device_id,jid:s},{promise:!0})),r.payload){const e=t.slice(0,16),s=t.slice(16),n=await Q.decryptMessage(Object.assign(r,{key:e,tag:s}));return o.save("active",!0),n}}function R(e){return{error_text:(0,c.__)("Sorry, could not decrypt a received OMEMO message due to an error.")+` ${e.name} ${e.message}`,error_condition:e.name,error_message:e.message,error_type:"Decryption",is_ephemeral:!0,is_error:!0,type:"error"}}function D(e,t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n].payload,o=t[n].device,i=3==parseInt(r.type,10);e.c("key",{rid:o.get("id")}).t(btoa(r.body)),i&&e.attrs({prekey:i}),e.up(),n==t.length-1&&e.c("iv").t(s).up().up()}return Promise.resolve(e)}function P(e){const t=e.querySelector("signedPreKeyPublic"),s=e.querySelector("signedPreKeySignature"),n=y("prekeys > preKeyPublic",e).map((e=>({id:parseInt(e.getAttribute("preKeyId"),10),key:e.textContent})));return{identity_key:e.querySelector("identityKey").textContent.trim(),signed_prekey:{id:parseInt(t.getAttribute("signedPreKeyId"),10),public_key:t.textContent,signature:s.textContent},prekeys:n}}async function L(e){if(e.get("bundle")?.fingerprint)return;const t=await e.getBundle();t.fingerprint=(0,g.arrayBufferToHex)((0,g.base64ToArrayBuffer)(t.identity_key)),e.save("bundle",t),e.trigger("change:bundle")}async function z(e){await d.api.waitUntil("OMEMOInitialized");const t=await d.api.omemo.devicelists.get(e,!0);return await t.fetchDevices(),t.devices}async function F(){const e=(await d.api.omemo.devicelists.get(d._converse.bare_jid,!0)).devices.pluck("id");let t=libsignal.KeyHelper.generateRegistrationId(),s=0;for(;e.includes(t);)if(t=libsignal.KeyHelper.generateRegistrationId(),s++,10===s)throw new Error("Unable to generate a unique device ID");return t.toString()}async function U(e){if(!e.get("bundle"))return d.log.error(`Could not build an OMEMO session for device ${e.get("id")} because we don't have its bundle`),null;const t=new libsignal.SignalProtocolAddress(e.get("jid"),e.get("id")),s=await d._converse.omemo_store.loadSession(t.toString());if(s)return s;try{const t=await async function(e){const t=new libsignal.SignalProtocolAddress(e.get("jid"),e.get("id")),s=new libsignal.SessionBuilder(d._converse.omemo_store,t),n=e.getRandomPreKey(),r=await e.getBundle();return s.processPreKey({registrationId:parseInt(e.get("id"),10),identityKey:(0,g.base64ToArrayBuffer)(r.identity_key),signedPreKey:{keyId:r.signed_prekey.id,publicKey:(0,g.base64ToArrayBuffer)(r.signed_prekey.public_key),signature:(0,g.base64ToArrayBuffer)(r.signed_prekey.signature)},preKey:{keyId:n.id,publicKey:(0,g.base64ToArrayBuffer)(n.key)}})}(e);return t}catch(t){return d.log.error(`Could not build an OMEMO session for device ${e.get("id")}`),d.log.error(t),null}}function B(){d._converse.connection.addHandler((async e=>{try{y(`event[xmlns="${_.NS.PUBSUB}#event"]`,e).length&&(await d.api.waitUntil("OMEMOInitialized"),await async function(e){const t=y(`items[node="${_.NS.OMEMO_DEVICELIST}"]`,e).pop();if(!t)return;const s=`item list[xmlns="${_.NS.OMEMO}"] device`,n=y(s,t).map((e=>e.getAttribute("id"))),r=e.getAttribute("from"),o=await d.api.omemo.devicelists.get(r,!0),i=o.devices;i.pluck("id").filter((e=>!n.includes(e))).forEach((e=>{r===d._converse.bare_jid&&e===d._converse.omemo_store.get("device_id")||i.get(e).save("active",!1)})),n.forEach((e=>{const t=i.get(e);t?t.save("active",!0):i.create({id:e,jid:r})})),b.isSameBareJID(r,d._converse.bare_jid)&&o.publishCurrentDevice(n)}(e),await async function(e){const t=y("items",e).pop();if(!t||!t.getAttribute("node").startsWith(_.NS.OMEMO_BUNDLES))return;const s=t.getAttribute("node").split(":")[1],n=e.getAttribute("from"),r=y("item > bundle",t).pop(),o=await d.api.omemo.devicelists.get(n,!0);(o.devices.get(s)||o.devices.create({id:s,jid:n})).save({bundle:P(r)})}(e))}catch(e){d.log.error(e.message)}return!0}),null,"message","headline")}async function q(){if(void 0===d._converse.omemo_store){const e=`converse.omemosession-${d._converse.bare_jid}`;d._converse.omemo_store=new d._converse.OMEMOStore({id:e}),(0,h.initStorage)(d._converse.omemo_store,e)}await d._converse.omemo_store.fetchSession()}async function H(e){if(!e)if(d._converse.config.get("trusted")&&!d.api.settings.get("clear_cache_on_logout")){try{await async function(){d._converse.devicelists=new d._converse.DeviceLists;const e=`converse.devicelists-${d._converse.bare_jid}`;(0,h.initStorage)(d._converse.devicelists,e),await new Promise((e=>{d._converse.devicelists.fetch({success:e,error:(t,s)=>{d.log.error(s),e()}})})),await d.api.omemo.devicelists.get(d._converse.bare_jid,!0)}(),await q(),await d._converse.omemo_store.publishBundle()}catch(e){return d.log.error("Could not initialize OMEMO support"),void d.log.error(e)}d.api.trigger("OMEMOInitialized")}else d.log.warn("Not initializing OMEMO, since this browser is not trusted or clear_cache_on_logout is set to true")}async function G(e){let t;e.get("type")===d._converse.CHATROOMS_TYPE?(await d.api.waitUntil("OMEMOInitialized"),t=e.features.get("nonanonymous")&&e.features.get("membersonly")):e.get("type")===d._converse.PRIVATE_CHAT_TYPE&&(t=await d._converse.contactHasOMEMOSupport(e.get("jid"))),e.set("omemo_supported",t),t&&d.api.settings.get("omemo_default")&&e.set("omemo_active",!0)}function W(e){e.stopPropagation(),e.preventDefault();const t=b.ancestor(e.target,"converse-chat-toolbar");if(!t.model.get("omemo_supported")){let e;return e=t.model.get("type")===d._converse.CHATROOMS_TYPE?[(0,c.__)("Cannot use end-to-end encryption in this groupchat, either the groupchat has some anonymity or not all participants support OMEMO.")]:[(0,c.__)("Cannot use end-to-end encryption because %1$s uses a client that doesn't support OMEMO.",t.model.contact.getDisplayName())],d.api.alert("error",(0,c.__)("Error"),e)}t.model.save({omemo_active:!t.model.get("omemo_active")})}function V(e,t){const s=e.model,n=s.get("type")===d._converse.CHATROOMS_TYPE;let r,o;if(s.get("omemo_supported")){const e=(0,c.__)("Messages are being sent in plaintext"),t=(0,c.__)("Messages are sent encrypted");r=s.get("omemo_active")?t:e}else r=n?(0,c.__)("This groupchat needs to be members-only and non-anonymous in order to support OMEMO encrypted messages"):(0,c.__)("OMEMO encryption is not supported");return o=s.get("omemo_supported")?s.get("omemo_active")?n?"var(--muc-color)":"var(--chat-toolbar-btn-color)":"var(--error-color)":"var(--muc-toolbar-btn-disabled-color)",t.push(u.html`
        <button class="toggle-omemo" title="${r}" data-disabled=${!s.get("omemo_supported")} @click=${W}>
            <converse-icon
                class="fa ${s.get("omemo_active")?"fa-lock":"fa-unlock"}"
                path-prefix="${d.api.settings.get("assets_path")}"
                size="1em"
                color="${o}"
            ></converse-icon>
        </button>
    `),t}async function J(e,t){let{stanza:s}=t;const{message:n}=t;if(!n.get("is_encrypted"))return t;if(!n.get("body"))throw new Error("No message body to encrypt!");const r=await async function(e){const t=(0,c.__)("Sorry, no devices found to which we can send an OMEMO encrypted message.");let s;if(e.get("type")===d._converse.CHATROOMS_TYPE){const t=await Promise.all(e.occupants.map((e=>z(e.get("jid")))));s=t.reduce(((e,t)=>e.concat(t.models)),[])}else if(e.get("type")===d._converse.PRIVATE_CHAT_TYPE){const n=await z(e.get("jid"));if(0===n.length){const e=new Error(t);throw e.user_facing=!0,e}const r=(await d.api.omemo.devicelists.get(d._converse.bare_jid)).devices;s=[...r.models,...n.models]}const n=d._converse.omemo_store.get("device_id");s=s.filter((e=>e.get("id")!==n)),await Promise.all(s.map((e=>e.getBundle())));const r=s.filter((e=>e)).map((e=>U(e)));if(await Promise.all(r),r.includes(null)&&(s=s.filter((e=>r[s.indexOf(e)])),0===s.length)){const e=new Error(t);throw e.user_facing=!0,e}return s}(e);s.c("encrypted",{xmlns:_.NS.OMEMO}).c("header",{sid:d._converse.omemo_store.get("device_id")});const{key_and_tag:o,iv:i,payload:l}=await Q.encryptMessage(n.get("plaintext")),u=await Promise.all(r.filter((e=>e.get("trusted")!=a.UNTRUSTED&&e.get("active"))).map((e=>function(e,t){return O(t.get("jid"),t.get("id")).encrypt(e).then((e=>({payload:e,device:t})))}(o,e))));return s=await D(s,u,i),s.c("payload").t(l).up().up(),s.c("store",{xmlns:_.NS.HINTS}).up(),s.c("encryption",{xmlns:_.NS.EME,namespace:_.NS.OMEMO}),{message:n,stanza:s}}const Q={decryptMessage:async function(e){const t=await crypto.subtle.importKey("raw",e.key,a.KEY_ALGO,!0,["encrypt","decrypt"]),s=(0,g.appendArrayBuffer)((0,g.base64ToArrayBuffer)(e.payload),e.tag),n={name:"AES-GCM",iv:(0,g.base64ToArrayBuffer)(e.iv),tagLength:a.TAG_LENGTH};return(0,g.arrayBufferToString)(await crypto.subtle.decrypt(n,t,s))},encryptMessage:async function(e){const t=crypto.getRandomValues(new window.Uint8Array(12)),s=await crypto.subtle.generateKey(a.KEY_ALGO,!0,["encrypt","decrypt"]),n={name:"AES-GCM",iv:t,tagLength:a.TAG_LENGTH},r=await crypto.subtle.encrypt(n,s,(0,g.stringToArrayBuffer)(e)),o=r.byteLength-16,i=r.slice(0,o),l=r.slice(o),c=await crypto.subtle.exportKey("raw",s);return{key:c,tag:l,key_and_tag:(0,g.appendArrayBuffer)(c,l),payload:(0,g.arrayBufferToBase64)(i),iv:(0,g.arrayBufferToBase64)(t)}},formatFingerprint:j}},"./src/plugins/profile/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/modal/index.js"),s("./src/plugins/profile/modals/chat-status.js"),s("./src/plugins/profile/modals/profile.js"),s("./src/plugins/profile/modals/user-settings.js"),s("./src/plugins/profile/statusview.js"),s("./src/headless/plugins/status/index.js"),s("./src/headless/plugins/vcard/index.js");var n=s("./src/headless/dist/converse-headless.js");n.converse.plugins.add("converse-profile",{dependencies:["converse-status","converse-modal","converse-vcard","converse-chatboxviews","converse-adhoc-views"],initialize(){n.api.settings.extend({show_client_info:!0})}})},"./src/plugins/profile/modals/chat-status.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/profile/templates/chat-status-modal.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");const a=i.converse.env.utils;class l extends n.default{initialize(){super.initialize(),this.render(),this.addEventListener("shown.bs.modal",(()=>{this.querySelector('input[name="status_message"]').focus()}),!1)}renderModal(){return(0,r.default)(this)}getModalTitle(){return(0,o.__)("Change chat status")}clearStatusMessage(e){e&&e.preventDefault&&(e.preventDefault(),a.hideElement(this.querySelector(".clear-input")));this.querySelector('input[name="status_message"]').value=""}onFormSubmitted(e){e.preventDefault();const t=new FormData(e.target);this.model.save({status_message:t.get("status_message"),status:t.get("chat_status")}),this.modal.hide()}}i._converse.ChatStatusModal=l,i.api.elements.define("converse-chat-status-modal",l)},"./src/plugins/profile/modals/profile.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/profile/templates/profile_modal.js"),o=s("./node_modules/client-compress/dist/index.js"),i=s.n(o),a=s("./src/i18n/index.js"),l=s("./src/headless/dist/converse-headless.js");s("./src/plugins/profile/password-reset.js");const c=new(i())({targetSize:.1,quality:.75,maxWidth:256,maxHeight:256});class d extends n.default{constructor(e){super(e),this.tab="profile"}initialize(){super.initialize(),this.listenTo(this.model,"change",this.render),l.api.trigger("profileModalInitialized",this.model)}renderModal(){return(0,r.default)(this)}getModalTitle(){return(0,a.__)("Your Profile")}async setVCard(e){try{await l.api.vcard.set(l._converse.bare_jid,e)}catch(e){return l.log.fatal(e),void this.alert([(0,a.__)("Sorry, an error happened while trying to save your profile data."),(0,a.__)("You can check your browser's developer console for any error output.")].join(" "))}this.modal.hide()}onFormSubmitted(e){e.preventDefault();const t=new FileReader,s=new FormData(e.target),n=s.get("image"),r={fn:s.get("fn"),nickname:s.get("nickname"),role:s.get("role"),email:s.get("email"),url:s.get("url")};if(n.size){const e=[n];c.compress(e).then((e=>{const{photo:s}=e[0];t.onloadend=()=>{Object.assign(r,{image:btoa(t.result),image_type:n.type}),this.setVCard(r)},t.readAsBinaryString(s.data)}))}else Object.assign(r,{image:this.model.vcard.get("image"),image_type:this.model.vcard.get("image_type")}),this.setVCard(r)}}l.api.elements.define("converse-profile-modal",d)},"./src/plugins/profile/modals/templates/user-settings.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/dompurify/dist/purify.js"),r=s.n(n),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/unsafe-html.js");const c=e=>{const t=(0,o.__)("%1$s Open Source %2$s XMPP chat client brought to you by %3$s Opkode %2$s",'<a target="_blank" rel="nofollow" href="https://conversejs.org">',"</a>",'<a target="_blank" rel="nofollow" href="https://opkode.com">'),s=(0,o.__)("%1$s Translate %2$s it into your own language",'<a target="_blank" rel="nofollow" href="https://hosted.weblate.org/projects/conversejs/#languages">',"</a>"),n=i.api.settings.get("show_client_info"),c=i.api.settings.get("allow_adhoc_commands"),d=n&&c;return a.html`
        ${d?(e=>{const t=(0,o.__)("About"),s=(0,o.__)("Commands");return a.html`
        <ul class="nav nav-pills justify-content-center">
            <li role="presentation" class="nav-item">
                <a class="nav-link ${"about"===e.tab?"active":""}"
                   id="about-tab"
                   href="#about-tabpanel"
                   aria-controls="about-tabpanel"
                   role="tab"
                   data-toggle="tab"
                   data-name="about"
                   @click=${t=>e.switchTab(t)}>${t}</a>
            </li>
            <li role="presentation" class="nav-item">
                <a class="nav-link ${"commands"===e.tab?"active":""}"
                   id="commands-tab"
                   href="#commands-tabpanel"
                   aria-controls="commands-tabpanel"
                   role="tab"
                   data-toggle="tab"
                   data-name="commands"
                   @click=${t=>e.switchTab(t)}>${s}</a>
            </li>
        </ul>
    `})(e):""}

        <div class="tab-content">
            ${n?a.html`
                <div class="tab-pane tab-pane--columns ${"about"===e.tab?"active":""}"
                        id="about-tabpanel" role="tabpanel" aria-labelledby="about-tab">

                    <span class="modal-alert"></span>
                    <br/>
                    <div class="container">
                        <h6 class="brand-heading">Converse</h6>
                        <p class="brand-subtitle">${i._converse.VERSION_NAME}</p>
                        <p class="brand-subtitle">${(0,l.unsafeHTML)(r().sanitize(t))}</p>
                        <p class="brand-subtitle">${(0,l.unsafeHTML)(r().sanitize(s))}</p>
                    </div>
                </div>`:""}

            ${c?a.html`
                <div class="tab-pane tab-pane--columns ${"commands"===e.tab?"active":""}"
                        id="commands-tabpanel"
                        role="tabpanel"
                        aria-labelledby="commands-tab">
                    <converse-adhoc-commands/>
                </div> `:""}
        </div>
`}},"./src/plugins/profile/modals/user-settings.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/modal/modal.js"),r=s("./src/plugins/profile/modals/templates/user-settings.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{constructor(e){super(e);const t=i.api.settings.get("show_client_info"),s=i.api.settings.get("allow_adhoc_commands");t&&s||t?this.tab="about":s&&(this.tab="commands")}renderModal(){return(0,r.default)(this)}getModalTitle(){return(0,o.__)("Settings")}}i.api.elements.define("converse-user-settings-modal",a)},"./src/plugins/profile/password-reset.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/profile/templates/password-reset.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js");const{Strophe:a,$iq:l,sizzle:c,u:d}=i.converse.env;class u extends r.CustomElement{static get properties(){return{passwords_mismatched:{type:Boolean},alert_message:{type:String}}}initialize(){this.passwords_mismatched=!1,this.alert_message=""}render(){return(0,n.default)(this)}checkPasswordsMatch(e){const t=new FormData(e.target.form??e.target),s=t.get("password"),n=t.get("password_check");return this.passwords_mismatched=s&&s!==n,this.passwords_mismatched}async onSubmit(e){if(e.preventDefault(),this.checkPasswordsMatch(e))return;const t=l({type:"get",to:i._converse.domain}).c("query",{xmlns:a.NS.REGISTER}),s=await i.api.sendIQ(t);if(null===s)return void(this.alert_message=(0,o.__)("Timeout error"));if(c(`error service-unavailable[xmlns="${a.NS.STANZAS}"]`,s).length)return void(this.alert_message=(0,o.__)("Your server does not support in-band password reset"));if(d.isErrorStanza(s))return this.alert_message=(0,o.__)("Your server responded with an unknown error, check the console for details"),i.log.error("Could not set password"),void i.log.error(s);const n=s.querySelector("username").textContent,r=new FormData(e.target).get("password"),u=l({type:"set",to:i._converse.domain}).c("query",{xmlns:a.NS.REGISTER}).c("username",{},n).c("password",{},r),h=await i.api.sendIQ(u);null===h?this.alert_message=(0,o.__)("Timeout error while trying to set your password"):c(`error not-allowed[xmlns="${a.NS.STANZAS}"]`,h).length?this.alert_message=(0,o.__)("Your server does not allow in-band password reset"):c(`error forbidden[xmlns="${a.NS.STANZAS}"]`,h).length||d.isErrorStanza(h)?this.alert_message=(0,o.__)("You are not allowed to change your password"):i.api.alert("info",(0,o.__)("Success"),[(0,o.__)("Your new password has been set")])}}i.api.elements.define("converse-change-password-form",u)},"./src/plugins/profile/statusview.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/profile/templates/profile.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{initialize(){this.model=o._converse.xmppstatus,this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:add",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:change",(()=>this.requestUpdate()))}render(){return(0,n.default)(this)}showProfileModal(e){e?.preventDefault(),o.api.modal.show("converse-profile-modal",{model:this.model},e)}showStatusChangeModal(e){e?.preventDefault(),o.api.modal.show("converse-chat-status-modal",{model:this.model},e)}showUserSettingsModal(e){e?.preventDefault(),o.api.modal.show("converse-user-settings-modal",{model:this.model,_converse:o._converse},e)}}o.api.elements.define("converse-user-profile",i)},"./src/plugins/profile/templates/chat-status-modal.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("Away"),s=(0,r.__)("Busy"),o=(0,r.__)("Online"),i=(0,r.__)("Save"),a=(0,r.__)("Away for long"),l=(0,r.__)("Personal status message"),c=e.model.get("status"),d=e.model.get("status_message");return n.html`
    <form class="converse-form set-xmpp-status" id="set-xmpp-status" @submit=${t=>e.onFormSubmitted(t)}>
        <div class="form-group">
            <div class="custom-control custom-radio">
                <input ?checked=${"online"===c}
                    type="radio" id="radio-online" value="online" name="chat_status" class="custom-control-input"/>
                <label class="custom-control-label" for="radio-online">
                    <converse-icon size="1em" class="fa fa-circle chat-status chat-status--online"></converse-icon>${o}</label>
            </div>
            <div class="custom-control custom-radio">
                <input ?checked=${"busy"===c}
                    type="radio" id="radio-busy" value="dnd" name="chat_status" class="custom-control-input"/>
                <label class="custom-control-label" for="radio-busy">
                    <converse-icon size="1em" class="fa fa-minus-circle  chat-status chat-status--busy"></converse-icon>${s}</label>
            </div>
            <div class="custom-control custom-radio">
                <input ?checked=${"away"===c}
                    type="radio" id="radio-away" value="away" name="chat_status" class="custom-control-input"/>
                <label class="custom-control-label" for="radio-away">
                    <converse-icon size="1em" class="fa fa-circle chat-status chat-status--away"></converse-icon>${t}</label>
            </div>
            <div class="custom-control custom-radio">
                <input ?checked=${"xa"===c}
                    type="radio" id="radio-xa" value="xa" name="chat_status" class="custom-control-input"/>
                <label class="custom-control-label" for="radio-xa">
                    <converse-icon size="1em" class="far fa-circle chat-status chat-status--xa"></converse-icon>${a}</label>
            </div>
        </div>
        <div class="form-group">
            <div class="btn-group w-100">
                <input name="status_message" type="text" class="form-control" autofocus
                    value="${d||""}" placeholder="${l}"/>
                <converse-icon size="1em" class="fa fa-times clear-input ${d?"":"hidden"}" @click=${t=>e.clearStatusMessage(t)}></converse-icon>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">${i}</button>
    </form>`}},"./src/plugins/profile/templates/password-reset.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=e=>{const t=(0,n.__)("Submit"),s=(0,n.__)("The new passwords must match"),o=(0,n.__)("New password"),i=(0,n.__)("Confirm new password");return r.html`<form class="converse-form passwordreset-form" method="POST" @submit=${t=>e.onSubmit(t)}>
        ${e.alert_message?r.html`<div class="alert alert-danger" role="alert">${e.alert_message}</div>`:""}

        <div class="form-group">
            <label for="converse_password_reset_new">${o}</label>
            <input
                class="form-control ${e.passwords_mismatched?"error":""}"
                type="password"
                value=""
                name="password"
                required="required"
                id="converse_password_reset_new"
                autocomplete="new-password"
                minlength="8"
                ?disabled="${e.alert_message}"
            />
        </div>
        <div class="form-group">
            <label for="converse_password_reset_check">${i}</label>
            <input
                class="form-control ${e.passwords_mismatched?"error":""}"
                type="password"
                value=""
                name="password_check"
                required="required"
                id="converse_password_reset_check"
                autocomplete="new-password"
                minlength="8"
                ?disabled="${e.alert_message}"
                @input=${t=>e.checkPasswordsMatch(t)}
            />
            ${e.passwords_mismatched?r.html`<span class="error">${s}</span>`:""}
        </div>

        <input class="save-form btn btn-primary"
               type="submit"
               value=${t}
               ?disabled="${e.alert_message}" />
    </form>`}},"./src/plugins/profile/templates/profile.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/avatar/avatar.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/profile/utils.js"),i=s("./node_modules/lit/index.js");const a=e=>{const t=e.model.get("status")||"offline",s=e.model.get("status_message")||(0,n.__)("I am %1$s",(0,o.getPrettyStatus)(t)),a=(0,n.__)("Click to change your chat status"),l=r.api.settings.get("show_client_info")||r.api.settings.get("allow_adhoc_commands");let c,d;return[c,d]="online"===t?["fa fa-circle chat-status","chat-status-online"]:"dnd"===t?["fa fa-minus-circle chat-status","chat-status-busy"]:"away"===t?["fa fa-circle chat-status","chat-status-away"]:["fa fa-circle chat-status","subdued-color"],i.html`
        <div class="userinfo controlbox-padded">
            <div class="controlbox-section profile d-flex">
                <a class="show-profile" href="#" @click=${e.showProfileModal}>
                    <converse-avatar class="avatar align-self-center"
                        .data=${e.model.vcard?.attributes}
                        nonce=${e.model.vcard?.get("vcard_updated")}
                        height="40" width="40"></converse-avatar>
                </a>
                <span class="username w-100 align-self-center">${e.model.getDisplayName()}</span>
                ${l?function(e){const t=(0,n.__)("Show details about this chat client");return i.html`<a class="controlbox-heading__btn show-client-info align-self-center" title="${t}" @click=${e.showUserSettingsModal}>
        <converse-icon class="fa fa-cog" size="1em"></converse-icon>
    </a>`}(e):""}
                ${r.api.settings.get("allow_logout")?function(){const e=(0,n.__)("Log out");return i.html`<a class="controlbox-heading__btn logout align-self-center" title="${e}" @click=${o.logOut}>
        <converse-icon class="fa fa-sign-out-alt" size="1em"></converse-icon>
    </a>`}():""}
            </div>
            <div class="d-flex xmpp-status">
                <a class="change-status" title="${a}" data-toggle="modal" data-target="#changeStatusModal" @click=${e.showStatusChangeModal}>
                    <span class="${t} w-100 align-self-center" data-value="${t}">
                    <converse-icon color="var(--${d})" style="margin-top: -0.1em" size="0.82em" class="${c}"></converse-icon> ${s}</span>
                </a>
            </div>
        </div>`}},"./src/plugins/profile/templates/profile_modal.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});s("./src/shared/components/image-picker.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t={...e.model.toJSON(),...e.model.vcard.toJSON()},s=(0,n.__)("Email"),i=(0,n.__)("Full Name"),a=(0,n.__)("XMPP Address"),l=(0,n.__)("Nickname"),c=(0,n.__)("Role"),d=(0,n.__)("Save and close"),u=(0,n.__)("Use commas to separate multiple roles. Your roles are shown next to your name on your chat messages."),h=(0,n.__)("URL"),f=(0,n.__)("OMEMO"),m=(0,n.__)("Profile"),p=(0,n.__)("Reset Password"),g=[o.html`<li role="presentation" class="nav-item">
            <a class="nav-link ${"profile"===e.tab?"active":""}"
               id="profile-tab"
               href="#profile-tabpanel"
               aria-controls="profile-tabpanel"
               role="tab"
               @click=${t=>e.switchTab(t)}
               data-name="profile"
               data-toggle="tab">${m}</a>
            </li>`];return g.push(o.html`<li role="presentation" class="nav-item">
                <a class="nav-link ${"passwordreset"===e.tab?"active":""}"
                id="passwordreset-tab"
                href="#passwordreset-tabpanel"
                aria-controls="passwordreset-tabpanel"
                role="tab"
                @click=${t=>e.switchTab(t)}
                data-name="passwordreset"
                data-toggle="tab">${p}</a>
        </li>`),r._converse.pluggable.plugins["converse-omemo"]?.enabled(r._converse)&&g.push(o.html`<li role="presentation" class="nav-item">
                <a class="nav-link ${"omemo"===e.tab?"active":""}"
                   id="omemo-tab"
                   href="#omemo-tabpanel"
                   aria-controls="omemo-tabpanel"
                   role="tab"
                   @click=${t=>e.switchTab(t)}
                   data-name="omemo"
                   data-toggle="tab">${f}</a>
            </li>`),o.html`
        <ul class="nav nav-pills justify-content-center">${g}</ul>
        <div class="tab-content">
            <div class="tab-pane ${"profile"===e.tab?"active":""}" id="profile-tabpanel" role="tabpanel" aria-labelledby="profile-tab">
                <form class="converse-form converse-form--modal profile-form" action="#" @submit=${t=>e.onFormSubmitted(t)}>
                    <div class="row">
                        <div class="col-auto">
                            <converse-image-picker .data="${{image:t.image,image_type:t.image_type}}" width="128" height="128"></converse-image-picker>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label class="col-form-label">${a}:</label>
                                <div>${t.jid}</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="vcard-fullname" class="col-form-label">${i}:</label>
                        <input id="vcard-fullname" type="text" class="form-control" name="fn" value="${t.fullname||""}"/>
                    </div>
                    <div class="form-group">
                        <label for="vcard-nickname" class="col-form-label">${l}:</label>
                        <input id="vcard-nickname" type="text" class="form-control" name="nickname" value="${t.nickname||""}"/>
                    </div>
                    <div class="form-group">
                        <label for="vcard-url" class="col-form-label">${h}:</label>
                        <input id="vcard-url" type="url" class="form-control" name="url" value="${t.url||""}"/>
                    </div>
                    <div class="form-group">
                        <label for="vcard-email" class="col-form-label">${s}:</label>
                        <input id="vcard-email" type="email" class="form-control" name="email" value="${t.email||""}"/>
                    </div>
                    <div class="form-group">
                        <label for="vcard-role" class="col-form-label">${c}:</label>
                        <input id="vcard-role" type="text" class="form-control" name="role" value="${t.role||""}" aria-describedby="vcard-role-help"/>
                        <small id="vcard-role-help" class="form-text text-muted">${u}</small>
                    </div>
                    <hr/>
                    <div class="form-group">
                        <button type="submit" class="save-form btn btn-primary">${d}</button>
                    </div>
                </form>
            </div>

            <div class="tab-pane ${"passwordreset"===e.tab?"active":""}" id="passwordreset-tabpanel" role="tabpanel" aria-labelledby="passwordreset-tab">
                ${"passwordreset"===e.tab?o.html`<converse-change-password-form></converse-change-password-form>`:""}
            </div>

            ${r._converse.pluggable.plugins["converse-omemo"]?.enabled(r._converse)?(e=>o.html`
    <div class="tab-pane ${"omemo"===e.tab?"active":""}" id="omemo-tabpanel" role="tabpanel" aria-labelledby="omemo-tab">
        ${"omemo"===e.tab?o.html`<converse-omemo-profile></converse-omemo-profile>`:""}
    </div>`)(e):""}
        </div>
    </div>`}},"./src/plugins/profile/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getPrettyStatus:()=>c,logOut:()=>d});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js");const{Strophe:o,$iq:i,sizzle:a,u:l}=r.converse.env;function c(e){return"chat"===e?(0,n.__)("online"):"dnd"===e?(0,n.__)("busy"):"xa"===e?(0,n.__)("away for long"):"away"===e?(0,n.__)("away"):"offline"===e?(0,n.__)("offline"):(0,n.__)(e)||(0,n.__)("online")}async function d(e){e?.preventDefault();await r.api.confirm((0,n.__)("Are you sure you want to log out?"))&&r.api.user.logout()}},"./src/plugins/push/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/plugins/push/utils.js");const{Strophe:o}=n.converse.env;o.addNamespace("PUSH","urn:xmpp:push:0"),n.converse.plugins.add("converse-push",{initialize(){n.api.settings.extend({push_app_servers:[],enable_muc_push:!1}),n.api.listen.on("statusInitialized",(()=>(0,r.enablePush)())),n.api.settings.get("enable_muc_push")&&n.api.listen.on("chatBoxesInitialized",(()=>n._converse.chatboxes.on("add",r.onChatBoxAdded)))}})},"./src/plugins/push/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{enablePush:()=>i,onChatBoxAdded:()=>a});var n=s("./src/headless/dist/converse-headless.js");const{Strophe:r,$iq:o}=n.converse.env;async function i(e){e=e||n._converse.bare_jid;const t=n._converse.session.get("push_enabled")||[];if(t.includes(e))return;const s=n.api.settings.get("push_app_servers").filter((e=>!e.disable)),i=n.api.settings.get("push_app_servers").filter((e=>e.disable)),a=s.map((t=>async function(e,t){if(!t.jid||!t.node)return;if(!await n.api.disco.getIdentity("pubsub","push",t.jid))return n.log.warn(`Not enabling push the service "${t.jid}", it doesn't have the right disco identtiy.`);const s=await Promise.all([n.api.disco.supports(r.NS.PUSH,t.jid),n.api.disco.supports(r.NS.PUSH,e)]);if(!s[0]&&!s[1])return void n.log.warn(`Not enabling push app server "${t.jid}", no disco support from your server.`);const i=o({type:"set"});return e!==n._converse.bare_jid&&i.attrs({to:e}),i.c("enable",{xmlns:r.NS.PUSH,jid:t.jid,node:t.node}),t.secret&&i.c("x",{xmlns:r.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE"}).c("value").t(`${r.NS.PUBSUB}#publish-options`).up().up().c("field",{var:"secret"}).c("value").t(t.secret),n.api.sendIQ(i)}(e,t))),l=i.map((t=>async function(e,t){if(!t.jid)return;if(!await n.api.disco.supports(r.NS.PUSH,e||n._converse.bare_jid))return void n.log.warn(`Not disabling push app server "${t.jid}", no disco support from your server.`);const s=o({type:"set"});e!==n._converse.bare_jid&&s.attrs({to:e}),s.c("disable",{xmlns:r.NS.PUSH,jid:t.jid}),t.node&&s.attrs({node:t.node}),n.api.sendIQ(s).catch((e=>{n.log.error(`Could not disable push app server for ${t.jid}`),n.log.error(e)}))}(e,t)));try{await Promise.all(a.concat(l))}catch(e){n.log.error("Could not enable or disable push App Server"),e&&n.log.error(e)}finally{t.push(e)}n._converse.session.save("push_enabled",t)}function a(e){e.get("type")==n._converse.CHATROOMS_TYPE&&i(r.getDomainFromJid(e.get("jid")))}},"./src/plugins/register/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/register/panel.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/register/utils.js"),i=s("./src/headless/shared/constants.js");const{Strophe:a}=r.converse.env;a.addNamespace("REGISTER","jabber:iq:register");const l=Object.keys(a.Status).reduce(((e,t)=>Math.max(e,a.Status[t])),0);a.Status.REGIFAIL=l+1,a.Status.REGISTERED=l+2,a.Status.CONFLICT=l+3,a.Status.NOTACCEPTABLE=l+5,r.converse.plugins.add("converse-register",{dependencies:["converse-controlbox"],enabled:()=>!0,initialize(){const{router:e}=r._converse;i.CONNECTION_STATUS[a.Status.REGIFAIL]="REGIFAIL",i.CONNECTION_STATUS[a.Status.REGISTERED]="REGISTERED",i.CONNECTION_STATUS[a.Status.CONFLICT]="CONFLICT",i.CONNECTION_STATUS[a.Status.NOTACCEPTABLE]="NOTACCEPTABLE",r.api.settings.extend({allow_registration:!0,domain_placeholder:(0,n.__)(" e.g. conversejs.org"),providers_link:"https://compliance.conversations.im/",registration_domain:""}),e.route("converse/login",(()=>(0,o.setActiveForm)("login"))),e.route("converse/register",(()=>(0,o.setActiveForm)("register")))}})},"./src/plugins/register/panel.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/templates/form_input.js"),r=s("./src/templates/form_url.js"),o=s("./src/templates/form_username.js"),i=s("./src/plugins/register/templates/register_panel.js"),a=s("./src/headless/shared/constants.js"),l=s("./src/shared/components/element.js"),c=s("./src/i18n/index.js"),d=s("./src/headless/dist/converse-headless.js"),u=s("./src/headless/utils/init.js"),h=s("./src/plugins/register/utils.js"),f=s("./src/headless/utils/form.js");s("./src/plugins/register/styles/register.scss");const{Strophe:m,sizzle:p,$iq:g}=d.converse.env,_=d.converse.env.utils,v=1,y=2;class b extends l.CustomElement{static get properties(){return{status:{type:String},alert_message:{type:String},alert_type:{type:String}}}constructor(){super(),this.alert_type="info",this.setErrorMessage=e=>this.setMessage(e,"danger"),this.setFeedbackMessage=e=>this.setMessage(e,"info")}initialize(){this.reset(),this.listenTo(d._converse,"connectionInitialized",(()=>this.registerHooks()));const e=d.api.settings.get("registration_domain");e?this.fetchRegistrationForm(e):this.status=0}render(){return(0,i.default)(this)}setMessage(e,t){this.alert_type=t,this.alert_message=e}registerHooks(){const e=d._converse.connection,t=e._connect_cb.bind(e);e._connect_cb=(e,s,n)=>{this._registering?this.getRegistrationFields(e,s)&&(this._registering=!1):t(e,s,n)}}getRegistrationFields(e,t){const s=d._converse.connection;s.connected=!0;const n=s._proto._reqToData(e);if(!n)return;if(s._proto._connect_cb(n)===m.Status.CONNFAIL)return this.status=0,this.setErrorMessage((0,c.__)("Sorry, we're unable to connect to your chosen provider.")),!1;const r=n.getElementsByTagName("register"),o=n.getElementsByTagName("mechanism");if(0===r.length&&0===o.length)return s._proto._no_auth_received(t),!1;if(0===r.length)return s._changeConnectStatus(m.Status.REGIFAIL),this.alert_type="danger",this.setErrorMessage((0,c.__)("Sorry, the given provider does not support in band account registration. Please try with a different provider.")),!0;s._addSysHandler((e=>this.onRegistrationFields(e)),null,"iq",null,null);const i=g({type:"get"}).c("query",{xmlns:m.NS.REGISTER}).tree();return i.setAttribute("id",s.getUniqueId("sendIQ")),s.send(i),s.connected=!1,!0}onRegistrationFields(e){return"error"===e.getAttribute("type")?(this.reportErrors(e),d.api.settings.get("registration_domain")?this.status=3:this.status=0,!1):(this.setFields(e),this.status===v&&this.renderRegistrationForm(e),!1)}reset(e){Object.assign(this,{fields:{},urls:[],title:"",instructions:"",registered:!1,_registering:!1,domain:null,form_type:null}),e&&Object.assign(this,e)}onFormSubmission(e){e?.preventDefault?.(),null===e.target.querySelector("input[name=domain]")?this.submitRegistrationForm(e.target):this.onProviderChosen(e.target)}onProviderChosen(e){const t=e.querySelector("input[name=domain]")?.value;t&&this.fetchRegistrationForm(t.trim())}fetchRegistrationForm(e){return this.status=v,this.reset({domain:m.getDomainFromJid(e),_registering:!0}),(0,u.initConnection)(this.domain),d._converse.connection?.connect(this.domain,"",(e=>this.onConnectStatusChanged(e))),!1}onConnectStatusChanged(e){d.log.debug("converse-register: onConnectStatusChanged"),[m.Status.DISCONNECTED,m.Status.CONNFAIL,m.Status.REGIFAIL,m.Status.NOTACCEPTABLE,m.Status.CONFLICT].includes(e)?(d.log.error(`Problem during registration: Strophe.Status is ${a.CONNECTION_STATUS[e]}`),this.abortRegistration()):e===m.Status.REGISTERED&&(d.log.debug("Registered successfully."),d._converse.connection.reset(),["converse/login","converse/register"].includes(d._converse.router.history.getFragment())&&d._converse.router.navigate("",{replace:!0}),(0,h.setActiveForm)("login"),this.fields.password&&this.fields.username?(d._converse.connection.connect(this.fields.username.toLowerCase()+"@"+this.domain.toLowerCase(),this.fields.password,d._converse.onConnectStatusChanged),this.setFeedbackMessage((0,c.__)("Now logging you in"))):this.setFeedbackMessage((0,c.__)("Registered successfully")),this.reset())}getLegacyFormFields(){const e=Object.keys(this.fields).map((e=>"username"===e?(0,o.default)({domain:` @${this.domain}`,name:e,type:"text",label:e,value:"",required:!0}):(0,n.default)({label:e,name:e,placeholder:e,required:!0,type:"password"===e||"email"===e?e:"text",value:""}))),t=this.urls.map((e=>(0,r.default)({label:"",value:e})));return[...e,...t]}getFormFields(e){return"xform"===this.form_type?Array.from(e.querySelectorAll("field")).map((t=>_.xForm2TemplateResult(t,e,{domain:this.domain}))):this.getLegacyFormFields()}renderRegistrationForm(e){this.form_fields=this.getFormFields(e),this.status=y}reportErrors(e){const t=Array.from(e.querySelectorAll("error"));t.length?this.setErrorMessage(t.reduce(((e,t)=>`${e}\n${t.textContent}`),"")):this.setErrorMessage((0,c.__)("The provider rejected your registration attempt. Please check the values you entered for correctness."))}renderProviderChoiceForm(e){e?.preventDefault?.(),d._converse.connection._proto._abortAllRequests(),d._converse.connection.reset(),this.status=0}abortRegistration(){d._converse.connection._proto._abortAllRequests(),d._converse.connection.reset(),[v,y].includes(this.status)?d.api.settings.get("registration_domain")&&this.fetchRegistrationForm(d.api.settings.get("registration_domain")):this.requestUpdate()}submitRegistrationForm(e){const t=p(":input:not([type=button]):not([type=submit])",e),s=g({type:"set",id:_.getUniqueId()}).c("query",{xmlns:m.NS.REGISTER});if("xform"===this.form_type){s.c("x",{xmlns:m.NS.XFORM,type:"submit"});t.map((e=>(0,f.webForm2xForm)(e))).filter((e=>e)).forEach((e=>s.cnode(e).up()))}else t.forEach((e=>s.c(e.getAttribute("name"),{},e.value)));d._converse.connection._addSysHandler((e=>this._onRegisterIQ(e)),null,"iq",null,null),d._converse.connection.send(s),this.setFields(s.tree())}setFields(e){const t=e.querySelector("query"),s=p(`x[xmlns="${m.NS.XFORM}"]`,t);s.length>0?this._setFieldsFromXForm(s.pop()):this._setFieldsFromLegacy(t)}_setFieldsFromLegacy(e){[].forEach.call(e.children,(e=>{"instructions"!==e.tagName.toLowerCase()?"x"!==e.tagName.toLowerCase()?this.fields[e.tagName.toLowerCase()]=m.getText(e):"jabber:x:oob"===e.getAttribute("xmlns")&&this.urls.concat(p("url",e).map((e=>e.textContent))):this.instructions=m.getText(e)})),this.form_type="legacy"}_setFieldsFromXForm(e){this.title=e.querySelector("title")?.textContent??"",this.instructions=e.querySelector("instructions")?.textContent??"",e.querySelectorAll("field").forEach((e=>{const t=e.getAttribute("var");t?this.fields[t.toLowerCase()]=e.querySelector("value")?.textContent??"":d.log.warn("Found field we couldn't parse")})),this.form_type="xform"}_onRegisterIQ(e){if("error"===e.getAttribute("type")){d.log.error("Registration failed."),this.reportErrors(e);let t=e.getElementsByTagName("error");if(1!==t.length)return d._converse.connection._changeConnectStatus(m.Status.REGIFAIL,"unknown"),!1;t=t[0].firstElementChild.tagName.toLowerCase(),"conflict"===t?d._converse.connection._changeConnectStatus(m.Status.CONFLICT,t):"not-acceptable"===t?d._converse.connection._changeConnectStatus(m.Status.NOTACCEPTABLE,t):d._converse.connection._changeConnectStatus(m.Status.REGIFAIL,t)}else d._converse.connection._changeConnectStatus(m.Status.REGISTERED,null);return!1}}d.api.elements.define("converse-register-panel",b)},"./src/plugins/register/templates/register_panel.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./src/plugins/register/templates/registration_form.js"),r=s("./src/templates/spinner.js"),o=s("./src/plugins/register/templates/switch_form.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./node_modules/lit/index.js");const c=e=>{const t=a.api.settings.get("registration_domain"),s=(0,i.__)("Create your account"),n=(0,i.__)("Please enter the XMPP provider to register with:"),r=!t&&e.status===d;return l.html`
        <form id="converse-register" class="converse-form" @submit=${t=>e.onFormSubmission(t)}>
            <legend class="col-form-label">${s}</legend>
            <div class="form-group">
                <label>${n}</label>

                ${t||(()=>{const e=a.api.settings.get("domain_placeholder"),t=(0,i.__)("Tip: A list of public XMPP providers is available"),s=(0,i.__)("here"),n=a.api.settings.get("providers_link");return l.html`
        <input class="form-control" required="required" type="text" name="domain" placeholder="${e}" />
        <p class="form-text text-muted">
            ${t}
            <a href="${n}" class="url" target="_blank" rel="noopener">${s}</a>.
        </p>
    `})()}
            </div>
            ${r?(()=>{const e=(0,i.__)("Fetch registration form"),t=(0,i.__)("Already have a chat account?"),s=(0,i.__)("Log in here");return l.html`
        <fieldset class="form-group buttons">
            <input class="btn btn-primary" type="submit" value="${e}" />
        </fieldset>
        <div class="switch-form">
            <p>${t}</p>
            <p><a class="login-here toggle-register-login" href="#converse/login">${s}</a></p>
        </div>
    `})():""}
        </form>
    `},d=0,u=e=>l.html`
        <converse-brand-logo></converse-brand-logo>
        ${e.alert_message?l.html`<div class="alert alert-${e.alert_type}" role="alert">${e.alert_message}</div>`:""}
        ${e.status===d?c(e):""}
        ${1===e.status?(e=>{const t=a.api.settings.get("registration_domain"),s=(0,i.__)("Cancel");return l.html`
        <form id="converse-register" class="converse-form no-scrolling" @submit=${t=>e.onFormSubmission(t)}>
            ${(0,r.default)({classes:"hor_centered"})}
            ${t?"":l.html`
                    <button class="btn btn-secondary button-cancel hor_centered"
                            @click=${t=>e.renderProviderChoiceForm(t)}>${s}</button>
                  `}
        </form>
    `})(e):""}
        ${2===e.status?(0,n.default)(e):""}
        ${3===e.status?(0,o.default)():""}
    `},"./src/plugins/register/templates/registration_form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/plugins/register/templates/switch_form.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");const a=e=>{const t=(0,r.__)("Choose a different provider"),s=(0,r.__)("Account Registration:"),a=(0,r.__)("Register"),l=o.api.settings.get("registration_domain");return i.html`
        <form id="converse-register" class="converse-form" @submit=${t=>e.onFormSubmission(t)}>
            <legend class="col-form-label">${s} ${e.domain}</legend>
            <p class="title">${e.title}</p>
            <p class="form-help instructions">${e.instructions}</p>
            <div class="form-errors hidden"></div>
            ${e.form_fields}

            <fieldset class="buttons form-group">
                ${e.fields?i.html`
                          <input type="submit" class="btn btn-primary" value="${a}" />
                      `:""}
                ${l?"":i.html`
                          <input
                              type="button"
                              class="btn btn-secondary button-cancel"
                              value="${t}"
                              @click=${t=>e.renderProviderChoiceForm(t)}
                          />
                      `}
                ${(0,n.default)()}
            </fieldset>
        </form>
    `}},"./src/plugins/register/templates/switch_form.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=()=>{const e=(0,n.__)("Already have a chat account?"),t=(0,n.__)("Log in here");return r.html`
        <div class="switch-form">
            <p>${e}</p>
            <p><a class="login-here toggle-register-login" href="#converse/login">${t}</a></p>
        </div>`}},"./src/plugins/register/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{setActiveForm:()=>r});var n=s("./src/headless/dist/converse-headless.js");async function r(e){await n.api.waitUntil("controlBoxInitialized");n._converse.chatboxes.get("controlbox").set({"active-form":e})}},"./src/plugins/roomslist/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/headless/plugins/muc/index.js"),s("./src/plugins/roomslist/view.js");var n=s("./src/headless/dist/converse-headless.js");n.converse.plugins.add("converse-roomslist",{dependencies:["converse-singleton","converse-controlbox","converse-muc","converse-bookmarks"],initialize(){}})},"./src/plugins/roomslist/model.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/@converse/skeletor/src/model.js"),r=s("./src/headless/dist/converse-headless.js");const{Strophe:o}=r.converse.env;class i extends n.Model{defaults(){return{muc_domain:r.api.settings.get("muc_domain"),nick:r._converse.getDefaultMUCNickname(),toggle_state:r._converse.OPENED}}initialize(){super.initialize(),r.api.settings.listen.on("change:muc_domain",(e=>this.setDomain(e)))}setDomain(e){r.api.settings.get("locked_muc_domain")||this.save("muc_domain",o.getDomainFromJid(e))}}const a=i},"./src/plugins/roomslist/templates/roomslist.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});s("./src/plugins/muc-views/modals/add-muc.js"),s("./src/plugins/muc-views/modals/muc-list.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/headless/utils/core.js"),a=s("./src/plugins/bookmark-views/utils.js");function l(e){return(0,i.isUniView)()&&!e.get("hidden")}function c(e,t){const s=(0,n.__)("Leave this groupchat"),i=t.get("num_unread_general")||t.get("has_activity");return o.html`
        <div class="list-item controlbox-padded available-chatroom d-flex flex-row ${l(t)?"open":""} ${i?"unread-msgs":""}"
            data-room-jid="${t.get("jid")}">

            ${t.get("num_unread")?(e=>o.html`<span class="list-item-badge badge badge--muc msgs-indicator">${e.get("num_unread")}</span>`)(t):t.get("has_activity")?o.html`<span class="list-item-badge badge badge--muc msgs-indicator"></span>`:""}

            <a class="list-item-link open-room available-room w-100"
                data-room-jid="${t.get("jid")}"
                title="${(0,n.__)("Click to open this groupchat")}"
                @click=${t=>e.openRoom(t)}>${t.getDisplayName()}</a>

            ${r.api.settings.get("allow_bookmarks")?function(e){const t=e.get("bookmarked")??!1,s=(0,n.__)("Bookmark");return o.html`
        <a class="list-item-action add-bookmark"
            data-room-jid="${e.get("jid")}"
            data-bookmark-name="${e.getDisplayName()}"
            @click=${e=>(0,a.addBookmarkViaEvent)(e)}
            title="${s}">

            <converse-icon class="fa ${t?"fa-bookmark":"fa-bookmark-empty"}"
                           size="1.2em"
                           color="${l(e)?"var(--inverse-link-color)":""}"></converse-icon>
        </a>`}(t):""}

            <a class="list-item-action room-info"
                data-room-jid="${t.get("jid")}"
                title="${(0,n.__)("Show more information on this groupchat")}"
                @click=${t=>e.showRoomDetailsModal(t)}>

                <converse-icon class="fa fa-info-circle" size="1.2em" color="${l(t)?"var(--inverse-link-color)":""}"></converse-icon>
            </a>

            <a class="list-item-action close-room"
                data-room-jid="${t.get("jid")}"
                data-room-name="${t.getDisplayName()}"
                title="${s}"
                @click=${t=>e.closeRoom(t)}>
                <converse-icon class="fa fa-sign-out-alt" size="1.2em" color="${l(t)?"var(--inverse-link-color)":""}"></converse-icon>
            </a>
        </div>`}const d=e=>{const{chatboxes:t,CHATROOMS_TYPE:s,CLOSED:i}=r._converse,a=t.filter((e=>e.get("type")===s));a.sort(((e,t)=>e.getDisplayName().toLowerCase()<=t.getDisplayName().toLowerCase()?-1:1));const l=(0,n.__)("Click to toggle the list of open groupchats"),d=(0,n.__)("Groupchats"),u=(0,n.__)("Query for groupchats"),h=(0,n.__)("Add a new groupchat"),f=(0,n.__)("Show bookmarked groupchats"),m=e.model.get("toggle_state")===i;return o.html`
        <div class="d-flex controlbox-padded">
            <span class="w-100 controlbox-heading controlbox-heading--groupchats">
                <a class="list-toggle open-rooms-toggle" title="${l}" @click=${t=>e.toggleRoomsList(t)}>
                    <converse-icon
                        class="fa ${m?"fa-caret-right":"fa-caret-down"}"
                        size="1em"
                        color="var(--muc-color)"></converse-icon>
                    ${d}
                </a>
            </span>

            <a class="controlbox-heading__btn show-bookmark-list-modal"
                @click=${t=>r.api.modal.show("converse-bookmark-list-modal",{model:e.model},t)}
                title="${f}"
                data-toggle="modal">
                    <converse-icon class="fa fa-bookmark right" size="1em"></converse-icon>
            </a>

            <a class="controlbox-heading__btn show-list-muc-modal"
                @click=${t=>r.api.modal.show("converse-muc-list-modal",{model:e.model},t)}
                title="${u}" data-toggle="modal" data-target="#muc-list-modal">
                    <converse-icon class="fa fa-list-ul right" size="1em"></converse-icon>
            </a>
            <a class="controlbox-heading__btn show-add-muc-modal"
                @click=${t=>r.api.modal.show("converse-add-muc-modal",{model:e.model},t)}
                title="${h}" data-toggle="modal" data-target="#add-chatrooms-modal">
                    <converse-icon class="fa fa-plus right" size="1em"></converse-icon>
            </a>
        </div>

        <div class="list-container list-container--openrooms ${a.length?"":"hidden"}">
            <div class="items-list rooms-list open-rooms-list ${m?"collapsed":""}">
                ${a.map((t=>c(e,t)))}
            </div>
        </div>`}},"./src/plugins/roomslist/view.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{RoomsList:()=>u});s("./src/plugins/muc-views/modals/muc-details.js");var n=s("./src/plugins/roomslist/model.js"),r=s("./src/plugins/roomslist/templates/roomslist.js"),o=s("./src/shared/components/element.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/headless/utils/storage.js");const{Strophe:c,u:d}=a.converse.env;class u extends o.CustomElement{initialize(){const e=`converse.roomspanel${a._converse.bare_jid}`;this.model=new n.default({id:e}),(0,l.initStorage)(this.model,e),this.model.fetch(),this.listenTo(a._converse.chatboxes,"add",this.renderIfChatRoom),this.listenTo(a._converse.chatboxes,"remove",this.renderIfChatRoom),this.listenTo(a._converse.chatboxes,"destroy",this.renderIfChatRoom),this.listenTo(a._converse.chatboxes,"change",this.renderIfRelevantChange),this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.requestUpdate()}render(){return(0,r.default)(this)}renderIfChatRoom(e){d.isChatRoom(e)&&this.requestUpdate()}renderIfRelevantChange(e){const t=["bookmarked","hidden","name","num_unread","num_unread_general","has_activity"],s=e.changed||{};d.isChatRoom(e)&&Object.keys(s).filter((e=>t.includes(e))).length&&this.requestUpdate()}showRoomDetailsModal(e){const t=e.currentTarget.getAttribute("data-room-jid"),s=a._converse.chatboxes.get(t);e.preventDefault(),a.api.modal.show("converse-muc-details-modal",{model:s},e)}async openRoom(e){e.preventDefault();const t=e.target.textContent,s=e.target.getAttribute("data-room-jid"),n={name:t||c.unescapeNode(c.getNodeFromJid(s))||s};await a.api.rooms.open(s,n,!0)}async closeRoom(e){e.preventDefault();const t=e.currentTarget.getAttribute("data-room-name"),s=e.currentTarget.getAttribute("data-room-jid");if(await a.api.confirm((0,i.__)("Are you sure you want to leave the groupchat %1$s?",t))){(await a.api.rooms.get(s)).close()}}toggleRoomsList(e){e?.preventDefault?.();const t=this.querySelector(".open-rooms-list");this.model.get("toggle_state")===a._converse.CLOSED?d.slideOut(t).then((()=>this.model.save({toggle_state:a._converse.OPENED}))):d.slideIn(t).then((()=>this.model.save({toggle_state:a._converse.CLOSED})))}}a.api.elements.define("converse-rooms-list",u)},"./src/plugins/rootview/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/plugins/rootview/root.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/plugins/rootview/utils.js");r.converse.plugins.add("converse-rootview",{initialize(){r.api.settings.extend({auto_insert:!0,theme:"classic",dark_theme:"dracula"}),r.api.listen.on("chatBoxesInitialized",o.ensureElement),r.api.elements.define("converse-root",n.default)}})},"./src/plugins/rootview/root.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/rootview/templates/root.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/shared/settings/utils.js"),a=s("./src/plugins/rootview/utils.js");s("./src/plugins/rootview/styles/root.scss");class l extends o.CustomElement{render(){return(0,n.default)()}initialize(){this.setAttribute("id","conversejs"),this.setClasses();const e=(0,i.getAppSettings)();this.listenTo(e,"change:view_mode",(()=>this.setClasses())),this.listenTo(e,"change:singleton",(()=>this.setClasses())),window.matchMedia("(prefers-color-scheme: dark)").addListener((()=>this.setClasses())),window.matchMedia("(prefers-color-scheme: light)").addListener((()=>this.setClasses()))}setClasses(){this.className="",this.classList.add("conversejs"),this.classList.add(`converse-${r.api.settings.get("view_mode")}`),this.classList.add(`theme-${(0,a.getTheme)()}`),this.requestUpdate()}}},"./src/plugins/rootview/templates/root.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});s("./src/shared/components/font-awesome.js");var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/index.js");const o=()=>{const e=n.api.settings.get("singleton")?["converse-singleton"]:[];return e.push(`converse-${n.api.settings.get("view_mode")}`),r.html`
        <converse-chats class="converse-chatboxes row no-gutters ${e.join(" ")}"></converse-chats>
        <div id="converse-modals" class="modals"></div>
        <converse-fontawesome></converse-fontawesome>
    `}},"./src/plugins/rootview/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ensureElement:()=>o,getTheme:()=>r});var n=s("./src/headless/dist/converse-headless.js");function r(){return window.matchMedia("(prefers-color-scheme: dark)").matches?n.api.settings.get("dark_theme"):n.api.settings.get("theme")}function o(){if(!n.api.settings.get("auto_insert"))return;const e=n.api.settings.get("root");if(!e.querySelector("converse-root")){const t=document.createElement("converse-root"),s=e.querySelector("body");s?s.appendChild(t):e.appendChild(t)}}},"./src/plugins/rosterview/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{STATUSES:()=>r});var n=s("./src/i18n/index.js");const r={dnd:(0,n.__)("This contact is busy"),online:(0,n.__)("This contact is online"),offline:(0,n.__)("This contact is offline"),unavailable:(0,n.__)("This contact is unavailable"),xa:(0,n.__)("This contact is away for an extended period"),away:(0,n.__)("This contact is away")}},"./src/plugins/rosterview/contactview.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/plugins/rosterview/templates/requesting_contact.js"),r=s("./src/plugins/rosterview/templates/roster_item.js"),o=s("./src/shared/components/element.js"),i=s("./src/i18n/index.js"),a=s("./src/headless/dist/converse-headless.js");class l extends o.CustomElement{static get properties(){return{model:{type:Object}}}initialize(){this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.listenTo(this.model,"highlight",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:add",(()=>this.requestUpdate())),this.listenTo(this.model,"vcard:change",(()=>this.requestUpdate())),this.listenTo(this.model,"presenceChanged",(()=>this.requestUpdate()))}render(){if(!0===this.model.get("requesting")){const e=this.model.getDisplayName();return(0,n.default)(Object.assign(this.model.toJSON(),{display_name:e,openChat:e=>this.openChat(e),acceptRequest:e=>this.acceptRequest(e),declineRequest:e=>this.declineRequest(e),desc_accept:(0,i.__)("Click to accept the contact request from %1$s",e),desc_decline:(0,i.__)("Click to decline the contact request from %1$s",e)}))}return(0,r.default)(this,this.model)}openChat(e){e?.preventDefault?.(),this.model.openChat()}async removeContact(e){if(e?.preventDefault?.(),!a.api.settings.get("allow_contact_removal"))return;if(await a.api.confirm((0,i.__)("Are you sure you want to remove this contact?")))try{this.model.removeFromRoster(),this.model.collection&&this.model.destroy()}catch(e){a.log.error(e),a.api.alert("error",(0,i.__)("Error"),[(0,i.__)("Sorry, there was an error while trying to remove %1$s as a contact.",this.model.getDisplayName())])}}async acceptRequest(e){e?.preventDefault?.(),await a._converse.roster.sendContactAddIQ(this.model.get("jid"),this.model.getFullname(),[]),this.model.authorize().subscribe()}async declineRequest(e){e&&e.preventDefault&&e.preventDefault();return await a.api.confirm((0,i.__)("Are you sure you want to decline this contact request?"))&&this.model.unauthorize().destroy(),this}}a.api.elements.define("converse-roster-contact",l)},"./src/plugins/rosterview/filterview.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{RosterFilterView:()=>l});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/plugins/rosterview/templates/roster_filter.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/utils/html.js");class l extends o.CustomElement{async initialize(){await i.api.waitUntil("rosterInitialized"),this.model=i._converse.roster_filter,this.liveFilter=(0,n.default)((()=>{this.model.save({filter_text:this.querySelector(".roster-filter").value})}),250),this.listenTo(i._converse,"rosterContactsFetched",(()=>this.requestUpdate())),this.listenTo(i._converse.presences,"change:show",(()=>this.requestUpdate())),this.listenTo(i._converse.roster,"add",(()=>this.requestUpdate())),this.listenTo(i._converse.roster,"destroy",(()=>this.requestUpdate())),this.listenTo(i._converse.roster,"remove",(()=>this.requestUpdate())),this.listenTo(this.model,"change",this.dispatchUpdateEvent),this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.requestUpdate()}render(){return this.model?(0,r.default)(Object.assign(this.model.toJSON(),{visible:this.shouldBeVisible(),changeChatStateFilter:e=>this.changeChatStateFilter(e),changeTypeFilter:e=>this.changeTypeFilter(e),clearFilter:e=>this.clearFilter(e),liveFilter:e=>this.liveFilter(e),submitFilter:e=>this.submitFilter(e)})):""}dispatchUpdateEvent(){this.dispatchEvent(new CustomEvent("update",{detail:this.model.changed}))}changeChatStateFilter(e){e&&e.preventDefault(),this.model.save({chat_state:this.querySelector(".state-type").value})}changeTypeFilter(e){e&&e.preventDefault();const t=(0,a.ancestor)(e.target,"converse-icon")?.dataset.type||"contacts";"state"===t?this.model.save({filter_type:t,chat_state:this.querySelector(".state-type").value}):this.model.save({filter_type:t,filter_text:this.querySelector(".roster-filter").value})}submitFilter(e){e&&e.preventDefault(),this.liveFilter()}isActive(){return"state"===this.model.get("filter_type")||this.model.get("filter_text")}shouldBeVisible(){return i._converse.roster?.length>=5||this.isActive()}clearFilter(e){e&&e.preventDefault(),this.model.save({filter_text:""})}}i.api.elements.define("converse-roster-filter",l)},"./src/plugins/rosterview/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/plugins/modal/index.js"),s("./src/headless/plugins/chatboxes/index.js"),s("./src/headless/plugins/roster/index.js"),s("./src/plugins/rosterview/modals/add-contact.js"),s("./src/plugins/rosterview/rosterview.js");var n=s("./src/plugins/rosterview/contactview.js"),r=s("./src/headless/plugins/roster/filter.js"),o=s("./src/plugins/rosterview/filterview.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/plugins/rosterview/utils.js");s("./src/shared/styles/status.scss"),s("./src/plugins/rosterview/styles/roster.scss");i.converse.plugins.add("converse-rosterview",{dependencies:["converse-roster","converse-modal","converse-chatboxviews"],initialize(){i.api.settings.extend({autocomplete_add_contact:!0,allow_contact_removal:!0,hide_offline_users:!1,roster_groups:!0,xhr_user_search_url:null}),i.api.promises.add("rosterViewInitialized"),i._converse.RosterFilter=r.RosterFilter,i._converse.RosterFilterView=o.RosterFilterView,i._converse.RosterContactView=n.default,i.api.listen.on("chatBoxesInitialized",(()=>{i._converse.chatboxes.on("destroy",(e=>(0,a.highlightRosterItem)(e))),i._converse.chatboxes.on("change:hidden",(e=>(0,a.highlightRosterItem)(e)))})),i.api.listen.on("afterTearDown",(()=>i._converse.rotergroups?.off().reset()))}})},"./src/plugins/rosterview/modals/add-contact.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});s("./src/shared/autocomplete/index.js");var n=s("./src/plugins/modal/modal.js"),r=s("./src/headless/shared/api/index.js"),o=s("./node_modules/lodash-es/debounce.js"),i=s("./src/plugins/rosterview/modals/templates/add-contact.js"),a=s("./node_modules/strophe.js/src/index.js"),l=s("./src/i18n/index.js"),c=s("./src/headless/dist/converse-headless.js"),d=s("./src/utils/html.js");class u extends n.default{initialize(){super.initialize(),this.listenTo(this.model,"change",(()=>this.render())),this.render(),this.addEventListener("shown.bs.modal",(()=>this.querySelector('input[name="jid"]')?.focus()),!1)}renderModal(){return(0,i.default)(this)}getModalTitle(){return(0,l.__)("Add a Contact")}afterRender(){"string"==typeof r.default.settings.get("xhr_user_search_url")?this.initXHRAutoComplete():this.initJIDAutoComplete()}initJIDAutoComplete(){if(!r.default.settings.get("autocomplete_add_contact"))return;const e=this.querySelector(".suggestion-box__jid").parentElement;this.jid_auto_complete=new c._converse.AutoComplete(e,{data:(e,t)=>`${t.slice(0,t.indexOf("@"))}@${e}`,filter:c._converse.FILTER_STARTSWITH,list:[...new Set(c._converse.roster.map((e=>a.Strophe.getDomainFromJid(e.get("jid")))))]})}initGroupAutoComplete(){if(!r.default.settings.get("autocomplete_add_contact"))return;const e=this.querySelector(".suggestion-box__jid").parentElement;this.jid_auto_complete=new c._converse.AutoComplete(e,{data:(e,t)=>`${t.slice(0,t.indexOf("@"))}@${e}`,filter:c._converse.FILTER_STARTSWITH,list:[...new Set(c._converse.roster.map((e=>a.Strophe.getDomainFromJid(e.get("jid")))))]})}initXHRAutoComplete(){if(!r.default.settings.get("autocomplete_add_contact"))return this.initXHRFetch();const e=this.querySelector(".suggestion-box__name").parentElement;this.name_auto_complete=new c._converse.AutoComplete(e,{auto_evaluate:!1,filter:c._converse.FILTER_STARTSWITH,list:[]});const t=new window.XMLHttpRequest;t.onload=()=>{if(t.responseText){const e=t.responseText;this.name_auto_complete.list=JSON.parse(e).map((e=>({label:e.fullname||e.jid,value:e.jid}))),this.name_auto_complete.auto_completing=!0,this.name_auto_complete.evaluate()}};const s=this.querySelector('input[name="name"]');s.addEventListener("input",(0,o.default)((()=>{t.open("GET",`${r.default.settings.get("xhr_user_search_url")}q=${encodeURIComponent(s.value)}`,!0),t.send()}),300)),this.name_auto_complete.on("suggestion-box-selectcomplete",(e=>{this.querySelector('input[name="name"]').value=e.text.label,this.querySelector('input[name="jid"]').value=e.text.value}))}initXHRFetch(){this.xhr=new window.XMLHttpRequest,this.xhr.onload=()=>{if(this.xhr.responseText){const e=this.xhr.responseText,t=JSON.parse(e).map((e=>({label:e.fullname||e.jid,value:e.jid})));if(1!==t.length){const e=this.querySelector(".invalid-feedback");return e.textContent=(0,l.__)("Sorry, could not find a contact with that name"),void(0,d.addClass)("d-block",e)}const s=t[0].value;if(this.validateSubmission(s)){const e=this.querySelector("form"),n=t[0].label;this.afterSubmission(e,s,n)}}}}validateSubmission(e){const t=this.querySelector(".invalid-feedback");return!e||e.split("@").filter((e=>!!e)).length<2?((0,d.addClass)("is-invalid",this.querySelector('input[name="jid"]')),(0,d.addClass)("d-block",t),!1):c._converse.roster.get(a.Strophe.getBareJidFromJid(e))?(t.textContent=(0,l.__)("This contact has already been added"),(0,d.addClass)("d-block",t),!1):((0,d.removeClass)("d-block",t),!0)}afterSubmission(e,t,s,n){n&&!Array.isArray(n)&&(n=[n]),c._converse.roster.addAndSubscribe(t,s,n),this.model.clear(),this.modal.hide()}addContactFromForm(e){e.preventDefault();const t=new FormData(e.target),s=(t.get("jid")||"").trim();if(!s&&"string"==typeof r.default.settings.get("xhr_user_search_url")){const e=this.querySelector('input[name="name"]');return this.xhr.open("GET",`${r.default.settings.get("xhr_user_search_url")}q=${encodeURIComponent(e.value)}`,!0),void this.xhr.send()}this.validateSubmission(s)&&this.afterSubmission(e.target,s,t.get("name"),t.get("group"))}}r.default.elements.define("converse-add-contact-modal",u)},"./src/plugins/rosterview/modals/templates/add-contact.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/headless/plugins/roster/utils.js"),i=s("./node_modules/lit/index.js");const a=e=>{const t=(0,n.__)("Add"),s=(0,n.__)("name@example.org"),a=(0,n.__)("Please enter a valid XMPP address"),l=(0,n.__)("Group"),c=(0,n.__)("Name"),d=(0,n.__)("XMPP Address");return i.html`
        <form class="converse-form add-xmpp-contact" @submit=${t=>e.addContactFromForm(t)}>
            <div class="modal-body">
                <span class="modal-alert"></span>
                <div class="form-group add-xmpp-contact__jid">
                    <label class="clearfix" for="jid">${d}:</label>
                    <div class="suggestion-box suggestion-box__jid">
                        <ul class="suggestion-box__results suggestion-box__results--below" hidden=""></ul>
                        <input type="text" name="jid" ?required=${!r.api.settings.get("xhr_user_search_url")}
                            value="${e.model.get("jid")||""}"
                            class="form-control suggestion-box__input"
                            placeholder="${s}"/>
                        <span class="suggestion-box__additions visually-hidden" role="status" aria-live="assertive" aria-relevant="additions"></span>
                    </div>
                </div>

                <div class="form-group add-xmpp-contact__name">
                    <label class="clearfix" for="name">${c}:</label>
                    <div class="suggestion-box suggestion-box__name">
                        <ul class="suggestion-box__results suggestion-box__results--above" hidden=""></ul>
                        <input type="text" name="name" value="${e.model.get("nickname")||""}"
                            class="form-control suggestion-box__input"/>
                        <span class="suggestion-box__additions visually-hidden" role="status" aria-live="assertive" aria-relevant="additions"></span>
                    </div>
                </div>
                <div class="form-group add-xmpp-contact__group">
                    <label class="clearfix" for="name">${l}:</label>
                    <converse-autocomplete .list=${(0,o.getGroupsAutoCompleteList)()} name="group"></converse-autocomplete>
                </div>
                <div class="form-group"><div class="invalid-feedback">${a}</div></div>
                <button type="submit" class="btn btn-primary">${t}</button>
            </div>
        </form>`}},"./src/plugins/rosterview/rosterview.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/rosterview/templates/roster.js"),r=s("./src/shared/components/element.js"),o=s("./node_modules/@converse/skeletor/src/model.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/storage.js"),l=s("./src/utils/html.js");class c extends r.CustomElement{async initialize(){const e=`converse.contacts-panel${i._converse.bare_jid}`;this.model=new o.Model({id:e}),(0,a.initStorage)(this.model,e),this.model.fetch(),await i.api.waitUntil("rosterInitialized");const{chatboxes:t,presences:s,roster:n}=i._converse;this.listenTo(i._converse,"rosterContactsFetched",(()=>this.requestUpdate())),this.listenTo(s,"change:show",(()=>this.requestUpdate())),this.listenTo(t,"change:hidden",(()=>this.requestUpdate())),this.listenTo(n,"add",(()=>this.requestUpdate())),this.listenTo(n,"destroy",(()=>this.requestUpdate())),this.listenTo(n,"remove",(()=>this.requestUpdate())),this.listenTo(n,"change",(()=>this.requestUpdate())),this.listenTo(n.state,"change",(()=>this.requestUpdate())),this.listenTo(this.model,"change",(()=>this.requestUpdate())),i.api.trigger("rosterViewInitialized")}render(){return(0,n.default)(this)}showAddContactModal(e){i.api.modal.show("converse-add-contact-modal",{model:new o.Model},e)}async syncContacts(e){e.preventDefault();const{roster:t}=i._converse;this.syncing_contacts=!0,this.requestUpdate(),t.data.save("version",null),await t.fetchFromServer(),i.api.user.presence.send(),this.syncing_contacts=!1,this.requestUpdate()}toggleRoster(e){e?.preventDefault?.();const t=this.querySelector(".list-container.roster-contacts");this.model.get("toggle_state")===i._converse.CLOSED?(0,l.slideOut)(t).then((()=>this.model.save({toggle_state:i._converse.OPENED}))):(0,l.slideIn)(t).then((()=>this.model.save({toggle_state:i._converse.CLOSED})))}}i.api.elements.define("converse-roster",c)},"./src/plugins/rosterview/templates/group.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});s("./src/shared/components/icons.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/headless/utils/core.js"),a=s("./node_modules/lit/directives/repeat.js"),l=s("./src/plugins/rosterview/utils.js");const{u:c}=r.converse.env;function d(e){const t=e.get("jid"),s=[];if((0,i.isUniView)()){const e=r._converse.chatboxes.get(t);e&&!e.get("hidden")&&s.push("open")}const n=e.get("ask"),a=e.get("requesting"),l=e.get("subscription");return"subscribe"===n||"from"===l?s.push("pending-xmpp-contact"):!0===a?s.push("requesting-xmpp-contact"):("both"===l||"to"===l||c.isSameBareJID(t,r._converse.connection.jid))&&(s.push("current-xmpp-contact"),s.push(l),s.push(e.presence.get("show"))),o.html`
        <li class="list-item d-flex controlbox-padded ${s.join(" ")}" data-status="${e.presence.get("show")}">
            <converse-roster-contact .model=${e}></converse-roster-contact>
        </li>`}const u=e=>{const t=(0,n.__)("Click to hide these contacts"),s=r._converse.roster.state.get("collapsed_groups");return o.html`
        <div class="roster-group" data-group="${e.name}">
            <a href="#" class="list-toggle group-toggle controlbox-padded" title="${t}" @click=${t=>(0,l.toggleGroup)(t,e.name)}>
                <converse-icon color="var(--chat-head-color-dark)" size="1em" class="fa ${s.includes(e.name)?"fa-caret-right":"fa-caret-down"}"></converse-icon> ${e.name}
            </a>
            <ul class="items-list roster-group-contacts ${s.includes(e.name)?"collapsed":""}" data-group="${e.name}">
                ${(0,a.repeat)(e.contacts,(e=>e.get("jid")),d)}
            </ul>
        </div>`}},"./src/plugins/rosterview/templates/requesting_contact.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
   <a class="open-chat w-100" href="#" @click=${e.openChat}>
      <span class="req-contact-name w-100" title="JID: ${e.jid}">${e.display_name}</span>
   </a>
   <a class="accept-xmpp-request list-item-action list-item-action--visible"
      @click=${e.acceptRequest}
      aria-label="${e.desc_accept}" title="${e.desc_accept}" href="#">

      <converse-icon class="fa fa-check" size="1em"></converse-icon>
   </a>

   <a class="decline-xmpp-request list-item-action list-item-action--visible"
      @click=${e.declineRequest}
      aria-label="${e.desc_decline}" title="${e.desc_decline}" href="#">

      <converse-icon class="fa fa-times" size="1em"></converse-icon>
   </a>`},"./src/plugins/rosterview/templates/roster.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/plugins/rosterview/templates/group.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/plugins/roster/utils.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/repeat.js"),c=s("./src/plugins/rosterview/utils.js");const d=e=>{const t=(0,r.__)("Contacts"),s=(0,r.__)("Click to toggle contacts"),d=(0,r.__)("Add a contact"),u=(0,r.__)("Re-sync your contacts"),h=(o._converse.roster||[]).reduce(((e,t)=>(0,c.populateContactsMap)(e,t)),{}),f=Object.keys(h).filter(c.shouldShowGroup),m=e.model.get("toggle_state")===o._converse.CLOSED;return f.sort(i.groupsComparator),a.html`
        <div class="d-flex controlbox-padded">
            <span class="w-100 controlbox-heading controlbox-heading--contacts">
                <a class="list-toggle open-contacts-toggle" title="${s}" @click=${e.toggleRoster}>
                    <converse-icon
                        class="fa ${m?"fa-caret-right":"fa-caret-down"}"
                        size="1em"
                        color="var(--chat-color)"></converse-icon>
                    ${t}
                </a>
            </span>
            <a class="controlbox-heading__btn sync-contacts"
               @click=${t=>e.syncContacts(t)}
               title="${u}">

                <converse-icon class="fa fa-sync right ${e.syncing_contacts?"fa-spin":""}" size="1em"></converse-icon>
            </a>
            ${o.api.settings.get("allow_contact_requests")?a.html`
                <a class="controlbox-heading__btn add-contact"
                    @click=${t=>e.showAddContactModal(t)}
                    title="${d}"
                    data-toggle="modal"
                    data-target="#add-contact-modal">
                    <converse-icon class="fa fa-user-plus right" size="1.25em"></converse-icon>
                </a>`:""}
        </div>

        <div class="list-container roster-contacts ${m?"hidden":""}">
            <converse-roster-filter @update=${()=>e.requestUpdate()}></converse-roster-filter>
            ${(0,l.repeat)(f,(e=>e),(e=>{const t=h[e].filter((t=>(0,c.shouldShowContact)(t,e)));return t.sort(i.contactsComparator),t.length?(0,n.default)({contacts:t,name:e}):""}))}
        </div>
    `}},"./src/plugins/rosterview/templates/roster_filter.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/i18n/index.js");const o=e=>{const t=(0,r.__)("Filter"),s=(0,r.__)("Filter by contact name"),o=(0,r.__)("Filter by group name"),i=(0,r.__)("Filter by status"),a=(0,r.__)("Any"),l=(0,r.__)("Unread"),c=(0,r.__)("Online"),d=(0,r.__)("Chatty"),u=(0,r.__)("Busy"),h=(0,r.__)("Away"),f=(0,r.__)("Extended Away"),m=(0,r.__)("Offline");return n.html`
        <form class="controlbox-padded roster-filter-form input-button-group ${e.visible?"fade-in":"hidden"}"
            @submit=${e.submitFilter}>
            <div class="form-inline flex-nowrap">
                <div class="filter-by d-flex flex-nowrap">
                    <converse-icon size="1em" @click=${e.changeTypeFilter} class="fa fa-user clickable ${"contacts"===e.filter_type?"selected":""}" data-type="contacts" title="${s}"></converse-icon>
                    <converse-icon size="1em" @click=${e.changeTypeFilter} class="fa fa-users clickable ${"groups"===e.filter_type?"selected":""}" data-type="groups" title="${o}"></converse-icon>
                    <converse-icon size="1em" @click=${e.changeTypeFilter} class="fa fa-circle clickable ${"state"===e.filter_type?"selected":""}" data-type="state" title="${i}"></converse-icon>
                </div>
                <div class="btn-group">
                    <input .value="${e.filter_text||""}"
                        @keydown=${e.liveFilter}
                        class="roster-filter form-control ${"state"===e.filter_type?"hidden":""}"
                        placeholder="${t}"/>
                    <converse-icon size="1em" class="fa fa-times clear-input ${e.filter_text&&"state"!==e.filter_type?"":"hidden"}"
                        @click=${e.clearFilter}>
                    </converse-icon>
                </div>
                <select class="form-control state-type ${"state"!==e.filter_type?"hidden":""}"
                        @change=${e.changeChatStateFilter}>
                    <option value="">${a}</option>
                    <option ?selected=${"unread_messages"===e.chat_state} value="unread_messages">${l}</option>
                    <option ?selected=${"online"===e.chat_state} value="online">${c}</option>
                    <option ?selected=${"chat"===e.chat_state} value="chat">${d}</option>
                    <option ?selected=${"dnd"===e.chat_state} value="dnd">${u}</option>
                    <option ?selected=${"away"===e.chat_state} value="away">${h}</option>
                    <option ?selected=${"xa"===e.chat_state} value="xa">${f}</option>
                    <option ?selected=${"offline"===e.chat_state} value="offline">${m}</option>
                </select>
            </div>
        </form>`}},"./src/plugins/rosterview/templates/roster_item.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/plugins/rosterview/constants.js");const a=(e,t)=>{const s=t.presence.get("show")||"offline";let a,l;[a,l]="online"===s?["fa fa-circle","chat-status-online"]:"dnd"===s?["fa fa-minus-circle","chat-status-busy"]:"away"===s?["fa fa-circle","chat-status-away"]:["fa fa-circle","subdued-color"];const c=i.STATUSES[s],d=t.get("num_unread")||0,u=t.getDisplayName(),h=(0,n.__)("Click to chat with %1$s (XMPP address: %2$s)",u,e.model.get("jid"));return o.html`
   <a class="list-item-link cbox-list-item open-chat ${d?"unread-msgs":""}" title="${h}" href="#" @click=${e.openChat}>
      <span>
         <converse-avatar
            class="avatar"
            .data=${e.model.vcard?.attributes}
            nonce=${e.model.vcard?.get("vcard_updated")}
            height="30" width="30"></converse-avatar>
         <converse-icon
            title="${c}"
            color="var(--${l})"
            size="1em"
            class="${a} chat-status chat-status--avatar"></converse-icon>
      </span>
      ${d?o.html`<span class="msgs-indicator">${d}</span>`:""}
      <span class="contact-name contact-name--${e.show} ${d?"unread-msgs":""}">${u}</span>
   </a>
   ${r.api.settings.get("allow_contact_removal")?((e,t)=>{const s=t.getDisplayName(),r=(0,n.__)("Click to remove %1$s as a contact",s);return o.html`
      <a class="list-item-action remove-xmpp-contact" @click=${e.removeContact} title="${r}" href="#">
         <converse-icon class="fa fa-trash-alt" size="1.5em"></converse-icon>
      </a>
   `})(e,t):""}`}},"./src/plugins/rosterview/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{highlightRosterItem:()=>i,isContactFiltered:()=>l,populateContactsMap:()=>u,removeContact:()=>o,shouldShowContact:()=>c,shouldShowGroup:()=>d,toggleGroup:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js");function o(e){e.removeFromRoster((()=>e.destroy()),(t=>{t&&r.log.error(t),r.api.alert("error",(0,n.__)("Error"),[(0,n.__)("Sorry, there was an error while trying to remove %1$s as a contact.",e.getDisplayName())])}))}function i(e){r._converse.roster?.get(e.get("jid"))?.trigger("highlight")}function a(e,t){e?.preventDefault?.();const s=r._converse.roster.state.get("collapsed_groups");s.includes(t)?r._converse.roster.state.save("collapsed_groups",s.filter((e=>e!==t))):r._converse.roster.state.save("collapsed_groups",[...s,t])}function l(e,t){const s=r._converse.roster_filter,n=s.get("filter_type"),o="state"===n?s.get("chat_state").toLowerCase():s.get("filter_text").toLowerCase();if(!o)return!1;if("state"===n){return![r._converse.HEADER_REQUESTING_CONTACTS,r._converse.HEADER_UNREAD].includes(t)&&("unread_messages"===o?0===e.get("num_unread"):"online"===o?["offline","unavailable"].includes(e.presence.get("show")):!e.presence.get("show").includes(o))}return"contacts"===n?!e.getFilterCriteria().includes(o):void 0}function c(e,t){const s=e.presence.get("show");return r.api.settings.get("hide_offline_users")&&"offline"===s?("subscribe"===e.get("ask")||"from"===e.get("subscription")||!0===e.get("requesting"))&&!l(e,t):!l(e,t)}function d(e){const t=r._converse.roster_filter;if("groups"===t.get("filter_type")){const s=t.get("filter_text")?.toLowerCase();if(!s)return!0;if(!e.toLowerCase().includes(s))return!1}return!0}function u(e,t){if(t.get("requesting")){const s=r._converse.HEADER_REQUESTING_CONTACTS;e[s]?e[s].push(t):e[s]=[t]}else{let s;r.api.settings.get("roster_groups")?(s=t.get("groups"),s=0===s.length?[r._converse.HEADER_UNGROUPED]:s):s="subscribe"===t.get("ask")?[r._converse.HEADER_PENDING_CONTACTS]:[r._converse.HEADER_CURRENT_CONTACTS];for(const n of s)e[n]?e[n].push(t):e[n]=[t]}if(t.get("num_unread")){const s=r._converse.HEADER_UNREAD;e[s]?e[s].push(t):e[s]=[t]}return e}},"./src/plugins/singleton/index.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/dist/converse-headless.js");s("./src/plugins/singleton/singleton.scss");n.converse.plugins.add("converse-singleton",{enabled:e=>e.api.settings.get("singleton"),initialize(){n.api.settings.extend({allow_logout:!1,allow_muc_invitations:!1,hide_muc_server:!0});const e=n.api.settings.get("auto_join_rooms"),t=n.api.settings.get("auto_join_private_chats");if(!Array.isArray(e)&&!Array.isArray(t))throw new Error("converse-singleton: auto_join_rooms must be an Array");if(0===e.length&&0===t.length)throw new Error("If you set singleton set to true, you need to specify auto_join_rooms or auto_join_private_chats");if(e.length>0&&t.length>0)throw new Error("It doesn't make sense to have singleton set to true and auto_join_rooms or auto_join_private_chats set to more then one, since only one chat room may be open at any time.")}})},"./src/shared/autocomplete/autocomplete.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AutoComplete:()=>l,default:()=>c});var n=s("./node_modules/@converse/skeletor/src/events.js"),r=s("./src/shared/autocomplete/utils.js"),o=s("./src/shared/autocomplete/suggestion.js"),i=s("./src/headless/dist/converse-headless.js");const a=i.converse.env.utils;class l{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.suggestions=[],this.is_opened=!1,a.hasClass("suggestion-box",e)?this.container=e:this.container=e.querySelector(".suggestion-box"),this.input=this.container.querySelector(".suggestion-box__input"),this.input.setAttribute("aria-autocomplete","list"),this.ul=this.container.querySelector(".suggestion-box__results"),this.status=this.container.querySelector(".suggestion-box__additions"),Object.assign(this,{match_current_word:!1,ac_triggers:[],include_triggers:[],min_chars:2,max_items:10,auto_evaluate:!0,auto_first:!1,data:e=>e,filter:r.FILTER_CONTAINS,sort:!1!==t.sort&&r.SORT_BY_QUERY_POSITION,item:r.ITEM},t),this.index=-1,this.bindEvents(),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||t.list||[]}bindEvents(){const e={blur:()=>this.close({reason:"blur"})};this.auto_evaluate&&(e.input=e=>this.evaluate(e)),this._events={input:e,form:{submit:()=>this.close({reason:"submit"})},ul:{mousedown:e=>this.onMouseDown(e),mouseover:e=>this.onMouseOver(e)}},r.helpers.bind(this.input,this._events.input),r.helpers.bind(this.input.form,this._events.form),r.helpers.bind(this.ul,this._events.ul)}set list(e){if(Array.isArray(e)||"function"==typeof e)this._list=e;else if("string"==typeof e&&e.includes(","))this._list=e.split(/\s*,\s*/);else{const t=r.helpers.getElement(e)?.children||[];this._list=Array.from(t).filter((e=>!e.disabled)).map((e=>{const t=e.textContent.trim(),s=e.value||t,n=e.label||t;return""!==s?{label:n,value:s}:null})).filter((e=>e))}document.activeElement===this.input&&this.evaluate()}get list(){return this._list}get selected(){return this.index>-1}get opened(){return this.is_opened}close(e){this.opened&&(this.ul.setAttribute("hidden",""),this.is_opened=!1,this.index=-1,this.trigger("suggestion-box-close",e||{}))}insertValue(e){this.match_current_word?a.replaceCurrentWord(this.input,e.value):this.input.value=e.value}open(){this.ul.removeAttribute("hidden"),this.is_opened=!0,this.auto_first&&-1===this.index&&this.goto(0),this.trigger("suggestion-box-open")}destroy(){r.helpers.unbind(this.input,this._events.input),r.helpers.unbind(this.input.form,this._events.form),this.input.removeAttribute("aria-autocomplete")}next(){const e=this.ul.children.length;this.goto(this.index<e-1?this.index+1:e?0:-1)}previous(){const e=this.ul.children.length,t=this.index-1;this.goto(this.selected&&-1!==t?t:e-1)}goto(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=this.ul.children;this.selected&&s[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&s.length>0&&(s[e].setAttribute("aria-selected","true"),s[e].focus(),this.status.textContent=s[e].textContent,t&&(this.ul.scrollTop=s[e].offsetTop-this.ul.clientHeight+s[e].clientHeight),this.trigger("suggestion-box-highlight",{text:this.suggestions[this.index]}))}select(e){if(e?this.index=a.siblingIndex(e):e=this.ul.children[this.index],e){const e=this.suggestions[this.index];this.insertValue(e),this.close({reason:"select"}),this.auto_completing=!1,this.trigger("suggestion-box-selectcomplete",{text:e})}}onMouseOver(e){const t=a.ancestor(e.target,"li");if(t){const e=Array.prototype.slice.call(this.ul.children).indexOf(t);this.goto(e,!1)}}onMouseDown(e){if(0!==e.button)return;const t=a.ancestor(e.target,"li");t&&(e.preventDefault(),this.select(t,e.target))}onKeyDown(e){if(this.opened){if([i.converse.keycodes.ENTER,i.converse.keycodes.TAB].includes(e.keyCode)&&this.selected)return e.preventDefault(),e.stopPropagation(),this.select(),!0;if(e.keyCode===i.converse.keycodes.ESCAPE)return this.close({reason:"esc"}),!0;if([i.converse.keycodes.UP_ARROW,i.converse.keycodes.DOWN_ARROW].includes(e.keyCode))return e.preventDefault(),e.stopPropagation(),this[e.keyCode===i.converse.keycodes.UP_ARROW?"previous":"next"](),!0}if(![i.converse.keycodes.SHIFT,i.converse.keycodes.META,i.converse.keycodes.META_RIGHT,i.converse.keycodes.ESCAPE,i.converse.keycodes.ALT].includes(e.keyCode))if(this.ac_triggers.includes(e.key))"Tab"===e.key&&e.preventDefault(),this.auto_completing=!0;else if("Backspace"===e.key){const t=a.getCurrentWord(e.target,e.target.selectionEnd-1);r.helpers.isMention(t,this.ac_triggers)&&(this.auto_completing=!0)}}async evaluate(e){const t=this.selected&&e&&(e.keyCode===i.converse.keycodes.UP_ARROW||e.keyCode===i.converse.keycodes.DOWN_ARROW);if(!this.auto_evaluate&&!this.auto_completing||t)return;let s=this.match_current_word?a.getCurrentWord(this.input):this.input.value;const n=r.helpers.isMention(s,this.ac_triggers);n&&!this.include_triggers.includes(e.key)&&(s=a.isMentionBoundary(s[0])?s.slice("2"):s.slice("1"));const l=s.length&&s.length>=this.min_chars;if(n||l){this.auto_completing=!0;const e="function"==typeof this._list?await this._list(s):this._list;if(0===e.length||!this.auto_completing)return void this.close({reason:"nomatches"});this.index=-1,this.ul.innerHTML="",this.suggestions=e.map((e=>new o.default(this.data(e,s),s))).filter((e=>this.filter(e,s))),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.max_items),this.suggestions.forEach((e=>this.ul.appendChild(this.item(e,s)))),0===this.ul.children.length?this.close({reason:"nomatches"}):this.open()}else this.close({reason:"nomatches"}),n||(this.auto_completing=!1)}}Object.assign(l.prototype,n.Events);const c=l},"./src/shared/autocomplete/component.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/shared/autocomplete/autocomplete.js"),r=s("./src/shared/components/element.js"),o=s("./src/shared/autocomplete/utils.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js");class l extends r.CustomElement{static get properties(){return{position:{type:String},autofocus:{type:Boolean},getAutoCompleteList:{type:Function},list:{type:Array},auto_evaluate:{type:Boolean},auto_first:{type:Boolean},filter:{type:String},include_triggers:{type:String},min_chars:{type:Number},name:{type:String},placeholder:{type:String},triggers:{type:String},required:{type:Boolean}}}constructor(){super(),this.position="above",this.auto_evaluate=!0,this.auto_first=!1,this.filter="contains",this.include_triggers="",this.match_current_word=!1,this.max_items=10,this.min_chars=1,this.triggers=""}render(){const e=`suggestion-box__results--${this.position}`;return a.html`
            <div class="suggestion-box suggestion-box__name">
                <ul class="suggestion-box__results ${e}" hidden=""></ul>
                <input
                    ?autofocus=${this.autofocus}
                    ?required=${this.required}
                    type="text"
                    name="${this.name}"
                    autocomplete="off"
                    @keydown=${this.onKeyDown}
                    @keyup=${this.onKeyUp}
                    class="form-control suggestion-box__input"
                    placeholder="${this.placeholder}"
                />
                <span
                    class="suggestion-box__additions visually-hidden"
                    role="status"
                    aria-live="assertive"
                    aria-relevant="additions"
                ></span>
            </div>
        `}firstUpdated(){this.auto_complete=new n.default(this.firstElementChild,{ac_triggers:this.triggers.split(" "),auto_evaluate:this.auto_evaluate,auto_first:this.auto_first,filter:"contains"==this.filter?o.FILTER_CONTAINS:o.FILTER_STARTSWITH,include_triggers:[],list:this.list??(e=>this.getAutoCompleteList(e)),match_current_word:!0,max_items:this.max_items,min_chars:this.min_chars}),this.auto_complete.on("suggestion-box-selectcomplete",(()=>this.auto_completing=!1))}onKeyDown(e){this.auto_complete.onKeyDown(e)}onKeyUp(e){this.auto_complete.evaluate(e)}}i.api.elements.define("converse-autocomplete",l)},"./src/shared/autocomplete/index.js":(e,t,s)=>{"use strict";s.r(t);s("./src/shared/autocomplete/component.js");var n=s("./src/shared/autocomplete/autocomplete.js"),r=s("./src/shared/autocomplete/utils.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/shared/autocomplete/styles/_autocomplete.scss");o._converse.FILTER_CONTAINS=r.FILTER_CONTAINS,o._converse.FILTER_STARTSWITH=r.FILTER_STARTSWITH,o._converse.AutoComplete=n.default},"./src/shared/autocomplete/suggestion.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=class extends String{constructor(e,t){super();const s=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};this.label=s.label||s.value,this.value=s.value,this.query=t}get lenth(){return this.label.length}toString(){return""+this.label}valueOf(){return this.toString()}}},"./src/shared/autocomplete/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{FILTER_CONTAINS:()=>i,FILTER_STARTSWITH:()=>a,ITEM:()=>c,SORT_BY_QUERY_POSITION:()=>l,helpers:()=>o});var n=s("./src/headless/dist/converse-headless.js");const r=n.converse.env.utils,o={getElement:(e,t)=>"string"==typeof e?(t||document).querySelector(e):e||null,bind(e,t){if(e)for(var s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;const n=t[s];s.split(/\s+/).forEach((t=>e.addEventListener(t,n)))}},unbind(e,t){if(e)for(var s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;const n=t[s];s.split(/\s+/).forEach((t=>e.removeEventListener(t,n)))}},regExpEscape:e=>e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&"),isMention:(e,t)=>t.includes(e[0])||r.isMentionBoundary(e[0])&&t.includes(e[1])},i=function(e,t){return RegExp(o.regExpEscape(t.trim()),"i").test(e)},a=function(e,t){return RegExp("^"+o.regExpEscape(t.trim()),"i").test(e)},l=function(e,t){const s=e.query.toLowerCase(),n=e.label.toLowerCase().indexOf(s),r=t.label.toLowerCase().indexOf(s);return n===r?function(e,t){return e.length!==t.length?e.length-t.length:e<t?-1:1}(e,t):(-1===n?1/0:n)<(-1===r?1/0:r)?-1:1},c=(e,t)=>{t=t.trim();const s=document.createElement("li");s.setAttribute("aria-selected","false");const n=new RegExp("("+t+")","ig");return(t?e.split(n):[e]).forEach((e=>{if(t&&e.match(n)){const t=document.createElement("mark");t.textContent=e,s.appendChild(t)}else s.appendChild(document.createTextNode(e))})),s}},"./src/shared/avatar/avatar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/components/element.js"),r=s("./src/shared/avatar/templates/avatar.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/shared/avatar/avatar.scss");class i extends n.CustomElement{static get properties(){return{data:{type:Object},width:{type:String},height:{type:String},nonce:{type:String}}}constructor(){super(),this.width=36,this.height=36}render(){const e=this.data?.image_type||o._converse.DEFAULT_IMAGE_TYPE;let t;if(this.data?.data_uri)t=this.data?.data_uri;else{t="data:"+e+";base64,"+(this.data?.image||o._converse.DEFAULT_IMAGE)}return(0,r.default)({classes:this.getAttribute("class"),height:this.height,width:this.width,image:t,image_type:e})}}o.api.elements.define("converse-avatar",i)},"./src/shared/avatar/templates/avatar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>{return e.image?n.html`
            <svg xmlns="http://www.w3.org/2000/svg" class="avatar ${e.classes}" width="${e.width}" height="${e.height}">
                <image width="${e.width}" height="${e.height}" preserveAspectRatio="xMidYMid meet" href="${t=e.image,s=e.image_type,t.startsWith("data:")?t:`data:${s};base64,${t}`}"/>
            </svg>`:"";var t,s}},"./src/shared/chat/baseview.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/shared/chat/utils.js");class i extends n.CustomElement{static get properties(){return{jid:{type:String}}}disconnectedCallback(){super.disconnectedCallback(),r._converse.chatboxviews.remove(this.jid,this)}updated(){this.model&&this.jid!==this.model.get("jid")&&(this.stopListening(),r._converse.chatboxviews.remove(this.model.get("jid"),this),delete this.model,this.requestUpdate(),this.initialize())}close(e){return e?.preventDefault?.(),this.model.close(e)}maybeFocus(){r.api.settings.get("auto_focus")&&this.focus()}focus(){const e=this.getElementsByClassName("chat-textarea")[0];return e&&document.activeElement!==e&&e.focus(),this}emitBlurred(e){this.contains(document.activeElement)||this.contains(e.relatedTarget)||r.api.trigger("chatBoxBlurred",this,e)}emitFocused(e){this.contains(e.relatedTarget)||r.api.trigger("chatBoxFocused",this,e)}getBottomPanel(){return this.model.get("type")===r._converse.CHATROOMS_TYPE?this.querySelector("converse-muc-bottom-panel"):this.querySelector("converse-chat-bottom-panel")}getMessageForm(){return this.model.get("type")===r._converse.CHATROOMS_TYPE?this.querySelector("converse-muc-message-form"):this.querySelector("converse-message-form")}scrollDown(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.model.ui.get("scrolled")&&this.model.ui.set({scrolled:!1}),(0,o.onScrolledDown)(this.model)}onWindowStateChanged(e){"visible"===e.state?this.model.isHidden()||this.model.clearUnreadMsgCounter():"hidden"===e.state&&(this.model.setChatState(r._converse.INACTIVE,{silent:!0}),this.model.sendChatState())}}},"./src/shared/chat/chat-content.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});s("./src/shared/chat/message-history.js");var n=s("./src/templates/spinner.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js"),a=s("./src/shared/chat/utils.js");s("./src/shared/chat/styles/chat-content.scss");class l extends r.CustomElement{static get properties(){return{jid:{type:String}}}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("scroll",a.markScrolled)}async initialize(){await this.setModels(),this.listenTo(this.model,"change:hidden_occupants",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"add",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"change",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"remove",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"rendered",(()=>this.requestUpdate())),this.listenTo(this.model.messages,"reset",(()=>this.requestUpdate())),this.listenTo(this.model.notifications,"change",(()=>this.requestUpdate())),this.listenTo(this.model.ui,"change",(()=>this.requestUpdate())),this.listenTo(this.model.ui,"change:scrolled",this.scrollDown),this.model.occupants&&this.listenTo(this.model.occupants,"change",(()=>this.requestUpdate())),this.addEventListener("scroll",a.markScrolled)}async setModels(){this.model=await o.api.chatboxes.get(this.jid),await this.model.initialized,this.requestUpdate()}render(){return this.model?i.html`
            <div class="chat-content__notifications">${this.model.getNotificationsText()}</div>
            <converse-message-history
                .model=${this.model}
                .messages=${[...this.model.messages.models]}>
            </converse-message-history>
            ${this.model.ui?.get("chat-content-spinner-top")?(0,n.default)():""}
        `:""}scrollDown(){if(!this.model.ui.get("scrolled")){if(this.scrollTo){const e=this.scrollTop?"smooth":"auto";this.scrollTo({top:0,behavior:e})}else this.scrollTop=0;o.api.trigger("chatBoxScrolledDown",{chatbox:this.model})}}}o.api.elements.define("converse-chat-content",l)},"./src/shared/chat/emoji-dropdown.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/shared/components/dropdown.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js"),a=s("./src/headless/utils/storage.js"),l=s("./node_modules/lit/directives/until.js");const c=o.converse.env.utils;class d extends n.default{static get properties(){return{chatview:{type:Object}}}constructor(){super(),this.render_emojis=!1}initModel(){return this.init_promise||(this.init_promise=(async()=>{await o.api.emojis.initialize();const e=`converse.emoji-${o._converse.bare_jid}-${this.chatview.model.get("jid")}`;this.model=new o._converse.EmojiPicker({id:e}),(0,a.initStorage)(this.model,e),await new Promise((e=>this.model.fetch({success:e,error:e}))),this.model.set({autocompleting:null,ac_position:null})})()),this.init_promise}render(){const e=this.chatview.model.get("type")===o._converse.CHATROOMS_TYPE?"--muc-toolbar-btn-color":"--chat-toolbar-btn-color";return i.html`
            <div class="dropup">
                <button class="toggle-emojis"
                        title="${(0,r.__)("Insert emojis")}"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="false">
                    <converse-icon
                        color="var(${e})"
                        class="fa fa-smile "
                        path-prefix="${o.api.settings.get("assets_path")}"
                        size="1em"></converse-icon>
                </button>
                <div class="dropdown-menu">
                    ${(0,l.until)(this.initModel().then((()=>i.html`
                        <converse-emoji-picker
                                .chatview=${this.chatview}
                                .model=${this.model}
                                @emojiSelected=${()=>this.hideMenu()}
                                ?render_emojis=${this.render_emojis}
                                current_category="${this.model.get("current_category")||""}"
                                current_skintone="${this.model.get("current_skintone")||""}"
                                query="${this.model.get("query")||""}"
                        ></converse-emoji-picker>`)),"")}
                </div>
            </div>`}connectedCallback(){super.connectedCallback(),this.render_emojis=!1}toggleMenu(e){e.stopPropagation(),e.preventDefault(),c.hasClass("show",this.menu)?c.ancestor(e.target,".toggle-emojis")&&this.hideMenu():this.showMenu()}async showMenu(){await this.initModel(),this.render_emojis||(this.render_emojis=!0,this.requestUpdate(),await this.updateComplete),super.showMenu(),setTimeout((()=>this.querySelector(".emoji-search")?.focus()))}}o.api.elements.define("converse-emoji-dropdown",d)},"./src/shared/chat/emoji-picker-content.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/shared/chat/templates/emoji-picker.js"),a=s("./src/shared/chat/utils.js");const{sizzle:l}=r.converse.env;class c extends n.CustomElement{static get properties(){return{chatview:{type:Object},search_results:{type:Array},current_skintone:{type:String},model:{type:Object},query:{type:String}}}render(){const e={current_skintone:this.current_skintone,insertEmoji:e=>this.insertEmoji(e),query:this.query,search_results:this.search_results,shouldBeHidden:e=>this.shouldBeHidden(e)};return o.html`
          <div class="emoji-picker__lists">
              ${(0,i.tplSearchResults)(e)}
              ${(0,i.tplAllEmojis)(e)}
          </div>
      `}firstUpdated(){this.initIntersectionObserver()}initIntersectionObserver(){if(window.IntersectionObserver){if(this.observer)this.observer.disconnect();else{const e={root:this.querySelector(".emoji-picker__lists"),threshold:[.1]},t=e=>this.setCategoryOnVisibilityChange(e);this.observer=new IntersectionObserver(t,e)}l(".emoji-picker",this).forEach((e=>this.observer.observe(e)))}}setCategoryOnVisibilityChange(e){const t=this.parentElement.navigator.selected,s=e.filter((e=>e.target.contains(t))).pop();let n;if(n=s||e.reduce(((e,t)=>t.intersectionRatio>=(e?.intersectionRatio||0)?t:e),null),n&&n.isIntersecting){const e=n.target.getAttribute("data-category");e!==this.model.get("current_category")&&(this.parentElement.preserve_scroll=!0,this.model.save({current_category:e}))}}insertEmoji(e){e.preventDefault(),e.stopPropagation();const t="IMG"===e.target.nodeName?e.target.parentElement:e.target;this.parentElement.insertIntoTextArea(t.getAttribute("data-emoji"))}shouldBeHidden(e){if(e.includes("_tone")){if(!this.current_skintone||!e.includes(this.current_skintone))return!0}else if(this.current_skintone&&(0,a.getTonedEmojis)().includes(e))return!0;return!(!this.query||r._converse.FILTER_CONTAINS(e,this.query))}}r.api.elements.define("converse-emoji-picker-content",c)},"./src/shared/chat/emoji-picker.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});s("./src/shared/chat/emoji-picker-content.js"),s("./src/shared/chat/emoji-dropdown.js");var n=s("./src/shared/dom-navigator.js"),r=s("./node_modules/lodash-es/debounce.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/shared/constants.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/shared/chat/utils.js"),c=s("./src/shared/chat/templates/emoji-picker.js");s("./src/shared/chat/styles/emoji.scss");const d=a.converse.env.utils;class u extends o.CustomElement{static get properties(){return{chatview:{type:Object},current_category:{type:String,reflect:!0},current_skintone:{type:String,reflect:!0},model:{type:Object},query:{type:String,reflect:!0},render_emojis:{type:Boolean}}}firstUpdated(){super.firstUpdated(),this.listenTo(this.model,"change",(e=>this.onModelChanged(e.changed))),this.initArrowNavigation()}constructor(){super(),this.query="",this._search_results=[],this.debouncedFilter=(0,r.default)((e=>this.model.set({query:e.value})),250)}get search_results(){return this._search_results}set search_results(e){this._search_results=e,this.requestUpdate()}render(){return(0,c.tplEmojiPicker)({chatview:this.chatview,current_category:this.current_category,current_skintone:this.current_skintone,model:this.model,onCategoryPicked:e=>this.chooseCategory(e),onSearchInputBlurred:e=>this.chatview.emitFocused(e),onSearchInputFocus:e=>this.onSearchInputFocus(e),onSearchInputKeyDown:e=>this.onSearchInputKeyDown(e),onSkintonePicked:e=>this.chooseSkinTone(e),query:this.query,search_results:this.search_results,render_emojis:this.render_emojis,sn2Emoji:e=>d.shortnamesToEmojis(this.getTonedShortname(e))})}updated(e){e.has("query")&&this.updateSearchResults(e),e.has("current_category")&&this.setScrollPosition()}onModelChanged(e){"current_category"in e&&(this.current_category=e.current_category),"current_skintone"in e&&(this.current_skintone=e.current_skintone),"query"in e&&(this.query=e.query)}setScrollPosition(){if(this.preserve_scroll)return void(this.preserve_scroll=!1);const e=this.querySelector(".emoji-lists__container--browse"),t=this.querySelector(`#emoji-picker-${this.current_category}`);t&&(e.scrollTop=t.offsetTop-3*t.offsetHeight+4)}updateSearchResults(e){const t=e.get("query"),s=a._converse.FILTER_CONTAINS;if(this.query){if(this.query===t)return this.search_results;t&&this.query.includes(t)?this.search_results=this.search_results.filter((e=>s(e.sn,this.query))):this.search_results=a.converse.emojis.list.filter((e=>s(e.sn,this.query)))}else this.search_results.length&&(this.search_results=[])}registerEvents(){this.onGlobalKeyDown=e=>this._onGlobalKeyDown(e);document.querySelector("body").addEventListener("keydown",this.onGlobalKeyDown)}connectedCallback(){super.connectedCallback(),this.registerEvents()}disconnectedCallback(){document.querySelector("body").removeEventListener("keydown",this.onGlobalKeyDown),this.disableArrowNavigation(),super.disconnectedCallback()}_onGlobalKeyDown(e){this.navigator&&(e.keyCode===i.KEYCODES.ENTER&&d.isVisible(this)?this.onEnterPressed(e):e.keyCode===i.KEYCODES.DOWN_ARROW&&!this.navigator.enabled&&d.isVisible(this)?this.enableArrowNavigation(e):e.keyCode===i.KEYCODES.ESCAPE&&(this.disableArrowNavigation(),setTimeout((()=>this.chatview.querySelector(".chat-textarea").focus()),50)))}setCategoryForElement(e){const t=this.current_category,s=e?.getAttribute("data-category")||t;t!==s&&this.model.save({current_category:s})}insertIntoTextArea(e){const t=this.model.get("autocompleting"),s=this.model.get("ac_position");this.model.set({autocompleting:null,query:"",ac_position:null}),this.disableArrowNavigation();const n={bubbles:!0,detail:{value:e,autocompleting:t,ac_position:s,jid:this.chatview.model.get("jid")}};this.dispatchEvent(new CustomEvent("emojiSelected",n))}chooseSkinTone(e){e.preventDefault(),e.stopPropagation();const t=("IMG"===e.target.nodeName?e.target.parentElement:e.target).getAttribute("data-skintone").trim();this.current_skintone===t?this.model.save({current_skintone:""}):this.model.save({current_skintone:t})}chooseCategory(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();const t=e.target.matches("li")?e.target:d.ancestor(e.target,"li");this.setCategoryForElement(t),this.navigator.select(t),!this.navigator.enabled&&this.navigator.enable()}onSearchInputKeyDown(e){if(e.keyCode===i.KEYCODES.TAB)if(e.target.value){e.preventDefault();const t=a.converse.emojis.shortnames.find((t=>a._converse.FILTER_CONTAINS(t,e.target.value)));t&&this.model.set({query:t})}else this.navigator.enabled||this.enableArrowNavigation(e);else e.keyCode!==i.KEYCODES.DOWN_ARROW||this.navigator.enabled?e.keyCode!==i.KEYCODES.ENTER&&e.keyCode!==i.KEYCODES.DOWN_ARROW&&this.debouncedFilter(e.target):this.enableArrowNavigation(e)}onEnterPressed(e){e.preventDefault(),e.stopPropagation(),a.converse.emojis.shortnames.includes(e.target.value)?this.insertIntoTextArea(e.target.value):1===this.search_results.length?this.insertIntoTextArea(this.search_results[0].sn):this.navigator.selected&&this.navigator.selected.matches(".insert-emoji")?this.insertIntoTextArea(this.navigator.selected.getAttribute("data-emoji")):this.navigator.selected&&this.navigator.selected.matches(".emoji-category")&&this.chooseCategory({target:this.navigator.selected})}onSearchInputFocus(e){this.chatview.emitBlurred(e),this.disableArrowNavigation()}getTonedShortname(e){return(0,l.getTonedEmojis)().includes(e)&&this.current_skintone?`${e.slice(0,e.length-1)}_${this.current_skintone}:`:e}initArrowNavigation(){if(!this.navigator){const e="li:not(.hidden):not(.emoji-skintone), .emoji-search",t={jump_to_picked:".emoji-category",jump_to_picked_selector:".emoji-category.picked",jump_to_picked_direction:n.default.DIRECTION.down,picked_selector:".picked",scroll_container:this.querySelector(".emoji-picker__lists"),getSelector:t=>{if(t===n.default.DIRECTION.down){const t=this.navigator.selected&&this.navigator.selected.getAttribute("data-category");return t?`ul[data-category="${t}"] li:not(.hidden):not(.emoji-skintone), .emoji-search`:e}return e},onSelected:e=>{e.matches(".insert-emoji")&&this.setCategoryForElement(e.parentElement),e.matches(".insert-emoji, .emoji-category")&&e.firstElementChild.focus(),e.matches(".emoji-search")&&e.focus()}};this.navigator=new n.default(this,t)}}disableArrowNavigation(){this.navigator?.disable()}enableArrowNavigation(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.disableArrowNavigation(),this.navigator.enable(),this.navigator.handleKeydown(e)}}a.api.elements.define("converse-emoji-picker",u)},"./src/shared/chat/help-messages.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});s("./src/shared/components/icons.js");var n=s("./node_modules/dompurify/dist/purify.js"),r=s.n(n),o=s("./src/shared/components/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/unsafe-html.js");class c extends o.CustomElement{static get properties(){return{chat_type:{type:String},messages:{type:Array},model:{type:Object},type:{type:String}}}render(){const e=(new Date).toISOString();return[a.html`<converse-icon class="fas fa-times close-chat-help"
                    @click=${this.close}
                    path-prefix="${i.api.settings.get("assets_path")}"
                    size="1em"></converse-icon>`,...this.messages.map((t=>this.renderHelpMessage({isodate:e,markup:r().sanitize(t,{ALLOWED_TAGS:["strong"]})})))]}close(){this.model.set({show_help_messages:!1})}renderHelpMessage(e){return a.html`<div class="message chat-${this.type}" data-isodate="${e.isodate}">${(0,l.unsafeHTML)(e.markup)}</div>`}}i.api.elements.define("converse-chat-help",c)},"./src/shared/chat/message-actions.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/shared/components/element.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/shared/settings/utils.js"),a=s("./src/headless/shared/chat/utils.js"),l=s("./node_modules/lit/index.js"),c=s("./src/headless/utils/url.js"),d=s("./node_modules/lit/directives/until.js");s("./src/shared/chat/styles/message-actions.scss");const{Strophe:u,u:h}=o.converse.env;class f extends n.CustomElement{static get properties(){return{is_retracted:{type:Boolean},model:{type:Object}}}initialize(){const e=(0,i.getAppSettings)();this.listenTo(e,"change:allowed_audio_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:allowed_image_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:allowed_video_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:render_media",(()=>this.requestUpdate())),this.listenTo(this.model,"change",(()=>this.requestUpdate()))}render(){return l.html`${(0,d.until)(this.renderActions(),"")}`}async renderActions(){const e=this.model.collection.length>2&&this.model===this.model.collection.last(),t=(await this.getActionButtons()).map((e=>f.getActionsDropdownItem(e)));return t.length?l.html`<converse-dropdown
                class="chat-msg__actions ${e?"dropup dropup--left":"dropleft"}"
                .items=${t}
            ></converse-dropdown>`:""}static getActionsDropdownItem(e){return l.html`
            <button class="chat-msg__action ${e.button_class}" @click=${e.handler}>
                <converse-icon
                    class="${e.icon_class}"
                    color="var(--text-color-lighten-15-percent)"
                    size="1em"
                ></converse-icon>
                ${e.i18n_text}
            </button>
        `}async onMessageEditButtonClicked(e){e.preventDefault();const t=this.model.collection.findWhere("correcting"),s=h.ancestor(this,".chatbox")?.querySelector(".chat-textarea")?.value;if(s&&(!t||t.getMessageText()!==s)){if(!await o.api.confirm((0,r.__)("You have an unsent message which will be lost if you continue. Are you sure?")))return}t!==this.model?(t?.save("correcting",!1),this.model.save("correcting",!0)):this.model.save("correcting",!1)}async onDirectMessageRetractButtonClicked(){if("me"!==this.model.get("sender"))return o.log.error("onMessageRetractButtonClicked called for someone else's message!");const e=(0,r.__)("Be aware that other XMPP/Jabber clients (and servers) may not yet support retractions and that this message may not be removed everywhere."),t=[(0,r.__)("Are you sure you want to retract this message?")];o.api.settings.get("show_retraction_warning")&&(t[1]=e);if(await o.api.confirm((0,r.__)("Confirm"),t)){this.model.collection.chatbox.retractOwnMessage(this.model)}}async retractOtherMessage(e){const t=this.model.collection.chatbox,s=await t.retractOtherMessage(this.model,e);if(null===s){const e=(0,r.__)("A timeout occurred while trying to retract the message");o.api.alert("error",(0,r.__)("Error"),e),(0,o.log)(e,u.LogLevel.WARN)}else if(h.isErrorStanza(s)){const e=(0,r.__)("Sorry, you're not allowed to retract this message.");o.api.alert("error",(0,r.__)("Error"),e),(0,o.log)(e,u.LogLevel.WARN),(0,o.log)(s,u.LogLevel.WARN)}}async onMUCMessageRetractButtonClicked(){const e=(0,r.__)("Be aware that other XMPP/Jabber clients (and servers) may not yet support retractions and that this message may not be removed everywhere.");if(this.model.mayBeRetracted()){const t=[(0,r.__)("Are you sure you want to retract this message?")];if(o.api.settings.get("show_retraction_warning")&&(t[1]=e),await o.api.confirm((0,r.__)("Confirm"),t)){this.model.collection.chatbox.retractOwnMessage(this.model)}}else if(await this.model.mayBeModerated())if("me"===this.model.get("sender")){let t=[(0,r.__)("Are you sure you want to retract this message?")];o.api.settings.get("show_retraction_warning")&&(t=[t[0],e,t[1]]),await o.api.confirm((0,r.__)("Confirm"),t)&&this.retractOtherMessage()}else{let t=[(0,r.__)("You are about to retract this message."),(0,r.__)("You may optionally include a message, explaining the reason for the retraction.")];o.api.settings.get("show_retraction_warning")&&(t=[t[0],e,t[1]]);const s=await o.api.prompt((0,r.__)("Message Retraction"),t,(0,r.__)("Optional reason"));!1!==s&&this.retractOtherMessage(s)}else{const e=(0,r.__)("Sorry, you're not allowed to retract this message");o.api.alert("error",(0,r.__)("Error"),e)}}onMessageRetractButtonClicked(e){e?.preventDefault?.();this.model.collection.chatbox.get("type")===o._converse.CHATROOMS_TYPE?this.onMUCMessageRetractButtonClicked():this.onDirectMessageRetractButtonClicked()}onMediaToggleClicked(e){if(e?.preventDefault?.(),this.hasHiddenMedia(this.getMediaURLs()))this.model.save({hide_url_previews:!1,url_preview_transition:"fade-in"});else{(this.model.get("ogp_metadata")||[]).length?this.model.set("url_preview_transition","fade-out"):this.model.save({hide_url_previews:!0,url_preview_transition:"fade-in"})}}hasHiddenMedia(e){if("boolean"==typeof this.model.get("hide_url_previews"))return this.model.get("hide_url_previews");const t=o.api.settings.get("render_media");return Array.isArray(t)?e.reduce(((e,s)=>e||!(0,c.isDomainWhitelisted)(t,s)),!1):!t}getMediaURLs(){const e=(this.model.get("ogp_metadata")||[]).map((e=>({url:e["og:image"],is_image:!0}))).filter((e=>(0,c.isMediaURLDomainAllowed)(e))),t=(0,a.getMediaURLs)(this.model.get("media_urls")||[],this.model.get("body")).filter((e=>(0,c.isMediaURLDomainAllowed)(e)));return[...new Set([...t.map((e=>e.url)),...e.map((e=>e.url))])]}addMediaRenderingToggle(e){const t=this.getMediaURLs();if(t.length){const s=this.hasHiddenMedia(t);e.push({i18n_text:s?(0,r.__)("Show media"):(0,r.__)("Hide media"),handler:e=>this.onMediaToggleClicked(e),button_class:"chat-msg__action-hide-previews",icon_class:s?"fas fa-eye":"fas fa-eye-slash",name:"hide"})}}async getActionButtons(){const e=[];this.model.get("editable")&&e.push({i18n_text:this.model.get("correcting")?(0,r.__)("Cancel Editing"):(0,r.__)("Edit"),handler:e=>this.onMessageEditButtonClicked(e),button_class:"chat-msg__action-edit",icon_class:"fa fa-pencil-alt",name:"edit"});const t=["groupchat","mep"].includes(this.model.get("type"))&&await this.model.mayBeModerated();return!this.is_retracted&&(this.model.mayBeRetracted()||t)&&e.push({i18n_text:(0,r.__)("Retract"),handler:e=>this.onMessageRetractButtonClicked(e),button_class:"chat-msg__action-retract",icon_class:"fas fa-trash-alt",name:"retract"}),this.model.collection?(this.addMediaRenderingToggle(e),o.api.hook("getMessageActionButtons",this,e)):[]}}o.api.elements.define("converse-message-actions",f)},"./src/shared/chat/message-body.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/registry.js"),s("./src/shared/modals/image.js");var n=s("./src/shared/directives/rich-text.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/shared/settings/utils.js");s("./src/shared/chat/styles/message-body.scss");class a extends r.CustomElement{static get properties(){return{hide_url_previews:{type:String},is_me_message:{type:Boolean},model:{type:Object},text:{type:String}}}initialize(){const e=(0,i.getAppSettings)();this.listenTo(e,"change:allowed_audio_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:allowed_image_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:allowed_video_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:render_media",(()=>this.requestUpdate()))}onImgClick(e){e.preventDefault(),o.api.modal.show("converse-image-modal",{src:e.target.src},e)}onImgLoad(){this.dispatchEvent(new CustomEvent("imageLoaded",{detail:this,bubbles:!0}))}render(){const e={media_urls:this.model.get("media_urls"),mentions:this.model.get("references"),nick:this.model.collection.chatbox.get("nick"),onImgClick:e=>this.onImgClick(e),onImgLoad:()=>this.onImgLoad(),render_styling:!this.model.get("is_unstyled")&&o.api.settings.get("allow_message_styling"),show_me_message:!0};return"false"===this.hide_url_previews?(e.embed_audio=!0,e.embed_videos=!0,e.show_images=!0):"true"===this.hide_url_previews&&(e.embed_audio=!1,e.embed_videos=!1,e.show_images=!1),(0,n.default)(this.text,0,e,(()=>this.model.collection?.trigger("rendered",this.model)))}}o.api.elements.define("converse-chat-message-body",a)},"./src/shared/chat/message-history.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});s("./src/shared/chat/message.js");var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./src/shared/chat/utils.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/repeat.js"),l=s("./node_modules/lit/directives/until.js");class c extends n.CustomElement{static get properties(){return{model:{type:Object},messages:{type:Array}}}render(){const e=this.messages;return e.length?(0,a.repeat)(e,(e=>e.get("id")),(e=>i.html`${this.renderMessage(e)}`)):""}renderMessage(e){if(e.get("dangling_retraction")||e.get("is_only_key"))return"";const t=e.get("template_hook");if("string"==typeof t){const s=r.api.hook(t,e,"");return(0,l.until)(s,"")}{const t=i.html`<converse-chat-message
                jid="${this.model.get("jid")}"
                mid="${e.get("id")}"></converse-chat-message>`,s=(0,o.getDayIndicator)(e);return s?[s,t]:t}}}r.api.elements.define("converse-message-history",c)},"./src/shared/chat/message-limit.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/chat/templates/message-limit.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{static get properties(){return{model:{type:Object}}}connectedCallback(){super.connectedCallback(),this.listenTo(this.model,"change:draft",(()=>this.requestUpdate()))}render(){const e=o.api.settings.get("message_limit");if(!e)return"";const t=this.model.get("draft")||"";return(0,n.default)(e-t.length)}}o.api.elements.define("converse-message-limit-indicator",i)},"./src/shared/chat/message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});s("./src/shared/chat/message-actions.js"),s("./src/shared/chat/message-body.js"),s("./src/shared/components/dropdown.js"),s("./src/shared/modals/message-versions.js"),s("./src/shared/modals/user-details.js"),s("./src/shared/registry.js"),s("./src/plugins/muc-views/modals/occupant.js");var n=s("./src/shared/chat/templates/file-progress.js"),r=s("./src/shared/chat/templates/info-message.js"),o=s("./src/plugins/muc-views/templates/mep-message.js"),i=s("./src/shared/chat/templates/message.js"),a=s("./src/shared/chat/templates/message-text.js"),l=s("./src/shared/chat/templates/retraction.js"),c=s("./src/templates/spinner.js"),d=s("./src/shared/components/element.js"),u=s("./src/i18n/index.js"),h=s("./src/headless/dist/converse-headless.js"),f=s("./src/headless/shared/settings/utils.js"),m=s("./src/shared/chat/utils.js");const{Strophe:p,dayjs:g}=h.converse.env;class _ extends d.CustomElement{static get properties(){return{jid:{type:String},mid:{type:String}}}async initialize(){if(await this.setModels(),!this.model)return void h.log.error("Could not find module for converse-chat-message");const e=(0,f.getAppSettings)();this.listenTo(e,"change:render_media",(()=>{this.model.save("hide_url_previews",void 0),this.requestUpdate()})),this.listenTo(this.chatbox,"change:first_unread_id",(()=>this.requestUpdate())),this.listenTo(this.model,"change",(()=>this.requestUpdate())),this.model.vcard&&this.listenTo(this.model.vcard,"change",(()=>this.requestUpdate())),"groupchat"===this.model.get("type")&&(this.model.occupant?this.listenTo(this.model.occupant,"change",(()=>this.requestUpdate())):this.listenTo(this.model,"occupantAdded",(()=>{this.requestUpdate(),this.listenTo(this.model.occupant,"change",(()=>this.requestUpdate()))})))}async setModels(){this.chatbox=await h.api.chatboxes.get(this.jid),await this.chatbox.initialized,await this.chatbox.messages.fetched,this.model=this.chatbox.messages.get(this.mid),this.model&&this.requestUpdate()}render(){return this.model?this.show_spinner?(0,c.default)():this.model.get("file")&&this.model.get("upload")!==h._converse.SUCCESS?this.renderFileProgress():["mep"].includes(this.model.get("type"))?this.renderMEPMessage():["error","info"].includes(this.model.get("type"))?this.renderInfoMessage():this.renderChatMessage():""}getProps(){return Object.assign(this.model.toJSON(),this.getDerivedMessageProps())}renderRetraction(){return(0,l.default)(this)}renderMessageText(){return(0,a.default)(this)}renderMEPMessage(){return(0,o.default)(this)}renderInfoMessage(){return(0,r.default)(this)}renderFileProgress(){return this.model.file?(0,n.default)(this):""}renderChatMessage(){return(0,i.default)(this,this.getProps())}shouldShowAvatar(){return h.api.settings.get("show_message_avatar")&&!this.model.isMeCommand()&&["chat","groupchat","normal"].includes(this.model.get("type"))}onUnfurlAnimationEnd(){"fade-out"===this.model.get("url_preview_transition")&&this.model.save({hide_url_previews:!0,url_preview_transition:"fade-in"})}async onRetryClicked(){this.show_spinner=!0,this.requestUpdate(),await h.api.trigger(this.model.get("retry_event_id"),{synchronous:!0}),this.model.destroy(),this.parentElement.removeChild(this)}isRetracted(){return this.model.get("retracted")||"retracted"===this.model.get("moderated")}hasMentions(){return"groupchat"===this.model.get("type")&&"them"===this.model.get("sender")&&this.chatbox.isUserMentioned(this.model)}getOccupantAffiliation(){return this.model.occupant?.get("affiliation")}getOccupantRole(){return this.model.occupant?.get("role")}getExtraMessageClasses(){const e=[this.model.isFollowup()?"chat-msg--followup":null,this.model.get("is_delayed")?"delayed":null,this.model.isMeCommand()?"chat-msg--action":null,this.isRetracted()?"chat-msg--retracted":null,this.model.get("type"),this.shouldShowAvatar()?"chat-msg--with-avatar":null].map((e=>e));return"groupchat"===this.model.get("type")&&(e.push(this.getOccupantRole()??""),e.push(this.getOccupantAffiliation()??""),"them"===this.model.get("sender")&&this.hasMentions()&&e.push("mentioned")),this.model.get("correcting")&&e.push("correcting"),e.filter((e=>e)).join(" ")}getDerivedMessageProps(){const e=h.api.settings.get("time_format");return{pretty_time:g(this.model.get("edited")||this.model.get("time")).format(e),has_mentions:this.hasMentions(),hats:(0,m.getHats)(this.model),is_first_unread:this.chatbox.get("first_unread_id")===this.model.get("id"),is_me_message:this.model.isMeCommand(),is_retracted:this.isRetracted(),username:this.model.getDisplayName(),should_show_avatar:this.shouldShowAvatar()}}getRetractionText(){if(["groupchat","mep"].includes(this.model.get("type"))&&this.model.get("moderated_by")){const e=this.model.get("moderated_by"),t=this.model.collection.chatbox;this.model.mod||(this.model.mod=t.occupants.findOccupant({jid:e})||t.occupants.findOccupant({nick:p.getResourceFromJid(e)}));const s=this.model.mod?this.model.mod.getDisplayName():"A moderator";return(0,u.__)("%1$s has removed this message",s)}return(0,u.__)("%1$s has removed this message",this.model.getDisplayName())}showUserModal(e){if("me"===this.model.get("sender"))h.api.modal.show("converse-profile-modal",{model:this.model},e);else if("groupchat"===this.model.get("type"))e.preventDefault(),h.api.modal.show("converse-muc-occupant-modal",{model:this.model.getOccupant(),message:this.model},e);else{e.preventDefault();const t=this.model.collection.chatbox;h.api.modal.show("converse-user-details-modal",{model:t},e)}}showMessageVersionsModal(e){e.preventDefault(),h.api.modal.show("converse-message-versions-modal",{model:this.model},e)}toggleSpoilerMessage(e){e?.preventDefault(),this.model.save({is_spoiler_visible:!this.model.get("is_spoiler_visible")})}}h.api.elements.define("converse-chat-message",_)},"./src/shared/chat/templates/emoji-picker.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{tplAllEmojis:()=>d,tplEmojiPicker:()=>u,tplSearchResults:()=>c});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const i=r.converse.env.utils,a=e=>{const t=r.api.settings.get("emoji_categories");return o.html`<ul>${Object.keys(t).map((s=>t[s]?(e=>o.html`
        <li data-category="${e.category}"
            class="emoji-category ${e.category} ${e.current_category===e.category?"picked":""}"
            title="${(0,n.__)(r.api.settings.get("emoji_category_labels")[e.category])}">

            <a class="pick-category"
               @click=${e.onCategoryPicked}
               href="#emoji-picker-${e.category}"
               data-category="${e.category}">${e.emoji} </a>
        </li>
    `)(Object.assign({category:s,emoji:e.sn2Emoji(t[s])},e)):""))}</ul>`},l=e=>o.html`
        <li class="emoji insert-emoji ${e.shouldBeHidden(e.emoji.sn)?"hidden":""}" data-emoji="${e.emoji.sn}" title="${e.emoji.sn}">
            <a href="#" @click=${e.insertEmoji} data-emoji="${e.emoji.sn}">${i.shortnamesToEmojis(e.emoji.sn)}</a>
        </li>
    `,c=e=>{const t=(0,n.__)("Search results");return o.html`
        <span ?hidden=${!e.query} class="emoji-lists__container emojis-lists__container--search">
        <a id="emoji-picker-search-results" class="emoji-category__heading">${t}</a>
        <ul class="emoji-picker">
            ${e.search_results.map((t=>l(Object.assign({emoji:t},e))))}
        </ul>
        </span>
    `},d=e=>{const t=r.api.settings.get("emoji_categories");return o.html`
        <span ?hidden=${e.query} class="emoji-lists__container emoji-lists__container--browse">
            ${Object.keys(t).map((s=>t[s]?(e=>o.html`
        <a id="emoji-picker-${e.category}" class="emoji-category__heading" data-category="${e.category}">${(0,n.__)(r.api.settings.get("emoji_category_labels")[e.category])}</a>
        <ul class="emoji-picker" data-category="${e.category}">
            ${Object.values(r.converse.emojis.json[e.category]).map((t=>l(Object.assign({emoji:t},e))))}
        </ul>`)(Object.assign({category:s},e)):""))}
        </span>`},u=e=>{const t=(0,n.__)("Search");return o.html`
        <div class="emoji-picker__header">
            <input class="form-control emoji-search" name="emoji-search" placeholder="${t}"
                .value=${e.query||""}
                @keydown=${e.onSearchInputKeyDown}
                @blur=${e.onSearchInputBlurred}
                @focus=${e.onSearchInputFocus}>
            ${e.query?"":a(e)}
        </div>
        ${e.render_emojis?o.html`<converse-emoji-picker-content
                .chatview=${e.chatview}
                .model=${e.model}
                .search_results="${e.search_results}"
                current_skintone="${e.current_skintone}"
                query="${e.query}"></converse-emoji-picker-content>`:""}

        <div class="emoji-skintone-picker">
            <ul>${["tone1","tone2","tone3","tone4","tone5"].map((t=>(e=>o.html`
        <li data-skintone="${e.skintone}" class="emoji-skintone ${e.current_skintone===e.skintone?"picked":""}">
            <a class="pick-skintone" href="#" data-skintone="${e.skintone}" @click=${e.onSkintonePicked}>${i.shortnamesToEmojis(":"+e.skintone+":")}</a>
        </li>`)(Object.assign({skintone:t},e))))}</ul>
        </div>`}},"./src/shared/chat/templates/file-progress.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/avatar/avatar.js");var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const{filesize:i}=r.converse.env,a=e=>{const t=(0,n.__)("Uploading file:"),s=e.model.file.name,r=i(e.model.file.size);return o.html`
        <div class="message chat-msg">
            ${e.shouldShowAvatar()?o.html`<a class="show-msg-author-modal" @click=${e.showUserModal}>
                    <converse-avatar class="avatar align-self-center"
                        .data=${e.model.vcard?.attributes}
                        nonce=${e.model.vcard?.get("vcard_updated")}
                        height="40" width="40"></converse-avatar>
                </a>`:""}
            <div class="chat-msg__content">
                <span class="chat-msg__text">${t} <strong>${s}</strong>, ${r}</span>
                <progress value="${e.model.get("progress")}"/>
            </div>
        </div>`}},"./src/shared/chat/templates/info-message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/i18n/index.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");const{dayjs:i}=r.converse.env,a=e=>{const t=i(e.model.get("time")).toISOString(),s=(0,n.__)("Retry");return o.html`
        <div class="message chat-info chat-${e.model.get("type")}"
            data-isodate="${t}"
            data-type="${e.data_name}"
            data-value="${e.data_value}">

            <div class="chat-info__message">
                <converse-rich-text
                    .mentions=${e.model.get("references")}
                    render_styling
                    text=${e.model.getMessageText()}>
                </converse-rich-text>
            </div>
            ${e.model.get("reason")?o.html`<q class="reason">${e.model.get("reason")}</q>`:""}
            ${e.model.get("error_text")?o.html`<q class="reason">${e.model.get("error_text")}</q>`:""}
            ${e.model.get("retry_event_id")?o.html`<a class="retry" @click=${e.onRetryClicked}>${s}</a>`:""}
        </div>`}},"./src/shared/chat/templates/message-limit.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=e=>{const t=(0,n.__)("Message characters remaining");return r.html`<span class="message-limit ${e<1?"error":""}" title="${t}">${e}</span>`}},"./src/shared/chat/templates/message-text.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./src/utils/html.js"),o=s("./node_modules/lit/index.js");const i=e=>{const t=(0,n.__)("Show more"),s="groupchat"===e.model.get("type"),i=(0,n.__)("Show less"),a=o.html`
        <div class="chat-msg__spoiler-hint">
            <span class="spoiler-hint">${e.model.get("spoiler_hint")}</span>
            <a class="badge badge-info spoiler-toggle" href="#" @click=${e.toggleSpoilerMessage}>
                <converse-icon size="1em" color="var(--background)" class="fa ${e.model.get("is_spoiler_visible")?"fa-eye-slash":"fa-eye"}"></converse-icon>
                ${e.model.get("is_spoiler_visible")?i:t}
            </a>
        </div>
    `,l=e.model.get("is_spoiler")?"spoiler "+(e.model.get("is_spoiler_visible")?"":"hidden"):"",c=e.model.getMessageText(),d=e.model.get("oob_url")&&c!==e.model.get("oob_url");return o.html`
        ${e.model.get("is_spoiler")?a:""}
        ${e.model.get("subject")?o.html`<div class="chat-msg__subject">${e.model.get("subject")}</div>`:""}
        <span class="chat-msg__body--wrapper">
            <converse-chat-message-body
                class="chat-msg__text ${e.model.get("is_only_emojis")?"chat-msg__text--larger":""} ${l}"
                .model="${e.model}"
                hide_url_previews=${e.model.get("hide_url_previews")}
                ?is_me_message=${e.model.isMeCommand()}
                text="${c}"></converse-chat-message-body>
            ${!e.model.get("received")||e.model.isMeCommand()||s?"":o.html`<converse-icon size="1em" color="var(--chat-color)" class="fa fa-check chat-msg__receipt"></converse-icon>`}
            ${e.model.get("edited")?(e=>{const t=(0,n.__)("This message has been edited");return o.html`<converse-icon title="${t}" class="fa fa-edit chat-msg__edit-modal" @click=${e.showMessageVersionsModal} size="1em"></converse-icon>`})(e):""}
        </span>
        ${d?o.html`<div class="chat-msg__media">${(0,r.getOOBURLMarkup)(e.model.get("oob_url"))}</div>`:""}
        <div class="chat-msg__error">${e.model.get("error_text")||e.model.get("error")}</div>
    `}},"./src/shared/chat/templates/message.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});s("./src/shared/avatar/avatar.js"),s("./src/shared/chat/unfurl.js");var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./src/headless/utils/url.js");const i=(e,t)=>{const s=(0,n.__)("New messages"),i=e.model.isFollowup();return r.html`
        ${t.is_first_unread?r.html`<div class="message separator"><hr class="separator"><span class="separator-text">${s}</span></div>`:""}
        <div class="message chat-msg ${e.getExtraMessageClasses()}"
                data-isodate="${t.time}"
                data-msgid="${t.msgid}"
                data-from="${t.from}"
                data-encrypted="${t.is_encrypted}">

            <!-- Anchor to allow us to scroll the message into view -->
            <a id="${t.msgid}"></a>

            ${t.should_show_avatar&&!i?r.html`<a class="show-msg-author-modal" @click=${e.showUserModal}>
                    <converse-avatar
                        class="avatar align-self-center"
                        .data=${e.model.vcard?.attributes}
                        nonce=${e.model.vcard?.get("vcard_updated")}
                        height="40" width="40"></converse-avatar>
                </a>`:""}

            <div class="chat-msg__content chat-msg__content--${t.sender} ${t.is_me_message?"chat-msg__content--action":""}">
                ${t.is_me_message||i?"":r.html`
                    <span class="chat-msg__heading">
                        <span class="chat-msg__author"><a class="show-msg-author-modal" @click=${e.showUserModal}>${t.username}</a></span>
                        ${t.hats.map((e=>r.html`<span class="badge badge-secondary">${e.title}</span>`))}
                        <time timestamp="${e.model.get("edited")||e.model.get("time")}" class="chat-msg__time">${t.pretty_time}</time>
                        ${t.is_encrypted?r.html`<converse-icon class="fa fa-lock" size="1.1em"></converse-icon>`:""}
                    </span>`}

                <div class="chat-msg__body chat-msg__body--${t.message_type} ${t.received?"chat-msg__body--received":""} ${t.is_delayed?"chat-msg__body--delayed":""}">
                    <div class="chat-msg__message">
                        ${t.is_me_message?r.html`
                            <time timestamp="${t.edited||t.time}" class="chat-msg__time">${t.pretty_time}</time>&nbsp;
                            <span class="chat-msg__author">${t.is_me_message?"**":""}${t.username}</span>&nbsp;`:""}
                        ${t.is_retracted?e.renderRetraction():e.renderMessageText()}
                    </div>
                    <converse-message-actions
                        .model=${e.model}
                        ?is_retracted=${t.is_retracted}></converse-message-actions>
                </div>

                ${e.model.get("ogp_metadata")?.map((t=>!0===e.model.get("hide_url_previews")?"":(0,o.shouldRenderMediaFromURL)(t["og:image"],"image")?r.html`<converse-message-unfurl
                        @animationend="${e.onUnfurlAnimationEnd}"
                        class="${e.model.get("url_preview_transition")}"
                        jid="${e.chatbox?.get("jid")}"
                        description="${t["og:description"]||""}"
                        title="${t["og:title"]||""}"
                        image="${t["og:image"]||""}"
                        url="${t["og:url"]||""}"></converse-message-unfurl>`:""))}
            </div>
        </div>`}},"./src/shared/chat/templates/new-day.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="message date-separator" data-isodate="${e.time}">
        <hr class="separator"/>
        <time class="separator-text" datetime="${e.time}"><span>${e.datestring}</span></time>
    </div>
`},"./src/shared/chat/templates/retraction.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");s("./src/shared/chat/styles/retraction.scss");const r=e=>{const t=e.isRetracted()?e.getRetractionText():null;return n.html`
        <div class="retraction">${t}</div>
        ${e.model.get("moderation_reason")?n.html`<q class="chat-msg--retracted__reason">${e.model.get("moderation_reason")}</q>`:""}`}},"./src/shared/chat/templates/toolbar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js"),o=s("./node_modules/lit/directives/until.js");const i=e=>r.html`
        <span class="toolbar-buttons">${(0,o.until)(e.getButtons(),"")}</span>
        ${e.show_send_button?function(){const e=(0,n.__)("Send the message");return r.html`<button type="submit" class="btn send-button" title="${e}">
        <converse-icon color="var(--toolbar-btn-text-color)" class="fa fa-paper-plane" size="1em"></converse-icon>
    </button>`}():""}
    `},"./src/shared/chat/templates/unfurl.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});s("./src/shared/components/image.js");var n=s("./src/headless/utils/url.js"),r=s("./node_modules/lit/index.js");function o(e){return!!(0,n.getURI)(e).host()}const i=e=>{const t=(s=e.image)&&(0,n.isDomainAllowed)(s,"allowed_image_domains")&&o(s);var s;const i=e.title||e.description||e.url;return t||i?r.html`<div class="card card--unfurl">
            ${t?(e=>r.html`<converse-image class="card-img-top hor_centered" href="${e.url}" src="${e.image}" .onImgLoad=${e.onload}></converse-image>`)(e):""}
            ${i?r.html` <div class="card-body">
                      ${e.title?((e,t)=>e.url&&o(e.url)&&!(0,n.isGIFURL)(e.image)?r.html`<a href="${e.url}" target="_blank" rel="noopener">${t(e)}</a>`:t(e))(e,(e=>r.html`<h5 class="card-title">${e.title}</h5>`)):""}
                      ${e.description?r.html`<p class="card-text">
                                <converse-rich-text text=${e.description}></converse-rich-text>
                            </p>`:""}
                      ${e.url?r.html`<p class="card-text">
                                <a href="${e.url}" target="_blank" rel="noopener">${(0,n.getURI)(e.url).domain()}</a>
                            </p>`:""}
                  </div>`:""}
        </div>`:""}},"./src/shared/chat/toolbar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ChatToolbar:()=>d});s("./src/shared/chat/emoji-picker.js"),s("./src/shared/chat/message-limit.js");var n=s("./src/shared/chat/templates/toolbar.js"),r=s("./src/shared/components/element.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/until.js");s("./src/shared/chat/styles/toolbar.scss");const c=i.converse.env.Strophe;class d extends r.CustomElement{static get properties(){return{hidden_occupants:{type:Boolean},is_groupchat:{type:Boolean},message_limit:{type:Number},model:{type:Object},show_call_button:{type:Boolean},show_emoji_button:{type:Boolean},show_send_button:{type:Boolean},show_spoiler_button:{type:Boolean}}}connectedCallback(){super.connectedCallback(),this.listenTo(this.model,"change:composing_spoiler",(()=>this.requestUpdate()))}render(){return(0,n.default)(this)}firstUpdated(){i.api.trigger("renderToolbar",this)}getButtons(){const e=[];if(this.show_emoji_button){const t=i._converse.chatboxviews.get(this.model.get("jid"));e.push(a.html`<converse-emoji-dropdown .chatview=${t}></converse-emoji-dropdown>`)}if(this.show_call_button){const t=this.is_groupchat?"--muc-toolbar-btn-color":"--chat-toolbar-btn-color",s=(0,o.__)("Start a call");e.push(a.html`
                <button class="toggle-call" @click=${this.toggleCall} title="${s}">
                    <converse-icon color="var(${t})" class="fa fa-phone" size="1em"></converse-icon>
                </button>`)}i.api.settings.get("message_limit")&&e.push(a.html`
                <converse-message-limit-indicator .model=${this.model} class="right">
                </converse-message-limit-indicator>`),this.show_spoiler_button&&e.push(this.getSpoilerButton());const t=i.api.disco.supports(c.NS.HTTPUPLOAD,i._converse.domain);if(e.push(a.html`${(0,l.until)(t.then((e=>this.getHTTPUploadButton(e))),"")}`),this.is_groupchat&&i.api.settings.get("visible_toolbar_buttons")?.toggle_occupants){const t=(0,o.__)("Hide participants"),s=(0,o.__)("Show participants");e.push(a.html`
                <button class="toggle_occupants right"
                        title="${this.hidden_occupants?s:t}"
                        @click=${this.toggleOccupants}>
                    <converse-icon
                        color="var(--muc-toolbar-btn-color)"
                        class="fa ${this.hidden_occupants?"fa-angle-double-left":"fa-angle-double-right"}"
                        size="1em"></converse-icon>
                </button>`)}return i._converse.api.hook("getToolbarButtons",this,e)}getHTTPUploadButton(e){if(e){const e=(0,o.__)("Choose a file to send"),t=this.is_groupchat?"--muc-toolbar-btn-color":"--chat-toolbar-btn-color";return a.html`
                <button title="${e}" @click=${this.toggleFileUpload}>
                    <converse-icon
                        color="var(${t})"
                        class="fa fa-paperclip"
                        size="1em"></converse-icon>
                </button>
                <input type="file" @change=${this.onFileSelection} class="fileupload" multiple="" style="display:none"/>`}return""}getSpoilerButton(){const e=this.model;if(!this.is_groupchat&&!e.presence?.resources.length)return;let t;t=e.get("composing_spoiler")?(0,o.__)("Click to write as a normal (non-spoiler) message"):(0,o.__)("Click to write your message as a spoiler");const s=this.is_groupchat?"--muc-toolbar-btn-color":"--chat-toolbar-btn-color",n=a.html`
            <button class="toggle-compose-spoiler"
                    title="${t}"
                    @click=${this.toggleComposeSpoilerMessage}>
                <converse-icon
                    color="var(${s})"
                    class="fa ${e.get("composing_spoiler")?"fa-eye-slash":"fa-eye"}"
                    size="1em"></converse-icon>
            </button>`;if(this.is_groupchat)return n;{const t=e.get("jid"),s=Promise.all(e.presence.resources.map((e=>i.api.disco.supports(c.NS.SPOILER,`${t}/${e.get("name")}`)))).then((e=>e.reduce(((e,t)=>e&&t),!0)));return a.html`${(0,l.until)(s.then((()=>n)),"")}`}}toggleFileUpload(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.querySelector(".fileupload").click()}onFileSelection(e){this.model.sendFiles(e.target.files)}toggleComposeSpoilerMessage(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.model.set("composing_spoiler",!this.model.get("composing_spoiler"))}toggleOccupants(e){e?.preventDefault?.(),e?.stopPropagation?.(),this.model.save({hidden_occupants:!this.model.get("hidden_occupants")})}toggleCall(e){e?.preventDefault?.(),e?.stopPropagation?.(),i.api.trigger("callButtonClicked",{connection:i._converse.connection,model:this.model})}}i.api.elements.define("converse-chat-toolbar",d)},"./src/shared/chat/unfurl.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./src/shared/chat/templates/unfurl.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/headless/shared/settings/utils.js");s("./src/shared/chat/styles/unfurl.scss");class a extends r.CustomElement{static get properties(){return{description:{type:String},image:{type:String},jid:{type:String},title:{type:String},url:{type:String}}}initialize(){const e=(0,i.getAppSettings)();this.listenTo(e,"change:allowed_image_domains",(()=>this.requestUpdate())),this.listenTo(e,"change:render_media",(()=>this.requestUpdate()))}render(){return(0,n.default)(Object.assign({onload:()=>this.onImageLoad()},{description:this.description||"",image:this.image||"",title:this.title||"",url:this.url||""}))}onImageLoad(){this.dispatchEvent(new CustomEvent("imageLoaded",{detail:this,bubbles:!0}))}}o.api.elements.define("converse-message-unfurl",a)},"./src/shared/chat/utils.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addEmojisMarkup:()=>j,getDayIndicator:()=>_,getDropdownButtons:()=>m,getEmojiMarkup:()=>b,getHats:()=>v,getHeadingDropdownItem:()=>u,getHeadingStandaloneButton:()=>h,getStandaloneButtons:()=>f,getTonedEmojis:()=>y,markScrolled:()=>g,onScrolledDown:()=>p,shortnamesToEmojis:()=>w});var n=s("./node_modules/lodash-es/debounce.js"),r=s("./src/shared/chat/templates/new-day.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/until.js"),l=s("./src/headless/plugins/emoji/utils.js");const{dayjs:c,u:d}=o.converse.env;async function u(e){const t=await e;return t?i.html`
              <a href="#" class="dropdown-item ${t.a_class}" @click=${t.handler} title="${t.i18n_title}">
                  <converse-icon
                      size="1em"
                      class="fa ${t.icon_class}"
                  ></converse-icon>
                  ${t.i18n_text}
              </a>
          `:""}async function h(e){const t=await e;return i.html`
        <a
            href="#"
            class="chatbox-btn ${t.a_class}"
            @click=${t.handler}
            title="${t.i18n_title}"
        >
            <converse-icon
                size="1em"
                class="fa ${t.icon_class}"
            ></converse-icon>
        </a>
    `}function f(e){return e.then((e=>e.filter((e=>e.standalone)).map((e=>h(e))).reverse().map((e=>(0,a.until)(e,"")))))}function m(e){return e.then((e=>{const t=e.filter((e=>!e.standalone)).map((e=>u(e)));return t.length?i.html`<converse-dropdown class="chatbox-btn dropleft" .items=${t}></converse-dropdown>`:""}))}function p(e){if(!e.isHidden()&&o.api.settings.get("allow_url_history_change")){const t=window.location.hash;t&&e.messages.get(t.slice(1))&&o._converse.router.history.navigate()}}const g=(0,n.default)((e=>function(e){const t=e.target;if("converse-chat-content"!==t.nodeName.toLowerCase())return;let s=!0;const n=0===Math.floor(t.scrollTop),r=Math.ceil(t.clientHeight-t.scrollTop)>=t.scrollHeight-Math.ceil(t.scrollHeight/20);n?(s=!1,p(t.model)):r&&o.api.trigger("chatBoxScrolledUp",t),t.model.get("scolled")!==s&&t.model.ui.set({scrolled:s})}(e)),50);function _(e){const t=e.collection?.models;if(!t)return;const s=t.indexOf(e),n=t[s-1];if(!n||c(e.get("time")).isAfter(c(n.get("time")),"day")){const t=c(e.get("time")).startOf("day");return(0,r.default)({type:"date",time:t.toISOString(),datestring:t.format("dddd MMM Do YYYY")})}}function v(e){if("groupchat"===e.get("type")){const t=o.api.settings.get("muc_hats").filter((e=>e)).map((e=>e.toLowerCase()));let s=[];t.includes("vcard_roles")&&(s=e.vcard?e.vcard.get("role"):null,s=s?s.split(",").filter((e=>e)).map((e=>({title:e}))):[]);const n=[...e.occupant?[e.occupant.get("role")]:[],...e.occupant?[e.occupant.get("affiliation")]:[]].filter((e=>e)).filter((e=>t.includes(e.toLowerCase()))).map((e=>({title:e})));return[...t.includes("xep317")&&e.occupant?.get("hats")||[],...s,...n]}return[]}function y(){var e;return o.converse.emojis.toned||(o.converse.emojis.toned=(e=Object.values(o.converse.emojis.json.people).filter((e=>e.sn.includes("_tone"))).map((e=>e.sn.replace(/_tone[1-5]/,""))),[...new Set(e)])),o.converse.emojis.toned}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{unicode_only:!1,add_title_wrapper:!1};const s=e.emoji,n=e.shortname;if(s){if(t.unicode_only)return s;if(o.api.settings.get("use_system_emojis"))return t.add_title_wrapper&&n?i.html`<span title="${n}">${s}</span>`:s;{const t=o.api.settings.get("emoji_image_path");return i.html`<img class="emoji"
                loading="lazy"
                draggable="false"
                title="${n}"
                alt="${s}"
                src="${t}/72x72/${e.cp}.png"/>`}}return t.unicode_only?n:i.html`<img class="emoji"
            loading="lazy"
            draggable="false"
            title="${n}"
            alt="${n}"
            src="${o.converse.emojis.by_sn[n].url}">`}function j(e,t){let s=[e];return[...(0,l.getShortnameReferences)(e),...(0,l.getCodePointReferences)(e)].sort(((e,t)=>t.begin-e.begin)).forEach((e=>{const n=s.shift(),r=b(e,t);s="string"==typeof r?[n.slice(0,e.begin)+r+n.slice(e.end),...s]:[n.slice(0,e.begin),r,n.slice(e.end),...s]})),s}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{unicode_only:!1,add_title_wrapper:!1};return j(e=(0,l.convertASCII2Emoji)(e),t)}Object.assign(d,{shortnamesToEmojis:w})},"./src/shared/components/brand-byline.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ConverseBrandByline:()=>i});var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");class i extends n.CustomElement{render(){r.api.settings.get("view_mode");return o.html` ${""} `}}r.api.elements.define("converse-brand-byline",i)},"./src/shared/components/brand-heading.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ConverseBrandHeading:()=>i});s("./src/shared/components/brand-byline.js"),s("./src/shared/components/brand-logo.js");var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/html.js");class i extends n.CustomElement{render(){return o.html`
            <converse-brand-logo></converse-brand-logo>
            <converse-brand-byline></converse-brand-byline>
        `}}r.api.elements.define("converse-brand-heading",i)},"./src/shared/components/brand-logo.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{ConverseBrandLogo:()=>i});var n=s("./src/headless/dist/converse-headless.js"),r=s("./src/shared/components/element.js"),o=s("./node_modules/lit/index.js");class i extends r.CustomElement{render(){const e="fullscreen"===n.api.settings.get("view_mode");return o.html`
            <a class="brand-heading" href="https://conversejs.org" target="_blank" rel="noopener">
                <span class="brand-name-wrapper ${e?"brand-name-wrapper--fullscreen":""}">
                    <img src="dist/images/logo-white.png" />
                </span>
            </a>
        `}}n.api.elements.define("converse-brand-logo",i)},"./src/shared/components/dropdown.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});s("./src/shared/components/icons.js");var n=s("./src/shared/dom-navigator.js"),r=s("./src/shared/components/dropdownbase.js"),o=s("./src/headless/shared/constants.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./node_modules/lit/index.js"),l=s("./node_modules/lit/directives/until.js");s("./src/shared/components/styles/dropdown.scss");class c extends r.default{static get properties(){return{icon_classes:{type:String},items:{type:Array}}}constructor(){super(),this.icon_classes="fa fa-bars"}render(){return a.html`
            <button type="button" class="btn btn--transparent btn--standalone" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <converse-icon size="1em" class="${this.icon_classes}">
            </button>
            <div class="dropdown-menu">
                ${this.items.map((e=>(0,l.until)(e,"")))}
            </div>
        `}firstUpdated(){super.firstUpdated(),this.initArrowNavigation()}connectedCallback(){super.connectedCallback(),this.hideOnEscape=e=>e.keyCode===o.KEYCODES.ESCAPE&&this.hideMenu(),document.addEventListener("keydown",this.hideOnEscape)}disconnectedCallback(){document.removeEventListener("keydown",this.hideOnEscape),super.disconnectedCallback()}hideMenu(){super.hideMenu(),this.navigator?.disable()}initArrowNavigation(){if(!this.navigator){const e={selector:".dropdown-item",onSelected:e=>e.focus()};this.navigator=new n.default(this.menu,e)}}enableArrowNavigation(e){e&&(e.preventDefault(),e.stopPropagation()),this.navigator.enable(),this.navigator.select(this.menu.firstElementChild)}handleKeyUp(e){super.handleKeyUp(e),e.keyCode!==o.KEYCODES.DOWN_ARROW||this.navigator.enabled||this.enableArrowNavigation(e)}}i.api.elements.define("converse-dropdown",c)},"./src/shared/components/dropdownbase.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js");const o=r.converse.env.utils;class i extends n.CustomElement{connectedCallback(){super.connectedCallback(),this.registerEvents()}registerEvents(){this.clickOutside=e=>this._clickOutside(e),document.addEventListener("click",this.clickOutside)}firstUpdated(){super.firstUpdated(),this.menu=this.querySelector(".dropdown-menu"),this.button=this.querySelector("button"),this.addEventListener("click",(e=>this.toggleMenu(e))),this.addEventListener("keyup",(e=>this.handleKeyUp(e)))}_clickOutside(e){this.contains(e.composedPath()[0])||this.hideMenu(e)}hideMenu(){o.removeClass("show",this.menu),this.button?.setAttribute("aria-expanded",!1),this.button?.blur()}showMenu(){o.addClass("show",this.menu),this.button.setAttribute("aria-expanded",!0)}toggleMenu(e){e.preventDefault(),o.hasClass("show",this.menu)?this.hideMenu():this.showMenu()}handleKeyUp(e){e.keyCode===r.converse.keycodes.ESCAPE&&this.hideMenu()}disconnectedCallback(){document.removeEventListener("click",this.clickOutside),super.disconnectedCallback()}}},"./src/shared/components/element.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CustomElement:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./node_modules/@converse/skeletor/src/events.js");class o extends n.LitElement{createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this.initialize?.()}disconnectedCallback(){super.disconnectedCallback(),this.stopListening()}}Object.assign(o.prototype,r.Events)},"./src/shared/components/font-awesome.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{FontAwesome:()=>i});var n=s("./src/shared/templates/icons.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");class i extends r.CustomElement{render(){return(0,n.default)()}}o.api.elements.define("converse-fontawesome",i)},"./src/shared/components/gif.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/shared/gif/index.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./src/utils/html.js"),a=s("./node_modules/lit/index.js");s("./src/shared/components/styles/gif.scss");class l extends r.CustomElement{static get properties(){return{autoplay:{type:Boolean},noloop:{type:Boolean},progress_color:{type:String},fallback:{type:String},src:{type:String}}}constructor(){super(),this.src=null,this.autoplay=!1,this.noloop=!1,this.fallback="url"}initGIF(){const e={autoplay:this.autoplay,loop:!this.noloop};this.progress_color&&(e.progress_color=this.progress_color),this.supergif=new n.default(this,e)}updated(e){this.supergif&&!e.has("src")?(e.has("autoplay")&&(this.supergif.options.autoplay=this.autoplay),e.has("noloop")&&(this.supergif.options.loop=!this.noloop),e.has("progress_color")&&(this.supergif.options.progress_color=this.progress_color)):this.initGIF()}render(){return this.supergif?.load_error&&["url","empty"].includes(this.fallback)?this.renderErrorFallback():a.html`<canvas class="gif-canvas"
                @mouseover=${()=>this.setHover()}
                @mouseleave=${()=>this.unsetHover()}
                @click=${e=>this.onControlsClicked(e)}><img class="gif" src="${this.src}"></a></canvas>`}renderErrorFallback(){return"url"===this.fallback?(0,i.getHyperlinkTemplate)(this.src):"empty"===this.fallback?"":void 0}setHover(){this.supergif&&(this.supergif.hovering=!0,this.hover_timeout&&clearTimeout(this.hover_timeout),this.hover_timeout=setTimeout((()=>this.unsetHover()),2e3))}unsetHover(){this.supergif&&(this.supergif.hovering=!1)}onControlsClicked(e){e.preventDefault(),this.supergif.playing?this.supergif.pause():this.supergif.frames.length>0&&(this.supergif.options.loop=!0,this.supergif.play())}}o.api.elements.define("converse-gif",l)},"./src/shared/components/icons.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js");s("./src/shared/components/styles/icon.scss");class i extends n.CustomElement{static get properties(){return{color:String,class_name:{attribute:"class"},style:String,size:String}}constructor(){super(),this.class_name="",this.style="",this.size="",this.color=""}getSource(){return`#icon-${this.class_name.trim().split(" ")[1].replace("fa-","")}`}getStyles(){const e=this.color.match(/var\((--.*)\)/)?.[1],t=e?getComputedStyle(this).getPropertyValue(e):this.color;return`\n            ${this.size?`width: ${this.size};`:""}\n            ${this.size?`height: ${this.size};`:""}\n            ${t?`fill: ${t};`:""}\n            ${this.style}\n        `}render(){return o.html`<svg .style="${this.getStyles()}"> <use href="${this.getSource()}"> </use> </svg>`}}r.api.elements.define("converse-icon",i)},"./src/shared/components/image-picker.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/shared/components/element.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js");const a=(0,r.__)("Your profile picture");class l extends n.CustomElement{static get properties(){return{height:{type:Number},data:{type:Object},width:{type:Number}}}render(){return i.html`
            <a class="change-avatar" @click=${this.openFileSelection} title="${a}">
                <converse-avatar class="avatar" .data=${this.data} height="${this.height}" width="${this.width}"></converse-avatar>
            </a>
            <input @change=${this.updateFilePreview} class="hidden" name="image" type="file"/>
        `}openFileSelection(e){e.preventDefault(),this.querySelector('input[type="file"]').click()}updateFilePreview(e){const t=e.target.files[0],s=new FileReader;s.onloadend=()=>{this.data={data_uri:s.result,image_type:t.type}},s.readAsDataURL(t)}}o.api.elements.define("converse-image-picker",l)},"./src/shared/components/image.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./src/templates/gif.js"),r=s("./src/templates/image.js"),o=s("./src/shared/components/element.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/headless/utils/url.js");class l extends o.CustomElement{static get properties(){return{src:{type:String},onImgLoad:{type:Function},href:{type:String}}}constructor(){super(),this.src=null,this.href=null,this.onImgClick=null,this.onImgLoad=null}render(){return(0,a.isGIFURL)(this.src)&&(0,a.shouldRenderMediaFromURL)(this.src,"image")?(0,n.default)((0,a.filterQueryParamsFromURL)(this.src),!0):(0,r.default)({src:(0,a.filterQueryParamsFromURL)(this.src),href:this.href,onClick:this.onImgClick,onLoad:this.onImgLoad})}}i.api.elements.define("converse-image",l)},"./src/shared/components/message-versions.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{MessageVersions:()=>l});var n=s("./src/shared/components/element.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/index.js"),i=s("./src/i18n/index.js");s("./src/shared/components/styles/message-versions.scss");const{dayjs:a}=r.converse.env;class l extends n.CustomElement{static get properties(){return{model:{type:Object}}}constructor(){super(),this.model=null}render(){const e=this.model.get("older_versions"),t=Object.keys(e);return o.html`
            ${t.length?o.html`<h4>${(0,i.__)("Older versions")}</h4> ${t.map((t=>((e,t)=>o.html`<p class="older-msg"><time>${a(e).format("MMM D, YYYY, HH:mm:ss")}</time>: ${t[e]}</p>`)(t,e)))}`:o.html`<h4>${(0,i.__)("No older versions found")}</h4>`}
            <hr/>
            <h4>${(0,i.__)("Current version")}</h4>
            <p><time>${a(this.model.get("time")).format("MMM D, YYYY, HH:mm:ss")}</time>: ${this.model.getMessageText()}</p>`}}r.api.elements.define("converse-message-versions",l)},"./src/shared/components/rich-text.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/shared/directives/rich-text.js"),r=s("./src/shared/components/element.js"),o=s("./src/headless/dist/converse-headless.js");s("./src/shared/components/styles/rich-text.scss");class i extends r.CustomElement{static get properties(){return{embed_audio:{type:Boolean},embed_videos:{type:Boolean},mentions:{type:Array},nick:{type:String},offset:{type:Number},onImgClick:{type:Function},onImgLoad:{type:Function},render_styling:{type:Boolean},show_images:{type:Boolean},hide_media_urls:{type:Boolean},show_me_message:{type:Boolean},text:{type:String}}}constructor(){super(),this.embed_audio=!1,this.embed_videos=!1,this.hide_media_urls=!1,this.mentions=[],this.offset=0,this.render_styling=!1,this.show_image_urls=!0,this.show_images=!1,this.show_me_message=!1}render(){const e={embed_audio:this.embed_audio,embed_videos:this.embed_videos,hide_media_urls:this.hide_media_urls,mentions:this.mentions,nick:this.nick,onImgClick:this.onImgClick,onImgLoad:this.onImgLoad,render_styling:this.render_styling,show_images:this.show_images,show_me_message:this.show_me_message};return(0,n.default)(this.text,this.offset,e)}}o.api.elements.define("converse-rich-text",i)},"./src/shared/constants.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{VIEW_PLUGINS:()=>n});const n=["converse-adhoc-views","converse-bookmark-views","converse-chatboxviews","converse-chatview","converse-controlbox","converse-dragresize","converse-fullscreen","converse-headlines-view","converse-mam-views","converse-minimize","converse-modal","converse-muc-views","converse-notification","converse-omemo","converse-profile","converse-push","converse-register","converse-roomslist","converse-rootview","converse-rosterview","converse-singleton"]},"./src/shared/directives/image.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{renderImage:()=>u});var n=s("./node_modules/lit/async-directive.js"),r=s("./src/headless/dist/converse-headless.js"),o=s("./node_modules/lit/directive.js"),i=s("./src/utils/html.js"),a=s("./node_modules/lit/index.js"),l=s("./src/headless/utils/url.js");const{URI:c}=r.converse.env;class d extends n.AsyncDirective{render(e,t,s,n){return t?a.html`<a href="${t}" class="chat-image__link" target="_blank" rel="noopener">${this.renderImage(e,t,s,n)}</a>`:this.renderImage(e,t,s,n)}renderImage(e,t,s,n){return a.html`<img class="chat-image img-thumbnail"
                loading="lazy"
                src="${e}"
                @click=${n}
                @error=${()=>this.onError(e,t,s,n)}
                @load=${s}/></a>`}onError(e,t,s,n){if((0,l.isURLWithImageExtension)(e))t&&this.setValue((0,i.getHyperlinkTemplate)(t));else{const r=new c(e),o=r.filename();r.filename(`${o}.png`),this.setValue(u(r.toString(),t,s,n))}}}const u=(0,o.directive)(d)},"./src/shared/directives/rich-text.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/directive.js"),o=s("./src/shared/rich-text.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/until.js");class l{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.offset=t,this.options=s,this.text=e}async transform(){const e=new o.RichText(this.text,this.offset,this.options);try{await e.addTemplates()}catch(e){n.log.error(e)}return e.payload}render(){return i.html`${(0,a.until)(this.transform(),i.html`${this.text}`)}`}}class c extends r.Directive{render(e,t,s,n){const r=new l(e,t,s).render();return n?.(),r}}const d=(0,r.directive)(c)},"./src/shared/directives/styling.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{renderStylingDirectiveBody:()=>c});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/directive.js"),o=s("./src/shared/rich-text.js"),i=s("./node_modules/lit/index.js"),a=s("./node_modules/lit/directives/until.js");class l extends r.Directive{render(e,t,s){const r=new o.RichText(e,t,Object.assign(s,{show_images:!1,embed_videos:!1,embed_audio:!1}));return i.html`${(0,a.until)(async function(e){try{await e.addTemplates()}catch(e){n.log.error(e)}return e.payload}(r),i.html`${r}`)}`}}const c=(0,r.directive)(l)},"./src/shared/dom-navigator.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/utils/html.js"),r=s("./src/headless/dist/converse-headless.js");const{keycodes:o}=r.converse;function i(e){let t=0;do{isNaN(e.offsetTop)||(t+=e.offsetTop)}while(e=e.offsetParent);return t}function a(e){let t=0;do{isNaN(e.offsetLeft)||(t+=e.offsetLeft)}while(e=e.offsetParent);return t}class l{static get DIRECTION(){return{down:"down",end:"end",home:"home",left:"left",right:"right",up:"up"}}static get DEFAULTS(){return{home:[`${o.SHIFT}+${o.UP_ARROW}`],end:[`${o.SHIFT}+${o.DOWN_ARROW}`],up:[o.UP_ARROW],down:[o.DOWN_ARROW],left:[o.LEFT_ARROW,`${o.SHIFT}+${o.TAB}`],right:[o.RIGHT_ARROW,o.TAB],getSelector:null,jump_to_picked:null,jump_to_picked_direction:null,jump_to_picked_selector:"picked",onSelected:null,selected:"selected",selector:"li"}}static getClosestElement(e,t){return e.reduce(((e,s)=>{const n=t(s);return n<e.distance?{distance:n,element:s}:e}),{distance:1/0}).element}constructor(e,t){this.doc=window.document,this.container=e,this.scroll_container=t.scroll_container||e,this.options=Object.assign({},l.DEFAULTS,t),this.init()}init(){this.selected=null,this.keydownHandler=null,this.elements={},this.keys={},this.options.down.forEach((e=>this.keys[e]=l.DIRECTION.down)),this.options.end.forEach((e=>this.keys[e]=l.DIRECTION.end)),this.options.home.forEach((e=>this.keys[e]=l.DIRECTION.home)),this.options.left.forEach((e=>this.keys[e]=l.DIRECTION.left)),this.options.right.forEach((e=>this.keys[e]=l.DIRECTION.right)),this.options.up.forEach((e=>this.keys[e]=l.DIRECTION.up))}enable(){this.getElements(),this.keydownHandler=e=>this.handleKeydown(e),this.doc.addEventListener("keydown",this.keydownHandler),this.enabled=!0}disable(){this.keydownHandler&&this.doc.removeEventListener("keydown",this.keydownHandler),this.unselect(),this.elements={},this.enabled=!1}destroy(){this.disable(),this.container.domNavigator&&delete this.container.domNavigator}getNextElement(e){let t;if(e===l.DIRECTION.home)t=this.getElements(e)[0];else if(e===l.DIRECTION.end)t=Array.from(this.getElements(e)).pop();else if(this.selected)if(e===l.DIRECTION.right){const s=this.getElements(e);t=s.slice(s.indexOf(this.selected))[1]}else if(e==l.DIRECTION.left){const s=this.getElements(e);t=s.slice(0,s.indexOf(this.selected)).pop()||this.selected}else if(e==l.DIRECTION.down){const e=this.selected.offsetLeft,s=this.selected.offsetTop+this.selected.offsetHeight,n=this.elementsAfter(0,s),r=t=>Math.abs(t.offsetLeft-e)+Math.abs(t.offsetTop-s);t=l.getClosestElement(n,r)}else{if(e!=l.DIRECTION.up)throw new Error("getNextElement: invalid direction value");{const e=this.selected.offsetLeft,s=this.selected.offsetTop-1,n=this.elementsBefore(1/0,s),r=t=>Math.abs(e-t.offsetLeft)+Math.abs(s-t.offsetTop);t=l.getClosestElement(n,r)}}else t=e===l.DIRECTION.right||e===l.DIRECTION.down?this.getElements(e)[1]:this.getElements(e)[0];return this.options.jump_to_picked&&t&&t.matches(this.options.jump_to_picked)&&e===this.options.jump_to_picked_direction&&(t=this.container.querySelector(this.options.jump_to_picked_selector)||t),t}select(e,t){e&&e!==this.selected&&(this.unselect(),t&&this.scrollTo(e,t),e.matches("input")?e.focus():n.default.addClass(this.options.selected,e),this.selected=e,this.options.onSelected&&this.options.onSelected(e))}unselect(){this.selected&&(n.default.removeClass(this.options.selected,this.selected),delete this.selected)}scrollTo(e,t){if(this.inScrollContainerViewport(e)){if(!function(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=window.innerHeight&&t.right<=window.innerWidth}(e))switch(t){case l.DIRECTION.left:document.body.scrollLeft=a(e)-document.body.offsetLeft;break;case l.DIRECTION.up:document.body.scrollTop=i(e)-document.body.offsetTop;break;case l.DIRECTION.right:document.body.scrollLeft=a(e)-document.body.offsetLeft-(document.documentElement.clientWidth-e.offsetWidth);break;case l.DIRECTION.down:document.body.scrollTop=i(e)-document.body.offsetTop-(document.documentElement.clientHeight-e.offsetHeight)}}else{const s=this.scroll_container;if(!s.contains(e))return;switch(t){case l.DIRECTION.left:s.scrollLeft=e.offsetLeft-s.offsetLeft,s.scrollTop=e.offsetTop-s.offsetTop;break;case l.DIRECTION.up:s.scrollTop=e.offsetTop-s.offsetTop;break;case l.DIRECTION.right:s.scrollLeft=e.offsetLeft-s.offsetLeft-(s.offsetWidth-e.offsetWidth),s.scrollTop=e.offsetTop-s.offsetTop-(s.offsetHeight-e.offsetHeight);break;case l.DIRECTION.down:s.scrollTop=e.offsetTop-s.offsetTop-(s.offsetHeight-e.offsetHeight)}}}inScrollContainerViewport(e){const t=this.scroll_container;return!(e.offsetLeft-t.scrollLeft<t.offsetLeft)&&(!(e.offsetTop-t.scrollTop<t.offsetTop)&&(!(e.offsetLeft+e.offsetWidth-t.scrollLeft>t.offsetLeft+t.offsetWidth)&&!(e.offsetTop+e.offsetHeight-t.scrollTop>t.offsetTop+t.offsetHeight)))}getElements(e){const t=this.options.getSelector?this.options.getSelector(e):this.options.selector;return this.elements[t]||(this.elements[t]=Array.from(this.container.querySelectorAll(t))),this.elements[t]}elementsAfter(e,t){return this.getElements(l.DIRECTION.down).filter((s=>s.offsetLeft>=e&&s.offsetTop>=t))}elementsBefore(e,t){return this.getElements(l.DIRECTION.up).filter((s=>s.offsetLeft<=e&&s.offsetTop<=t))}handleKeydown(e){const t=o,s=e.shiftKey?this.keys[`${t.SHIFT}+${e.which}`]:this.keys[e.which];if(s){e.preventDefault(),e.stopPropagation();const t=this.getNextElement(s,e);this.select(t,s)}}}const c=l},"./src/shared/gif/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/@converse/openpromise/openpromise.js"),o=s("./node_modules/gifuct-js/lib/index.js");class i{constructor(e,t){this.options=Object.assign({width:null,height:null,autoplay:!0,loop:!0,show_progress_bar:!0,progress_bg_color:"rgba(0,0,0,0.4)",progress_color:"rgba(255,0,22,.8)",progress_bar_height:5},t),this.el=e,this.gif_el=e.querySelector("img"),this.canvas=e.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.offscreenCanvas=document.createElement("canvas"),this.patchCanvas=document.createElement("canvas"),this.ctx_scaled=!1,this.frames=[],this.load_error=null,this.playing=this.options.autoplay,this.frame_idx=0,this.iteration_count=0,this.start=null,this.hovering=null,this.frameImageData=null,this.disposal_restore_from_idx=null,this.initialize()}async initialize(){this.options.width&&this.options.height&&this.setSizes(this.options.width,this.options.height);const e=await this.fetchGIF(this.gif_el.src);requestAnimationFrame((()=>this.handleGIFResponse(e)))}initPlayer(){if(!this.load_error&&(this.options.width&&this.options.height||this.ctx.scale(this.getCanvasScale(),this.getCanvasScale()),this.frame_idx=0,this.renderImage(),this.options.autoplay)){const e=this.frames[this.frame_idx]?.delay??0;setTimeout((()=>this.play()),e)}}getNextFrameNo(){return 0===this.frames.length?0:(this.frame_idx+1+this.frames.length)%this.frames.length}onIterationEnd(){return this.iteration_count++,this.options.onIterationEnd?.(this),!this.options.loop&&(this.pause(),!0)}onAnimationFrame(e,t,s){if(!this.playing)return;if(e-t<s)return this.hovering?this.drawPauseIcon():this.renderImage(),void requestAnimationFrame((e=>this.onAnimationFrame(e,t,s)));const n=this.getNextFrameNo();if(0===n&&this.onIterationEnd())return;this.frame_idx=n,this.renderImage();const r=this.frames[this.frame_idx]?.delay||8;requestAnimationFrame((t=>this.onAnimationFrame(t,e,r)))}setSizes(e,t){this.canvas.width=e*this.getCanvasScale(),this.canvas.height=t*this.getCanvasScale(),this.offscreenCanvas.width=e,this.offscreenCanvas.height=t,this.offscreenCanvas.style.width=e+"px",this.offscreenCanvas.style.height=t+"px",this.offscreenCanvas.getContext("2d").setTransform(1,0,0,1,0,0)}doShowProgress(e,t,s){if(s&&this.options.show_progress_bar){let s=this.options.progress_bar_height;const n=(this.canvas.height-s)/(this.ctx_scaled?this.getCanvasScale():1),r=e/t*this.canvas.width/(this.ctx_scaled?this.getCanvasScale():1),o=this.canvas.width/(this.ctx_scaled?this.getCanvasScale():1);s/=this.ctx_scaled?this.getCanvasScale():1,this.ctx.fillStyle=this.options.progress_bg_color,this.ctx.fillRect(r,n,o-r,s),this.ctx.fillStyle=this.options.progress_color,this.ctx.fillRect(0,n,r,s)}}handleGIFResponse(e){try{const t=(0,o.parseGIF)(e);this.hdr=t.header,this.lsd=t.lsd,this.setSizes(this.options.width??this.lsd.width,this.options.height??this.lsd.height),this.frames=(0,o.decompressFrames)(t,!0)}catch(e){this.showError()}this.initPlayer(),!this.options.autoplay&&this.drawPlayIcon()}drawError(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.options.width,this.options.height),this.ctx.strokeStyle="red",this.ctx.lineWidth=3,this.ctx.moveTo(0,0),this.ctx.lineTo(this.options.width,this.options.height),this.ctx.moveTo(0,this.options.height),this.ctx.lineTo(this.options.width,0),this.ctx.stroke()}showError(){this.load_error=!0,this.hdr={width:this.gif_el.width,height:this.gif_el.height},this.frames=[],this.drawError(),this.el.requestUpdate()}manageDisposal(e){if(e<=0)return;const t=this.offscreenCanvas.getContext("2d"),s=this.frames[e-1].disposalType;e>1&&(3===s?null!=this.disposal_restore_from_idx&&t.putImageData(this.frames[this.disposal_restore_from_idx].data,0,0):this.disposal_restore_from_idx=e-1),2===s&&t.clearRect(this.last_frame.dims.left,this.last_frame.dims.top,this.last_frame.dims.width,this.last_frame.dims.height)}renderImage(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.frames.length)return;let t=this.frame_idx;t=parseInt(t.toString(),10),(t>this.frames.length-1||t<0)&&(t=0),this.manageDisposal(t);const s=this.frames[t],n=this.patchCanvas.getContext("2d"),r=this.offscreenCanvas.getContext("2d"),o=s.dims;this.frameImageData&&o.width==this.frameImageData.width&&o.height==this.frameImageData.height||(this.patchCanvas.width=o.width,this.patchCanvas.height=o.height,this.frameImageData=n.createImageData(o.width,o.height)),this.frameImageData.data.set(s.patch),n.putImageData(this.frameImageData,0,0),r.drawImage(this.patchCanvas,o.left,o.top);const i=r.getImageData(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height);this.ctx.putImageData(i,0,0),this.ctx.drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height),e&&this.hovering&&this.drawPauseIcon(),this.last_frame=s}play(){this.playing=!0,requestAnimationFrame((e=>this.onAnimationFrame(e,0,0)))}pause(){this.playing=!1,requestAnimationFrame((()=>this.drawPlayIcon()))}drawPauseIcon(){if(!this.playing)return;this.renderImage(!1),this.ctx.fillStyle="rgb(0, 0, 0, 0.25)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);const e=.1*this.canvas.height;this.ctx.lineWidth=.04*this.canvas.height,this.ctx.beginPath(),this.ctx.moveTo(this.canvas.width/2-e/2,this.canvas.height/2-e),this.ctx.lineTo(this.canvas.width/2-e/2,this.canvas.height/2+e),this.ctx.fillStyle="rgb(200, 200, 200, 0.75)",this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(this.canvas.width/2+e/2,this.canvas.height/2-e),this.ctx.lineTo(this.canvas.width/2+e/2,this.canvas.height/2+e),this.ctx.fillStyle="rgb(200, 200, 200, 0.75)",this.ctx.stroke(),this.ctx.lineWidth=.02*this.canvas.height,this.ctx.strokeStyle="rgb(200, 200, 200, 0.75)",this.ctx.beginPath(),this.ctx.arc(this.canvas.width/2,this.canvas.height/2,1.5*e,0,2*Math.PI),this.ctx.stroke()}drawPlayIcon(){if(this.playing)return;this.renderImage(!1),this.ctx.fillStyle="rgb(0, 0, 0, 0.25)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);const e=.1*this.canvas.height,t=new Path2D;t.moveTo(this.canvas.width/2+e,this.canvas.height/2),t.lineTo(this.canvas.width/2-e/2,this.canvas.height/2+e),t.lineTo(this.canvas.width/2-e/2,this.canvas.height/2-e),t.closePath(),this.ctx.fillStyle="rgb(200, 200, 200, 0.75)",this.ctx.fill(t);const s=1.5*e;this.ctx.lineWidth=.02*this.canvas.height,this.ctx.strokeStyle="rgb(200, 200, 200, 0.75)",this.ctx.beginPath(),this.ctx.arc(this.canvas.width/2,this.canvas.height/2,s,0,2*Math.PI),this.ctx.stroke()}getCanvasScale(){let e;return e=this.options.max_width&&this.hdr&&this.lsd.width>this.options.max_width?this.options.max_width/this.lsd.width:1,e}fetchGIF(e){const t=(0,r.getOpenPromise)(),s=new XMLHttpRequest;return s.open("GET",e,!0),s.responseType="arraybuffer",s?.overrideMimeType("text/plain; charset=x-user-defined"),s.onload=()=>{if(200!=s.status)return this.showError(),t.reject();t.resolve(s.response)},s.onprogress=e=>e.lengthComputable&&this.doShowProgress(e.loaded,e.total,!0),s.onerror=e=>{n.log.error(e),this.showError()},s.send(),t}}},"./src/shared/modals/image.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/modal/modal.js"),r=s("./src/shared/modals/templates/image.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/utils/html.js"),l=s("./node_modules/lit/index.js");s("./src/shared/modals/styles/image.scss");class c extends n.default{renderModal(){return(0,r.default)({src:this.src})}getModalTitle(){return l.html`${(0,o.__)("Image: ")}<a target="_blank" rel="noopener" href="${this.src}">${(0,a.getFileName)(this.src)}</a>`}}i.api.elements.define("converse-image-modal",c)},"./src/shared/modals/message-versions.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});s("./src/shared/components/message-versions.js");var n=s("./src/plugins/modal/modal.js"),r=s("./src/i18n/index.js"),o=s("./node_modules/lit/index.js"),i=s("./src/headless/dist/converse-headless.js");class a extends n.default{renderModal(){return o.html`<converse-message-versions .model=${this.model}></converse-message-versions>`}getModalTitle(){return(0,r.__)("Message versions")}}i.api.elements.define("converse-message-versions-modal",a)},"./src/shared/modals/templates/image.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`<img class="chat-image chat-image--modal" src="${e.src}">`},"./src/shared/modals/templates/user-details.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{tplFooter:()=>l,tplUserDetailsModal:()=>c});var n=s("./src/shared/avatar/templates/avatar.js"),r=s("./src/i18n/index.js"),o=s("./src/headless/dist/converse-headless.js"),i=s("./node_modules/lit/index.js"),a=s("./src/plugins/modal/templates/buttons.js");const l=e=>{const t=void 0!==e.model.contact,s=(0,r.__)("Refresh"),n=o.api.settings.get("allow_contact_removal");return i.html`
        <div class="modal-footer">
            ${a.modal_close_button}
            <button type="button" class="btn btn-info refresh-contact" @click=${t=>e.refreshContact(t)}>
                <converse-icon
                    class="fa fa-refresh"
                    color="var(--text-color-lighten-15-percent)"
                    size="1em"
                ></converse-icon>
                ${s}</button>
            ${n&&t?(e=>{const t=(0,r.__)("Remove as contact");return i.html`
        <button type="button" @click="${t=>e.removeContact(t)}" class="btn btn-danger remove-contact">
            <converse-icon
                class="fas fa-trash-alt"
                color="var(--text-color-lighten-15-percent)"
                size="1em"
            ></converse-icon>
            ${t}
        </button>
    `})(e):""}
        </div>
    `},c=e=>{const t=e.model?.vcard,s=t?t.toJSON():{},o={...e.model.toJSON(),...s},a=(0,r.__)("XMPP Address"),l=(0,r.__)("Email"),c=(0,r.__)("Full Name"),d=(0,r.__)("Nickname"),u=(0,r.__)("The User's Profile Image"),h=(0,r.__)("Role"),f=(0,r.__)("URL"),m={alt_text:u,extra_classes:"mb-3",height:"120",width:"120"};return i.html`
        <div class="modal-body">
            ${o.image?i.html`<div class="mb-4">${(0,n.default)(Object.assign(o,m))}</div>`:""}
            ${o.fullname?i.html`<p><label>${c}:</label> ${o.fullname}</p>`:""}
            <p><label>${a}:</label> <a href="xmpp:${o.jid}">${o.jid}</a></p>
            ${o.nickname?i.html`<p><label>${d}:</label> ${o.nickname}</p>`:""}
            ${o.url?i.html`<p><label>${f}:</label> <a target="_blank" rel="noopener" href="${o.url}">${o.url}</a></p>`:""}
            ${o.email?i.html`<p><label>${l}:</label> <a href="mailto:${o.email}">${o.email}</a></p>`:""}
            ${o.role?i.html`<p><label>${h}:</label> ${o.role}</p>`:""}

            <converse-omemo-fingerprints jid=${o.jid}></converse-omemo-fingerprints>
        </div>
    `}},"./src/shared/modals/user-details.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./src/plugins/modal/modal.js"),r=s("./src/shared/modals/templates/user-details.js"),o=s("./src/i18n/index.js"),i=s("./src/headless/dist/converse-headless.js"),a=s("./src/plugins/rosterview/utils.js");const l=i.converse.env.utils;class c extends n.default{initialize(){super.initialize(),this.model.rosterContactAdded.then((()=>this.registerContactEventHandlers())),this.listenTo(this.model,"change",this.render),this.registerContactEventHandlers(),i.api.trigger("userDetailsModalInitialized",this.model)}renderModal(){return(0,r.tplUserDetailsModal)(this)}renderModalFooter(){return(0,r.tplFooter)(this)}getModalTitle(){return this.model.getDisplayName()}registerContactEventHandlers(){void 0!==this.model.contact&&(this.listenTo(this.model.contact,"change",this.render),this.listenTo(this.model.contact.vcard,"change",this.render),this.model.contact.on("destroy",(()=>{delete this.model.contact,this.render()})))}async refreshContact(e){e&&e.preventDefault&&e.preventDefault();const t=this.el.querySelector(".fa-refresh");l.addClass("fa-spin",t);try{await i.api.vcard.update(this.model.contact.vcard,!0)}catch(e){i.log.fatal(e),this.alert((0,o.__)("Sorry, something went wrong while trying to refresh"),"danger")}l.removeClass("fa-spin",t)}async removeContact(e){if(e?.preventDefault?.(),!i.api.settings.get("allow_contact_removal"))return;await i.api.confirm((0,o.__)("Are you sure you want to remove this contact?"))&&(setTimeout((()=>(0,a.removeContact)(this.model.contact)),1),this.modal.hide())}}i.api.elements.define("converse-user-details-modal",c)},"./src/shared/registry.js":(e,t,s)=>{"use strict";s.r(t);var n=s("./src/headless/dist/converse-headless.js");const r={},o={registry:r,define(e,t){this.registry[e]=t},register(){Object.keys(r).forEach((e=>{customElements.get(e)||customElements.define(e,r[e])}))}};Object.assign(n.api,{elements:o})},"./src/shared/rich-text.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{RichText:()=>_});var n=s("./src/templates/audio.js"),r=s("./src/templates/gif.js"),o=s("./src/templates/image.js"),i=s("./src/templates/video.js"),a=s("./src/headless/dist/converse-headless.js"),l=s("./src/shared/styling.js"),c=s("./src/shared/chat/utils.js"),d=s("./src/utils/html.js"),u=s("./src/headless/shared/chat/utils.js"),h=s("./src/headless/shared/parsers.js"),f=s("./src/headless/plugins/emoji/utils.js"),m=s("./src/headless/utils/url.js"),p=s("./node_modules/lit/index.js");const g=e=>"string"==typeof e;class _ extends String{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(e),this.embed_audio=s?.embed_audio,this.embed_videos=s?.embed_videos,this.mentions=s?.mentions||[],this.media_urls=s?.media_urls,this.nick=s?.nick,this.offset=t,this.onImgClick=s?.onImgClick,this.onImgLoad=s?.onImgLoad,this.options=s,this.payload=[],this.references=[],this.render_styling=s?.render_styling,this.show_images=s?.show_images,this.hide_media_urls=s?.hide_media_urls}shouldRenderMedia(e,t){let s;return"image"===t?s=this.show_images:"audio"===t?s=this.embed_audio:"video"===t&&(s=this.embed_videos),"boolean"==typeof s?s:(0,m.shouldRenderMediaFromURL)(e,t)}addHyperlinks(e,t){const s=t+this.offset,a=this.media_urls||(0,h.getMediaURLsMetadata)(e,t).media_urls||[];(0,u.getMediaURLs)(a,e,s).filter((e=>!e.is_encrypted)).forEach((e=>{const s=e.url,a=(0,m.filterQueryParamsFromURL)(s);let l;l=(0,m.isGIFURL)(s)&&this.shouldRenderMedia(s,"image")?(0,r.default)(a,this.hide_media_urls):(0,m.isImageURL)(s)&&this.shouldRenderMedia(s,"image")?(0,o.default)({src:a,href:this.hide_media_urls?null:a,onClick:this.onImgClick,onLoad:this.onImgLoad}):(0,m.isVideoURL)(s)&&this.shouldRenderMedia(s,"video")?(0,i.default)(a,this.hide_media_urls):(0,m.isAudioURL)(s)&&this.shouldRenderMedia(s,"audio")?(0,n.default)(a,this.hide_media_urls):(0,d.getHyperlinkTemplate)(a),this.addTemplateResult(e.start+t,e.end+t,l)}))}addMapURLs(e,t){const s=/geo:([\-0-9.]+),([\-0-9.]+)(?:,([\-0-9.]+))?(?:\?(.*))?/g,n=e.matchAll(s);for(const e of n)this.addTemplateResult(e.index+t,e.index+e[0].length+t,(0,d.getHyperlinkTemplate)(e[0].replace(s,a.api.settings.get("geouri_replacement"))))}addEmojis(e,t){[...(0,f.getShortnameReferences)(e.toString()),...(0,f.getCodePointReferences)(e.toString())].forEach((e=>{this.addTemplateResult(e.begin+t,e.end+t,(0,c.getEmojiMarkup)(e,{add_title_wrapper:!0}))}))}addMentions(e,t){const s=t+this.offset;this.mentions?.forEach((n=>{const r=Number(n.begin)-s;if(r<0||r>=s+e.length)return;const o=Number(n.end)-s,i=e.slice(r,o);var a;i===this.nick?this.addTemplateResult(r+t,o+t,(a={...n,mention:i},p.html`<span class="mention mention--self badge badge-info" data-uri="${a.uri}">${a.mention}</span>`)):this.addTemplateResult(r+t,o+t,(e=>p.html`<span class="mention" data-uri="${e.uri}">${e.mention}</span>`)({...n,mention:i}))}))}addStyling(){if(!(0,l.containsDirectives)(this))return;const e=[],t=this.mentions.map((e=>Array.from({length:Number(e.end)},((t,s)=>Number(e.begin)+s))));let s=0;for(;s<this.length;){if(t.filter((e=>e.includes(s))).length){s++;continue}const{d:n,length:r}=(0,l.getDirectiveAndLength)(this,s);if(n&&r){const t=(0,l.isQuoteDirective)(n),o=s+r,i=t?o:o-n.length;let a="```"===n?s+n.length+1:s+n.length;t&&" "===this[a]&&(a+=1);const c=a,d=this.slice(a,i);e.push({begin:s,template:(0,l.getDirectiveTemplate)(n,d,c,this.options),end:o}),s=o}s++}e.forEach((e=>this.addTemplateResult(e.begin,e.end,e.template)))}trimMeMessage(){0===this.offset&&this.isMeCommand()&&(this.payload[0]=this.payload[0].substring(4))}addAnnotations(e){const t=this.marshall();let s=0;for(const n of t)n&&(g(n)?(e.call(this,n,s),s+=n.length):s=n.end)}async addTemplates(){await a.api.trigger("beforeMessageBodyTransformed",this,{Synchronous:!0}),this.render_styling&&this.addStyling(),this.addAnnotations(this.addMentions),this.addAnnotations(this.addHyperlinks),this.addAnnotations(this.addMapURLs),await a.api.emojis.initialize(),this.addAnnotations(this.addEmojis),await a.api.trigger("afterMessageBodyTransformed",this,{Synchronous:!0}),this.payload=this.marshall(),this.options.show_me_message&&this.trimMeMessage(),this.payload=this.payload.map((e=>g(e)?e:e.template))}addTemplateResult(e,t,s){this.references.push({begin:e,end:t,template:s})}isMeCommand(){const e=this.toString();return!!e&&e.startsWith("/me ")}marshall(){let e=[this.toString()];return this.references.sort(((e,t)=>t.begin-e.begin)).forEach((t=>{const s=e.shift();e=[s.slice(0,t.begin),t,s.slice(t.end),...e]})),e.reduce(((e,t)=>{return g(t)?[...e,(0,f.convertASCII2Emoji)((s=t,s.replace(/\n\n+/g,(e=>`\n${"".repeat(e.length-2)}\n`))))]:[...e,t];var s}),[])}}},"./src/shared/styling.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{containsDirectives:()=>m,getDirectiveAndLength:()=>u,getDirectiveTemplate:()=>f,isQuoteDirective:()=>h});var n=s("./node_modules/lit/index.js"),r=s("./src/shared/directives/styling.js");const o=["*","_","~","`"],i=[...o,"```",">"],a={"*":{name:"strong",type:"span"},_:{name:"emphasis",type:"span"},"~":{name:"strike",type:"span"},"`":{name:"preformatted",type:"span"},"```":{name:"preformatted_block",type:"block"},">":{name:"quote",type:"block"}},l=["_",">","`","~"],c={emphasis:(e,t,s)=>n.html`<span class="styling-directive">_</span><i>${(0,r.renderStylingDirectiveBody)(e,t,s)}</i><span class="styling-directive">_</span>`,preformatted:e=>n.html`<span class="styling-directive">\`</span><code>${e}</code><span class="styling-directive">\`</span>`,preformatted_block:e=>n.html`<div class="styling-directive">\`\`\`</div><code class="block">${e}</code><div class="styling-directive">\`\`\`</div>`,quote:(e,t,s)=>n.html`<blockquote>${(0,r.renderStylingDirectiveBody)(e,t,s)}</blockquote>`,strike:(e,t,s)=>n.html`<span class="styling-directive">~</span><del>${(0,r.renderStylingDirectiveBody)(e,t,s)}</del><span class="styling-directive">~</span>`,strong:(e,t,s)=>n.html`<span class="styling-directive">*</span><b>${(0,r.renderStylingDirectiveBody)(e,t,s)}</b><span class="styling-directive">*</span>`};function d(e,t){let s,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(/(^```[\s,\u200B]*\n)|(^```[\s,\u200B]*$)/.test(e.slice(t))&&(0===t||">"===e[t-1]||/\n\u200B{0,2}$/.test(e.slice(0,t))))s=e.slice(t,t+3);else{if(!i.includes(e.slice(t,t+1)))return null;if(s=e.slice(t,t+1),!function(e,t,s,n){if(n){const n=RegExp(l.includes(e)?`^(\\p{L}|\\p{N})${e}`:`^(\\p{L}|\\p{N})\\${e}`,"u");if(s>1&&n.test(t.slice(s-1)))return!1;if(h(e)&&s>0&&"\n"!==t[s-1])return!1;if(o.includes(e)&&t[s+1]===e)return!1}else{const n=RegExp(l.includes(e)?`^${e}(\\p{L}|\\p{N})`:`^\\${e}(\\p{L}|\\p{N})`,"u");if(s<t.length-1&&n.test(t.slice(s)))return!1;if(o.includes(e)&&t[s-1]===e)return!1}return!0}(s,e,t,n))return null}return s}function u(e,t){const s=d(e,t),n=s?function(e,t,s){if(!e)return 0;const n=s;if(s+=e.length,h(e))return(s+=t.slice(s).split(/\n[^>]/).shift().length)-n;if("span"===a[e].type){const n=t.slice(s).split("\n").shift();let r=0,o=n.indexOf(e);for(;-1!==o;){if(d(t,s+o,!1)===e)return o+2*e.length;o=n.indexOf(e,r++)}return 0}{const n=t.slice(s+1);let r=0,o=n.indexOf(e);for(;-1!==o;){if(d(t,s+1+o,!1)===e)return o+1+2*e.length;o=n.indexOf(e,r++)}return 0}}(s,e,t):0;return n>0?{d:s,length:n}:{}}const h=e=>[">","&gt;"].includes(e);function f(e,t,s,n){const r=c[a[e].name];if(h(e)){return r(t.replace(/\n>\s/g,"\n").replace(/\n>/g,"\n").replace(/\n$/,""),s,n)}return r(t,s,n)}function m(e){for(let t=0;t<i.length;t++)if(e.includes(i[t]))return!0}},"./src/shared/templates/icons.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=()=>n.html`
    <?xml version="1.0" encoding="UTF-8"?>
    <!--
    Font Awesome Free 5.13.0 by @fontawesome - https://fontawesome.com
    License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
    -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="icon-address-book" viewBox="0 0 448 512">
        <path d="M436 160c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h320c26.5 0 48-21.5 48-48v-48h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20zm-228-32c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm112 236.8c0 10.6-10 19.2-22.4 19.2H118.4C106 384 96 375.4 96 364.8v-19.2c0-31.8 30.1-57.6 67.2-57.6h5c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h5c37.1 0 67.2 25.8 67.2 57.6v19.2z"></path>
    </symbol>
    <symbol id="icon-angle-double-down" viewBox="0 0 320 512">
        <path d="M143 256.3L7 120.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0L313 86.3c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.4 9.5-24.6 9.5-34 .1zm34 192l136-136c9.4-9.4 9.4-24.6 0-33.9l-22.6-22.6c-9.4-9.4-24.6-9.4-33.9 0L160 352.1l-96.4-96.4c-9.4-9.4-24.6-9.4-33.9 0L7 278.3c-9.4 9.4-9.4 24.6 0 33.9l136 136c9.4 9.5 24.6 9.5 34 .1z"></path>
    </symbol>
    <symbol id="icon-angle-double-left" viewBox="0 0 448 512">
        <path d="M223.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L319.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L393.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34zm-192 34l136 136c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9L127.9 256l96.4-96.4c9.4-9.4 9.4-24.6 0-33.9L201.7 103c-9.4-9.4-24.6-9.4-33.9 0l-136 136c-9.5 9.4-9.5 24.6-.1 34z"></path>
    </symbol>
    <symbol id="icon-angle-double-right" viewBox="0 0 448 512">
        <path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34zm192-34l-136-136c-9.4-9.4-24.6-9.4-33.9 0l-22.6 22.6c-9.4 9.4-9.4 24.6 0 33.9l96.4 96.4-96.4 96.4c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l136-136c9.4-9.2 9.4-24.4 0-33.8z"></path>
    </symbol>
    <symbol id="icon-angle-double-up" viewBox="0 0 320 512">
        <path d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"></path>
    </symbol>
    <symbol id="icon-angle-down" viewBox="0 0 320 512">
        <path d="M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"></path>
    </symbol>
    <symbol id="icon-angle-left" viewBox="0 0 256 512">
        <path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"></path>
    </symbol>
    <symbol id="icon-angle-right" viewBox="0 0 256 512">
        <path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path>
    </symbol>
    <symbol id="icon-angle-up" viewBox="0 0 320 512">
        <path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"></path>
    </symbol>
    <symbol id="icon-arrow-alt-circle-down" viewBox="0 0 512 512">
        <path d="M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z"></path>
    </symbol>
    <symbol id="icon-arrow-alt-circle-left" viewBox="0 0 512 512">
        <path d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zm116-292H256v-70.9c0-10.7-13-16.1-20.5-8.5L121.2 247.5c-4.7 4.7-4.7 12.2 0 16.9l114.3 114.9c7.6 7.6 20.5 2.2 20.5-8.5V300h116c6.6 0 12-5.4 12-12v-64c0-6.6-5.4-12-12-12z"></path>
    </symbol>
    <symbol id="icon-arrow-alt-circle-right" viewBox="0 0 512 512">
        <path d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zM140 300h116v70.9c0 10.7 13 16.1 20.5 8.5l114.3-114.9c4.7-4.7 4.7-12.2 0-16.9l-114.3-115c-7.6-7.6-20.5-2.2-20.5 8.5V212H140c-6.6 0-12 5.4-12 12v64c0 6.6 5.4 12 12 12z"></path>
    </symbol>
    <symbol id="icon-arrow-alt-circle-up" viewBox="0 0 512 512">
        <path d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm292 116V256h70.9c10.7 0 16.1-13 8.5-20.5L264.5 121.2c-4.7-4.7-12.2-4.7-16.9 0l-115 114.3c-7.6 7.6-2.2 20.5 8.5 20.5H212v116c0 6.6 5.4 12 12 12h64c6.6 0 12-5.4 12-12z"></path>
    </symbol>
    <symbol id="icon-arrow-circle-down" viewBox="0 0 512 512">
        <path d="M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-143.6-28.9L288 302.6V120c0-13.3-10.7-24-24-24h-16c-13.3 0-24 10.7-24 24v182.6l-72.4-75.5c-9.3-9.7-24.8-9.9-34.3-.4l-10.9 11c-9.4 9.4-9.4 24.6 0 33.9L239 404.3c9.4 9.4 24.6 9.4 33.9 0l132.7-132.7c9.4-9.4 9.4-24.6 0-33.9l-10.9-11c-9.5-9.5-25-9.3-34.3.4z"></path>
    </symbol>
    <symbol id="icon-arrow-circle-left" viewBox="0 0 512 512">
        <path d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zm28.9-143.6L209.4 288H392c13.3 0 24-10.7 24-24v-16c0-13.3-10.7-24-24-24H209.4l75.5-72.4c9.7-9.3 9.9-24.8.4-34.3l-11-10.9c-9.4-9.4-24.6-9.4-33.9 0L107.7 239c-9.4 9.4-9.4 24.6 0 33.9l132.7 132.7c9.4 9.4 24.6 9.4 33.9 0l11-10.9c9.5-9.5 9.3-25-.4-34.3z"></path>
    </symbol>
    <symbol id="icon-arrow-circle-right" viewBox="0 0 512 512">
        <path d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm-28.9 143.6l75.5 72.4H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h182.6l-75.5 72.4c-9.7 9.3-9.9 24.8-.4 34.3l11 10.9c9.4 9.4 24.6 9.4 33.9 0L404.3 273c9.4-9.4 9.4-24.6 0-33.9L271.6 106.3c-9.4-9.4-24.6-9.4-33.9 0l-11 10.9c-9.5 9.6-9.3 25.1.4 34.4z"></path>
    </symbol>
    <symbol id="icon-arrow-circle-up" viewBox="0 0 512 512">
        <path d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm143.6 28.9l72.4-75.5V392c0 13.3 10.7 24 24 24h16c13.3 0 24-10.7 24-24V209.4l72.4 75.5c9.3 9.7 24.8 9.9 34.3.4l10.9-11c9.4-9.4 9.4-24.6 0-33.9L273 107.7c-9.4-9.4-24.6-9.4-33.9 0L106.3 240.4c-9.4 9.4-9.4 24.6 0 33.9l10.9 11c9.6 9.5 25.1 9.3 34.4-.4z"></path>
    </symbol>
    <symbol id="icon-arrow-down" viewBox="0 0 448 512">
        <path d="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"></path>
    </symbol>
    <symbol id="icon-arrow-left" viewBox="0 0 448 512">
        <path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"></path>
    </symbol>
    <symbol id="icon-arrow-right" viewBox="0 0 448 512">
        <path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"></path>
    </symbol>
    <symbol id="icon-arrow-up" viewBox="0 0 448 512">
        <path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"></path>
    </symbol>
    <symbol id="icon-arrows-alt" viewBox="0 0 512 512">
        <path d="M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z"></path>
    </symbol>
    <symbol id="icon-arrows-alt-h" viewBox="0 0 512 512">
        <path d="M377.941 169.941V216H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.568 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296h243.882v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.568 0-33.941l-86.059-86.059c-15.119-15.12-40.971-4.412-40.971 16.97z"></path>
    </symbol>
    <symbol id="icon-arrows-alt-v" viewBox="0 0 256 512">
        <path d="M214.059 377.941H168V134.059h46.059c21.382 0 32.09-25.851 16.971-40.971L144.971 7.029c-9.373-9.373-24.568-9.373-33.941 0L24.971 93.088c-15.119 15.119-4.411 40.971 16.971 40.971H88v243.882H41.941c-21.382 0-32.09 25.851-16.971 40.971l86.059 86.059c9.373 9.373 24.568 9.373 33.941 0l86.059-86.059c15.12-15.119 4.412-40.971-16.97-40.971z"></path>
    </symbol>
    <symbol id="icon-bars" viewBox="0 0 448 512">
        <path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path>
    </symbol>
    <symbol id="icon-bookmark" viewBox="0 0 384 512">
        <path d="M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z"></path>
    </symbol>
    <symbol id="icon-bookmark-empty" viewBox="0 0 384 512">
        <path d="M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z"/>
    </symbol>
    <symbol id="icon-caret-down" viewBox="0 0 320 512">
        <path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"></path>
    </symbol>
    <symbol id="icon-caret-right" viewBox="0 0 192 512">
        <path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"></path>
    </symbol>
    <symbol id="icon-check" viewBox="0 0 512 512">
        <path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"></path>
    </symbol>
    <symbol id="icon-circle" viewBox="0 0 512 512">
        <path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path>
    </symbol>
    <symbol id="icon-cog" viewBox="0 0 512 512">
        <path d="M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"></path>
    </symbol>
    <symbol id="icon-database" viewBox="0 0 448 512">
        <path d="M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"></path>
    </symbol>
    <symbol id="icon-edit" viewBox="0 0 576 512">
        <path d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"></path>
    </symbol>
    <symbol id="icon-eye" viewBox="0 0 576 512">
        <path d="M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"></path>
    </symbol>
    <symbol id="icon-eye-slash" viewBox="0 0 640 512">
        <path d="M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"></path>
    </symbol>
    <symbol id="icon-gavel" viewBox="0 0 512 512">
        <path d="M504.971 199.362l-22.627-22.627c-9.373-9.373-24.569-9.373-33.941 0l-5.657 5.657L329.608 69.255l5.657-5.657c9.373-9.373 9.373-24.569 0-33.941L312.638 7.029c-9.373-9.373-24.569-9.373-33.941 0L154.246 131.48c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l5.657-5.657 39.598 39.598-81.04 81.04-5.657-5.657c-12.497-12.497-32.758-12.497-45.255 0L9.373 412.118c-12.497 12.497-12.497 32.758 0 45.255l45.255 45.255c12.497 12.497 32.758 12.497 45.255 0l114.745-114.745c12.497-12.497 12.497-32.758 0-45.255l-5.657-5.657 81.04-81.04 39.598 39.598-5.657 5.657c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l124.451-124.451c9.372-9.372 9.372-24.568 0-33.941z"></path>
    </symbol>
    <symbol id="icon-globe" viewBox="0 0 496 512">
        <path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"></path>
    </symbol>
    <symbol id="icon-id-card" viewBox="0 0 576 512">
        <path d="M528 32H48C21.5 32 0 53.5 0 80v16h576V80c0-26.5-21.5-48-48-48zM0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V128H0v304zm352-232c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zM176 192c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zM67.1 396.2C75.5 370.5 99.6 352 128 352h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.9-5.2 19.8-15.6 19.8H82.7c-10.4 0-18.8-10-15.6-19.8z"></path>
    </symbol>
    <symbol id="icon-id-card-alt" viewBox="0 0 576 512">
        <path d="M528 64H384v96H192V64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM288 224c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm93.3 224H194.7c-10.4 0-18.8-10-15.6-19.8 8.3-25.6 32.4-44.2 60.9-44.2h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.8-5.2 19.8-15.6 19.8zM352 32c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v96h128V32z"></path>
    </symbol>
    <symbol id="icon-info" viewBox="0 0 192 512">
        <path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"></path>
    </symbol>
    <symbol id="icon-info-circle" viewBox="0 0 512 512">
        <path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"></path>
    </symbol>
    <symbol id="icon-list-ul" viewBox="0 0 512 512">
        <path d="M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"></path>
    </symbol>
    <symbol id="icon-lock" viewBox="0 0 448 512">
        <path d="M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"></path>
    </symbol>
    <symbol id="icon-lock-open" viewBox="0 0 576 512">
        <path d="M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"></path>
    </symbol>
    <symbol id="icon-minus" viewBox="0 0 448 512">
        <path d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path>
    </symbol>
    <symbol id="icon-minus-circle" viewBox="0 0 512 512">
        <path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zM124 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H124z"></path>
    </symbol>
    <symbol id="icon-minus-square" viewBox="0 0 448 512">
        <path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"></path>
    </symbol>
    <symbol id="icon-paper-plane" viewBox="0 0 512 512">
        <path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"></path>
    </symbol>
    <symbol id="icon-paperclip" viewBox="0 0 448 512">
        <path d="M43.246 466.142c-58.43-60.289-57.341-157.511 1.386-217.581L254.392 34c44.316-45.332 116.351-45.336 160.671 0 43.89 44.894 43.943 117.329 0 162.276L232.214 383.128c-29.855 30.537-78.633 30.111-107.982-.998-28.275-29.97-27.368-77.473 1.452-106.953l143.743-146.835c6.182-6.314 16.312-6.422 22.626-.241l22.861 22.379c6.315 6.182 6.422 16.312.241 22.626L171.427 319.927c-4.932 5.045-5.236 13.428-.648 18.292 4.372 4.634 11.245 4.711 15.688.165l182.849-186.851c19.613-20.062 19.613-52.725-.011-72.798-19.189-19.627-49.957-19.637-69.154 0L90.39 293.295c-34.763 35.56-35.299 93.12-1.191 128.313 34.01 35.093 88.985 35.137 123.058.286l172.06-175.999c6.177-6.319 16.307-6.433 22.626-.256l22.877 22.364c6.319 6.177 6.434 16.307.256 22.626l-172.06 175.998c-59.576 60.938-155.943 60.216-214.77-.485z"></path>
    </symbol>
    <symbol id="icon-pencil-alt" viewBox="0 0 512 512">
        <path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"></path>
    </symbol>
    <symbol id="icon-phone" viewBox="0 0 512 512">
        <path d="M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"></path>
    </symbol>
    <symbol id="icon-plus" viewBox="0 0 448 512">
        <path d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"></path>
    </symbol>
    <symbol id="icon-plus-circle" viewBox="0 0 512 512">
        <path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"></path>
    </symbol>
    <symbol id="icon-plus-square" viewBox="0 0 448 512">
        <path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"></path>
    </symbol>
    <symbol id="icon-save" viewBox="0 0 448 512">
        <path d="M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"></path>
    </symbol>
    <symbol id="icon-sign-out-alt" viewBox="0 0 512 512">
        <path d="M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"></path>
    </symbol>
    <symbol id="icon-smile" viewBox="0 0 496 512">
        <path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm80 168c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zm-160 0c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zm194.8 170.2C334.3 380.4 292.5 400 248 400s-86.3-19.6-114.8-53.8c-13.6-16.3 11-36.7 24.6-20.5 22.4 26.9 55.2 42.2 90.2 42.2s67.8-15.4 90.2-42.2c13.4-16.2 38.1 4.2 24.6 20.5z"></path>
    </symbol>
    <symbol id="icon-snowflake" viewBox="0 0 448 512">
        <path d="M440.3 345.2l-33.8-19.5 26-7c8.2-2.2 13.1-10.7 10.9-18.9l-4-14.9c-2.2-8.2-10.7-13.1-18.9-10.9l-70.8 19-63.9-37 63.8-36.9 70.8 19c8.2 2.2 16.7-2.7 18.9-10.9l4-14.9c2.2-8.2-2.7-16.7-10.9-18.9l-26-7 33.8-19.5c7.4-4.3 9.9-13.7 5.7-21.1L430.4 119c-4.3-7.4-13.7-9.9-21.1-5.7l-33.8 19.5 7-26c2.2-8.2-2.7-16.7-10.9-18.9l-14.9-4c-8.2-2.2-16.7 2.7-18.9 10.9l-19 70.8-62.8 36.2v-77.5l53.7-53.7c6.2-6.2 6.2-16.4 0-22.6l-11.3-11.3c-6.2-6.2-16.4-6.2-22.6 0L256 56.4V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v40.4l-19.7-19.7c-6.2-6.2-16.4-6.2-22.6 0L138.3 48c-6.3 6.2-6.3 16.4 0 22.6l53.7 53.7v77.5l-62.8-36.2-19-70.8c-2.2-8.2-10.7-13.1-18.9-10.9l-14.9 4c-8.2 2.2-13.1 10.7-10.9 18.9l7 26-33.8-19.5c-7.4-4.3-16.8-1.7-21.1 5.7L2.1 145.7c-4.3 7.4-1.7 16.8 5.7 21.1l33.8 19.5-26 7c-8.3 2.2-13.2 10.7-11 19l4 14.9c2.2 8.2 10.7 13.1 18.9 10.9l70.8-19 63.8 36.9-63.8 36.9-70.8-19c-8.2-2.2-16.7 2.7-18.9 10.9l-4 14.9c-2.2 8.2 2.7 16.7 10.9 18.9l26 7-33.8 19.6c-7.4 4.3-9.9 13.7-5.7 21.1l15.5 26.8c4.3 7.4 13.7 9.9 21.1 5.7l33.8-19.5-7 26c-2.2 8.2 2.7 16.7 10.9 18.9l14.9 4c8.2 2.2 16.7-2.7 18.9-10.9l19-70.8 62.8-36.2v77.5l-53.7 53.7c-6.3 6.2-6.3 16.4 0 22.6l11.3 11.3c6.2 6.2 16.4 6.2 22.6 0l19.7-19.7V496c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-40.4l19.7 19.7c6.2 6.2 16.4 6.2 22.6 0l11.3-11.3c6.2-6.2 6.2-16.4 0-22.6L256 387.7v-77.5l62.8 36.2 19 70.8c2.2 8.2 10.7 13.1 18.9 10.9l14.9-4c8.2-2.2 13.1-10.7 10.9-18.9l-7-26 33.8 19.5c7.4 4.3 16.8 1.7 21.1-5.7l15.5-26.8c4.3-7.3 1.8-16.8-5.6-21z"></path>
    </symbol>
    <symbol id="icon-spinner" viewBox="0 0 512 512">
        <path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"></path>
    </symbol>
    <symbol id="icon-sync" viewBox="0 0 512 512">
        <path d="M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"></path>
    </symbol>
    <symbol id="icon-times" viewBox="0 0 352 512">
        <path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path>
    </symbol>
    <symbol id="icon-times-circle" viewBox="0 0 512 512">
        <path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"></path>
    </symbol>
    <symbol id="icon-trash" viewBox="0 0 448 512">
        <path d="M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"></path>
    </symbol>
    <symbol id="icon-trash-alt" viewBox="0 0 448 512">
        <path d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"></path>
    </symbol>
    <symbol id="icon-unlock" viewBox="0 0 448 512">
        <path d="M400 256H152V152.9c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v16c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-16C376 68 307.5-.3 223.5 0 139.5.3 72 69.5 72 153.5V256H48c-26.5 0-48 21.5-48 48v160c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48z"></path>
    </symbol>
    <symbol id="icon-user" viewBox="0 0 448 512">
        <path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"></path>
    </symbol>
    <symbol id="icon-user-cog" viewBox="0 0 640 512">
        <path d="M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z"></path>
    </symbol>
    <symbol id="icon-user-plus" viewBox="0 0 640 512">
        <path d="M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"></path>
    </symbol>
    <symbol id="icon-user-secret" viewBox="0 0 448 512">
        <path d="M383.9 308.3l23.9-62.6c4-10.5-3.7-21.7-15-21.7h-58.5c11-18.9 17.8-40.6 17.8-64v-.3c39.2-7.8 64-19.1 64-31.7 0-13.3-27.3-25.1-70.1-33-9.2-32.8-27-65.8-40.6-82.8-9.5-11.9-25.9-15.6-39.5-8.8l-27.6 13.8c-9 4.5-19.6 4.5-28.6 0L182.1 3.4c-13.6-6.8-30-3.1-39.5 8.8-13.5 17-31.4 50-40.6 82.8-42.7 7.9-70 19.7-70 33 0 12.6 24.8 23.9 64 31.7v.3c0 23.4 6.8 45.1 17.8 64H56.3c-11.5 0-19.2 11.7-14.7 22.3l25.8 60.2C27.3 329.8 0 372.7 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-48.4-25.8-90.4-64.1-114.1zM176 480l-41.6-192 49.6 32 24 40-32 120zm96 0l-32-120 24-40 49.6-32L272 480zm41.7-298.5c-3.9 11.9-7 24.6-16.5 33.4-10.1 9.3-48 22.4-64-25-2.8-8.4-15.4-8.4-18.3 0-17 50.2-56 32.4-64 25-9.5-8.8-12.7-21.5-16.5-33.4-.8-2.5-6.3-5.7-6.3-5.8v-10.8c28.3 3.6 61 5.8 96 5.8s67.7-2.1 96-5.8v10.8c-.1.1-5.6 3.2-6.4 5.8z"></path>
    </symbol>
    <symbol id="icon-users" viewBox="0 0 640 512">
        <path d="M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"></path>
    </symbol>
    <symbol id="icon-wrench" viewBox="0 0 512 512">
        <path d="M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"></path>
    </symbol>
    <symbol id="icon-refresh" viewBox="0 0 512 512">
        <path d="M464 16c-17.67 0-32 14.31-32 32v74.09C392.1 66.52 327.4 32 256 32C161.5 32 78.59 92.34 49.58 182.2c-5.438 16.81 3.797 34.88 20.61 40.28c16.89 5.5 34.88-3.812 40.3-20.59C130.9 138.5 189.4 96 256 96c50.5 0 96.26 24.55 124.4 64H336c-17.67 0-32 14.31-32 32s14.33 32 32 32h128c17.67 0 32-14.31 32-32V48C496 30.31 481.7 16 464 16zM441.8 289.6c-16.92-5.438-34.88 3.812-40.3 20.59C381.1 373.5 322.6 416 256 416c-50.5 0-96.25-24.55-124.4-64H176c17.67 0 32-14.31 32-32s-14.33-32-32-32h-128c-17.67 0-32 14.31-32 32v144c0 17.69 14.33 32 32 32s32-14.31 32-32v-74.09C119.9 445.5 184.6 480 255.1 480c94.45 0 177.4-60.34 206.4-150.2C467.9 313 458.6 294.1 441.8 289.6z"></path>
    </symbol>
    </svg>
`},"./src/strophe-shims.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{DOMParser:()=>r,WebSocket:()=>n,getDummyXMLDOMDocument:()=>o});const n=window.WebSocket,r=window.DOMParser;function o(){return document.implementation.createDocument("jabber:client","strophe",null)}},"./src/templates/audio.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=(e,t)=>n.html`<audio controls src="${e}"></audio>${t?"":n.html`<a target="_blank" rel="noopener" href="${e}">${e}</a>`}`},"./src/templates/background_logo.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/headless/dist/converse-headless.js");const o=()=>n.html`
    <div class="inner-content converse-brand row">
        <div class="converse-brand__padding"></div>
        <div class="converse-brand__heading">
            <svg height="200px"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                viewBox="0 0 364 364"
                version="1.1">
                <title>Logo Converse</title>
                <defs>
                    <linearGradient id="gradient" x1="92.14" y1="27.64" x2="267.65" y2="331.62" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#fff1d1"/>
                        <stop offset="0.05" stop-color="#fae8c1"/>
                        <stop offset="0.15" stop-color="#f0d5a1"/>
                        <stop offset="0.27" stop-color="#e7c687"/>
                        <stop offset="0.4" stop-color="#e1bb72"/>
                        <stop offset="0.54" stop-color="#dcb264"/>
                        <stop offset="0.71" stop-color="#daad5c"/>
                        <stop offset="1" stop-color="#d9ac59"/>
                    </linearGradient>
                    <filter id="shadow">
                        <feGaussianBlur in="SourceAlpha" stdDeviation="2.3" result="blur1"/>
                        <feOffset in="blur1" dx="3" dy="3" result="blur2"/>
                        <feColorMatrix in="blur2" type="matrix" result="blur3"
                            values="1 0 0 0 0.1
                                    0 1 0 0 0.1
                                    0 0 1 0 0.1
                                    0 0 0 1 0"/>
                        <feMerge>
                            <feMergeNode in="blur3"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                <g filter="url(#shadow)">
                    <path d="M221.46,103.71c0,18.83-29.36,18.83-29.12,0C192.1,84.88,221.46,84.88,221.46,103.71Z" fill="#d9ac59"/>
                    <path d="M179.9,4.15A175.48,175.48,0,1,0,355.38,179.63,175.48,175.48,0,0,0,179.9,4.15Zm-40.79,264.5c-.23-17.82,27.58-17.82,27.58,0S138.88,286.48,139.11,268.65ZM218.6,168.24A79.65,79.65,0,0,1,205.15,174a12.76,12.76,0,0,0-6.29,4.65L167.54,222a1.36,1.36,0,0,1-2.46-.8v-35.8a2.58,2.58,0,0,0-3.06-2.53c-15.43,3-30.23,7.7-42.73,19.94-38.8,38-29.42,105.69,16.09,133.16a162.25,162.25,0,0,1-91.47-67.27C-3.86,182.26,34.5,47.25,138.37,25.66c46.89-9.75,118.25,5.16,123.73,62.83C265.15,120.64,246.56,152.89,218.6,168.24Z" fill="url(#gradient)"/>
                </g>
            </svg>
            <span class="converse-brand__text">
                <span>converse<span class="subdued">.js</span></span>
                <p class="byline">messaging freedom</p>
            </span>
        </div>
        ${"overlayed"===r.api.settings.get("view_mode")?n.html`<div class="converse-brand__padding"></div>`:""}
    </div>`},"./src/templates/file.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./src/i18n/index.js"),r=s("./node_modules/lit/index.js");const o=(e,t)=>{const s=(0,n.__)('Download file "%1$s"',t);return r.html`<a target="_blank" rel="noopener" href="${e}">${s}</a>`}},"./src/templates/form_captcha.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <fieldset class="form-group">
        ${e.label?n.html`<label>${e.label}</label>`:""}
        <img src="data:${e.type};base64,${e.data}">
        <input name="${e.name}" type="text" ?required="${e.required}" />
    </fieldset>
`},"./src/templates/form_checkbox.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <fieldset class="form-group">
        <input id="${e.id}" name="${e.name}" type="checkbox" ?checked=${e.checked} ?required=${e.required} />
        <label class="form-check-label" for="${e.id}">${e.label}</label>
    </fieldset>`},"./src/templates/form_help.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`<p class="form-help">${e.text}</p>`},"./src/templates/form_input.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="form-group">
        ${"hidden"!==e.type?n.html`<label for="${e.id}">${e.label}</label>`:""}

        <!-- This is a hack to prevent Chrome from auto-filling the username in
             any of the other input fields in the MUC configuration form. -->
        ${"password"===e.type&&e.fixed_username?n.html`
            <input class="hidden-username" type="text" autocomplete="username" value="${e.fixed_username}"></input>
        `:""}

        <input
            autocomplete="${e.autocomplete||""}"
            class="form-control"
            id="${e.id}"
            name="${e.name}"
            placeholder="${e.placeholder||""}"
            type="${e.type}"
            value="${e.value||""}"
            ?required=${e.required} />
    </div>`},"./src/templates/form_select.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="form-group">
        <label for="${e.id}">${e.label}</label>
        <select class="form-control" id="${e.id}" name="${e.name}" ?multiple="${e.multiple}">
            ${e.options?.map((e=>(e=>n.html`<option value="${e.value}" ?selected="${e.selected}">${e.label}</option>`)(e)))}
        </select>
    </div>`},"./src/templates/form_textarea.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/headless/utils/core.js");const o=e=>{const t=r.default.getUniqueId();return n.html`
        <div class="form-group">
            <label class="label-ta" for="${t}">${e.label}</label>
            <textarea name="${e.name}" id="${t}" class="form-control">${e.value}</textarea>
        </div>
    `}},"./src/templates/form_url.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <label>${e.label}
        <a class="form-url" target="_blank" rel="noopener" href="${e.value}">${e.value}</a>
    </label>`},"./src/templates/form_username.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=e=>n.html`
    <div class="form-group">
        ${e.label?n.html`<label>${e.label}</label>`:""}
        <div class="input-group">
                <input name="${e.name}"
                       class="form-control"
                       type="${e.type}"
                       value="${e.value||""}"
                       ?required="${e.required}" />
            <div class="input-group-append">
                <div class="input-group-text" title="${e.domain}">${e.domain}</div>
            </div>
        </div>
    </div>`},"./src/templates/gif.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");s("./src/shared/components/gif.js");const r=(e,t)=>n.html`<converse-gif autoplay noloop fallback='empty' src=${e}></converse-gif>${t?"":n.html`<a target="_blank" rel="noopener" href="${e}">${e}</a>`}`},"./src/templates/hyperlink.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./src/headless/dist/converse-headless.js"),r=s("./node_modules/lit/index.js");function o(e){e.preventDefault(),n.api.rooms.open(e.target.href)}const i=(e,t)=>{let s=e.normalizePath().toString();return e._parts.protocol||t.startsWith("http://")||t.startsWith("https://")||(s="http://"+s),"xmpp"===e._parts.protocol&&"join"===e._parts.query?r.html`
            <a target="_blank"
               rel="noopener"
               @click=${o}
               href="${s}">${t}</a>`:r.html`<a target="_blank" rel="noopener" href="${s}">${t}</a>`}},"./src/templates/image.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lit/index.js"),r=s("./src/shared/directives/image.js");const o=e=>n.html`${(0,r.renderImage)(e.src||e.url,e.href,e.onLoad,e.onClick)}`},"./src/templates/spinner.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.classes?.includes("hor_centered")?n.html`<div class="spinner__container"><converse-icon size="1em" class="fa fa-spinner spinner centered ${e.classes||""}"></converse-icon></div>`:n.html`<converse-icon size="1em" class="fa fa-spinner spinner centered ${e.classes||""}"></converse-icon>`}},"./src/templates/video.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lit/index.js");const r=(e,t)=>n.html`<video controls preload="metadata" src="${e}"></video>${t?"":n.html`<a target="_blank" rel="noopener" href="${e}">${e}</a>`}`},"./src/utils/file.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{MIMETYPES_MAP:()=>n});const n={aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",cda:"application/x-cdf",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gif:"image/gif",gz:"application/gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",m4a:"audio/mp4",mid:"audio/midi",midi:"audio/midi",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"text/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"}},"./src/utils/html.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{addClass:()=>M,ancestor:()=>D,default:()=>U,getFileName:()=>k,getHyperlinkTemplate:()=>P,getNameAndValue:()=>T,getOOBURLMarkup:()=>N,hasClass:()=>O,removeClass:()=>$,removeElement:()=>R,slideIn:()=>z,slideOut:()=>L});var n=s("./src/templates/audio.js"),r=s("./src/templates/file.js"),o=s("./src/templates/form_captcha.js"),i=s("./src/templates/form_checkbox.js"),a=s("./src/templates/form_help.js"),l=s("./src/templates/form_input.js"),c=s("./src/templates/form_select.js"),d=s("./src/templates/form_textarea.js"),u=s("./src/templates/form_url.js"),h=s("./src/templates/form_username.js"),f=s("./src/templates/hyperlink.js"),m=s("./src/templates/video.js"),p=s("./src/headless/utils/core.js"),g=s("./src/headless/dist/converse-headless.js"),_=s("./src/headless/utils/url.js"),v=s("./node_modules/lit/index.js");const{sizzle:y,Strophe:b}=g.converse.env,j=["http","https","xmpp","mailto"];function w(e,t){return{"muc#roomconfig_lang":"language","muc#roomconfig_roomsecret":t?.new_password?"new-password":"current-password"}[e]}const S={"text-private":"password","text-single":"text",fixed:"label",boolean:"checkbox",hidden:"hidden","jid-multi":"textarea","list-single":"dropdown","list-multi":"dropdown"},x={"xs:anyURI":"url","xs:byte":"number","xs:date":"date","xs:dateTime":"datetime","xs:int":"number","xs:integer":"number","xs:time":"time"},E=/\s*\n\s*/;function A(e){let t;e=e.tree?.()??e;const s=[],n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,(e=>"body"===e.parentElement.nodeName.toLowerCase()?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT));for(;t=n.nextNode();)s.push(t);return s.forEach((e=>E.test(e.data)&&e.parentElement.removeChild(e))),e}const C=new XMLSerializer;function T(e){const t=e.getAttribute("name");if(!t)return null;let s;return s="checkbox"===e.getAttribute("type")?e.checked?1:0:"TEXTAREA"==e.tagName?e.value.split("\n").filter((e=>e.trim())):"SELECT"==e.tagName?p.default.getSelectValues(e):e.value,{name:t,value:s}}function I(e){const t=S[e.getAttribute("type")];if("text"==t){const s=e.getElementsByTagNameNS("http://jabber.org/protocol/xdata-validate","validate");if(1===s.length){const e=s[0].getAttribute("datatype");return x[e]||t}}return t}function k(e){const t=(0,_.getURI)(e);try{return decodeURI(t.filename())}catch(e){return g.log.debug(e),t.filename()}}function N(e){const t=(0,_.getURI)(e);return null===t?e:(0,_.isVideoURL)(t)?(0,m.default)(e):(0,_.isAudioURL)(t)?(0,n.default)(e):((0,_.isImageURL)(t),(0,r.default)(t.toString(),k(t)))}function O(e,t){return t instanceof Element&&t.classList.contains(e)}function M(e,t){return t instanceof Element&&t.classList.add(e),t}function $(e,t){return t instanceof Element&&t.classList.remove(e),t}function R(e){return e instanceof Element&&e.parentNode&&e.parentNode.removeChild(e),e}function D(e,t){let s=e;for(;null!==s&&!y.matchesSelector(s,t);)s=s.parentElement;return s}function P(e){const t=RegExp("^w{3}.","ig").test(e)?`http://${e}`:e,s=(0,_.getURI)(e);return null===s||!function(e){try{return!!new URL(e)}catch(e){return!1}}(t)||!function(e){return!!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:j).includes(e)}(s._parts.protocol)&&s._parts.protocol?e:(0,f.default)(s,e)}function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return new Promise(((s,n)=>{if(!e){const e="An element needs to be passed in to slideOut";return g.log.warn(e),void n(new Error(e))}const r=e.getAttribute("data-slider-marker");r&&(e.removeAttribute("data-slider-marker"),cancelAnimationFrame(r));const o=p.default.calculateElementHeight(e);if(window.converse_disable_effects)return e.style.height=o+"px",function(e){e.removeAttribute("data-slider-marker"),e.classList.remove("collapsed"),e.style.overflow="",e.style.height=""}(e),void s();if(!p.default.hasClass("collapsed",e)&&!p.default.hasClass("hidden",e))return void s();const i=t/17;let a=0;e.style.height="0",e.style.overflow="hidden",e.classList.remove("hidden"),e.classList.remove("collapsed"),e.setAttribute("data-slider-marker",requestAnimationFrame((function t(){a+=o/i,a<o?(e.style.height=a+"px",e.setAttribute("data-slider-marker",requestAnimationFrame(t).toString())):(e.removeAttribute("data-slider-marker"),e.style.height=p.default.calculateElementHeight(e)+"px",e.style.overflow="",e.style.height="",s())})).toString())}))}function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return new Promise(((s,n)=>{if(!e){const e="An element needs to be passed in to slideIn";return g.log.warn(e),n(new Error(e))}if(p.default.hasClass("collapsed",e))return s(e);if(window.converse_disable_effects)return e.classList.add("collapsed"),e.style.height="",s(e);const r=e.getAttribute("data-slider-marker");r&&(e.removeAttribute("data-slider-marker"),cancelAnimationFrame(r));const o=e.offsetHeight,i=t/17;let a=o;e.style.overflow="hidden",e.setAttribute("data-slider-marker",requestAnimationFrame((function t(){a-=o/i,a>0?(e.style.height=a+"px",e.setAttribute("data-slider-marker",requestAnimationFrame(t).toString())):(e.removeAttribute("data-slider-marker"),e.classList.add("collapsed"),e.style.height="",s(e))})).toString())}))}function F(e,t){e.classList.remove("visible"),t?.()}p.default.calculateElementHeight=function(e){return Array.from(e.children).reduce(((e,t)=>e+t.offsetHeight),0)},p.default.getNextElement=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",s=e.nextElementSibling;for(;null!==s&&!y.matchesSelector(s,t);)s=s.nextElementSibling;return s},p.default.getPreviousElement=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",s=e.previousElementSibling;for(;null!==s&&!y.matchesSelector(s,t);)s=s.previousElementSibling;return s},p.default.getFirstChildElement=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",s=e.firstElementChild;for(;null!==s&&!y.matchesSelector(s,t);)s=s.nextElementSibling;return s},p.default.getLastChildElement=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",s=e.lastElementChild;for(;null!==s&&!y.matchesSelector(s,t);)s=s.previousElementSibling;return s},p.default.toggleClass=function(e,t){p.default.hasClass(e,t)?$(e,t):M(e,t)},p.default.getElementFromTemplateResult=function(e){const t=document.createElement("div");return(0,v.render)(e,t),t.firstElementChild},p.default.showElement=e=>{$("collapsed",e),$("hidden",e)},p.default.hideElement=function(e){return e instanceof Element&&e.classList.add("hidden"),e},p.default.nextUntil=function(e,t){const s=[];let n=e.nextElementSibling;for(;null!==n&&!n.matches(t);)s.push(n),n=n.nextElementSibling;return s},p.default.unescapeHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},p.default.escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p.default.slideInAllElements=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return Promise.all(Array.from(e).map((e=>p.default.slideIn(e,t))))},p.default.slideToggleElement=function(e,t){return p.default.hasClass("collapsed",e)||p.default.hasClass("hidden",e)?p.default.slideOut(e,t):p.default.slideIn(e,t)},p.default.isInDOM=function(e){return document.querySelector("body").contains(e)},p.default.isVisible=function(e){return null!==e&&(!p.default.hasClass("hidden",e)&&(e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0))},p.default.fadeIn=function(e,t){if(e||g.log.warn("An element needs to be passed in to fadeIn"),window.converse_disable_effects)return e.classList.remove("hidden"),F(e,t);p.default.hasClass("hidden",e)?(e.classList.add("visible"),e.classList.remove("hidden"),e.addEventListener("webkitAnimationEnd",(()=>F(e,t))),e.addEventListener("animationend",(()=>F(e,t))),e.addEventListener("oanimationend",(()=>F(e,t)))):F(e,t)},p.default.xForm2TemplateResult=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("list-single"===e.getAttribute("type")||"list-multi"===e.getAttribute("type")){const t=p.default.queryChildren(e,"value").map((e=>e?.textContent)),s=p.default.queryChildren(e,"option").map((s=>{const n=s.querySelector("value")?.textContent;return{value:n,label:s.getAttribute("label"),selected:t.includes(n),required:!!e.querySelector("required")}}));return(0,c.default)({options:s,id:p.default.getUniqueId(),label:e.getAttribute("label"),multiple:"list-multi"===e.getAttribute("type"),name:e.getAttribute("var"),required:!!e.querySelector("required")})}if("fixed"===e.getAttribute("type")){const t=e.querySelector("value")?.textContent;return(0,a.default)({text:t})}if("jid-multi"===e.getAttribute("type"))return(0,d.default)({name:e.getAttribute("var"),label:e.getAttribute("label")||"",value:e.querySelector("value")?.textContent,required:!!e.querySelector("required")});if("boolean"===e.getAttribute("type")){const t=e.querySelector("value")?.textContent;return(0,i.default)({id:p.default.getUniqueId(),name:e.getAttribute("var"),label:e.getAttribute("label")||"",checked:"1"===t||"true"===t?'checked="1"':""})}if("url"===e.getAttribute("var"))return(0,u.default)({label:e.getAttribute("label")||"",value:e.querySelector("value")?.textContent});if("username"===e.getAttribute("var"))return(0,h.default)({domain:" @"+s.domain,name:e.getAttribute("var"),type:I(e),label:e.getAttribute("label")||"",value:e.querySelector("value")?.textContent,required:!!e.querySelector("required")});if("password"===e.getAttribute("var"))return(0,l.default)({name:e.getAttribute("var"),type:"password",label:e.getAttribute("label")||"",value:e.querySelector("value")?.textContent,required:!!e.querySelector("required")});if("ocr"===e.getAttribute("var")){const s=e.querySelector("uri"),n=y('data[cid="'+s.textContent.replace(/^cid:/,"")+'"]',t)[0];return(0,o.default)({label:e.getAttribute("label"),name:e.getAttribute("var"),data:n?.textContent,type:s.getAttribute("type"),required:!!e.querySelector("required")})}{const t=e.getAttribute("var");return(0,l.default)({id:p.default.getUniqueId(),label:e.getAttribute("label")||"",name:t,fixed_username:s?.fixed_username,autocomplete:w(t,s),placeholder:null,required:!!e.querySelector("required"),type:I(e),value:e.querySelector("value")?.textContent})}},Object.assign(p.default,{hasClass:O,addClass:M,ancestor:D,getOOBURLMarkup:N,isEqualNode:function(e,t){if(!p.default.isElement(e))throw new Error("Element being compared must be an Element!");e=A(e),t=A(t);let s=e.isEqualNode(t);if(!s){const{xmlHtmlNode:n}=b,r=C.serializeToString(e),o=C.serializeToString(t);s=r===o||n(r).isEqualNode(n(o))}return s},removeClass:$,removeElement:R,slideIn:z,slideOut:L});const U=p.default},"./node_modules/bootstrap.native/dist/bootstrap-native.js":function(e,t,s){var n,r,o;r=[],void 0===(o="function"==typeof(n=function(){"use strict";var e=void 0!==s.g?s.g:this||window,t=document,n=t.documentElement,r="body",o=e.BSN={},i=o.supports=[],a="data-toggle",l="data-dismiss",c="Alert",d="Button",u="Collapse",h="Dropdown",f="Modal",m="Popover",p="Tab",g="data-backdrop",_="data-keyboard",v="data-target",y="data-height",b="data-title",j="data-dismissible",w="data-trigger",S="data-animation",x="data-container",E="data-placement",A="data-delay",C="backdrop",T="keyboard",I="delay",k="content",N="target",O="currentTarget",M="animation",$="placement",R="container",D="offsetTop",P="offsetLeft",L="scrollTop",z="scrollLeft",F="clientWidth",U="clientHeight",B="offsetWidth",q="offsetHeight",H="innerWidth",G="scrollHeight",W="height",V="aria-expanded",J="aria-hidden",Q="aria-selected",Y="click",K="focus",X="hover",Z="keydown",ee="keyup",te="resize",se="onmouseleave"in t?["mouseenter","mouseleave"]:["mouseover","mouseout"],ne="show",re="shown",oe="hide",ie="hidden",ae="close",le="closed",ce="change",de="getAttribute",ue="setAttribute",he="hasAttribute",fe="createElement",me="appendChild",pe="innerHTML",ge="getElementsByTagName",_e="preventDefault",ve="getBoundingClientRect",ye="querySelectorAll",be="getElementsByClassName",je="getComputedStyle",we="indexOf",Se="parentNode",xe="length",Ee="toLowerCase",Ae="Transition",Ce="Duration",Te="Webkit",Ie="style",ke="push",Ne="tabindex",Oe="contains",Me="active",$e="show",Re="collapsing",De="left",Pe="right",Le="top",ze="bottom",Fe=/\b(top|bottom|left|right)+/,Ue=0,Be="fixed-top",qe="fixed-bottom",He=Te+Ae in n[Ie]||Ae[Ee]()in n[Ie],Ge=Te+Ae in n[Ie]?Te[Ee]()+Ae+"End":Ae[Ee]()+"end",We=Te+Ce in n[Ie]?Te[Ee]()+Ae+Ce:Ae[Ee]()+Ce,Ve=function(e){e.focus?e.focus():e.setActive()},Je=function(e,t){e.classList.add(t)},Qe=function(e,t){e.classList.remove(t)},Ye=function(e,t){return e.classList[Oe](t)},Ke=function(e,t){return[].slice.call(e[be](t))},Xe=function(e,s){return"object"==typeof e?e:(s||t).querySelector(e)},Ze=function(e,s){var n=s.charAt(0),r=s.substr(1);if("."===n){for(;e&&e!==t;e=e[Se])if(null!==Xe(s,e[Se])&&Ye(e,r))return e}else if("#"===n)for(;e&&e!==t;e=e[Se])if(e.id===r)return e;return!1},et=function(e,t,s,n){n=n||!1,e.addEventListener(t,s,n)},tt=function(e,t,s,n){n=n||!1,e.removeEventListener(t,s,n)},st=function(e,t,s,n){et(e,t,(function r(o){s(o),tt(e,t,r,n)}),n)},nt=!!function(){var t=!1;try{var s=Object.defineProperty({},"passive",{get:function(){t=!0}});st(e,"testPassive",null,s)}catch(e){}return t}()&&{passive:!0},rt=function(t){var s=He?e[je](t)[We]:0;return s="number"!=typeof(s=parseFloat(s))||isNaN(s)?0:1e3*s},ot=function(e,t){var s=0;rt(e)?st(e,Ge,(function(e){!s&&t(e),s=1})):setTimeout((function(){!s&&t(),s=1}),17)},it=function(e,t,s){var n=new CustomEvent(e+".bs."+t);n.relatedTarget=s,this.dispatchEvent(n)},at=function(){return{y:e.pageYOffset||n[L],x:e.pageXOffset||n[z]}},lt=function(e,s,o,i){var a,l,c,d,u,h,f={w:s[B],h:s[q]},m=n[F]||t[r][F],p=n[U]||t[r][U],g=e[ve](),_=i===t[r]?at():{x:i[P]+i[z],y:i[D]+i[L]},v={w:g[Pe]-g[De],h:g[ze]-g[Le]},y=Ye(s,"popover"),b=Xe(".arrow",s),j=g[Le]+v.h/2-f.h/2<0,w=g[De]+v.w/2-f.w/2<0,S=g[De]+f.w/2+v.w/2>=m,x=g[Le]+f.h/2+v.h/2>=p,E=g[Le]-f.h<0,A=g[De]-f.w<0,C=g[Le]+f.h+v.h>=p,T=g[De]+f.w+v.w>=m;o=(o=(o=(o=(o=(o===De||o===Pe)&&A&&T?Le:o)===Le&&E?ze:o)===ze&&C?Le:o)===De&&A?Pe:o)===Pe&&T?De:o,-1===s.className[we](o)&&(s.className=s.className.replace(Fe,o)),u=b[B],h=b[q],o===De||o===Pe?(l=o===De?g[De]+_.x-f.w-(y?u:0):g[De]+_.x+v.w,j?(a=g[Le]+_.y,c=v.h/2-u):x?(a=g[Le]+_.y-f.h+v.h,c=f.h-v.h/2-u):(a=g[Le]+_.y-f.h/2+v.h/2,c=f.h/2-(y?.9*h:h/2))):o!==Le&&o!==ze||(a=o===Le?g[Le]+_.y-f.h-(y?h:0):g[Le]+_.y+v.h,w?(l=0,d=g[De]+v.w/2-u):S?(l=m-1.01*f.w,d=f.w-(m-g[De])+v.w/2-u/2):(l=g[De]+_.x-f.w/2+v.w/2,d=f.w/2-(y?u:u/2))),s[Ie][Le]=a+"px",s[Ie][De]=l+"px",c&&(b[Ie][Le]=c+"px"),d&&(b[Ie][De]=d+"px")};o.version="2.0.27";var ct=function(e){e=Xe(e);var t=this,s="alert",n=Ze(e,"."+s),r=function(){Ye(n,"fade")?ot(n,i):i()},o=function(r){n=Ze(r[N],"."+s),(e=Xe("["+l+'="'+s+'"]',n))&&n&&(e===r[N]||e[Oe](r[N]))&&t.close()},i=function(){it.call(n,le,s),tt(e,Y,o),n[Se].removeChild(n)};this.close=function(){n&&e&&Ye(n,$e)&&(it.call(n,ae,s),Qe(n,$e),n&&r())},c in e||et(e,Y,o),e[c]=t};i[ke]([c,ct,"["+l+'="alert"]']);var dt=function(e){e=Xe(e);var s=!1,n="button",r="checked",o="LABEL",i="INPUT",a=function(e){32===(e.which||e.keyCode)&&e[N]===t.activeElement&&c(e)},l=function(e){32===(e.which||e.keyCode)&&e[_e]()},c=function(t){var a=t[N].tagName===o?t[N]:t[N][Se].tagName===o?t[N][Se]:null;if(a){var l=Ke(a[Se],"btn"),c=a[ge](i)[0];if(c){if("checkbox"===c.type&&(c[r]?(Qe(a,Me),c[de](r),c.removeAttribute(r),c[r]=!1):(Je(a,Me),c[de](r),c[ue](r,r),c[r]=!0),s||(s=!0,it.call(c,ce,n),it.call(e,ce,n))),"radio"===c.type&&!s&&(!c[r]||0===t.screenX&&0==t.screenY)){Je(a,Me),Je(a,K),c[ue](r,r),c[r]=!0,it.call(c,ce,n),it.call(e,ce,n),s=!0;for(var d=0,u=l[xe];d<u;d++){var h=l[d],f=h[ge](i)[0];h!==a&&Ye(h,Me)&&(Qe(h,Me),f.removeAttribute(r),f[r]=!1,it.call(f,ce,n))}}setTimeout((function(){s=!1}),50)}}},u=function(e){Je(e[N][Se],K)},h=function(e){Qe(e[N][Se],K)};if(!(d in e)){et(e,Y,c),et(e,ee,a),et(e,Z,l);for(var f=Ke(e,"btn"),m=0;m<f.length;m++){var p=f[m][ge](i)[0];et(p,K,u),et(p,"blur",h)}}var g=Ke(e,"btn"),_=g[xe];for(m=0;m<_;m++)!Ye(g[m],Me)&&Xe("input:checked",g[m])&&Je(g[m],Me);e[d]=this};i[ke]([d,dt,"["+a+'="buttons"]']);var ut=function(e,t){e=Xe(e),t=t||{};var s,n,r=null,o=null,i=this,a=e[de]("data-parent"),l="collapse",c="collapsed",d="isAnimating",h=function(e,t){it.call(e,ne,l),e[d]=!0,Je(e,Re),Qe(e,l),e[Ie][W]=e[G]+"px",ot(e,(function(){e[d]=!1,e[ue](V,"true"),t[ue](V,"true"),Qe(e,Re),Je(e,l),Je(e,$e),e[Ie][W]="",it.call(e,re,l)}))},f=function(e,t){it.call(e,oe,l),e[d]=!0,e[Ie][W]=e[G]+"px",Qe(e,l),Qe(e,$e),Je(e,Re),e[B],e[Ie][W]="0px",ot(e,(function(){e[d]=!1,e[ue](V,"false"),t[ue](V,"false"),Qe(e,Re),Je(e,l),e[Ie][W]="",it.call(e,ie,l)}))},m=function(){var t=e.href&&e[de]("href"),s=e[de](v),n=t||s&&"#"===s.charAt(0)&&s;return n&&Xe(n)};this.toggle=function(e){e[_e](),Ye(o,$e)?i.hide():i.show()},this.hide=function(){o[d]||(f(o,e),Je(e,c))},this.show=function(){r&&(s=Xe("."+l+"."+$e,r),n=s&&(Xe("["+v+'="#'+s.id+'"]',r)||Xe('[href="#'+s.id+'"]',r))),(!o[d]||s&&!s[d])&&(n&&s!==o&&(f(s,n),Je(n,c)),h(o,e),Qe(e,c))},u in e||et(e,Y,i.toggle),(o=m())[d]=!1,r=Xe(t.parent)||a&&Ze(e,a),e[u]=i};i[ke]([u,ut,"["+a+'="collapse"]']);var ht=function(e,s){e=Xe(e),this.persist=!0===s||"true"===e[de]("data-persist")||!1;var n=this,r="children",o=e[Se],i="dropdown",l="open",c=null,d=Xe(".dropdown-menu",o),u=function(){for(var e=d[r],t=[],s=0;s<e[xe];s++)e[s][r][xe]&&"A"===e[s][r][0].tagName&&t[ke](e[s][r][0]),"A"===e[s].tagName&&t[ke](e[s]);return t}(),f=function(e){(e.href&&"#"===e.href.slice(-1)||e[Se]&&e[Se].href&&"#"===e[Se].href.slice(-1))&&this[_e]()},m=function(){var s=e[l]?et:tt;s(t,Y,p),s(t,Z,_),s(t,ee,v),s(t,K,p,!0)},p=function(t){var s=t[N],r=s&&(s[de](a)||s[Se]&&de in s[Se]&&s[Se][de](a));(t.type!==K||s!==e&&s!==d&&!d[Oe](s))&&(s!==d&&!d[Oe](s)||!n.persist&&!r)&&(c=s===e||e[Oe](s)?e:null,b(),f.call(t,s))},g=function(t){c=e,y(),f.call(t,t[N])},_=function(e){var t=e.which||e.keyCode;38!==t&&40!==t||e[_e]()},v=function(s){var r=s.which||s.keyCode,o=t.activeElement,i=u[we](o),a=o===e,h=d[Oe](o),f=o[Se]===d||o[Se][Se]===d;f&&(i=a?0:38===r?i>1?i-1:0:40===r&&i<u[xe]-1?i+1:i,u[i]&&Ve(u[i])),(u[xe]&&f||!u[xe]&&(h||a)||!h)&&e[l]&&27===r&&(n.toggle(),c=null)},y=function(){it.call(o,ne,i,c),Je(d,$e),Je(o,$e),e[ue](V,!0),it.call(o,re,i,c),e[l]=!0,tt(e,Y,g),setTimeout((function(){Ve(d[ge]("INPUT")[0]||e),m()}),1)},b=function(){it.call(o,oe,i,c),Qe(d,$e),Qe(o,$e),e[ue](V,!1),it.call(o,ie,i,c),e[l]=!1,m(),Ve(e),setTimeout((function(){et(e,Y,g)}),1)};e[l]=!1,this.toggle=function(){Ye(o,$e)&&e[l]?b():y()},h in e||(!Ne in d&&d[ue](Ne,"0"),et(e,Y,g)),e[h]=n};i[ke]([h,ht,"["+a+'="dropdown"]']);var ft=function(s,o){s=Xe(s);var i="modal",a="static",c="modalTrigger",d="paddingRight",u="modal-backdrop",h="isAnimating",m=s[de](v)||s[de]("href"),p=Xe(m),y=Ye(s,i)?s:p;if(Ye(s,i)&&(s=null),y){o=o||{},this[T]=!1!==o[T]&&"false"!==y[de](_),this[C]=o[C]!==a&&y[de](g)!==a||a,this[C]=!1!==o[C]&&"false"!==y[de](g)&&this[C],this[M]=!!Ye(y,"fade"),this[k]=o[k],y[h]=!1;var b,j,w,S,x,E=this,A=null,I=Ke(n,Be).concat(Ke(n,qe)),O=function(){var t=n[ve]();return e[H]||t[Pe]-Math.abs(t[De])},$=function(){var s,n=e[je](t[r]),o=parseInt(n[d],10);if(b&&(t[r][Ie][d]=o+j+"px",y[Ie][d]=j+"px",I[xe]))for(var i=0;i<I[xe];i++)s=e[je](I[i])[d],I[i][Ie][d]=parseInt(s)+j+"px"},R=function(){if(t[r][Ie][d]="",y[Ie][d]="",I[xe])for(var e=0;e<I[xe];e++)I[e][Ie][d]=""},D=function(){var e,s=t[fe]("div");return s.className=i+"-scrollbar-measure",t[r][me](s),e=s[B]-s[F],t[r].removeChild(s),e},P=function(){b=t[r][F]<O(),j=D()},L=function(){var e=t[fe]("div");null===(w=Xe("."+u))&&(e[ue]("class",u+(E[M]?" fade":"")),w=e,t[r][me](w)),Ue=1},z=function(){(w=Xe("."+u))&&null!==w&&"object"==typeof w&&(Ue=0,t[r].removeChild(w),w=null)},U=function(){Ve(y),y[h]=!1,it.call(y,re,i,A),et(e,te,E.update,nt),et(y,Y,V),et(t,Z,W)},q=function(){y[Ie].display="",s&&Ve(s),it.call(y,ie,i),Ke(t,i+" "+$e)[0]||(R(),Qe(t[r],i+"-open"),w&&Ye(w,"fade")?(Qe(w,$e),ot(w,z)):z(),tt(e,te,E.update,nt),tt(y,Y,V),tt(t,Z,W)),y[h]=!1},G=function(e){if(!y[h]){var t=e[N];(t=t[he](v)||t[he]("href")?t:t[Se])!==s||Ye(y,$e)||(y[c]=s,A=s,E.show(),e[_e]())}},W=function(e){y[h]||E[T]&&27==e.which&&Ye(y,$e)&&E.hide()},V=function(e){if(!y[h]){var t=e[N];Ye(y,$e)&&(t[Se][de](l)===i||t[de](l)===i||t===y&&E[C]!==a)&&(E.hide(),A=null,e[_e]())}};this.toggle=function(){Ye(y,$e)?this.hide():this.show()},this.show=function(){Ye(y,$e)||y[h]||(clearTimeout(x),x=setTimeout((function(){y[h]=!0,it.call(y,ne,i,A);var e=Ke(t,i+" "+$e)[0];e&&e!==y&&(c in e&&e[c][f].hide(),f in e&&e[f].hide()),E[C]&&!Ue&&!w&&L(),w&&!Ye(w,$e)&&(w[B],S=rt(w),Je(w,$e)),setTimeout((function(){y[Ie].display="block",P(),$(),Je(t[r],i+"-open"),Je(y,$e),y[ue](J,!1),Ye(y,"fade")?ot(y,U):U()}),He&&w&&S?S:1)}),1))},this.hide=function(){!y[h]&&Ye(y,$e)&&(clearTimeout(x),x=setTimeout((function(){y[h]=!0,it.call(y,oe,i),w=Xe("."+u),S=w&&rt(w),Qe(y,$e),y[ue](J,!0),setTimeout((function(){Ye(y,"fade")?ot(y,q):q()}),He&&w&&S?S:2)}),2))},this.setContent=function(e){Xe("."+i+"-content",y)[pe]=e},this.update=function(){Ye(y,$e)&&(P(),$())},s&&!(f in s)&&et(s,Y,G),E[k]&&E.setContent(E[k]),s?(s[f]=E,y[c]=s):y[f]=E}};i[ke]([f,ft,"["+a+'="modal"]']);var mt=function(s,n){s=Xe(s),n=n||{};var o=s[de](w),i=s[de](S),a=s[de](E),l=s[de](j),c=s[de](A),d=s[de](x),u="popover",h="template",f="trigger",p="class",g="div",_="fade",v="data-content",y="dismissible",C='<button type="button" class="close"></button>',T=Xe(n[R]),k=Xe(d),O=Ze(s,".modal"),D=Ze(s,"."+Be),P=Ze(s,"."+qe);this[h]=n[h]?n[h]:null,this[f]=n[f]?n[f]:o||X,this[M]=n[M]&&n[M]!==_?n[M]:i||_,this[$]=n[$]?n[$]:a||Le,this[I]=parseInt(n[I]||c)||200,this[y]=!(!n[y]&&"true"!==l),this[R]=T||k||D||P||O||t[r];var L=this,z=n.title||s[de](b)||null,F=n.content||s[de](v)||null;if(F||this[h]){var U=null,B=0,q=this[$],H=function(e){null!==U&&e[N]===Xe(".close",U)&&L.hide()},G=function(){L[R].removeChild(U),B=null,U=null},W=function(){z=n.title||s[de](b),F=(F=n.content||s[de](v))?F.trim():null,U=t[fe](g);var e=t[fe](g);if(e[ue](p,"arrow"),U[me](e),null!==F&&null===L[h]){if(U[ue]("role","tooltip"),null!==z){var r=t[fe]("h3");r[ue](p,u+"-header"),r[pe]=L[y]?z+C:z,U[me](r)}var o=t[fe](g);o[ue](p,u+"-body"),o[pe]=L[y]&&null===z?F+C:F,U[me](o)}else{var i=t[fe](g);L[h]=L[h].trim(),i[pe]=L[h],U[pe]=i.firstChild[pe]}L[R][me](U),U[Ie].display="block",U[ue](p,u+" bs-"+u+"-"+q+" "+L[M])},V=function(){!Ye(U,$e)&&Je(U,$e)},J=function(){lt(s,U,q,L[R])},Q=function(n){Y!=L[f]&&"focus"!=L[f]||!L[y]&&n(s,"blur",L.hide),L[y]&&n(t,Y,H),n(e,te,L.hide,nt)},K=function(){Q(et),it.call(s,re,u)},Z=function(){Q(tt),G(),it.call(s,ie,u)};this.toggle=function(){null===U?L.show():L.hide()},this.show=function(){clearTimeout(B),B=setTimeout((function(){null===U&&(q=L[$],W(),J(),V(),it.call(s,ne,u),L[M]?ot(U,K):K())}),20)},this.hide=function(){clearTimeout(B),B=setTimeout((function(){U&&null!==U&&Ye(U,$e)&&(it.call(s,oe,u),Qe(U,$e),L[M]?ot(U,Z):Z())}),L[I])},m in s||(L[f]===X?(et(s,se[0],L.show),L[y]||et(s,se[1],L.hide)):Y!=L[f]&&"focus"!=L[f]||et(s,L[f],L.toggle)),s[m]=L}};i[ke]([m,mt,"["+a+'="popover"]']);var pt=function(e,t){var s=(e=Xe(e))[de](y),n="tab",r="height",o="float",i="isAnimating";t=t||{},this[r]=!!He&&(t[r]||"true"===s);var a,l,c,d,u,h,f,m=this,g=Ze(e,".nav"),_=!1,v=g&&Xe(".dropdown-toggle",g),b=function(){_[Ie][r]="",Qe(_,Re),g[i]=!1},j=function(){_?h?b():setTimeout((function(){_[Ie][r]=f+"px",_[B],ot(_,b)}),50):g[i]=!1,it.call(a,re,n,l)},w=function(){_&&(c[Ie][o]=De,d[Ie][o]=De,u=c[G]),Je(d,Me),it.call(a,ne,n,l),Qe(c,Me),it.call(l,ie,n,a),_&&(f=d[G],h=f===u,Je(_,Re),_[Ie][r]=u+"px",_[q],c[Ie][o]="",d[Ie][o]=""),Ye(d,"fade")?setTimeout((function(){Je(d,$e),ot(d,j)}),20):j()};if(g){g[i]=!1;var S=function(){var e,t=Ke(g,Me);return 1!==t[xe]||Ye(t[0][Se],"dropdown")?t[xe]>1&&(e=t[t[xe]-1]):e=t[0],e},x=function(){return Xe(S()[de]("href"))},E=function(e){e[_e](),a=e[O],!g[i]&&!Ye(a,Me)&&m.show()};this.show=function(){d=Xe((a=a||e)[de]("href")),l=S(),c=x(),g[i]=!0,Qe(l,Me),l[ue](Q,"false"),Je(a,Me),a[ue](Q,"true"),v&&(Ye(e[Se],"dropdown-menu")?Ye(v,Me)||Je(v,Me):Ye(v,Me)&&Qe(v,Me)),it.call(l,oe,n,a),Ye(c,"fade")?(Qe(c,$e),ot(c,w)):w()},p in e||et(e,Y,E),m[r]&&(_=x()[Se]),e[p]=m}};i[ke]([p,pt,"["+a+'="tab"]']);var gt=function(e,t){for(var s=0,n=t[xe];s<n;s++)new e(t[s])},_t=o.initCallback=function(e){e=e||t;for(var s=0,n=i[xe];s<n;s++)gt(i[s][1],e[ye](i[s][2]))};return t[r]?_t():et(t,"DOMContentLoaded",(function(){_t()})),{Alert:ct,Button:dt,Collapse:ut,Dropdown:ht,Modal:ft,Popover:mt,Tab:pt}})?n.apply(t,r):n)||(e.exports=o)},"./node_modules/client-compress/dist/index.js":e=>{window,e.exports=function(e){var t={};function s(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=7)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadImageElement=function(e,t){return new Promise((function(s,n){e.addEventListener("load",(function(){s(e)}),!1),e.addEventListener("error",(function(e){n(e)}),!1),e.src=t}))},t.resize=function(e,t,s,n){if(!s&&!n)return{currentWidth:e,currentHeight:t};var r=e/t,o=void 0,i=void 0;return r>s/n?i=(o=Math.min(e,s))/r:o=(i=Math.min(t,n))*r,{width:o,height:i}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToFile=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",s=window.atob(e),n=[],r=0;r<s.length;r++)n[r]=s.charCodeAt(r);return new window.Blob([new Uint8Array(n)],{type:t})},t.imageToCanvas=function(e,t,s,n){var r=document.createElement("canvas"),o=r.getContext("2d");if(r.width=t,r.height=s,!n||n>8)return o.drawImage(e,0,0,r.width,r.height),r;switch(n>4&&(r.width=s,r.height=t),n){case 2:o.translate(t,0),o.scale(-1,1);break;case 3:o.translate(t,s),o.rotate(Math.PI);break;case 4:o.translate(0,s),o.scale(1,-1);break;case 5:o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:o.rotate(.5*Math.PI),o.translate(0,-s);break;case 7:o.rotate(.5*Math.PI),o.translate(t,-s),o.scale(-1,1);break;case 8:o.rotate(-.5*Math.PI),o.translate(-t,0)}return n>4?o.drawImage(e,0,0,r.height,r.width):o.drawImage(e,0,0,r.width,r.height),r},t.canvasToBlob=function(e,t){return new Promise((function(s,n){e.toBlob((function(e){s(e)}),"image/jpeg",t)}))},t.size=function(e){return{kB:.001*e,MB:1e-6*e}},t.blobToBase64=function(e){return new Promise((function(t,s){var n=new window.FileReader;n.addEventListener("load",(function(e){t(e.target.result)}),!1),n.addEventListener("error",(function(e){s(e)}),!1),n.readAsDataURL(e)}))}},function(e,t,s){e.exports=s(6)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractOrientation=function(e){return new Promise((function(t,s){var n=new window.FileReader;n.onload=function(e){var s=new DataView(e.target.result);65496!==s.getUint16(0,!1)&&t(-2);for(var n=s.byteLength,r=2;r<n;){var o=s.getUint16(r,!1);if(r+=2,65505===o){1165519206!==s.getUint32(r+=2,!1)&&t(-1);var i=18761===s.getUint16(r+=6,!1);r+=s.getUint32(r+4,i);var a=s.getUint16(r,i);r+=2;for(var l=0;l<a;l++)274===s.getUint16(r+12*l,i)&&t(s.getUint16(r+12*l+8,i))}else{if(65280!=(65280&o))break;r+=s.getUint16(r,!1)}}t(-1)},n.readAsArrayBuffer(e.slice(0,65536))}))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=s(2))&&n.__esModule?n:{default:n},o=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),i=s(3),a=s(0),l=s(1);function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function n(r,o){try{var i=t[r](o),a=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(a).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(a)}("next")}))}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.name=t.name,this.type=t.type,this.size=t.size}return o(e,[{key:"setData",value:function(e){this.data=e,this.size=e.size,this.type=e.type}},{key:"_calculateOrientation",value:function(){var e=c(r.default.mark((function e(){var t;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.extractOrientation)(this.data);case 2:t=e.sent,this.orientation=t;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=c(r.default.mark((function e(){var t,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._calculateOrientation();case 2:return t=URL.createObjectURL(this.data),s=new window.Image,e.next=6,(0,a.loadImageElement)(s,t);case 6:URL.revokeObjectURL(t),this._img=s,this.width=s.naturalWidth,this.height=s.naturalHeight;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCanvas",value:function(e,t,s){return void 0!==s?(0,l.imageToCanvas)(this._img,e,t,s):(0,l.imageToCanvas)(this._img,e,t,this.orientation)}}]),e}();t.default=d,e.exports=t.default},function(e,t){!function(t){"use strict";var s,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",c="object"==typeof e,d=t.regeneratorRuntime;if(d)c&&(e.exports=d);else{(d=t.regeneratorRuntime=c?e.exports:{}).wrap=b;var u="suspendedStart",h="suspendedYield",f="executing",m="completed",p={},g={};g[i]=function(){return this};var _=Object.getPrototypeOf,v=_&&_(_(N([])));v&&v!==n&&r.call(v,i)&&(g=v);var y=x.prototype=w.prototype=Object.create(g);S.prototype=y.constructor=x,x.constructor=S,x[l]=S.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(y),e},d.awrap=function(e){return{__await:e}},E(A.prototype),A.prototype[a]=function(){return this},d.AsyncIterator=A,d.async=function(e,t,s,n){var r=new A(b(e,t,s,n));return d.isGeneratorFunction(t)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},E(y),y[l]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var s in e)t.push(s);return t.reverse(),function s(){for(;t.length;){var n=t.pop();if(n in e)return s.value=n,s.done=!1,s}return s.done=!0,s}},d.values=N,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=s),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),I(s),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===e){var n=s.completion;if("throw"===n.type){var r=n.arg;I(s)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=s),p}}}function b(e,t,s,n){var r=t&&t.prototype instanceof w?t:w,o=Object.create(r.prototype),i=new k(n||[]);return o._invoke=function(e,t,s){var n=u;return function(r,o){if(n===f)throw new Error("Generator is already running");if(n===m){if("throw"===r)throw o;return O()}for(s.method=r,s.arg=o;;){var i=s.delegate;if(i){var a=C(i,s);if(a){if(a===p)continue;return a}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(n===u)throw n=m,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);n=f;var l=j(e,t,s);if("normal"===l.type){if(n=s.done?m:h,l.arg===p)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(n=m,s.method="throw",s.arg=l.arg)}}}(e,s,i),o}function j(e,t,s){try{return{type:"normal",arg:e.call(t,s)}}catch(e){return{type:"throw",arg:e}}}function w(){}function S(){}function x(){}function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function A(e){var t;this._invoke=function(s,n){function o(){return new Promise((function(t,o){!function t(s,n,o,i){var a=j(e[s],e,n);if("throw"!==a.type){var l=a.arg,c=l.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,o,i)}),(function(e){t("throw",e,o,i)})):Promise.resolve(c).then((function(e){l.value=e,o(l)}),i)}i(a.arg)}(s,n,t,o)}))}return t=t?t.then(o,o):o()}}function C(e,t){var n=e.iterator[t.method];if(n===s){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=s,C(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=j(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=s),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function N(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=s,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:s,done:!0}}}(function(){return this}()||Function("return this")())},function(e,t,s){var n=function(){return this}()||Function("return this")(),r=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=r&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,e.exports=s(5),r)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(s(2)),r=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}(s(1)),i=s(0),a=l(s(4));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,s){return function n(r,o){try{var i=t[r](o),a=i.value}catch(e){return void s(e)}if(!i.done)return Promise.resolve(a).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(a)}("next")}))}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setOptions(t)}return r(e,[{key:"setOptions",value:function(e){var t={targetSize:1/0,quality:.75,minQuality:.5,qualityStepSize:.1,maxWidth:1920,maxHeight:1920,resize:!0,throwIfSizeNotReached:!1,autoRotate:!0},s=new Proxy(e,{get:function(e,s){return s in e?e[s]:t[s]}});this.options=s}},{key:"_compressFile",value:function(){var e=c(n.default.mark((function e(t){var s,r;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new a.default(t),(r={}).start=window.performance.now(),r.quality=this.options.quality,r.startType=s.type,e.next=7,s.load();case 7:return e.next=9,this._compressImage(s,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_compressImage",value:function(){var e=c(n.default.mark((function e(t,s){var r,a,l,c,d;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.startWidth=t.width,s.startHeight=t.height,r=void 0,a=void 0,this.options.resize?(l=(0,i.resize)(t.width,t.height,this.options.maxWidth,this.options.maxHeight),r=l.width,a=l.height):(r=t.width,a=t.height),s.endWidth=r,s.endHeight=a,c=this.doAutoRotation?void 0:1,d=t.getCanvas(r,a,c),s.iterations=0,s.startSizeMB=o.size(t.size).MB,e.next=12,this._loopCompression(d,t,s);case 12:return s.endSizeMB=o.size(t.size).MB,s.sizeReducedInPercent=(s.startSizeMB-s.endSizeMB)/s.startSizeMB*100,s.end=window.performance.now(),s.elapsedTimeInSeconds=(s.end-s.start)/1e3,s.endType=t.type,e.abrupt("return",{photo:t,info:s});case 18:case"end":return e.stop()}}),e,this)})));return function(t,s){return e.apply(this,arguments)}}()},{key:"_loopCompression",value:function(){var e=c(n.default.mark((function e(t,s,r){var i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.iterations++,e.t0=s,e.next=4,o.canvasToBlob(t,r.quality);case 4:if(e.t1=e.sent,e.t0.setData.call(e.t0,e.t1),1==r.iterations&&(s.width=r.endWidth,s.height=r.endHeight),!(o.size(s.size).MB>this.options.targetSize)){e.next=24;break}if(!(r.quality.toFixed(10)-.1<this.options.minQuality)){e.next=18;break}if(i="Couldn't compress image to target size while maintaining quality.\n        Target size: "+this.options.targetSize+"\n        Actual size: "+o.size(s.size).MB,this.options.throwIfSizeNotReached){e.next=14;break}console.error(i),e.next=15;break;case 14:throw new Error(i);case 15:case 24:return e.abrupt("return");case 18:return r.quality-=this.options.qualityStepSize,e.next=21,this._loopCompression(t,s,r);case 21:return e.abrupt("return",e.sent);case 22:e.next=25;break;case 25:case"end":return e.stop()}}),e,this)})));return function(t,s,n){return e.apply(this,arguments)}}()},{key:"setAutoRotate",value:function(){var t=c(n.default.mark((function t(){var s;return n.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.automaticRotationFeatureTest();case 2:s=t.sent,this.doAutoRotation=this.options.autoRotate&&!s;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"compress",value:function(){var e=c(n.default.mark((function e(t){var s=this;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setAutoRotate();case 2:return e.abrupt("return",Promise.all(t.map((function(e){return s._compressFile(e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"blobToBase64",value:function(){var e=c(n.default.mark((function e(){var t=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.blobToBase64.apply(o,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadImageElement",value:function(){var e=c(n.default.mark((function e(){var t=arguments;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.loadImageElement.apply(void 0,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"automaticRotationFeatureTest",value:function(){return new Promise((function(e){var t=new Image;t.onload=function(){var s=1===t.width&&2===t.height;e(s)},t.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="}))}}]),e}();t.default=d,e.exports=t.default}])},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/bookmark-views/styles/bookmarks.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatboxviews/styles/chats.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/chat-bottom-panel.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/chat-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/controlbox/styles/_controlbox.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/controlbox/styles/controlbox-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/fullscreen/styles/fullscreen.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/headlines-view/styles/headlines-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/headlines-view/styles/headlines.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/mam-views/styles/placeholder.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/minimize/styles/minimize.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/modal/styles/_modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/add-muc-modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/moderator-tools.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-bottom-panel.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-details-modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-occupants.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/nickname-form.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/register/styles/register.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/rootview/styles/root.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/rosterview/styles/roster.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/singleton/singleton.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/autocomplete/styles/_autocomplete.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/avatar/avatar.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/chat-content.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/emoji.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/message-actions.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/message-body.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/retraction.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/toolbar.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/unfurl.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/dropdown.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/gif.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/icon.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/message-versions.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/rich-text.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/modals/styles/image.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/styles/status.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(n),o=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(o)()(r());i.push([e.id,"","",{version:3,sources:[],names:[],mappings:"",sourceRoot:""}]);const a=i},"./node_modules/css-loader/dist/runtime/api.js":e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",n=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),n&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),n&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,n,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);n&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),s&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=s):d[2]=s),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":e=>{"use strict";e.exports=function(e){var t=e[1],s=e[3];if(!s)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),o="/*# ".concat(r," */");return[t].concat([o]).join("\n")}return[t].join("\n")}},"./node_modules/dayjs/dayjs.min.js":function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,s=36e5,n="millisecond",r="second",o="minute",i="hour",a="day",l="week",c="month",d="quarter",u="year",h="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],s=e%100;return"["+e+(t[(s-20)%10]||t[s]||t[0])+"]"}},_=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},v={s:_,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),r=s%60;return(t<=0?"+":"-")+_(n,2,"0")+":"+_(r,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),r=t.clone().add(n,c),o=s-r<0,i=t.clone().add(n+(o?-1:1),c);return+(-(n+(s-r)/(o?r-i:i-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:a,D:h,h:i,m:o,s:r,ms:n,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=g;var j=function(e){return e instanceof E},w=function e(t,s,n){var r;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(r=o),s&&(b[o]=s,r=o);var i=t.split("-");if(!r&&i.length>1)return e(i[0])}else{var a=t.name;b[a]=t,r=a}return!n&&r&&(y=r),r||!n&&y},S=function(e,t){if(j(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new E(s)},x=v;x.l=w,x.i=j,x.w=function(e,t){return S(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var _=g.prototype;return _.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(x.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(m);if(n){var r=n[2]-1||0,o=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},_.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},_.$utils=function(){return x},_.isValid=function(){return!(this.$d.toString()===f)},_.isSame=function(e,t){var s=S(e);return this.startOf(t)<=s&&s<=this.endOf(t)},_.isAfter=function(e,t){return S(e)<this.startOf(t)},_.isBefore=function(e,t){return this.endOf(t)<S(e)},_.$g=function(e,t,s){return x.u(e)?this[t]:this.set(s,e)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(e,t){var s=this,n=!!x.u(t)||t,d=x.p(e),f=function(e,t){var r=x.w(s.$u?Date.UTC(s.$y,t,e):new Date(s.$y,t,e),s);return n?r:r.endOf(a)},m=function(e,t){return x.w(s.toDate()[e].apply(s.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},p=this.$W,g=this.$M,_=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case u:return n?f(1,0):f(31,11);case c:return n?f(1,g):f(0,g+1);case l:var y=this.$locale().weekStart||0,b=(p<y?p+7:p)-y;return f(n?_-b:_+(6-b),g);case a:case h:return m(v+"Hours",0);case i:return m(v+"Minutes",1);case o:return m(v+"Seconds",2);case r:return m(v+"Milliseconds",3);default:return this.clone()}},_.endOf=function(e){return this.startOf(e,!1)},_.$set=function(e,t){var s,l=x.p(e),d="set"+(this.$u?"UTC":""),f=(s={},s[a]=d+"Date",s[h]=d+"Date",s[c]=d+"Month",s[u]=d+"FullYear",s[i]=d+"Hours",s[o]=d+"Minutes",s[r]=d+"Seconds",s[n]=d+"Milliseconds",s)[l],m=l===a?this.$D+(t-this.$W):t;if(l===c||l===u){var p=this.clone().set(h,1);p.$d[f](m),p.init(),this.$d=p.set(h,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},_.set=function(e,t){return this.clone().$set(e,t)},_.get=function(e){return this[x.p(e)]()},_.add=function(n,d){var h,f=this;n=Number(n);var m=x.p(d),p=function(e){var t=S(f);return x.w(t.date(t.date()+Math.round(e*n)),f)};if(m===c)return this.set(c,this.$M+n);if(m===u)return this.set(u,this.$y+n);if(m===a)return p(1);if(m===l)return p(7);var g=(h={},h[o]=t,h[i]=s,h[r]=e,h)[m]||1,_=this.$d.getTime()+n*g;return x.w(_,this)},_.subtract=function(e,t){return this.add(-1*e,t)},_.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=x.z(this),o=this.$H,i=this.$m,a=this.$M,l=s.weekdays,c=s.months,d=function(e,s,r,o){return e&&(e[s]||e(t,n))||r[s].slice(0,o)},u=function(e){return x.s(o%12||12,e,"0")},h=s.meridiem||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n},m={YY:String(this.$y).slice(-2),YYYY:x.s(this.$y,4,"0"),M:a+1,MM:x.s(a+1,2,"0"),MMM:d(s.monthsShort,a,c,3),MMMM:d(c,a),D:this.$D,DD:x.s(this.$D,2,"0"),d:String(this.$W),dd:d(s.weekdaysMin,this.$W,l,2),ddd:d(s.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:x.s(o,2,"0"),h:u(1),hh:u(2),a:h(o,i,!0),A:h(o,i,!1),m:String(i),mm:x.s(i,2,"0"),s:String(this.$s),ss:x.s(this.$s,2,"0"),SSS:x.s(this.$ms,3,"0"),Z:r};return n.replace(p,(function(e,t){return t||m[e]||r.replace(":","")}))},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(n,h,f){var m,p=x.p(h),g=S(n),_=(g.utcOffset()-this.utcOffset())*t,v=this-g,y=x.m(this,g);return y=(m={},m[u]=y/12,m[c]=y,m[d]=y/3,m[l]=(v-_)/6048e5,m[a]=(v-_)/864e5,m[i]=v/s,m[o]=v/t,m[r]=v/e,m)[p]||v,f?y:x.a(y)},_.daysInMonth=function(){return this.endOf(c).$D},_.$locale=function(){return b[this.$L]},_.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=w(e,t,!0);return n&&(s.$L=n),s},_.clone=function(){return x.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},g}(),A=E.prototype;return S.prototype=A,[["$ms",n],["$s",r],["$m",o],["$H",i],["$W",a],["$M",c],["$y",u],["$D",h]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),S.extend=function(e,t){return e.$i||(e(t,E,S),e.$i=!0),S},S.locale=w,S.isDayjs=j,S.unix=function(e){return S(1e3*e)},S.en=b[y],S.Ls=b,S.p={},S}()},"./node_modules/dayjs/locale lazy recursive ^\\.\\/.*\\.js$":(e,t,s)=>{var n={"./af.js":["./node_modules/dayjs/locale/af.js","locales/dayjs/af-js"],"./am.js":["./node_modules/dayjs/locale/am.js","locales/dayjs/am-js"],"./ar-dz.js":["./node_modules/dayjs/locale/ar-dz.js","locales/dayjs/ar-dz-js"],"./ar-iq.js":["./node_modules/dayjs/locale/ar-iq.js","locales/dayjs/ar-iq-js"],"./ar-kw.js":["./node_modules/dayjs/locale/ar-kw.js","locales/dayjs/ar-kw-js"],"./ar-ly.js":["./node_modules/dayjs/locale/ar-ly.js","locales/dayjs/ar-ly-js"],"./ar-ma.js":["./node_modules/dayjs/locale/ar-ma.js","locales/dayjs/ar-ma-js"],"./ar-sa.js":["./node_modules/dayjs/locale/ar-sa.js","locales/dayjs/ar-sa-js"],"./ar-tn.js":["./node_modules/dayjs/locale/ar-tn.js","locales/dayjs/ar-tn-js"],"./ar.js":["./node_modules/dayjs/locale/ar.js","locales/dayjs/ar-js"],"./az.js":["./node_modules/dayjs/locale/az.js","locales/dayjs/az-js"],"./be.js":["./node_modules/dayjs/locale/be.js","locales/dayjs/be-js"],"./bg.js":["./node_modules/dayjs/locale/bg.js","locales/dayjs/bg-js"],"./bi.js":["./node_modules/dayjs/locale/bi.js","locales/dayjs/bi-js"],"./bm.js":["./node_modules/dayjs/locale/bm.js","locales/dayjs/bm-js"],"./bn-bd.js":["./node_modules/dayjs/locale/bn-bd.js","locales/dayjs/bn-bd-js"],"./bn.js":["./node_modules/dayjs/locale/bn.js","locales/dayjs/bn-js"],"./bo.js":["./node_modules/dayjs/locale/bo.js","locales/dayjs/bo-js"],"./br.js":["./node_modules/dayjs/locale/br.js","locales/dayjs/br-js"],"./bs.js":["./node_modules/dayjs/locale/bs.js","locales/dayjs/bs-js"],"./ca.js":["./node_modules/dayjs/locale/ca.js","locales/dayjs/ca-js"],"./cs.js":["./node_modules/dayjs/locale/cs.js","locales/dayjs/cs-js"],"./cv.js":["./node_modules/dayjs/locale/cv.js","locales/dayjs/cv-js"],"./cy.js":["./node_modules/dayjs/locale/cy.js","locales/dayjs/cy-js"],"./da.js":["./node_modules/dayjs/locale/da.js","locales/dayjs/da-js"],"./de-at.js":["./node_modules/dayjs/locale/de-at.js","locales/dayjs/de-at-js"],"./de-ch.js":["./node_modules/dayjs/locale/de-ch.js","locales/dayjs/de-ch-js"],"./de.js":["./node_modules/dayjs/locale/de.js","locales/dayjs/de-js"],"./dv.js":["./node_modules/dayjs/locale/dv.js","locales/dayjs/dv-js"],"./el.js":["./node_modules/dayjs/locale/el.js","locales/dayjs/el-js"],"./en-au.js":["./node_modules/dayjs/locale/en-au.js","locales/dayjs/en-au-js"],"./en-ca.js":["./node_modules/dayjs/locale/en-ca.js","locales/dayjs/en-ca-js"],"./en-gb.js":["./node_modules/dayjs/locale/en-gb.js","locales/dayjs/en-gb-js"],"./en-ie.js":["./node_modules/dayjs/locale/en-ie.js","locales/dayjs/en-ie-js"],"./en-il.js":["./node_modules/dayjs/locale/en-il.js","locales/dayjs/en-il-js"],"./en-in.js":["./node_modules/dayjs/locale/en-in.js","locales/dayjs/en-in-js"],"./en-nz.js":["./node_modules/dayjs/locale/en-nz.js","locales/dayjs/en-nz-js"],"./en-sg.js":["./node_modules/dayjs/locale/en-sg.js","locales/dayjs/en-sg-js"],"./en-tt.js":["./node_modules/dayjs/locale/en-tt.js","locales/dayjs/en-tt-js"],"./en.js":["./node_modules/dayjs/locale/en.js","locales/dayjs/en-js"],"./eo.js":["./node_modules/dayjs/locale/eo.js","locales/dayjs/eo-js"],"./es-do.js":["./node_modules/dayjs/locale/es-do.js","locales/dayjs/es-do-js"],"./es-mx.js":["./node_modules/dayjs/locale/es-mx.js","locales/dayjs/es-mx-js"],"./es-pr.js":["./node_modules/dayjs/locale/es-pr.js","locales/dayjs/es-pr-js"],"./es-us.js":["./node_modules/dayjs/locale/es-us.js","locales/dayjs/es-us-js"],"./es.js":["./node_modules/dayjs/locale/es.js","locales/dayjs/es-js"],"./et.js":["./node_modules/dayjs/locale/et.js","locales/dayjs/et-js"],"./eu.js":["./node_modules/dayjs/locale/eu.js","locales/dayjs/eu-js"],"./fa.js":["./node_modules/dayjs/locale/fa.js","locales/dayjs/fa-js"],"./fi.js":["./node_modules/dayjs/locale/fi.js","locales/dayjs/fi-js"],"./fo.js":["./node_modules/dayjs/locale/fo.js","locales/dayjs/fo-js"],"./fr-ca.js":["./node_modules/dayjs/locale/fr-ca.js","locales/dayjs/fr-ca-js"],"./fr-ch.js":["./node_modules/dayjs/locale/fr-ch.js","locales/dayjs/fr-ch-js"],"./fr.js":["./node_modules/dayjs/locale/fr.js","locales/dayjs/fr-js"],"./fy.js":["./node_modules/dayjs/locale/fy.js","locales/dayjs/fy-js"],"./ga.js":["./node_modules/dayjs/locale/ga.js","locales/dayjs/ga-js"],"./gd.js":["./node_modules/dayjs/locale/gd.js","locales/dayjs/gd-js"],"./gl.js":["./node_modules/dayjs/locale/gl.js","locales/dayjs/gl-js"],"./gom-latn.js":["./node_modules/dayjs/locale/gom-latn.js","locales/dayjs/gom-latn-js"],"./gu.js":["./node_modules/dayjs/locale/gu.js","locales/dayjs/gu-js"],"./he.js":["./node_modules/dayjs/locale/he.js","locales/dayjs/he-js"],"./hi.js":["./node_modules/dayjs/locale/hi.js","locales/dayjs/hi-js"],"./hr.js":["./node_modules/dayjs/locale/hr.js","locales/dayjs/hr-js"],"./ht.js":["./node_modules/dayjs/locale/ht.js","locales/dayjs/ht-js"],"./hu.js":["./node_modules/dayjs/locale/hu.js","locales/dayjs/hu-js"],"./hy-am.js":["./node_modules/dayjs/locale/hy-am.js","locales/dayjs/hy-am-js"],"./id.js":["./node_modules/dayjs/locale/id.js","locales/dayjs/id-js"],"./is.js":["./node_modules/dayjs/locale/is.js","locales/dayjs/is-js"],"./it-ch.js":["./node_modules/dayjs/locale/it-ch.js","locales/dayjs/it-ch-js"],"./it.js":["./node_modules/dayjs/locale/it.js","locales/dayjs/it-js"],"./ja.js":["./node_modules/dayjs/locale/ja.js","locales/dayjs/ja-js"],"./jv.js":["./node_modules/dayjs/locale/jv.js","locales/dayjs/jv-js"],"./ka.js":["./node_modules/dayjs/locale/ka.js","locales/dayjs/ka-js"],"./kk.js":["./node_modules/dayjs/locale/kk.js","locales/dayjs/kk-js"],"./km.js":["./node_modules/dayjs/locale/km.js","locales/dayjs/km-js"],"./kn.js":["./node_modules/dayjs/locale/kn.js","locales/dayjs/kn-js"],"./ko.js":["./node_modules/dayjs/locale/ko.js","locales/dayjs/ko-js"],"./ku.js":["./node_modules/dayjs/locale/ku.js","locales/dayjs/ku-js"],"./ky.js":["./node_modules/dayjs/locale/ky.js","locales/dayjs/ky-js"],"./lb.js":["./node_modules/dayjs/locale/lb.js","locales/dayjs/lb-js"],"./lo.js":["./node_modules/dayjs/locale/lo.js","locales/dayjs/lo-js"],"./lt.js":["./node_modules/dayjs/locale/lt.js","locales/dayjs/lt-js"],"./lv.js":["./node_modules/dayjs/locale/lv.js","locales/dayjs/lv-js"],"./me.js":["./node_modules/dayjs/locale/me.js","locales/dayjs/me-js"],"./mi.js":["./node_modules/dayjs/locale/mi.js","locales/dayjs/mi-js"],"./mk.js":["./node_modules/dayjs/locale/mk.js","locales/dayjs/mk-js"],"./ml.js":["./node_modules/dayjs/locale/ml.js","locales/dayjs/ml-js"],"./mn.js":["./node_modules/dayjs/locale/mn.js","locales/dayjs/mn-js"],"./mr.js":["./node_modules/dayjs/locale/mr.js","locales/dayjs/mr-js"],"./ms-my.js":["./node_modules/dayjs/locale/ms-my.js","locales/dayjs/ms-my-js"],"./ms.js":["./node_modules/dayjs/locale/ms.js","locales/dayjs/ms-js"],"./mt.js":["./node_modules/dayjs/locale/mt.js","locales/dayjs/mt-js"],"./my.js":["./node_modules/dayjs/locale/my.js","locales/dayjs/my-js"],"./nb.js":["./node_modules/dayjs/locale/nb.js","locales/dayjs/nb-js"],"./ne.js":["./node_modules/dayjs/locale/ne.js","locales/dayjs/ne-js"],"./nl-be.js":["./node_modules/dayjs/locale/nl-be.js","locales/dayjs/nl-be-js"],"./nl.js":["./node_modules/dayjs/locale/nl.js","locales/dayjs/nl-js"],"./nn.js":["./node_modules/dayjs/locale/nn.js","locales/dayjs/nn-js"],"./oc-lnc.js":["./node_modules/dayjs/locale/oc-lnc.js","locales/dayjs/oc-lnc-js"],"./pa-in.js":["./node_modules/dayjs/locale/pa-in.js","locales/dayjs/pa-in-js"],"./pl.js":["./node_modules/dayjs/locale/pl.js","locales/dayjs/pl-js"],"./pt-br.js":["./node_modules/dayjs/locale/pt-br.js","locales/dayjs/pt-br-js"],"./pt.js":["./node_modules/dayjs/locale/pt.js","locales/dayjs/pt-js"],"./rn.js":["./node_modules/dayjs/locale/rn.js","locales/dayjs/rn-js"],"./ro.js":["./node_modules/dayjs/locale/ro.js","locales/dayjs/ro-js"],"./ru.js":["./node_modules/dayjs/locale/ru.js","locales/dayjs/ru-js"],"./rw.js":["./node_modules/dayjs/locale/rw.js","locales/dayjs/rw-js"],"./sd.js":["./node_modules/dayjs/locale/sd.js","locales/dayjs/sd-js"],"./se.js":["./node_modules/dayjs/locale/se.js","locales/dayjs/se-js"],"./si.js":["./node_modules/dayjs/locale/si.js","locales/dayjs/si-js"],"./sk.js":["./node_modules/dayjs/locale/sk.js","locales/dayjs/sk-js"],"./sl.js":["./node_modules/dayjs/locale/sl.js","locales/dayjs/sl-js"],"./sq.js":["./node_modules/dayjs/locale/sq.js","locales/dayjs/sq-js"],"./sr-cyrl.js":["./node_modules/dayjs/locale/sr-cyrl.js","locales/dayjs/sr-cyrl-js"],"./sr.js":["./node_modules/dayjs/locale/sr.js","locales/dayjs/sr-js"],"./ss.js":["./node_modules/dayjs/locale/ss.js","locales/dayjs/ss-js"],"./sv-fi.js":["./node_modules/dayjs/locale/sv-fi.js","locales/dayjs/sv-fi-js"],"./sv.js":["./node_modules/dayjs/locale/sv.js","locales/dayjs/sv-js"],"./sw.js":["./node_modules/dayjs/locale/sw.js","locales/dayjs/sw-js"],"./ta.js":["./node_modules/dayjs/locale/ta.js","locales/dayjs/ta-js"],"./te.js":["./node_modules/dayjs/locale/te.js","locales/dayjs/te-js"],"./tet.js":["./node_modules/dayjs/locale/tet.js","locales/dayjs/tet-js"],"./tg.js":["./node_modules/dayjs/locale/tg.js","locales/dayjs/tg-js"],"./th.js":["./node_modules/dayjs/locale/th.js","locales/dayjs/th-js"],"./tk.js":["./node_modules/dayjs/locale/tk.js","locales/dayjs/tk-js"],"./tl-ph.js":["./node_modules/dayjs/locale/tl-ph.js","locales/dayjs/tl-ph-js"],"./tlh.js":["./node_modules/dayjs/locale/tlh.js","locales/dayjs/tlh-js"],"./tr.js":["./node_modules/dayjs/locale/tr.js","locales/dayjs/tr-js"],"./tzl.js":["./node_modules/dayjs/locale/tzl.js","locales/dayjs/tzl-js"],"./tzm-latn.js":["./node_modules/dayjs/locale/tzm-latn.js","locales/dayjs/tzm-latn-js"],"./tzm.js":["./node_modules/dayjs/locale/tzm.js","locales/dayjs/tzm-js"],"./ug-cn.js":["./node_modules/dayjs/locale/ug-cn.js","locales/dayjs/ug-cn-js"],"./uk.js":["./node_modules/dayjs/locale/uk.js","locales/dayjs/uk-js"],"./ur.js":["./node_modules/dayjs/locale/ur.js","locales/dayjs/ur-js"],"./uz-latn.js":["./node_modules/dayjs/locale/uz-latn.js","locales/dayjs/uz-latn-js"],"./uz.js":["./node_modules/dayjs/locale/uz.js","locales/dayjs/uz-js"],"./vi.js":["./node_modules/dayjs/locale/vi.js","locales/dayjs/vi-js"],"./x-pseudo.js":["./node_modules/dayjs/locale/x-pseudo.js","locales/dayjs/x-pseudo-js"],"./yo.js":["./node_modules/dayjs/locale/yo.js","locales/dayjs/yo-js"],"./zh-cn.js":["./node_modules/dayjs/locale/zh-cn.js","locales/dayjs/zh-cn-js"],"./zh-hk.js":["./node_modules/dayjs/locale/zh-hk.js","locales/dayjs/zh-hk-js"],"./zh-tw.js":["./node_modules/dayjs/locale/zh-tw.js","locales/dayjs/zh-tw-js"],"./zh.js":["./node_modules/dayjs/locale/zh.js","locales/dayjs/zh-js"]};function r(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return s.e(t[1]).then((()=>s.t(r,23)))}r.keys=()=>Object.keys(n),r.id="./node_modules/dayjs/locale lazy recursive ^\\.\\/.*\\.js$",e.exports=r},"./node_modules/dompurify/dist/purify.js":function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,s){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,s)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function n(e,r,o){return n=s()?Reflect.construct:function(e,s,n){var r=[null];r.push.apply(r,s);var o=new(Function.bind.apply(e,r));return n&&t(o,n.prototype),o},n.apply(null,arguments)}function r(e){return o(e)||i(e)||a(e)||c()}function o(e){if(Array.isArray(e))return l(e)}function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function a(e,t){if(e){if("string"==typeof e)return l(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,n=new Array(t);s<t;s++)n[s]=e[s];return n}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d=Object.hasOwnProperty,u=Object.setPrototypeOf,h=Object.isFrozen,f=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,p=Object.freeze,g=Object.seal,_=Object.create,v="undefined"!=typeof Reflect&&Reflect,y=v.apply,b=v.construct;y||(y=function(e,t,s){return e.apply(t,s)}),p||(p=function(e){return e}),g||(g=function(e){return e}),b||(b=function(e,t){return n(e,r(t))});var j=O(Array.prototype.forEach),w=O(Array.prototype.pop),S=O(Array.prototype.push),x=O(String.prototype.toLowerCase),E=O(String.prototype.toString),A=O(String.prototype.match),C=O(String.prototype.replace),T=O(String.prototype.indexOf),I=O(String.prototype.trim),k=O(RegExp.prototype.test),N=M(TypeError);function O(e){return function(t){for(var s=arguments.length,n=new Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];return y(e,t,n)}}function M(e){return function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return b(e,s)}}function $(e,t,s){s=s||x,u&&u(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var o=s(r);o!==r&&(h(t)||(t[n]=o),r=o)}e[r]=!0}return e}function R(e){var t,s=_(null);for(t in e)!0===y(d,e,[t])&&(s[t]=e[t]);return s}function D(e,t){for(;null!==e;){var s=m(e,t);if(s){if(s.get)return O(s.get);if("function"==typeof s.value)return O(s.value)}e=f(e)}function n(e){return console.warn("fallback value for",e),null}return n}var P=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),z=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),q=p(["#text"]),H=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),G=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),V=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),J=g(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Q=g(/<%[\w\W]*|[\w\W]*%>/gm),Y=g(/\${[\w\W]*}/gm),K=g(/^data-[\-\w.\u00B7-\uFFFF]/),X=g(/^aria-[\-\w]+$/),Z=g(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=g(/^(?:\w+script|data):/i),te=g(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),se=g(/^html$/i),ne=function(){return"undefined"==typeof window?null:window},re=function(t,s){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var n=null,r="data-tt-policy-suffix";s.currentScript&&s.currentScript.hasAttribute(r)&&(n=s.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function oe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne(),s=function(e){return oe(e)};if(s.version="2.4.5",s.removed=[],!t||!t.document||9!==t.document.nodeType)return s.isSupported=!1,s;var n=t.document,o=t.document,i=t.DocumentFragment,a=t.HTMLTemplateElement,l=t.Node,c=t.Element,d=t.NodeFilter,u=t.NamedNodeMap,h=void 0===u?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,m=t.DOMParser,g=t.trustedTypes,_=c.prototype,v=D(_,"cloneNode"),y=D(_,"nextSibling"),b=D(_,"childNodes"),O=D(_,"parentNode");if("function"==typeof a){var M=o.createElement("template");M.content&&M.content.ownerDocument&&(o=M.content.ownerDocument)}var ie=re(g,n),ae=ie?ie.createHTML(""):"",le=o,ce=le.implementation,de=le.createNodeIterator,ue=le.createDocumentFragment,he=le.getElementsByTagName,fe=n.importNode,me={};try{me=R(o).documentMode?o.documentMode:{}}catch(e){}var pe={};s.isSupported="function"==typeof O&&ce&&void 0!==ce.createHTMLDocument&&9!==me;var ge,_e,ve=J,ye=Q,be=Y,je=K,we=X,Se=ee,xe=te,Ee=Z,Ae=null,Ce=$({},[].concat(r(P),r(L),r(z),r(U),r(q))),Te=null,Ie=$({},[].concat(r(H),r(G),r(W),r(V))),ke=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,Oe=null,Me=!0,$e=!0,Re=!1,De=!0,Pe=!1,Le=!1,ze=!1,Fe=!1,Ue=!1,Be=!1,qe=!1,He=!0,Ge=!1,We="user-content-",Ve=!0,Je=!1,Qe={},Ye=null,Ke=$({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xe=null,Ze=$({},["audio","video","img","source","image","track"]),et=null,tt=$({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),st="http://www.w3.org/1998/Math/MathML",nt="http://www.w3.org/2000/svg",rt="http://www.w3.org/1999/xhtml",ot=rt,it=!1,at=null,lt=$({},[st,nt,rt],E),ct=["application/xhtml+xml","text/html"],dt="text/html",ut=null,ht=o.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},mt=function(t){ut&&ut===t||(t&&"object"===e(t)||(t={}),t=R(t),ge=ge=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?dt:t.PARSER_MEDIA_TYPE,_e="application/xhtml+xml"===ge?E:x,Ae="ALLOWED_TAGS"in t?$({},t.ALLOWED_TAGS,_e):Ce,Te="ALLOWED_ATTR"in t?$({},t.ALLOWED_ATTR,_e):Ie,at="ALLOWED_NAMESPACES"in t?$({},t.ALLOWED_NAMESPACES,E):lt,et="ADD_URI_SAFE_ATTR"in t?$(R(tt),t.ADD_URI_SAFE_ATTR,_e):tt,Xe="ADD_DATA_URI_TAGS"in t?$(R(Ze),t.ADD_DATA_URI_TAGS,_e):Ze,Ye="FORBID_CONTENTS"in t?$({},t.FORBID_CONTENTS,_e):Ke,Ne="FORBID_TAGS"in t?$({},t.FORBID_TAGS,_e):{},Oe="FORBID_ATTR"in t?$({},t.FORBID_ATTR,_e):{},Qe="USE_PROFILES"in t&&t.USE_PROFILES,Me=!1!==t.ALLOW_ARIA_ATTR,$e=!1!==t.ALLOW_DATA_ATTR,Re=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pe=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,Ue=t.RETURN_DOM||!1,Be=t.RETURN_DOM_FRAGMENT||!1,qe=t.RETURN_TRUSTED_TYPE||!1,Fe=t.FORCE_BODY||!1,He=!1!==t.SANITIZE_DOM,Ge=t.SANITIZE_NAMED_PROPS||!1,Ve=!1!==t.KEEP_CONTENT,Je=t.IN_PLACE||!1,Ee=t.ALLOWED_URI_REGEXP||Ee,ot=t.NAMESPACE||rt,ke=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ke.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ke.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ke.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&($e=!1),Be&&(Ue=!0),Qe&&(Ae=$({},r(q)),Te=[],!0===Qe.html&&($(Ae,P),$(Te,H)),!0===Qe.svg&&($(Ae,L),$(Te,G),$(Te,V)),!0===Qe.svgFilters&&($(Ae,z),$(Te,G),$(Te,V)),!0===Qe.mathMl&&($(Ae,U),$(Te,W),$(Te,V))),t.ADD_TAGS&&(Ae===Ce&&(Ae=R(Ae)),$(Ae,t.ADD_TAGS,_e)),t.ADD_ATTR&&(Te===Ie&&(Te=R(Te)),$(Te,t.ADD_ATTR,_e)),t.ADD_URI_SAFE_ATTR&&$(et,t.ADD_URI_SAFE_ATTR,_e),t.FORBID_CONTENTS&&(Ye===Ke&&(Ye=R(Ye)),$(Ye,t.FORBID_CONTENTS,_e)),Ve&&(Ae["#text"]=!0),Le&&$(Ae,["html","head","body"]),Ae.table&&($(Ae,["tbody"]),delete Ne.tbody),p&&p(t),ut=t)},pt=$({},["mi","mo","mn","ms","mtext"]),gt=$({},["foreignobject","desc","title","annotation-xml"]),_t=$({},["title","style","font","a","script"]),vt=$({},L);$(vt,z),$(vt,F);var yt=$({},U);$(yt,B);var bt=function(e){var t=O(e);t&&t.tagName||(t={namespaceURI:ot,tagName:"template"});var s=x(e.tagName),n=x(t.tagName);return!!at[e.namespaceURI]&&(e.namespaceURI===nt?t.namespaceURI===rt?"svg"===s:t.namespaceURI===st?"svg"===s&&("annotation-xml"===n||pt[n]):Boolean(vt[s]):e.namespaceURI===st?t.namespaceURI===rt?"math"===s:t.namespaceURI===nt?"math"===s&&gt[n]:Boolean(yt[s]):e.namespaceURI===rt?!(t.namespaceURI===nt&&!gt[n])&&!(t.namespaceURI===st&&!pt[n])&&!yt[s]&&(_t[s]||!vt[s]):!("application/xhtml+xml"!==ge||!at[e.namespaceURI]))},jt=function(e){S(s.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ae}catch(t){e.remove()}}},wt=function(e,t){try{S(s.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){S(s.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Ue||Be)try{jt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},St=function(e){var t,s;if(Fe)e="<remove></remove>"+e;else{var n=A(e,/^[\r\n\t ]+/);s=n&&n[0]}"application/xhtml+xml"===ge&&ot===rt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var r=ie?ie.createHTML(e):e;if(ot===rt)try{t=(new m).parseFromString(r,ge)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(ot,"template",null);try{t.documentElement.innerHTML=it?ae:r}catch(e){}}var i=t.body||t.documentElement;return e&&s&&i.insertBefore(o.createTextNode(s),i.childNodes[0]||null),ot===rt?he.call(t,Le?"html":"body")[0]:Le?t.documentElement:i},xt=function(e){return de.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},Et=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},At=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Ct=function(e,t,n){pe[e]&&j(pe[e],(function(e){e.call(s,t,n,ut)}))},Tt=function(e){var t;if(Ct("beforeSanitizeElements",e,null),Et(e))return jt(e),!0;if(k(/[\u0080-\uFFFF]/,e.nodeName))return jt(e),!0;var n=_e(e.nodeName);if(Ct("uponSanitizeElement",e,{tagName:n,allowedTags:Ae}),e.hasChildNodes()&&!At(e.firstElementChild)&&(!At(e.content)||!At(e.content.firstElementChild))&&k(/<[/\w]/g,e.innerHTML)&&k(/<[/\w]/g,e.textContent))return jt(e),!0;if("select"===n&&k(/<template/i,e.innerHTML))return jt(e),!0;if(!Ae[n]||Ne[n]){if(!Ne[n]&&kt(n)){if(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,n))return!1;if(ke.tagNameCheck instanceof Function&&ke.tagNameCheck(n))return!1}if(Ve&&!Ye[n]){var r=O(e)||e.parentNode,o=b(e)||e.childNodes;if(o&&r)for(var i=o.length-1;i>=0;--i)r.insertBefore(v(o[i],!0),y(e))}return jt(e),!0}return e instanceof c&&!bt(e)?(jt(e),!0):"noscript"!==n&&"noembed"!==n||!k(/<\/no(script|embed)/i,e.innerHTML)?(Pe&&3===e.nodeType&&(t=e.textContent,t=C(t,ve," "),t=C(t,ye," "),t=C(t,be," "),e.textContent!==t&&(S(s.removed,{element:e.cloneNode()}),e.textContent=t)),Ct("afterSanitizeElements",e,null),!1):(jt(e),!0)},It=function(e,t,s){if(He&&("id"===t||"name"===t)&&(s in o||s in ht))return!1;if($e&&!Oe[t]&&k(je,t));else if(Me&&k(we,t));else if(!Te[t]||Oe[t]){if(!(kt(e)&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,e)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(e))&&(ke.attributeNameCheck instanceof RegExp&&k(ke.attributeNameCheck,t)||ke.attributeNameCheck instanceof Function&&ke.attributeNameCheck(t))||"is"===t&&ke.allowCustomizedBuiltInElements&&(ke.tagNameCheck instanceof RegExp&&k(ke.tagNameCheck,s)||ke.tagNameCheck instanceof Function&&ke.tagNameCheck(s))))return!1}else if(et[t]);else if(k(Ee,C(s,xe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==T(s,"data:")||!Xe[e])if(Re&&!k(Se,C(s,xe,"")));else if(s)return!1;return!0},kt=function(e){return e.indexOf("-")>0},Nt=function(t){var n,r,o,i;Ct("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(i=a.length;i--;){var c=n=a[i],d=c.name,u=c.namespaceURI;if(r="value"===d?n.value:I(n.value),o=_e(d),l.attrName=o,l.attrValue=r,l.keepAttr=!0,l.forceKeepAttr=void 0,Ct("uponSanitizeAttribute",t,l),r=l.attrValue,!l.forceKeepAttr&&(wt(d,t),l.keepAttr))if(De||!k(/\/>/i,r)){Pe&&(r=C(r,ve," "),r=C(r,ye," "),r=C(r,be," "));var h=_e(t.nodeName);if(It(h,o,r)){if(!Ge||"id"!==o&&"name"!==o||(wt(d,t),r=We+r),ie&&"object"===e(g)&&"function"==typeof g.getAttributeType)if(u);else switch(g.getAttributeType(h,o)){case"TrustedHTML":r=ie.createHTML(r);break;case"TrustedScriptURL":r=ie.createScriptURL(r)}try{u?t.setAttributeNS(u,d,r):t.setAttribute(d,r),w(s.removed)}catch(e){}}}else wt(d,t)}Ct("afterSanitizeAttributes",t,null)}},Ot=function e(t){var s,n=xt(t);for(Ct("beforeSanitizeShadowDOM",t,null);s=n.nextNode();)Ct("uponSanitizeShadowNode",s,null),Tt(s)||(s.content instanceof i&&e(s.content),Nt(s));Ct("afterSanitizeShadowDOM",t,null)};return s.sanitize=function(r){var o,a,c,d,u,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!r)&&(r="\x3c!--\x3e"),"string"!=typeof r&&!At(r)){if("function"!=typeof r.toString)throw N("toString is not a function");if("string"!=typeof(r=r.toString()))throw N("dirty is not a string, aborting")}if(!s.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof r)return t.toStaticHTML(r);if(At(r))return t.toStaticHTML(r.outerHTML)}return r}if(ze||mt(h),s.removed=[],"string"==typeof r&&(Je=!1),Je){if(r.nodeName){var f=_e(r.nodeName);if(!Ae[f]||Ne[f])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(r instanceof l)1===(a=(o=St("\x3c!----\x3e")).ownerDocument.importNode(r,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!Ue&&!Pe&&!Le&&-1===r.indexOf("<"))return ie&&qe?ie.createHTML(r):r;if(!(o=St(r)))return Ue?null:qe?ae:""}o&&Fe&&jt(o.firstChild);for(var m=xt(Je?r:o);c=m.nextNode();)3===c.nodeType&&c===d||Tt(c)||(c.content instanceof i&&Ot(c.content),Nt(c),d=c);if(d=null,Je)return r;if(Ue){if(Be)for(u=ue.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(Te.shadowroot||Te.shadowrootmod)&&(u=fe.call(n,u,!0)),u}var p=Le?o.outerHTML:o.innerHTML;return Le&&Ae["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&k(se,o.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+p),Pe&&(p=C(p,ve," "),p=C(p,ye," "),p=C(p,be," ")),ie&&qe?ie.createHTML(p):p},s.setConfig=function(e){mt(e),ze=!0},s.clearConfig=function(){ut=null,ze=!1},s.isValidAttribute=function(e,t,s){ut||mt({});var n=_e(e),r=_e(t);return It(n,r,s)},s.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],S(pe[e],t))},s.removeHook=function(e){if(pe[e])return w(pe[e])},s.removeHooks=function(e){pe[e]&&(pe[e]=[])},s.removeAllHooks=function(){pe={}},s}return oe()}()},"./node_modules/favico.js-slevomat/favico.js":(e,t)=>{var s,n;n=function(e){"use strict";e=e||{};var t,s,n,r,o,i,a,l,c,d,u,h,f,m,p={bgColor:"#d00",textColor:"#fff",fontFamily:"sans-serif",fontStyle:"bold",type:"circle",position:"down",animation:"slide",elementId:!1,element:null,dataUrl:!1,win:window};(h={}).ff="undefined"!=typeof InstallTrigger,h.chrome=!!window.chrome,h.opera=!!window.opera||navigator.userAgent.indexOf("Opera")>=0,h.ie=!1,h.safari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,h.supported=h.chrome||h.ff||h.opera;var g=[];u=function(){},l=!1;var _={ready:function(){l=!0,_.reset(),u()},reset:function(){l&&(g=[],c=!1,d=!1,i.clearRect(0,0,r,n),i.drawImage(a,0,0,r,n),b.setIcon(o),window.clearTimeout(f),window.clearTimeout(void 0))},start:function(){if(l&&!d&&g.length>0){d=!0;var e=function(){["type","animation","bgColor","textColor","fontFamily","fontStyle"].forEach((function(e){e in g[0].options&&(t[e]=g[0].options[e])})),S.run(g[0].options,(function(){c=g[0],d=!1,g.length>0&&(g.shift(),_.start())}),!1)};c?S.run(c.options,(function(){e()}),!0):e()}}},v={},y=function(e){return e.n="number"==typeof e.n?Math.abs(0|e.n):e.n,e.x=r*e.x,e.y=n*e.y,e.w=r*e.w,e.h=n*e.h,e.len=(""+e.n).length,e};v.circle=function(e){var s=!1;2===(e=y(e)).len?(e.x=e.x-.4*e.w,e.w=1.4*e.w,s=!0):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w,s=!0),i.clearRect(0,0,r,n),i.drawImage(a,0,0,r,n),i.beginPath(),i.font=t.fontStyle+" "+Math.floor(e.h*(e.n>99?.85:1))+"px "+t.fontFamily,i.textAlign="center",s?(i.moveTo(e.x+e.w/2,e.y),i.lineTo(e.x+e.w-e.h/2,e.y),i.quadraticCurveTo(e.x+e.w,e.y,e.x+e.w,e.y+e.h/2),i.lineTo(e.x+e.w,e.y+e.h-e.h/2),i.quadraticCurveTo(e.x+e.w,e.y+e.h,e.x+e.w-e.h/2,e.y+e.h),i.lineTo(e.x+e.h/2,e.y+e.h),i.quadraticCurveTo(e.x,e.y+e.h,e.x,e.y+e.h-e.h/2),i.lineTo(e.x,e.y+e.h/2),i.quadraticCurveTo(e.x,e.y,e.x+e.h/2,e.y)):i.arc(e.x+e.w/2,e.y+e.h/2,e.h/2,0,2*Math.PI),i.fillStyle="rgba("+t.bgColor.r+","+t.bgColor.g+","+t.bgColor.b+","+e.o+")",i.fill(),i.closePath(),i.beginPath(),i.stroke(),i.fillStyle="rgba("+t.textColor.r+","+t.textColor.g+","+t.textColor.b+","+e.o+")","number"==typeof e.n&&e.n>999?i.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):i.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),i.closePath()},v.rectangle=function(e){2===(e=y(e)).len?(e.x=e.x-.4*e.w,e.w=1.4*e.w):e.len>=3&&(e.x=e.x-.65*e.w,e.w=1.65*e.w),i.clearRect(0,0,r,n),i.drawImage(a,0,0,r,n),i.beginPath(),i.font=t.fontStyle+" "+Math.floor(e.h*(e.n>99?.9:1))+"px "+t.fontFamily,i.textAlign="center",i.fillStyle="rgba("+t.bgColor.r+","+t.bgColor.g+","+t.bgColor.b+","+e.o+")",i.fillRect(e.x,e.y,e.w,e.h),i.fillStyle="rgba("+t.textColor.r+","+t.textColor.g+","+t.textColor.b+","+e.o+")","number"==typeof e.n&&e.n>999?i.fillText((e.n>9999?9:Math.floor(e.n/1e3))+"k+",Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.2*e.h)):i.fillText(e.n,Math.floor(e.x+e.w/2),Math.floor(e.y+e.h-.15*e.h)),i.closePath()};var b={};function j(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,s,n){return t+t+s+s+n+n}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return!!t&&{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}}function w(e,t){var s,n={};for(s in e)n[s]=e[s];for(s in t)n[s]=t[s];return n}b.getIcons=function(){var e=[];return t.element?e=[t.element]:t.elementId?(e=[m.getElementById(t.elementId)])[0].setAttribute("href",e[0].getAttribute("src")):0===(e=function(){for(var e=[],t=m.getElementsByTagName("head")[0].getElementsByTagName("link"),s=0;s<t.length;s++)/(^|\s)icon(\s|$)/i.test(t[s].getAttribute("rel"))&&e.push(t[s]);return e}()).length&&((e=[m.createElement("link")])[0].setAttribute("rel","icon"),m.getElementsByTagName("head")[0].appendChild(e[0])),e.forEach((function(e){e.setAttribute("type","image/png")})),e},b.setIcon=function(e){var t=e.toDataURL("image/png");b.setIconSrc(t)},b.setIconSrc=function(e){if(t.dataUrl&&t.dataUrl(e),t.element)t.element.setAttribute("href",e),t.element.setAttribute("src",e);else if(t.elementId){var n=m.getElementById(t.elementId);n.setAttribute("href",e),n.setAttribute("src",e)}else if(h.ff||h.opera){var r=s[s.length-1],o=m.createElement("link");s=[o],h.opera&&o.setAttribute("rel","icon"),o.setAttribute("rel","icon"),o.setAttribute("type","image/png"),m.getElementsByTagName("head")[0].appendChild(o),o.setAttribute("href",e),r.parentNode&&r.parentNode.removeChild(r)}else s.forEach((function(t){t.setAttribute("href",e)}))};var S={duration:40,types:{}};return S.types.fade=[{x:.4,y:.4,w:.6,h:.6,o:0},{x:.4,y:.4,w:.6,h:.6,o:.1},{x:.4,y:.4,w:.6,h:.6,o:.2},{x:.4,y:.4,w:.6,h:.6,o:.3},{x:.4,y:.4,w:.6,h:.6,o:.4},{x:.4,y:.4,w:.6,h:.6,o:.5},{x:.4,y:.4,w:.6,h:.6,o:.6},{x:.4,y:.4,w:.6,h:.6,o:.7},{x:.4,y:.4,w:.6,h:.6,o:.8},{x:.4,y:.4,w:.6,h:.6,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],S.types.none=[{x:.4,y:.4,w:.6,h:.6,o:1}],S.types.pop=[{x:1,y:1,w:0,h:0,o:1},{x:.9,y:.9,w:.1,h:.1,o:1},{x:.8,y:.8,w:.2,h:.2,o:1},{x:.7,y:.7,w:.3,h:.3,o:1},{x:.6,y:.6,w:.4,h:.4,o:1},{x:.5,y:.5,w:.5,h:.5,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],S.types.popFade=[{x:.75,y:.75,w:0,h:0,o:0},{x:.65,y:.65,w:.1,h:.1,o:.2},{x:.6,y:.6,w:.2,h:.2,o:.4},{x:.55,y:.55,w:.3,h:.3,o:.6},{x:.5,y:.5,w:.4,h:.4,o:.8},{x:.45,y:.45,w:.5,h:.5,o:.9},{x:.4,y:.4,w:.6,h:.6,o:1}],S.types.slide=[{x:.4,y:1,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.9,w:.6,h:.6,o:1},{x:.4,y:.8,w:.6,h:.6,o:1},{x:.4,y:.7,w:.6,h:.6,o:1},{x:.4,y:.6,w:.6,h:.6,o:1},{x:.4,y:.5,w:.6,h:.6,o:1},{x:.4,y:.4,w:.6,h:.6,o:1}],S.run=function(e,s,n,r){var i=S.types[m.hidden||m.msHidden||m.webkitHidden||m.mozHidden?"none":t.animation];r=!0===n?void 0!==r?r:i.length-1:void 0!==r?r:0,s=s||function(){},r<i.length&&r>=0?(v[t.type](w(e,i[r])),f=setTimeout((function(){n?r-=1:r+=1,S.run(e,s,n,r)}),S.duration),b.setIcon(o)):s()},function(){(t=w(p,e)).bgColor=j(t.bgColor),t.textColor=j(t.textColor),t.position=t.position.toLowerCase(),t.animation=S.types[""+t.animation]?t.animation:p.animation,m=t.win.document;var l=t.position.indexOf("up")>-1,c=t.position.indexOf("left")>-1;if(l||c)for(var d in S.types)for(var u=0;u<S.types[d].length;u++){var h=S.types[d][u];l&&(h.y<.6?h.y=h.y-.4:h.y=h.y-2*h.y+(1-h.w)),c&&(h.x<.6?h.x=h.x-.4:h.x=h.x-2*h.x+(1-h.h)),S.types[d][u]=h}t.type=v[""+t.type]?t.type:p.type,s=b.getIcons(),o=document.createElement("canvas"),a=document.createElement("img");var f=s[s.length-1];f.hasAttribute("href")?(a.setAttribute("crossOrigin","anonymous"),a.onload=function(){n=a.height>0?a.height:32,r=a.width>0?a.width:32,o.height=n,o.width=r,i=o.getContext("2d"),_.ready()},a.setAttribute("src",f.getAttribute("href"))):(n=32,r=32,a.height=n,a.width=r,o.height=n,o.width=r,i=o.getContext("2d"),_.ready())}(),{badge:function(e,t){t=("string"==typeof t?{animation:t}:t)||{},u=function(){try{if("number"==typeof e?e>0:""!==e){var s={type:"badge",options:{n:e}};if("animation"in t&&S.types[""+t.animation]&&(s.options.animation=""+t.animation),"type"in t&&v[""+t.type]&&(s.options.type=""+t.type),["bgColor","textColor"].forEach((function(e){e in t&&(s.options[e]=j(t[e]))})),["fontStyle","fontFamily"].forEach((function(e){e in t&&(s.options[e]=t[e])})),g.push(s),g.length>100)throw new Error("Too many badges requests in queue.");_.start()}else _.reset()}catch(e){throw new Error("Error setting badge. Message: "+e.message)}},l&&u()},setOpt:function(e,s){var n=e;null==s&&"[object Object]"==Object.prototype.toString.call(e)||((n={})[e]=s);for(var r=Object.keys(n),o=0;o<r.length;o++)"bgColor"==r[o]||"textColor"==r[o]?t[r[o]]=j(n[r[o]]):t[r[o]]=n[r[o]];g.push(c),_.start()},reset:_.reset,browser:{supported:h.supported}}},void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)},"./node_modules/gifuct-js/lib/deinterlace.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deinterlace=void 0;t.deinterlace=function(e,t){for(var s=new Array(e.length),n=e.length/t,r=function(n,r){var o=e.slice(r*t,(r+1)*t);s.splice.apply(s,[n*t,t].concat(o))},o=[0,4,2,1],i=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=o[l];c<n;c+=i[l])r(c,a),a++;return s}},"./node_modules/gifuct-js/lib/index.js":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n,r=(n=s("./node_modules/js-binary-schema-parser/lib/schemas/gif.js"))&&n.__esModule?n:{default:n},o=s("./node_modules/js-binary-schema-parser/lib/index.js"),i=s("./node_modules/js-binary-schema-parser/lib/parsers/uint8.js"),a=s("./node_modules/gifuct-js/lib/deinterlace.js"),l=s("./node_modules/gifuct-js/lib/lzw.js");t.parseGIF=function(e){var t=new Uint8Array(e);return(0,o.parse)((0,i.buildStream)(t),r.default)};var c=function(e,t,s){if(e.image){var n=e.image,r=n.descriptor.width*n.descriptor.height,o=(0,l.lzw)(n.data.minCodeSize,n.data.blocks,r);n.descriptor.lct.interlaced&&(o=(0,a.deinterlace)(o,n.descriptor.width));var i={pixels:o,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return n.descriptor.lct&&n.descriptor.lct.exists?i.colorTable=n.lct:i.colorTable=t,e.gce&&(i.delay=10*(e.gce.delay||10),i.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(i.transparentIndex=e.gce.transparentColorIndex)),s&&(i.patch=function(e){for(var t=e.pixels.length,s=new Uint8ClampedArray(4*t),n=0;n<t;n++){var r=4*n,o=e.pixels[n],i=e.colorTable[o]||[0,0,0];s[r]=i[0],s[r+1]=i[1],s[r+2]=i[2],s[r+3]=o!==e.transparentIndex?255:0}return s}(i)),i}console.warn("gif frame does not have associated image.")};t.decompressFrame=c;t.decompressFrames=function(e,t){return e.frames.filter((function(e){return e.image})).map((function(s){return c(s,e.gct,t)}))}},"./node_modules/gifuct-js/lib/lzw.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lzw=void 0;t.lzw=function(e,t,s){var n,r,o,i,a,l,c,d,u,h,f,m,p,g,_,v,y=4096,b=s,j=new Array(s),w=new Array(y),S=new Array(y),x=new Array(4097);for(a=(r=1<<(h=e))+1,n=r+2,c=-1,o=(1<<(i=h+1))-1,d=0;d<r;d++)w[d]=0,S[d]=d;for(f=m=p=g=_=v=0,u=0;u<b;){if(0===g){if(m<i){f+=t[v]<<m,m+=8,v++;continue}if(d=f&o,f>>=i,m-=i,d>n||d==a)break;if(d==r){o=(1<<(i=h+1))-1,n=r+2,c=-1;continue}if(-1==c){x[g++]=S[d],c=d,p=d;continue}for(l=d,d==n&&(x[g++]=p,d=c);d>r;)x[g++]=S[d],d=w[d];p=255&S[d],x[g++]=p,n<y&&(w[n]=c,S[n]=p,0==(++n&o)&&n<y&&(i++,o+=n)),c=l}g--,j[_++]=x[g],u++}for(u=_;u<b;u++)j[u]=0;return j}},"./node_modules/immediate/lib/browser.js":(e,t,s)=>{"use strict";var n,r,o=s.g.MutationObserver||s.g.WebKitMutationObserver;if(o){var i=0,a=new o(u),l=s.g.document.createTextNode("");a.observe(l,{characterData:!0}),n=function(){l.data=i=++i%2}}else if(s.g.setImmediate||void 0===s.g.MessageChannel)n="document"in s.g&&"onreadystatechange"in s.g.document.createElement("script")?function(){var e=s.g.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},s.g.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new s.g.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var d=[];function u(){var e,t;r=!0;for(var s=d.length;s;){for(t=d,d=[],e=-1;++e<s;)t[e]();s=d.length}r=!1}e.exports=function(e){1!==d.push(e)||r||n()}},"./node_modules/jed/jed.js":function(e,t){!function(s,n){var r=Array.prototype,o=Object.prototype,i=r.slice,a=o.hasOwnProperty,l=r.forEach,c={},d={forEach:function(e,t,s){var n,r,o;if(null!==e)if(l&&e.forEach===l)e.forEach(t,s);else if(e.length===+e.length){for(n=0,r=e.length;n<r;n++)if(n in e&&t.call(s,e[n],n,e)===c)return}else for(o in e)if(a.call(e,o)&&t.call(s,e[o],o,e)===c)return},extend:function(e){return this.forEach(i.call(arguments,1),(function(t){for(var s in t)e[s]=t[s]})),e}},u=function(e){if(this.defaults={locale_data:{messages:{"":{domain:"messages",lang:"en",plural_forms:"nplurals=2; plural=(n != 1);"}}},domain:"messages",debug:!1},this.options=d.extend({},this.defaults,e),this.textdomain(this.options.domain),e.domain&&!this.options.locale_data[this.options.domain])throw new Error("Text domain set to non-existent domain: `"+e.domain+"`")};function h(e){return u.PF.compile(e||"nplurals=2; plural=(n != 1);")}function f(e,t){this._key=e,this._i18n=t}u.context_delimiter=String.fromCharCode(4),d.extend(f.prototype,{onDomain:function(e){return this._domain=e,this},withContext:function(e){return this._context=e,this},ifPlural:function(e,t){return this._val=e,this._pkey=t,this},fetch:function(e){return"[object Array]"!={}.toString.call(e)&&(e=[].slice.call(arguments,0)),(e&&e.length?u.sprintf:function(e){return e})(this._i18n.dcnpgettext(this._domain,this._context,this._key,this._pkey,this._val),e)}}),d.extend(u.prototype,{translate:function(e){return new f(e,this)},textdomain:function(e){if(!e)return this._textdomain;this._textdomain=e},gettext:function(e){return this.dcnpgettext.call(this,n,n,e)},dgettext:function(e,t){return this.dcnpgettext.call(this,e,n,t)},dcgettext:function(e,t){return this.dcnpgettext.call(this,e,n,t)},ngettext:function(e,t,s){return this.dcnpgettext.call(this,n,n,e,t,s)},dngettext:function(e,t,s,r){return this.dcnpgettext.call(this,e,n,t,s,r)},dcngettext:function(e,t,s,r){return this.dcnpgettext.call(this,e,n,t,s,r)},pgettext:function(e,t){return this.dcnpgettext.call(this,n,e,t)},dpgettext:function(e,t,s){return this.dcnpgettext.call(this,e,t,s)},dcpgettext:function(e,t,s){return this.dcnpgettext.call(this,e,t,s)},npgettext:function(e,t,s,r){return this.dcnpgettext.call(this,n,e,t,s,r)},dnpgettext:function(e,t,s,n,r){return this.dcnpgettext.call(this,e,t,s,n,r)},dcnpgettext:function(e,t,s,n,r){var o;if(n=n||s,e=e||this._textdomain,!this.options)return(o=new u).dcnpgettext.call(o,void 0,void 0,s,n,r);if(!this.options.locale_data)throw new Error("No locale data provided.");if(!this.options.locale_data[e])throw new Error("Domain `"+e+"` was not found.");if(!this.options.locale_data[e][""])throw new Error("No locale meta information provided.");if(!s)throw new Error("No translation key found.");var i,a,l,c=t?t+u.context_delimiter+s:s,d=this.options.locale_data,f=d[e],m=(d.messages||this.defaults.locale_data.messages)[""],p=f[""].plural_forms||f[""]["Plural-Forms"]||f[""]["plural-forms"]||m.plural_forms||m["Plural-Forms"]||m["plural-forms"];if(void 0===r)l=0;else{if("number"!=typeof r&&(r=parseInt(r,10),isNaN(r)))throw new Error("The number that was passed in is not a number.");l=h(p)(r)}if(!f)throw new Error("No domain named `"+e+"` could be found.");return!(i=f[c])||l>i.length?(this.options.missing_key_callback&&this.options.missing_key_callback(c,e),a=[s,n],!0===this.options.debug&&console.log(a[h(p)(r)]),a[h()(r)]):(a=i[l])||(a=[s,n])[h()(r)]}});var m,p,g=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var s=[];t>0;s[--t]=e);return s.join("")}var s=function(){return s.cache.hasOwnProperty(arguments[0])||(s.cache[arguments[0]]=s.parse(arguments[0])),s.format.call(null,s.cache[arguments[0]],arguments)};return s.format=function(s,n){var r,o,i,a,l,c,d,u=1,h=s.length,f="",m=[];for(o=0;o<h;o++)if("string"===(f=e(s[o])))m.push(s[o]);else if("array"===f){if((a=s[o])[2])for(r=n[u],i=0;i<a[2].length;i++){if(!r.hasOwnProperty(a[2][i]))throw g('[sprintf] property "%s" does not exist',a[2][i]);r=r[a[2][i]]}else r=a[1]?n[a[1]]:n[u++];if(/[^s]/.test(a[8])&&"number"!=e(r))throw g("[sprintf] expecting number but found %s",e(r));switch(null==r&&(r=""),a[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=a[7]?r.toExponential(a[7]):r.toExponential();break;case"f":r=a[7]?parseFloat(r).toFixed(a[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&a[7]?r.substring(0,a[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(a[8])&&a[3]&&r>=0?"+"+r:r,c=a[4]?"0"==a[4]?"0":a[4].charAt(1):" ",d=a[6]-String(r).length,l=a[6]?t(c,d):"",m.push(a[5]?r+l:l+r)}return m.join("")},s.cache={},s.parse=function(e){for(var t=e,s=[],n=[],r=0;t;){if(null!==(s=/^[^\x25]+/.exec(t)))n.push(s[0]);else if(null!==(s=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(s=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(s[2]){r|=1;var o=[],i=s[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(i)))throw"[sprintf] huh?";for(o.push(a[1]);""!==(i=i.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(i)))o.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(i)))throw"[sprintf] huh?";o.push(a[1])}s[2]=o}else r|=2;if(3===r)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";n.push(s)}t=t.substring(s[0].length)}return n},s}();u.parse_plural=function(e,t){return e=e.replace(/n/g,t),u.parse_expression(e)},u.sprintf=function(e,t){return"[object Array]"=={}.toString.call(t)?function(e,t){return t.unshift(e),g.apply(null,t)}(e,[].slice.call(t)):g.apply(this,[].slice.call(arguments))},u.prototype.sprintf=function(){return u.sprintf.apply(this,arguments)},(u.PF={}).parse=function(e){var t=u.PF.extractPluralExpr(e);return u.PF.parser.parse.call(u.PF.parser,t)},u.PF.compile=function(e){var t=u.PF.parse(e);return function(e){return!0===(s=u.PF.interpreter(t)(e))?1:s||0;var s}},u.PF.interpreter=function(e){return function(t){switch(e.type){case"GROUP":return u.PF.interpreter(e.expr)(t);case"TERNARY":return u.PF.interpreter(e.expr)(t)?u.PF.interpreter(e.truthy)(t):u.PF.interpreter(e.falsey)(t);case"OR":return u.PF.interpreter(e.left)(t)||u.PF.interpreter(e.right)(t);case"AND":return u.PF.interpreter(e.left)(t)&&u.PF.interpreter(e.right)(t);case"LT":return u.PF.interpreter(e.left)(t)<u.PF.interpreter(e.right)(t);case"GT":return u.PF.interpreter(e.left)(t)>u.PF.interpreter(e.right)(t);case"LTE":return u.PF.interpreter(e.left)(t)<=u.PF.interpreter(e.right)(t);case"GTE":return u.PF.interpreter(e.left)(t)>=u.PF.interpreter(e.right)(t);case"EQ":return u.PF.interpreter(e.left)(t)==u.PF.interpreter(e.right)(t);case"NEQ":return u.PF.interpreter(e.left)(t)!=u.PF.interpreter(e.right)(t);case"MOD":return u.PF.interpreter(e.left)(t)%u.PF.interpreter(e.right)(t);case"VAR":return t;case"NUM":return e.val;default:throw new Error("Invalid Token found.")}}},u.PF.extractPluralExpr=function(e){e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),/;\s*$/.test(e)||(e=e.concat(";"));var t,s=/nplurals\=(\d+);/,n=e.match(s);if(!(n.length>1))throw new Error("nplurals not found in plural_forms string: "+e);if(n[1],!((t=(e=e.replace(s,"")).match(/plural\=(.*);/))&&t.length>1))throw new Error("`plural` expression not found: "+e);return t[1]},u.PF.parser=(m={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,"?":6,":":7,"||":8,"&&":9,"<":10,"<=":11,">":12,">=":13,"!=":14,"==":15,"%":16,"(":17,")":18,n:19,NUMBER:20,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"?",7:":",8:"||",9:"&&",10:"<",11:"<=",12:">",13:">=",14:"!=",15:"==",16:"%",17:"(",18:")",19:"n",20:"NUMBER"},productions_:[0,[3,2],[4,5],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,1],[4,1]],performAction:function(e,t,s,n,r,o,i){var a=o.length-1;switch(r){case 1:return{type:"GROUP",expr:o[a-1]};case 2:this.$={type:"TERNARY",expr:o[a-4],truthy:o[a-2],falsey:o[a]};break;case 3:this.$={type:"OR",left:o[a-2],right:o[a]};break;case 4:this.$={type:"AND",left:o[a-2],right:o[a]};break;case 5:this.$={type:"LT",left:o[a-2],right:o[a]};break;case 6:this.$={type:"LTE",left:o[a-2],right:o[a]};break;case 7:this.$={type:"GT",left:o[a-2],right:o[a]};break;case 8:this.$={type:"GTE",left:o[a-2],right:o[a]};break;case 9:this.$={type:"NEQ",left:o[a-2],right:o[a]};break;case 10:this.$={type:"EQ",left:o[a-2],right:o[a]};break;case 11:this.$={type:"MOD",left:o[a-2],right:o[a]};break;case 12:this.$={type:"GROUP",expr:o[a-1]};break;case 13:this.$={type:"VAR"};break;case 14:this.$={type:"NUM",val:Number(e)}}},table:[{3:1,4:2,17:[1,3],19:[1,4],20:[1,5]},{1:[3]},{5:[1,6],6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{4:17,17:[1,3],19:[1,4],20:[1,5]},{5:[2,13],6:[2,13],7:[2,13],8:[2,13],9:[2,13],10:[2,13],11:[2,13],12:[2,13],13:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13]},{5:[2,14],6:[2,14],7:[2,14],8:[2,14],9:[2,14],10:[2,14],11:[2,14],12:[2,14],13:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14]},{1:[2,1]},{4:18,17:[1,3],19:[1,4],20:[1,5]},{4:19,17:[1,3],19:[1,4],20:[1,5]},{4:20,17:[1,3],19:[1,4],20:[1,5]},{4:21,17:[1,3],19:[1,4],20:[1,5]},{4:22,17:[1,3],19:[1,4],20:[1,5]},{4:23,17:[1,3],19:[1,4],20:[1,5]},{4:24,17:[1,3],19:[1,4],20:[1,5]},{4:25,17:[1,3],19:[1,4],20:[1,5]},{4:26,17:[1,3],19:[1,4],20:[1,5]},{4:27,17:[1,3],19:[1,4],20:[1,5]},{6:[1,7],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[1,28]},{6:[1,7],7:[1,29],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16]},{5:[2,3],6:[2,3],7:[2,3],8:[2,3],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,3]},{5:[2,4],6:[2,4],7:[2,4],8:[2,4],9:[2,4],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,4]},{5:[2,5],6:[2,5],7:[2,5],8:[2,5],9:[2,5],10:[2,5],11:[2,5],12:[2,5],13:[2,5],14:[2,5],15:[2,5],16:[1,16],18:[2,5]},{5:[2,6],6:[2,6],7:[2,6],8:[2,6],9:[2,6],10:[2,6],11:[2,6],12:[2,6],13:[2,6],14:[2,6],15:[2,6],16:[1,16],18:[2,6]},{5:[2,7],6:[2,7],7:[2,7],8:[2,7],9:[2,7],10:[2,7],11:[2,7],12:[2,7],13:[2,7],14:[2,7],15:[2,7],16:[1,16],18:[2,7]},{5:[2,8],6:[2,8],7:[2,8],8:[2,8],9:[2,8],10:[2,8],11:[2,8],12:[2,8],13:[2,8],14:[2,8],15:[2,8],16:[1,16],18:[2,8]},{5:[2,9],6:[2,9],7:[2,9],8:[2,9],9:[2,9],10:[2,9],11:[2,9],12:[2,9],13:[2,9],14:[2,9],15:[2,9],16:[1,16],18:[2,9]},{5:[2,10],6:[2,10],7:[2,10],8:[2,10],9:[2,10],10:[2,10],11:[2,10],12:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[1,16],18:[2,10]},{5:[2,11],6:[2,11],7:[2,11],8:[2,11],9:[2,11],10:[2,11],11:[2,11],12:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11]},{5:[2,12],6:[2,12],7:[2,12],8:[2,12],9:[2,12],10:[2,12],11:[2,12],12:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12]},{4:30,17:[1,3],19:[1,4],20:[1,5]},{5:[2,2],6:[1,7],7:[2,2],8:[1,8],9:[1,9],10:[1,10],11:[1,11],12:[1,12],13:[1,13],14:[1,14],15:[1,15],16:[1,16],18:[2,2]}],defaultActions:{6:[2,1]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,s=[0],n=[null],r=[],o=this.table,i="",a=0,l=0,c=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;function u(){var e;return"number"!=typeof(e=t.lexer.lex()||1)&&(e=t.symbols_[e]||e),e}r.push(d),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var h,f,m,p,g,_,v,y,b,j,w={};;){if(m=s[s.length-1],this.defaultActions[m]?p=this.defaultActions[m]:(null==h&&(h=u()),p=o[m]&&o[m][h]),void 0===p||!p.length||!p[0]){if(!c){for(_ in b=[],o[m])this.terminals_[_]&&_>2&&b.push("'"+this.terminals_[_]+"'");var S="";S=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+b.join(", ")+", got '"+this.terminals_[h]+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==h?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(S,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:d,expected:b})}if(3==c){if(1==h)throw new Error(S||"Parsing halted.");l=this.lexer.yyleng,i=this.lexer.yytext,a=this.lexer.yylineno,d=this.lexer.yylloc,h=u()}for(;!(2..toString()in o[m]);){if(0==m)throw new Error(S||"Parsing halted.");j=1,s.length=s.length-2*j,n.length=n.length-j,r.length=r.length-j,m=s[s.length-1]}f=h,h=2,p=o[m=s[s.length-1]]&&o[m][2],c=3}if(p[0]instanceof Array&&p.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+h);switch(p[0]){case 1:s.push(h),n.push(this.lexer.yytext),r.push(this.lexer.yylloc),s.push(p[1]),h=null,f?(h=f,f=null):(l=this.lexer.yyleng,i=this.lexer.yytext,a=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:if(v=this.productions_[p[1]][1],w.$=n[n.length-v],w._$={first_line:r[r.length-(v||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(v||1)].first_column,last_column:r[r.length-1].last_column},void 0!==(g=this.performAction.call(w,i,l,a,this.yy,p[1],n,r)))return g;v&&(s=s.slice(0,-1*v*2),n=n.slice(0,-1*v),r=r.slice(0,-1*v)),s.push(this.productions_[p[1]][0]),n.push(w.$),r.push(w._$),y=o[s[s.length-2]][s[s.length-1]],s.push(y);break;case 3:return!0}}return!0}},p=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parseError)throw new Error(e);this.yy.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.match+=e,this.matched+=e,e.match(/\n/)&&this.yylineno++,this._input=this._input.slice(1),e},unput:function(e){return this._input=e+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),n=0;n<s.length;n++)if(e=this._input.match(this.rules[s[n]]))return(t=e[0].match(/\n.*/g))&&(this.yylineno+=t.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:t?t[t.length-1].length-1:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],this.performAction.call(this,this.yy,this,s[n],this.conditionStack[this.conditionStack.length-1])||void 0;if(""===this._input)return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},performAction:function(e,t,s,n){switch(s){case 0:break;case 1:return 20;case 2:return 19;case 3:return 8;case 4:return 9;case 5:return 6;case 6:return 7;case 7:return 11;case 8:return 13;case 9:return 10;case 10:return 12;case 11:return 14;case 12:return 15;case 13:return 16;case 14:return 17;case 15:return 18;case 16:return 5;case 17:return"INVALID"}},rules:[/^\s+/,/^[0-9]+(\.[0-9]+)?\b/,/^n\b/,/^\|\|/,/^&&/,/^\?/,/^:/,/^<=/,/^>=/,/^</,/^>/,/^!=/,/^==/,/^%/,/^\(/,/^\)/,/^$/,/^./],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],inclusive:!0}}};return e}(),m.lexer=p,m),e.exports&&(t=e.exports=u),t.Jed=u}()},"./node_modules/js-binary-schema-parser/lib/index.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loop=t.conditional=t.parse=void 0;t.parse=function e(t,s){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(Array.isArray(s))s.forEach((function(s){return e(t,s,n,r)}));else if("function"==typeof s)s(t,n,r,e);else{var o=Object.keys(s)[0];Array.isArray(s[o])?(r[o]={},e(t,s[o],n,r[o])):r[o]=s[o](t,n,r,e)}return n};t.conditional=function(e,t){return function(s,n,r,o){t(s,n,r)&&o(s,e,n,r)}};t.loop=function(e,t){return function(s,n,r,o){for(var i=[],a=s.pos;t(s,n,r);){var l={};if(o(s,e,n,l),s.pos===a)break;a=s.pos,i.push(l)}return i}}},"./node_modules/js-binary-schema-parser/lib/parsers/uint8.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readBits=t.readArray=t.readUnsigned=t.readString=t.peekBytes=t.readBytes=t.peekByte=t.readByte=t.buildStream=void 0;t.buildStream=function(e){return{data:e,pos:0}};var s=function(){return function(e){return e.data[e.pos++]}};t.readByte=s;t.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return t.data[t.pos+e]}};var n=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};t.readBytes=n;t.peekBytes=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}};t.readString=function(e){return function(t){return Array.from(n(e)(t)).map((function(e){return String.fromCharCode(e)})).join("")}};t.readUnsigned=function(e){return function(t){var s=n(2)(t);return e?(s[1]<<8)+s[0]:(s[0]<<8)+s[1]}};t.readArray=function(e,t){return function(s,r,o){for(var i="function"==typeof t?t(s,r,o):t,a=n(e),l=new Array(i),c=0;c<i;c++)l[c]=a(s);return l}};t.readBits=function(e){return function(t){for(var s=function(e){return e.data[e.pos++]}(t),n=new Array(8),r=0;r<8;r++)n[7-r]=!!(s&1<<r);return Object.keys(e).reduce((function(t,s){var r=e[s];return r.length?t[s]=function(e,t,s){for(var n=0,r=0;r<s;r++)n+=e[t+r]&&Math.pow(2,s-r-1);return n}(n,r.index,r.length):t[s]=n[r.index],t}),{})}}},"./node_modules/js-binary-schema-parser/lib/schemas/gif.js":(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s("./node_modules/js-binary-schema-parser/lib/index.js"),r=s("./node_modules/js-binary-schema-parser/lib/parsers/uint8.js"),o={blocks:function(e){for(var t=[],s=e.data.length,n=0,o=(0,r.readByte)()(e);0!==o&&o;o=(0,r.readByte)()(e)){if(e.pos+o>=s){var i=s-e.pos;t.push((0,r.readBytes)(i)(e)),n+=i;break}t.push((0,r.readBytes)(o)(e)),n+=o}for(var a=new Uint8Array(n),l=0,c=0;c<t.length;c++)a.set(t[c],l),l+=t[c].length;return a}},i=(0,n.conditional)({gce:[{codes:(0,r.readBytes)(2)},{byteSize:(0,r.readByte)()},{extras:(0,r.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,r.readUnsigned)(!0)},{transparentColorIndex:(0,r.readByte)()},{terminator:(0,r.readByte)()}]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&249===t[1]})),a=(0,n.conditional)({image:[{code:(0,r.readByte)()},{descriptor:[{left:(0,r.readUnsigned)(!0)},{top:(0,r.readUnsigned)(!0)},{width:(0,r.readUnsigned)(!0)},{height:(0,r.readUnsigned)(!0)},{lct:(0,r.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,n.conditional)({lct:(0,r.readArray)(3,(function(e,t,s){return Math.pow(2,s.descriptor.lct.size+1)}))},(function(e,t,s){return s.descriptor.lct.exists})),{data:[{minCodeSize:(0,r.readByte)()},o]}]},(function(e){return 44===(0,r.peekByte)()(e)})),l=(0,n.conditional)({text:[{codes:(0,r.readBytes)(2)},{blockSize:(0,r.readByte)()},{preData:function(e,t,s){return(0,r.readBytes)(s.text.blockSize)(e)}},o]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&1===t[1]})),c=(0,n.conditional)({application:[{codes:(0,r.readBytes)(2)},{blockSize:(0,r.readByte)()},{id:function(e,t,s){return(0,r.readString)(s.blockSize)(e)}},o]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&255===t[1]})),d=(0,n.conditional)({comment:[{codes:(0,r.readBytes)(2)},o]},(function(e){var t=(0,r.peekBytes)(2)(e);return 33===t[0]&&254===t[1]})),u=[{header:[{signature:(0,r.readString)(3)},{version:(0,r.readString)(3)}]},{lsd:[{width:(0,r.readUnsigned)(!0)},{height:(0,r.readUnsigned)(!0)},{gct:(0,r.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,r.readByte)()},{pixelAspectRatio:(0,r.readByte)()}]},(0,n.conditional)({gct:(0,r.readArray)(3,(function(e,t){return Math.pow(2,t.lsd.gct.size+1)}))},(function(e,t){return t.lsd.gct.exists})),{frames:(0,n.loop)([i,c,d,a,l],(function(e){var t=(0,r.peekByte)()(e);return 33===t||44===t}))}];t.default=u},"./node_modules/lie/lib/browser.js":(e,t,s)=>{"use strict";var n=s("./node_modules/immediate/lib/browser.js");function r(){}var o={},i=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function d(e,t,s){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof s&&(this.onRejected=s,this.callRejected=this.otherCallRejected)}function u(e,t,s){n((function(){var n;try{n=t(s)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var s=!1;function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}var i=m((function(){t(r,n)}));"error"===i.status&&n(i.value)}function m(e,t){var s={};try{s.value=e(t),s.status="success"}catch(e){s.status="error",s.value=e}return s}e.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var s=new this.constructor(r);this.state!==l?u(s,this.state===a?e:t,this.outcome):this.queue.push(new d(s,e,t));return s},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},o.resolve=function(e,t){var s=m(h,t);if("error"===s.status)return o.reject(e,s.value);var n=s.value;if(n)f(e,n);else{e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var s=-1,n=e.queue.length;++s<n;)e.queue[s].callRejected(t);return e},c.resolve=function(e){if(e instanceof this)return e;return o.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);var i=new Array(s),a=0,l=-1,c=new this(r);for(;++l<s;)d(e[l],l);return c;function d(e,r){t.resolve(e).then((function(e){i[r]=e,++a!==s||n||(n=!0,o.resolve(c,i))}),(function(e){n||(n=!0,o.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);var i=-1,a=new this(r);for(;++i<s;)l=e[i],t.resolve(l).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}));var l;return a}},"./node_modules/lie/polyfill.js":(e,t,s)=>{"use strict";"function"!=typeof s.g.Promise&&(s.g.Promise=s("./node_modules/lie/lib/browser.js"))},"./node_modules/localforage-driver-memory/_bundle/umd.js":function(e,t){"undefined"!=typeof self&&self,function(e){"use strict";var t="localforage-driver-memory";function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],s=0;return t?t.call(e):{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}}}function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}}var r=/^~~local_forage_type~([^~]+)~/,o=9,i=o+4,a=Object.prototype.toString;function l(e){var t=.75*e.length,s=e.length;"="===e[e.length-1]&&(t--,"="===e[e.length-2]&&t--);for(var n=new ArrayBuffer(t),r=new Uint8Array(n),o=0,i=0;o<s;o+=4){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o]),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+1]),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+2]),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e[o+3]);r[i++]=a<<2|l>>4,r[i++]=(15&l)<<4|c>>2,r[i++]=(3&c)<<6|63&d}return n}function c(e){for(var t=new Uint8Array(e),s="",n=0;n<t.length;n+=3)s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t[n]>>2],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&t[n])<<4|t[n+1]>>4],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&t[n+1])<<2|t[n+2]>>6],s+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&t[n+2]];return t.length%3==2?s=s.substring(0,s.length-1)+"=":t.length%3==1&&(s=s.substring(0,s.length-2)+"=="),s}function d(e,t){var s="";if(e&&(s=a.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===a.call(e.buffer))){var n=void 0,r="__lfsc__:";e instanceof ArrayBuffer?(n=e,r+="arbf"):(n=e.buffer,"[object Int8Array]"===s?r+="si08":"[object Uint8Array]"===s?r+="ui08":"[object Uint8ClampedArray]"===s?r+="uic8":"[object Int16Array]"===s?r+="si16":"[object Uint16Array]"===s?r+="ur16":"[object Int32Array]"===s?r+="si32":"[object Uint32Array]"===s?r+="ui32":"[object Float32Array]"===s?r+="fl32":"[object Float64Array]"===s?r+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(r+c(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s="~~local_forage_type~"+e.type+"~"+c(this.result);t("__lfsc__:blob"+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function u(e){if("__lfsc__:"!==e.substring(0,o))return JSON.parse(e);var t,s=e.substring(i),a=e.substring(o,i);if("blob"===a&&r.test(s)){var c=s.match(r);t=c[1],s=s.substring(c[0].length)}var d=l(s);switch(a){case"arbf":return d;case"blob":return n([d],{type:t});case"si08":return new Int8Array(d);case"ui08":return new Uint8Array(d);case"uic8":return new Uint8ClampedArray(d);case"si16":return new Int16Array(d);case"ur16":return new Uint16Array(d);case"si32":return new Int32Array(d);case"ui32":return new Uint32Array(d);case"fl32":return new Float32Array(d);case"fl64":return new Float64Array(d);default:throw new Error("Unkown type: "+a)}}function h(e){var t,n;if(null===e||"object"!=typeof e||"isActiveClone"in e)return e;var r=e instanceof Date?new Date(e):e.constructor();try{for(var o=s(Object.keys(e)),i=o.next();!i.done;i=o.next()){var a=i.value;Object.prototype.hasOwnProperty.call(e,a)&&(e.isActiveClone=null,r[a]=h(e[a]),delete e.isActiveClone)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function f(e,t){return(e.name||t.name)+"/"+(e.storeName||t.storeName)+"/"}function m(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function g(e,t){var s=this;if(t=p.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}return{promise:e.name?new Promise((function(t){e.storeName?t(f(e,s._defaultConfig)):t(e.name+"/")})):Promise.reject("Invalid arguments"),callback:t}}function _(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}var v={bufferToString:c,deserialize:u,serialize:d,stringToBuffer:l},y={},b=function(){function e(e){this.kp=e,this.data={}}return e.resolve=function(t){return y[t]||(y[t]=new e(t)),y[t]},e.prototype.clear=function(){this.data={}},e.prototype.drop=function(){this.clear(),delete y[this.kp]},e.prototype.get=function(e){return this.data[e]},e.prototype.key=function(e){return this.keys()[e]},e.prototype.keys=function(){return Object.keys(this.data)},e.prototype.rm=function(e){delete this.data[e]},e.prototype.set=function(e,t){this.data[e]=t},e}();function j(e){var t=e?h(e):{},s=f(t,this._defaultConfig),n=b.resolve(s);return this._dbInfo=t,this._dbInfo.serializer=v,this._dbInfo.keyPrefix=s,this._dbInfo.mStore=n,Promise.resolve()}function w(e){var t=this,s=this.ready().then((function(){t._dbInfo.mStore.clear()}));return m(s,e),s}function S(e,t){var s=g.apply(this,arguments),n=s.promise,r=s.callback;return m(n.then((function(e){b.resolve(e).drop()})),r),n}function x(e,t){var s=this;e=_(e);var n=this.ready().then((function(){var t=s._dbInfo.mStore.get(e);return null==t?null:s._dbInfo.serializer.deserialize(t)}));return m(n,t),n}function E(e,t){var s=this,n=this.ready().then((function(){for(var t=s._dbInfo.mStore,n=t.keys(),r=0;r<n.length;r++){var o=t.get(n[r]);if(o&&(o=s._dbInfo.serializer.deserialize(o)),void 0!==(o=e(o,n[r],r+1)))return o}}));return m(n,t),n}function A(e,t){var s=this,n=this.ready().then((function(){var t;try{void 0===(t=s._dbInfo.mStore.key(e))&&(t=null)}catch(e){t=null}return t}));return m(n,t),n}function C(e){var t=this,s=this.ready().then((function(){return t._dbInfo.mStore.keys()}));return m(s,e),s}function T(e){var t=this.keys().then((function(e){return e.length}));return m(t,e),t}function I(e,t){var s=this;e=_(e);var n=this.ready().then((function(){s._dbInfo.mStore.rm(e)}));return m(n,t),n}function k(e,t,s){var n=this;e=_(e);var r=this.ready().then((function(){void 0===t&&(t=null);var s=t;return new Promise((function(r,o){n._dbInfo.serializer.serialize(t,(function(t,i){if(i)o(i);else try{n._dbInfo.mStore.set(e,t),r(s)}catch(e){o(e)}}))}))}));return m(r,s),r}var N=!0;e._support=N,e._driver=t,e._initStorage=j,e.clear=w,e.dropInstance=S,e.getItem=x,e.iterate=E,e.key=A,e.keys=C,e.length=T,e.removeItem=I,e.setItem=k,Object.defineProperty(e,"__esModule",{value:!0})}(t)},"./node_modules/localforage-setitems/dist/localforage-setitems.js":function(e,t,s){!function(e,t){"use strict";function s(e){return s.result?s.result:e&&"function"==typeof e.getSerializer?(s.result=e.getSerializer(),s.result):Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!"))}function n(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function r(e,t,s,n){function r(e,t){var s=e||t;return e&&"function"==typeof e||"string"!=typeof s||(e=function(e){return e[s]}),e}var o=[];if("[object Array]"===Object.prototype.toString.call(e)){t=r(t,"key"),s=r(s,"value");for(var i=0,a=e.length;i<a;i++){var l=e[i];o.push(n(t(l),s(l)))}}else for(var c in e)e.hasOwnProperty(c)&&o.push(n(c,e[c]));return o}function o(e,t,s,o){var i=this,a=i.ready().then((function(){return new Promise((function(n,o){var a,l=i._dbInfo,c=l.db.transaction(l.storeName,"readwrite"),d=c.objectStore(l.storeName);function u(e){var t=e.target||this;a=t.error||t.transaction.error,o(a)}c.oncomplete=function(){n(e)},c.onabort=c.onerror=function(e){o(a||e.target)},r(e,t,s,(function(e,t){null===t&&(t=void 0),d.put(t,e).onerror=u}))}))}));return n(a,o),a}function i(e,t,o,i){var a=this,l=new Promise((function(n,i){a.ready().then((function(){return s(a)})).then((function(s){var l=a._dbInfo;l.db.transaction((function(a){var c="INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",d=r(e,t,o,(function(e,t){return new Promise((function(n,r){s.serialize(t,(function(t,s){s?r(s):a.executeSql(c,[e,t],(function(){n()}),(function(e,t){r(t)}))}))}))}));Promise.all(d).then((function(){n(e)}),i)}),(function(e){i(e)}))})).catch(i)}));return n(l,i),l}function a(e,t,s,o){var i=this,a=r(e,t,s,(function(e,t){return i.setItem(e,t)})),l=Promise.all(a);return n(l,o),l}function l(e,t,s,n){var r=this,l=r.driver();return l===r.INDEXEDDB?o.call(r,e,t,s,n):l===r.WEBSQL?i.call(r,e,t,s,n):a.call(r,e,t,s,n)}function c(e){var t=Object.getPrototypeOf(e);t&&(t.setItems=l,t.setItems.indexedDB=function(){return o.apply(this,arguments)},t.setItems.websql=function(){return i.apply(this,arguments)},t.setItems.generic=function(){return a.apply(this,arguments)})}var d=c(t="default"in t?t.default:t);e.setItemsGeneric=a,e.localforageSetItems=l,e.extendPrototype=c,e.extendPrototypeResult=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,s("./node_modules/localforage/dist/localforage.js"))},"./node_modules/localforage-webextensionstorage-driver/driver.js":(e,t,s)=>{"use strict";var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var s=(0,a.getStorage)(),n=!(!s||!s[t]),l=n?s[t]:{clear:function(){},get:function(){},remove:function(){},set:function(){}},c=l.clear.bind(l),d=l.get.bind(l),u=l.remove.bind(l),h=l.set.bind(l);return{_driver:e,_support:n,_initStorage:function(){return Promise.resolve()},clear:function(e){return(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c(),e&&e();case 2:case"end":return t.stop()}}),t)})))()},iterate:function(e,t){return(0,i.default)(r.default.mark((function s(){var n;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(d,null);case 2:n=s.sent,Object.keys(n).forEach((function(t,s){return e(n[t],t,s)})),t&&t();case 6:case"end":return s.stop()}}),s)})))()},getItem:function(e,t){return(0,i.default)(r.default.mark((function s(){var n;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,(0,a.usePromise)(d,e);case 3:return n=s.sent,n=void 0===(n="string"==typeof e?n[e]:n)?null:n,t&&t(null,n),s.abrupt("return",n);case 10:throw s.prev=10,s.t0=s.catch(0),t&&t(s.t0),s.t0;case 14:case"end":return s.stop()}}),s,null,[[0,10]])})))()},key:function(e,t){return(0,i.default)(r.default.mark((function s(){var n,o;return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(d,null);case 2:return n=s.sent,o=Object.keys(n)[e],t&&t(o),s.abrupt("return",o);case 6:case"end":return s.stop()}}),s)})))()},keys:function(e){return(0,i.default)(r.default.mark((function t(){var s,n;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.usePromise)(d,null);case 2:return s=t.sent,n=Object.keys(s),e&&e(n),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})))()},length:function(e){return(0,i.default)(r.default.mark((function t(){var s,n,o;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.usePromise)(d,null);case 2:return s=t.sent,n=Object.keys(s),o=n.length,e&&e(o),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})))()},removeItem:function(e,t){return(0,i.default)(r.default.mark((function s(){return r.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,a.usePromise)(u,e);case 2:t&&t();case 3:case"end":return s.stop()}}),s)})))()},setItem:function(e,t,s){return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,a.usePromise)(h,(0,o.default)({},e,t));case 2:s&&s();case 3:case"end":return n.stop()}}),n)})))()}}};var r=n(s("./node_modules/@babel/runtime/regenerator/index.js")),o=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),a=s("./node_modules/localforage-webextensionstorage-driver/utils.js")},"./node_modules/localforage-webextensionstorage-driver/local.js":(e,t,s)=>{"use strict";var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(s("./node_modules/localforage-webextensionstorage-driver/driver.js")).default)("webExtensionLocalStorage","local");t.default=r},"./node_modules/localforage-webextensionstorage-driver/sync.js":(e,t,s)=>{"use strict";var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,n(s("./node_modules/localforage-webextensionstorage-driver/driver.js")).default)("webExtensionSyncStorage","sync");t.default=r},"./node_modules/localforage-webextensionstorage-driver/utils.js":(e,t)=>{"use strict";function s(){return"undefined"!=typeof browser&&browser.storage||"undefined"!=typeof chrome&&chrome.storage}Object.defineProperty(t,"__esModule",{value:!0}),t.getStorage=s,t.usePromise=function(e,t){if(function(){var e=s();try{return e&&e.local.get&&e.local.get()&&"function"==typeof e.local.get().then}catch(e){return!1}}())return e(t);return new Promise((function(s){e(t,(function(){s.apply(void 0,arguments)}))}))}},"./node_modules/localforage/dist/localforage.js":(e,t,s)=>{e.exports=function e(t,s,n){function r(i,a){if(!s[i]){if(!t[i]){if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=s[i]={exports:{}};t[i][0].call(c.exports,(function(e){var s=t[i][1][e];return r(s||e)}),c,c.exports,e,t,s,n)}return s[i].exports}for(var o=void 0,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(e,t,n){(function(e){"use strict";var s,n,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var o=0,i=new r(d),a=e.document.createTextNode("");i.observe(a,{characterData:!0}),s=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)s="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,s=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;n=!0;for(var s=c.length;s;){for(t=c,c=[],e=-1;++e<s;)t[e]();s=c.length}n=!1}function u(e){1!==c.push(e)||n||s()}t.exports=u}).call(this,void 0!==s.g?s.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,s){"use strict";var n=e(1);function r(){}var o={},i=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function d(e,t,s){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof s&&(this.onRejected=s,this.callRejected=this.otherCallRejected)}function u(e,t,s){n((function(){var n;try{n=t(s)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var s=!1;function n(t){s||(s=!0,o.reject(e,t))}function r(t){s||(s=!0,o.resolve(e,t))}function i(){t(r,n)}var a=m(i);"error"===a.status&&n(a.value)}function m(e,t){var s={};try{s.value=e(t),s.status="success"}catch(e){s.status="error",s.value=e}return s}function p(e){return e instanceof this?e:o.resolve(new this(r),e)}function g(e){var t=new this(r);return o.reject(t,e)}function _(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i=new Array(s),a=0,l=-1,c=new this(r);++l<s;)d(e[l],l);return c;function d(e,r){function l(e){i[r]=e,++a!==s||n||(n=!0,o.resolve(c,i))}t.resolve(e).then(l,(function(e){n||(n=!0,o.reject(c,e))}))}}function v(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var s=e.length,n=!1;if(!s)return this.resolve([]);for(var i=-1,a=new this(r);++i<s;)l(e[i]);return a;function l(e){t.resolve(e).then((function(e){n||(n=!0,o.resolve(a,e))}),(function(e){n||(n=!0,o.reject(a,e))}))}}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===i)return this;var s=new this.constructor(r);return this.state!==l?u(s,this.state===a?e:t,this.outcome):this.queue.push(new d(s,e,t)),s},d.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){o.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},o.resolve=function(e,t){var s=m(h,t);if("error"===s.status)return o.reject(e,s.value);var n=s.value;if(n)f(e,n);else{e.state=a,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var s=-1,n=e.queue.length;++s<n;)e.queue[s].callRejected(t);return e},c.resolve=p,c.reject=g,c.all=_,c.race=v},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==s.g?s.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,s){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}var i=o();function a(){try{if(!i||!i.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function l(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var s=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)s.append(e[n]);return s.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var c=Promise;function d(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function u(e,t,s){"function"==typeof t&&e.then(t),"function"==typeof s&&e.catch(s)}function h(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",p=void 0,g={},_=Object.prototype.toString,v="readonly",y="readwrite";function b(e){for(var t=e.length,s=new ArrayBuffer(t),n=new Uint8Array(s),r=0;r<t;r++)n[r]=e.charCodeAt(r);return s}function j(e){return new c((function(t){var s=e.transaction(m,y),n=l([""]);s.objectStore(m).put(n,"key"),s.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},s.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);t(s||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}function w(e){return"boolean"==typeof p?c.resolve(p):j(e).then((function(e){return p=e}))}function S(e){var t=g[e.name],s={};s.promise=new c((function(e,t){s.resolve=e,s.reject=t})),t.deferredOperations.push(s),t.dbReady?t.dbReady=t.dbReady.then((function(){return s.promise})):t.dbReady=s.promise}function x(e){var t=g[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function E(e,t){var s=g[e.name].deferredOperations.pop();if(s)return s.reject(t),s.promise}function A(e,t){return new c((function(s,n){if(g[e.name]=g[e.name]||D(),e.db){if(!t)return s(e.db);S(e),e.db.close()}var r=[e.name];t&&r.push(e.version);var o=i.open.apply(i,r);t&&(o.onupgradeneeded=function(t){var s=o.result;try{s.createObjectStore(e.storeName),t.oldVersion<=1&&s.createObjectStore(m)}catch(s){if("ConstraintError"!==s.name)throw s;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){var t=o.result;t.onversionchange=function(e){e.target.close()},s(t),x(e)}}))}function C(e){return A(e,!1)}function T(e){return A(e,!0)}function I(e,t){if(!e.db)return!0;var s=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||s){if(s){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function k(e){return new c((function(t,s){var n=new FileReader;n.onerror=s,n.onloadend=function(s){var n=btoa(s.target.result||"");t({__local_forage_encoded_blob:!0,data:n,type:e.type})},n.readAsBinaryString(e)}))}function N(e){return l([b(atob(e.data))],{type:e.type})}function O(e){return e&&e.__local_forage_encoded_blob}function M(e){var t=this,s=t._initReady().then((function(){var e=g[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return u(s,e,e),s}function $(e){S(e);for(var t=g[e.name],s=t.forages,n=0;n<s.length;n++){var r=s[n];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,C(e).then((function(t){return e.db=t,I(e)?T(e):t})).then((function(n){e.db=t.db=n;for(var r=0;r<s.length;r++)s[r]._dbInfo.db=n})).catch((function(t){throw E(e,t),t}))}function R(e,t,s,n){void 0===n&&(n=1);try{var r=e.db.transaction(e.storeName,t);s(null,r)}catch(r){if(n>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return c.resolve().then((function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return $(e).then((function(){R(e,t,s,n-1)}))})).catch(s);s(r)}}function D(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function P(e){var t=this,s={db:null};if(e)for(var n in e)s[n]=e[n];var r=g[s.name];r||(r=D(),g[s.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=M);var o=[];function i(){return c.resolve()}for(var a=0;a<r.forages.length;a++){var l=r.forages[a];l!==t&&o.push(l._initReady().catch(i))}var d=r.forages.slice(0);return c.all(o).then((function(){return s.db=r.db,C(s)})).then((function(e){return s.db=e,I(s,t._defaultConfig.version)?T(s):e})).then((function(e){s.db=r.db=e,t._dbInfo=s;for(var n=0;n<d.length;n++){var o=d[n];o!==t&&(o._dbInfo.db=s.db,o._dbInfo.version=s.version)}}))}function L(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),O(e)&&(e=N(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function z(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).openCursor(),a=1;i.onsuccess=function(){var s=i.result;if(s){var n=s.value;O(n)&&(n=N(n));var r=e(n,s.key,a++);void 0!==r?t(r):s.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function F(e,t,s){var n=this;e=h(e);var r=new c((function(s,r){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===_.call(t)?w(o.db).then((function(e){return e?t:k(t)})):t})).then((function(t){R(n._dbInfo,y,(function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),s(t)},i.onabort=i.onerror=function(){var e=l.error?l.error:l.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return d(r,s),r}function U(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){R(s._dbInfo,y,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function B(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,y,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;s(e)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function q(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,v,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function H(e,t){var s=this,n=new c((function(t,n){e<0?t(null):s.ready().then((function(){R(s._dbInfo,v,(function(r,o){if(r)return n(r);try{var i=o.objectStore(s._dbInfo.storeName),a=!1,l=i.openKeyCursor();l.onsuccess=function(){var s=l.result;s?0===e||a?t(s.key):(a=!0,s.advance(e)):t(null)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return d(n,t),n}function G(e){var t=this,s=new c((function(e,s){t.ready().then((function(){R(t._dbInfo,v,(function(n,r){if(n)return s(n);try{var o=r.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){s(o.error)}}catch(e){s(e)}}))})).catch(s)}));return d(s,e),s}function W(e,t){t=f.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;if(e.name){var o=e.name===s.name&&r._dbInfo.db?c.resolve(r._dbInfo.db):C(e).then((function(t){var s=g[e.name],n=s.forages;s.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}));n=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var s=t.version+1;S(e);var n=g[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++){var a=r[o];a._dbInfo.db=null,a._dbInfo.version=s}var l=new c((function(t,n){var r=i.open(e.name,s);r.onerror=function(e){r.result.close(),n(e)},r.onupgradeneeded=function(){r.result.deleteObjectStore(e.storeName)},r.onsuccess=function(){var e=r.result;e.close(),t(e)}}));return l.then((function(e){n.db=e;for(var t=0;t<r.length;t++){var s=r[t];s._dbInfo.db=e,x(s._dbInfo)}})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}})):o.then((function(t){S(e);var s=g[e.name],n=s.forages;t.close();for(var r=0;r<n.length;r++)n[r]._dbInfo.db=null;var o=new c((function(t,s){var n=i.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),s(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}));return o.then((function(e){s.db=e;for(var t=0;t<n.length;t++)x(n[t]._dbInfo)})).catch((function(t){throw(E(e,t)||c.resolve()).catch((function(){})),t}))}))}else n=c.reject("Invalid arguments");return d(n,t),n}var V={_driver:"asyncStorage",_initStorage:P,_support:a(),iterate:z,getItem:L,setItem:F,removeItem:U,clear:B,length:q,key:H,keys:G,dropInstance:W};function J(){return"function"==typeof openDatabase}var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="~~local_forage_type~",K=/^~~local_forage_type~([^~]+)~/,X="__lfsc__:",Z=X.length,ee="arbf",te="blob",se="si08",ne="ui08",re="uic8",oe="si16",ie="si32",ae="ur16",le="ui32",ce="fl32",de="fl64",ue=Z+ee.length,he=Object.prototype.toString;function fe(e){var t,s,n,r,o,i=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),d=new Uint8Array(c);for(t=0;t<a;t+=4)s=Q.indexOf(e[t]),n=Q.indexOf(e[t+1]),r=Q.indexOf(e[t+2]),o=Q.indexOf(e[t+3]),d[l++]=s<<2|n>>4,d[l++]=(15&n)<<4|r>>2,d[l++]=(3&r)<<6|63&o;return c}function me(e){var t,s=new Uint8Array(e),n="";for(t=0;t<s.length;t+=3)n+=Q[s[t]>>2],n+=Q[(3&s[t])<<4|s[t+1]>>4],n+=Q[(15&s[t+1])<<2|s[t+2]>>6],n+=Q[63&s[t+2]];return s.length%3==2?n=n.substring(0,n.length-1)+"=":s.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function pe(e,t){var s="";if(e&&(s=he.call(e)),e&&("[object ArrayBuffer]"===s||e.buffer&&"[object ArrayBuffer]"===he.call(e.buffer))){var n,r=X;e instanceof ArrayBuffer?(n=e,r+=ee):(n=e.buffer,"[object Int8Array]"===s?r+=se:"[object Uint8Array]"===s?r+=ne:"[object Uint8ClampedArray]"===s?r+=re:"[object Int16Array]"===s?r+=oe:"[object Uint16Array]"===s?r+=ae:"[object Int32Array]"===s?r+=ie:"[object Uint32Array]"===s?r+=le:"[object Float32Array]"===s?r+=ce:"[object Float64Array]"===s?r+=de:t(new Error("Failed to get type for BinaryArray"))),t(r+me(n))}else if("[object Blob]"===s){var o=new FileReader;o.onload=function(){var s=Y+e.type+"~"+me(this.result);t(X+te+s)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function ge(e){if(e.substring(0,Z)!==X)return JSON.parse(e);var t,s=e.substring(ue),n=e.substring(Z,ue);if(n===te&&K.test(s)){var r=s.match(K);t=r[1],s=s.substring(r[0].length)}var o=fe(s);switch(n){case ee:return o;case te:return l([o],{type:t});case se:return new Int8Array(o);case ne:return new Uint8Array(o);case re:return new Uint8ClampedArray(o);case oe:return new Int16Array(o);case ae:return new Uint16Array(o);case ie:return new Int32Array(o);case le:return new Uint32Array(o);case ce:return new Float32Array(o);case de:return new Float64Array(o);default:throw new Error("Unkown type: "+n)}}var _e={serialize:pe,deserialize:ge,stringToBuffer:fe,bufferToString:me};function ve(e,t,s,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],s,n)}function ye(e){var t=this,s={db:null};if(e)for(var n in e)s[n]="string"!=typeof e[n]?e[n].toString():e[n];var r=new c((function(e,n){try{s.db=openDatabase(s.name,String(s.version),s.description,s.size)}catch(e){return n(e)}s.db.transaction((function(r){ve(r,s,(function(){t._dbInfo=s,e()}),(function(e,t){n(t)}))}),n)}));return s.serializer=_e,r}function be(e,t,s,n,r,o){e.executeSql(s,n,r,(function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,i):ve(e,t,(function(){e.executeSql(s,n,r,o)}),o)}),o):o(e,i)}),o)}function je(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,s){var n=s.rows.length?s.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function we(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT * FROM "+r.storeName,[],(function(s,n){for(var o=n.rows,i=o.length,a=0;a<i;a++){var l=o.item(a),c=l.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Se(e,t,s,n){var r=this;e=h(e);var o=new c((function(o,i){r.ready().then((function(){void 0===t&&(t=null);var a=t,l=r._dbInfo;l.serializer.serialize(t,(function(t,c){c?i(c):l.db.transaction((function(s){be(s,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){i(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(Se.apply(r,[e,a,s,n-1]));i(t)}}))}))})).catch(i)}));return d(o,s),o}function xe(e,t,s){return Se.apply(this,[e,t,s,1])}function Ee(e,t){var s=this;e=h(e);var n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Ae(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function Ce(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,s){var n=s.rows.item(0).c;e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function Te(e,t){var s=this,n=new c((function(t,n){s.ready().then((function(){var r=s._dbInfo;r.db.transaction((function(s){be(s,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,s){var n=s.rows.length?s.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return d(n,t),n}function Ie(e){var t=this,s=new c((function(e,s){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){be(t,n,"SELECT key FROM "+n.storeName,[],(function(t,s){for(var n=[],r=0;r<s.rows.length;r++)n.push(s.rows.item(r).key);e(n)}),(function(e,t){s(t)}))}))})).catch(s)}));return d(s,e),s}function ke(e){return new c((function(t,s){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(s,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).name);t({db:e,storeNames:r})}),(function(e,t){s(t)}))}),(function(e){s(e)}))}))}function Ne(e,t){t=f.apply(this,arguments);var s=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||s.name,e.storeName=e.storeName||s.storeName);var n,r=this;return d(n=e.name?new c((function(t){var n;n=e.name===s.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(ke(n))})).then((function(e){return new c((function(t,s){e.db.transaction((function(n){function r(e){return new c((function(t,s){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){s(t)}))}))}for(var o=[],i=0,a=e.storeNames.length;i<a;i++)o.push(r(e.storeNames[i]));c.all(o).then((function(){t()})).catch((function(e){s(e)}))}),(function(e){s(e)}))}))})):c.reject("Invalid arguments"),t),n}var Oe={_driver:"webSQLStorage",_initStorage:ye,_support:J(),iterate:we,getItem:je,setItem:xe,removeItem:Ee,clear:Ae,length:Ce,key:Te,keys:Ie,dropInstance:Ne};function Me(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function $e(e,t){var s=e.name+"/";return e.storeName!==t.storeName&&(s+=e.storeName+"/"),s}function Re(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function De(){return!Re()||localStorage.length>0}function Pe(e){var t=this,s={};if(e)for(var n in e)s[n]=e[n];return s.keyPrefix=$e(e,t._defaultConfig),De()?(t._dbInfo=s,s.serializer=_e,c.resolve()):c.reject()}function Le(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,s=localStorage.length-1;s>=0;s--){var n=localStorage.key(s);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return d(s,e),s}function ze(e,t){var s=this;e=h(e);var n=s.ready().then((function(){var t=s._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return d(n,t),n}function Fe(e,t){var s=this,n=s.ready().then((function(){for(var t=s._dbInfo,n=t.keyPrefix,r=n.length,o=localStorage.length,i=1,a=0;a<o;a++){var l=localStorage.key(a);if(0===l.indexOf(n)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(r),i++)))return c}}}));return d(n,t),n}function Ue(e,t){var s=this,n=s.ready().then((function(){var t,n=s._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return d(n,t),n}function Be(e){var t=this,s=t.ready().then((function(){for(var e=t._dbInfo,s=localStorage.length,n=[],r=0;r<s;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return d(s,e),s}function qe(e){var t=this.keys().then((function(e){return e.length}));return d(t,e),t}function He(e,t){var s=this;e=h(e);var n=s.ready().then((function(){var t=s._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return d(n,t),n}function Ge(e,t,s){var n=this;e=h(e);var r=n.ready().then((function(){void 0===t&&(t=null);var s=t;return new c((function(r,o){var i=n._dbInfo;i.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(i.keyPrefix+e,t),r(s)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return d(r,s),r}function We(e,t){if(t=f.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var s=this.config();e.name=e.name||s.name,e.storeName=e.storeName||s.storeName}var n,r=this;return n=e.name?new c((function(t){e.storeName?t($e(e,r._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var s=localStorage.key(t);0===s.indexOf(e)&&localStorage.removeItem(s)}})):c.reject("Invalid arguments"),d(n,t),n}var Ve={_driver:"localStorageWrapper",_initStorage:Pe,_support:Me(),iterate:Fe,getItem:ze,setItem:Ge,removeItem:He,clear:Le,length:qe,key:Ue,keys:Be,dropInstance:We},Je=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Qe=function(e,t){for(var s=e.length,n=0;n<s;){if(Je(e[n],t))return!0;n++}return!1},Ye=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ke={},Xe={},Ze={INDEXEDDB:V,WEBSQL:Oe,LOCALSTORAGE:Ve},et=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],tt=["dropInstance"],st=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(tt),nt={description:"",driver:et.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function rt(e,t){e[t]=function(){var s=arguments;return e.ready().then((function(){return e[t].apply(e,s)}))}}function ot(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var s in t)t.hasOwnProperty(s)&&(Ye(t[s])?arguments[0][s]=t[s].slice():arguments[0][s]=t[s])}return arguments[0]}var it=function(){function e(t){for(var s in r(this,e),Ze)if(Ze.hasOwnProperty(s)){var n=Ze[s],o=n._driver;this[s]=o,Ke[o]||this.defineDriver(n)}this._defaultConfig=ot({},nt),this._config=ot({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,s){var n=new c((function(t,s){try{var n=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void s(r);for(var o=st.concat("_initStorage"),i=0,a=o.length;i<a;i++){var l=o[i];if((!Qe(tt,l)||e[l])&&"function"!=typeof e[l])return void s(r)}var u=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),s=c.reject(t);return d(s,arguments[arguments.length-1]),s}},s=0,n=tt.length;s<n;s++){var r=tt[s];e[r]||(e[r]=t(r))}};u();var h=function(s){Ke[n]&&console.info("Redefining LocalForage driver: "+n),Ke[n]=e,Xe[n]=s,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(h,s):h(!!e._support):h(!0)}catch(e){s(e)}}));return u(n,t,s),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,s){var n=Ke[e]?c.resolve(Ke[e]):c.reject(new Error("Driver not found."));return u(n,t,s),n},e.prototype.getSerializer=function(e){var t=c.resolve(_e);return u(t,e),t},e.prototype.ready=function(e){var t=this,s=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return u(s,e,e),s},e.prototype.setDriver=function(e,t,s){var n=this;Ye(e)||(e=[e]);var r=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function i(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}function a(e){return function(){var t=0;function s(){for(;t<e.length;){var r=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(i).catch(s)}o();var a=new Error("No available storage method found.");return n._driverSet=c.reject(a),n._driverSet}return s()}}var l=null!==this._driverSet?this._driverSet.catch((function(){return c.resolve()})):c.resolve();return this._driverSet=l.then((function(){var e=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=a(r)}))})).catch((function(){o();var e=new Error("No available storage method found.");return n._driverSet=c.reject(e),n._driverSet})),u(this._driverSet,t,s),this._driverSet},e.prototype.supports=function(e){return!!Xe[e]},e.prototype._extend=function(e){ot(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],s=0,n=e.length;s<n;s++){var r=e[s];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=st.length;e<t;e++)rt(this,st[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),at=new it;t.exports=at},{3:3}]},{},[4])(4)},"./node_modules/sizzle/dist/sizzle.js":(e,t,s)=>{var n;!function(r){var o,i,a,l,c,d,u,h,f,m,p,g,_,v,y,b,j,w,S,x="sizzle"+1*new Date,E=r.document,A=0,C=0,T=he(),I=he(),k=he(),N=he(),O=function(e,t){return e===t&&(p=!0),0},M={}.hasOwnProperty,$=[],R=$.pop,D=$.push,P=$.push,L=$.slice,z=function(e,t){for(var s=0,n=e.length;s<n;s++)if(e[s]===t)return s;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",U="[\\x20\\t\\r\\n\\f]",B="(?:\\\\[\\da-fA-F]{1,6}"+U+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",q="\\["+U+"*("+B+")(?:"+U+"*([*^$|!~]?=)"+U+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+B+"))|)"+U+"*\\]",H=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|.*)\\)|)",G=new RegExp(U+"+","g"),W=new RegExp("^"+U+"+|((?:^|[^\\\\])(?:\\\\.)*)"+U+"+$","g"),V=new RegExp("^"+U+"*,"+U+"*"),J=new RegExp("^"+U+"*([>+~]|"+U+")"+U+"*"),Q=new RegExp(U+"|>"),Y=new RegExp(H),K=new RegExp("^"+B+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+U+"*(even|odd|(([+-]|)(\\d*)n|)"+U+"*(?:([+-]|)"+U+"*(\\d+)|))"+U+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+U+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+U+"*((?:-\\d)?\\d*)"+U+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,ee=/^(?:input|select|textarea|button)$/i,te=/^h\d$/i,se=/^[^{]+\{\s*\[native \w/,ne=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,re=/[+~]/,oe=new RegExp("\\\\[\\da-fA-F]{1,6}"+U+"?|\\\\([^\\r\\n\\f])","g"),ie=function(e,t){var s="0x"+e.slice(1)-65536;return t||(s<0?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320))},ae=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,le=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ce=function(){g()},de=xe((function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{P.apply($=L.call(E.childNodes),E.childNodes),$[E.childNodes.length].nodeType}catch(e){P={apply:$.length?function(e,t){D.apply(e,L.call(t))}:function(e,t){for(var s=e.length,n=0;e[s++]=t[n++];);e.length=s-1}}}function ue(e,t,s,n){var r,o,a,l,c,u,f,m=t&&t.ownerDocument,p=t?t.nodeType:9;if(s=s||[],"string"!=typeof e||!e||1!==p&&9!==p&&11!==p)return s;if(!n&&(g(t),t=t||_,y)){if(11!==p&&(c=ne.exec(e)))if(r=c[1]){if(9===p){if(!(a=t.getElementById(r)))return s;if(a.id===r)return s.push(a),s}else if(m&&(a=m.getElementById(r))&&S(t,a)&&a.id===r)return s.push(a),s}else{if(c[2])return P.apply(s,t.getElementsByTagName(e)),s;if((r=c[3])&&i.getElementsByClassName&&t.getElementsByClassName)return P.apply(s,t.getElementsByClassName(r)),s}if(i.qsa&&!N[e+" "]&&(!b||!b.test(e))&&(1!==p||"object"!==t.nodeName.toLowerCase())){if(f=e,m=t,1===p&&(Q.test(e)||J.test(e))){for((m=re.test(e)&&je(t.parentNode)||t)===t&&i.scope||((l=t.getAttribute("id"))?l=l.replace(ae,le):t.setAttribute("id",l=x)),o=(u=d(e)).length;o--;)u[o]=(l?"#"+l:":scope")+" "+Se(u[o]);f=u.join(",")}try{return P.apply(s,m.querySelectorAll(f)),s}catch(t){N(e,!0)}finally{l===x&&t.removeAttribute("id")}}}return h(e.replace(W,"$1"),t,s,n)}function he(){var e=[];return function t(s,n){return e.push(s+" ")>a.cacheLength&&delete t[e.shift()],t[s+" "]=n}}function fe(e){return e[x]=!0,e}function me(e){var t=_.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function pe(e,t){for(var s=e.split("|"),n=s.length;n--;)a.attrHandle[s[n]]=t}function ge(e,t){var s=t&&e,n=s&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(s)for(;s=s.nextSibling;)if(s===t)return-1;return e?1:-1}function _e(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ve(e){return function(t){var s=t.nodeName.toLowerCase();return("input"===s||"button"===s)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&de(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function be(e){return fe((function(t){return t=+t,fe((function(s,n){for(var r,o=e([],s.length,t),i=o.length;i--;)s[r=o[i]]&&(s[r]=!(n[r]=s[r]))}))}))}function je(e){return e&&void 0!==e.getElementsByTagName&&e}for(o in i=ue.support={},c=ue.isXML=function(e){var t=e&&e.namespaceURI,s=e&&(e.ownerDocument||e).documentElement;return!Z.test(t||s&&s.nodeName||"HTML")},g=ue.setDocument=function(e){var t,s,n=e?e.ownerDocument||e:E;return n!=_&&9===n.nodeType&&n.documentElement?(v=(_=n).documentElement,y=!c(_),E!=_&&(s=_.defaultView)&&s.top!==s&&(s.addEventListener?s.addEventListener("unload",ce,!1):s.attachEvent&&s.attachEvent("onunload",ce)),i.scope=me((function(e){return v.appendChild(e).appendChild(_.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length})),i.cssHas=me((function(){try{return _.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),i.attributes=me((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=me((function(e){return e.appendChild(_.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=se.test(_.getElementsByClassName),i.getById=me((function(e){return v.appendChild(e).id=x,!_.getElementsByName||!_.getElementsByName(x).length})),i.getById?(a.filter.ID=function(e){var t=e.replace(oe,ie);return function(e){return e.getAttribute("id")===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var s=t.getElementById(e);return s?[s]:[]}}):(a.filter.ID=function(e){var t=e.replace(oe,ie);return function(e){var s=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return s&&s.value===t}},a.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var s,n,r,o=t.getElementById(e);if(o){if((s=o.getAttributeNode("id"))&&s.value===e)return[o];for(r=t.getElementsByName(e),n=0;o=r[n++];)if((s=o.getAttributeNode("id"))&&s.value===e)return[o]}return[]}}),a.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var s,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;s=o[r++];)1===s.nodeType&&n.push(s);return n}return o},a.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},j=[],b=[],(i.qsa=se.test(_.querySelectorAll))&&(me((function(e){var t;v.appendChild(e).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&b.push("[*^$]="+U+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||b.push("\\["+U+"*(?:value|"+F+")"),e.querySelectorAll("[id~="+x+"-]").length||b.push("~="),(t=_.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||b.push("\\["+U+"*name"+U+"*="+U+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||b.push(":checked"),e.querySelectorAll("a#"+x+"+*").length||b.push(".#.+[+~]"),e.querySelectorAll("\\\f"),b.push("[\\r\\n\\f]")})),me((function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=_.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&b.push("name"+U+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&b.push(":enabled",":disabled"),v.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&b.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),b.push(",.*:")}))),(i.matchesSelector=se.test(w=v.matches||v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&me((function(e){i.disconnectedMatch=w.call(e,"*"),w.call(e,"[s!='']:x"),j.push("!=",H)})),i.cssHas||b.push(":has"),b=b.length&&new RegExp(b.join("|")),j=j.length&&new RegExp(j.join("|")),t=se.test(v.compareDocumentPosition),S=t||se.test(v.contains)?function(e,t){var s=9===e.nodeType&&e.documentElement||e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(s.contains?s.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},O=t?function(e,t){if(e===t)return p=!0,0;var s=!e.compareDocumentPosition-!t.compareDocumentPosition;return s||(1&(s=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===s?e==_||e.ownerDocument==E&&S(E,e)?-1:t==_||t.ownerDocument==E&&S(E,t)?1:m?z(m,e)-z(m,t):0:4&s?-1:1)}:function(e,t){if(e===t)return p=!0,0;var s,n=0,r=e.parentNode,o=t.parentNode,i=[e],a=[t];if(!r||!o)return e==_?-1:t==_?1:r?-1:o?1:m?z(m,e)-z(m,t):0;if(r===o)return ge(e,t);for(s=e;s=s.parentNode;)i.unshift(s);for(s=t;s=s.parentNode;)a.unshift(s);for(;i[n]===a[n];)n++;return n?ge(i[n],a[n]):i[n]==E?-1:a[n]==E?1:0},_):_},ue.matches=function(e,t){return ue(e,null,null,t)},ue.matchesSelector=function(e,t){if(g(e),i.matchesSelector&&y&&!N[t+" "]&&(!j||!j.test(t))&&(!b||!b.test(t)))try{var s=w.call(e,t);if(s||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(e){N(t,!0)}return ue(t,_,null,[e]).length>0},ue.contains=function(e,t){return(e.ownerDocument||e)!=_&&g(e),S(e,t)},ue.attr=function(e,t){(e.ownerDocument||e)!=_&&g(e);var s=a.attrHandle[t.toLowerCase()],n=s&&M.call(a.attrHandle,t.toLowerCase())?s(e,t,!y):void 0;return void 0!==n?n:i.attributes||!y?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},ue.escape=function(e){return(e+"").replace(ae,le)},ue.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ue.uniqueSort=function(e){var t,s=[],n=0,r=0;if(p=!i.detectDuplicates,m=!i.sortStable&&e.slice(0),e.sort(O),p){for(;t=e[r++];)t===e[r]&&(n=s.push(r));for(;n--;)e.splice(s[n],1)}return m=null,e},l=ue.getText=function(e){var t,s="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)s+=l(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)s+=l(t);return s},a=ue.selectors={cacheLength:50,createPseudo:fe,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(oe,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(oe,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ue.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ue.error(e[0]),e},PSEUDO:function(e){var t,s=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":s&&Y.test(s)&&(t=d(s,!0))&&(t=s.indexOf(")",s.length-t)-s.length)&&(e[0]=e[0].slice(0,t),e[2]=s.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(oe,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+U+")"+e+"("+U+"|$)"))&&T(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,s){return function(n){var r=ue.attr(n,e);return null==r?"!="===t:!t||(r+="","="===t?r===s:"!="===t?r!==s:"^="===t?s&&0===r.indexOf(s):"*="===t?s&&r.indexOf(s)>-1:"$="===t?s&&r.slice(-s.length)===s:"~="===t?(" "+r.replace(G," ")+" ").indexOf(s)>-1:"|="===t&&(r===s||r.slice(0,s.length+1)===s+"-"))}},CHILD:function(e,t,s,n,r){var o="nth"!==e.slice(0,3),i="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,s,l){var c,d,u,h,f,m,p=o!==i?"nextSibling":"previousSibling",g=t.parentNode,_=a&&t.nodeName.toLowerCase(),v=!l&&!a,y=!1;if(g){if(o){for(;p;){for(h=t;h=h[p];)if(a?h.nodeName.toLowerCase()===_:1===h.nodeType)return!1;m=p="only"===e&&!m&&"nextSibling"}return!0}if(m=[i?g.firstChild:g.lastChild],i&&v){for(y=(f=(c=(d=(u=(h=g)[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===A&&c[1])&&c[2],h=f&&g.childNodes[f];h=++f&&h&&h[p]||(y=f=0)||m.pop();)if(1===h.nodeType&&++y&&h===t){d[e]=[A,f,y];break}}else if(v&&(y=f=(c=(d=(u=(h=t)[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]||[])[0]===A&&c[1]),!1===y)for(;(h=++f&&h&&h[p]||(y=f=0)||m.pop())&&((a?h.nodeName.toLowerCase()!==_:1!==h.nodeType)||!++y||(v&&((d=(u=h[x]||(h[x]={}))[h.uniqueID]||(u[h.uniqueID]={}))[e]=[A,y]),h!==t)););return(y-=r)===n||y%n==0&&y/n>=0}}},PSEUDO:function(e,t){var s,n=a.pseudos[e]||a.setFilters[e.toLowerCase()]||ue.error("unsupported pseudo: "+e);return n[x]?n(t):n.length>1?(s=[e,e,"",t],a.setFilters.hasOwnProperty(e.toLowerCase())?fe((function(e,s){for(var r,o=n(e,t),i=o.length;i--;)e[r=z(e,o[i])]=!(s[r]=o[i])})):function(e){return n(e,0,s)}):n}},pseudos:{not:fe((function(e){var t=[],s=[],n=u(e.replace(W,"$1"));return n[x]?fe((function(e,t,s,r){for(var o,i=n(e,null,r,[]),a=e.length;a--;)(o=i[a])&&(e[a]=!(t[a]=o))})):function(e,r,o){return t[0]=e,n(t,null,o,s),t[0]=null,!s.pop()}})),has:fe((function(e){return function(t){return ue(e,t).length>0}})),contains:fe((function(e){return e=e.replace(oe,ie),function(t){return(t.textContent||l(t)).indexOf(e)>-1}})),lang:fe((function(e){return K.test(e||"")||ue.error("unsupported lang: "+e),e=e.replace(oe,ie).toLowerCase(),function(t){var s;do{if(s=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(s=s.toLowerCase())===e||0===s.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=r.location&&r.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===v},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!a.pseudos.empty(e)},header:function(e){return te.test(e.nodeName)},input:function(e){return ee.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:be((function(){return[0]})),last:be((function(e,t){return[t-1]})),eq:be((function(e,t,s){return[s<0?s+t:s]})),even:be((function(e,t){for(var s=0;s<t;s+=2)e.push(s);return e})),odd:be((function(e,t){for(var s=1;s<t;s+=2)e.push(s);return e})),lt:be((function(e,t,s){for(var n=s<0?s+t:s>t?t:s;--n>=0;)e.push(n);return e})),gt:be((function(e,t,s){for(var n=s<0?s+t:s;++n<t;)e.push(n);return e}))}},a.pseudos.nth=a.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})a.pseudos[o]=_e(o);for(o in{submit:!0,reset:!0})a.pseudos[o]=ve(o);function we(){}function Se(e){for(var t=0,s=e.length,n="";t<s;t++)n+=e[t].value;return n}function xe(e,t,s){var n=t.dir,r=t.next,o=r||n,i=s&&"parentNode"===o,a=C++;return t.first?function(t,s,r){for(;t=t[n];)if(1===t.nodeType||i)return e(t,s,r);return!1}:function(t,s,l){var c,d,u,h=[A,a];if(l){for(;t=t[n];)if((1===t.nodeType||i)&&e(t,s,l))return!0}else for(;t=t[n];)if(1===t.nodeType||i)if(d=(u=t[x]||(t[x]={}))[t.uniqueID]||(u[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((c=d[o])&&c[0]===A&&c[1]===a)return h[2]=c[2];if(d[o]=h,h[2]=e(t,s,l))return!0}return!1}}function Ee(e){return e.length>1?function(t,s,n){for(var r=e.length;r--;)if(!e[r](t,s,n))return!1;return!0}:e[0]}function Ae(e,t,s,n,r){for(var o,i=[],a=0,l=e.length,c=null!=t;a<l;a++)(o=e[a])&&(s&&!s(o,n,r)||(i.push(o),c&&t.push(a)));return i}function Ce(e,t,s,n,r,o){return n&&!n[x]&&(n=Ce(n)),r&&!r[x]&&(r=Ce(r,o)),fe((function(o,i,a,l){var c,d,u,h=[],f=[],m=i.length,p=o||function(e,t,s){for(var n=0,r=t.length;n<r;n++)ue(e,t[n],s);return s}(t||"*",a.nodeType?[a]:a,[]),g=!e||!o&&t?p:Ae(p,h,e,a,l),_=s?r||(o?e:m||n)?[]:i:g;if(s&&s(g,_,a,l),n)for(c=Ae(_,f),n(c,[],a,l),d=c.length;d--;)(u=c[d])&&(_[f[d]]=!(g[f[d]]=u));if(o){if(r||e){if(r){for(c=[],d=_.length;d--;)(u=_[d])&&c.push(g[d]=u);r(null,_=[],c,l)}for(d=_.length;d--;)(u=_[d])&&(c=r?z(o,u):h[d])>-1&&(o[c]=!(i[c]=u))}}else _=Ae(_===i?_.splice(m,_.length):_),r?r(null,i,_,l):P.apply(i,_)}))}function Te(e){for(var t,s,n,r=e.length,o=a.relative[e[0].type],i=o||a.relative[" "],l=o?1:0,c=xe((function(e){return e===t}),i,!0),d=xe((function(e){return z(t,e)>-1}),i,!0),u=[function(e,s,n){var r=!o&&(n||s!==f)||((t=s).nodeType?c(e,s,n):d(e,s,n));return t=null,r}];l<r;l++)if(s=a.relative[e[l].type])u=[xe(Ee(u),s)];else{if((s=a.filter[e[l].type].apply(null,e[l].matches))[x]){for(n=++l;n<r&&!a.relative[e[n].type];n++);return Ce(l>1&&Ee(u),l>1&&Se(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(W,"$1"),s,l<n&&Te(e.slice(l,n)),n<r&&Te(e=e.slice(n)),n<r&&Se(e))}u.push(s)}return Ee(u)}we.prototype=a.filters=a.pseudos,a.setFilters=new we,d=ue.tokenize=function(e,t){var s,n,r,o,i,l,c,d=I[e+" "];if(d)return t?0:d.slice(0);for(i=e,l=[],c=a.preFilter;i;){for(o in s&&!(n=V.exec(i))||(n&&(i=i.slice(n[0].length)||i),l.push(r=[])),s=!1,(n=J.exec(i))&&(s=n.shift(),r.push({value:s,type:n[0].replace(W," ")}),i=i.slice(s.length)),a.filter)!(n=X[o].exec(i))||c[o]&&!(n=c[o](n))||(s=n.shift(),r.push({value:s,type:o,matches:n}),i=i.slice(s.length));if(!s)break}return t?i.length:i?ue.error(e):I(e,l).slice(0)},u=ue.compile=function(e,t){var s,n=[],r=[],o=k[e+" "];if(!o){for(t||(t=d(e)),s=t.length;s--;)(o=Te(t[s]))[x]?n.push(o):r.push(o);o=k(e,function(e,t){var s=t.length>0,n=e.length>0,r=function(r,o,i,l,c){var d,u,h,m=0,p="0",v=r&&[],b=[],j=f,w=r||n&&a.find.TAG("*",c),S=A+=null==j?1:Math.random()||.1,x=w.length;for(c&&(f=o==_||o||c);p!==x&&null!=(d=w[p]);p++){if(n&&d){for(u=0,o||d.ownerDocument==_||(g(d),i=!y);h=e[u++];)if(h(d,o||_,i)){l.push(d);break}c&&(A=S)}s&&((d=!h&&d)&&m--,r&&v.push(d))}if(m+=p,s&&p!==m){for(u=0;h=t[u++];)h(v,b,o,i);if(r){if(m>0)for(;p--;)v[p]||b[p]||(b[p]=R.call(l));b=Ae(b)}P.apply(l,b),c&&!r&&b.length>0&&m+t.length>1&&ue.uniqueSort(l)}return c&&(A=S,f=j),v};return s?fe(r):r}(r,n)),o.selector=e}return o},h=ue.select=function(e,t,s,n){var r,o,i,l,c,h="function"==typeof e&&e,f=!n&&d(e=h.selector||e);if(s=s||[],1===f.length){if((o=f[0]=f[0].slice(0)).length>2&&"ID"===(i=o[0]).type&&9===t.nodeType&&y&&a.relative[o[1].type]){if(!(t=(a.find.ID(i.matches[0].replace(oe,ie),t)||[])[0]))return s;h&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=X.needsContext.test(e)?0:o.length;r--&&(i=o[r],!a.relative[l=i.type]);)if((c=a.find[l])&&(n=c(i.matches[0].replace(oe,ie),re.test(o[0].type)&&je(t.parentNode)||t))){if(o.splice(r,1),!(e=n.length&&Se(o)))return P.apply(s,n),s;break}}return(h||u(e,f))(n,t,!y,s,!t||re.test(e)&&je(t.parentNode)||t),s},i.sortStable=x.split("").sort(O).join("")===x,i.detectDuplicates=!!p,g(),i.sortDetached=me((function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))})),me((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||pe("type|href|height|width",(function(e,t,s){if(!s)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&me((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||pe("value",(function(e,t,s){if(!s&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),me((function(e){return null==e.getAttribute("disabled")}))||pe(F,(function(e,t,s){var n;if(!s)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}));var Ie=r.Sizzle;ue.noConflict=function(){return r.Sizzle===ue&&(r.Sizzle=Ie),ue},void 0===(n=function(){return ue}.call(t,s,t,e))||(e.exports=n)}(window)},"./src/plugins/bookmark-views/styles/bookmarks.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/bookmark-views/styles/bookmarks.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/chatboxviews/styles/chats.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatboxviews/styles/chats.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/chatview/styles/chat-bottom-panel.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/chat-bottom-panel.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/chatview/styles/chat-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/chat-head.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/chatview/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/chatview/styles/index.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/controlbox/styles/_controlbox.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/controlbox/styles/_controlbox.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/controlbox/styles/controlbox-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/controlbox/styles/controlbox-head.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/fullscreen/styles/fullscreen.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/fullscreen/styles/fullscreen.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/headlines-view/styles/headlines-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/headlines-view/styles/headlines-head.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/headlines-view/styles/headlines.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/headlines-view/styles/headlines.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/mam-views/styles/placeholder.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/mam-views/styles/placeholder.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/minimize/styles/minimize.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/minimize/styles/minimize.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/modal/styles/_modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/modal/styles/_modal.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/add-muc-modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/add-muc-modal.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/index.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/moderator-tools.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/moderator-tools.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/muc-bottom-panel.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-bottom-panel.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/muc-details-modal.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-details-modal.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/muc-head.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-head.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/muc-occupants.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/muc-occupants.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/muc-views/styles/nickname-form.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/muc-views/styles/nickname-form.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/register/styles/register.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/register/styles/register.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/rootview/styles/root.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/rootview/styles/root.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/rosterview/styles/roster.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/rosterview/styles/roster.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/plugins/singleton/singleton.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/plugins/singleton/singleton.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/autocomplete/styles/_autocomplete.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/autocomplete/styles/_autocomplete.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/avatar/avatar.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/avatar/avatar.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/chat-content.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/chat-content.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/emoji.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/emoji.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/message-actions.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/message-actions.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/message-body.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/message-body.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/retraction.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/retraction.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/toolbar.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/toolbar.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/chat/styles/unfurl.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/chat/styles/unfurl.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/components/styles/dropdown.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/dropdown.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/components/styles/gif.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/gif.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/components/styles/icon.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/icon.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/components/styles/message-versions.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/message-versions.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/components/styles/rich-text.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/components/styles/rich-text.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/modals/styles/image.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/modals/styles/image.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/styles/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/styles/index.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./src/shared/styles/status.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var n=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(n),o=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(o),a=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),l=s.n(a),c=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),d=s.n(c),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),h=s.n(u),f=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=s.n(f),p=s("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[2].use[3]!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[5].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[5].use[2]!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[5].use[3]!./src/shared/styles/status.scss"),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=h();r()(p.default,g);const _=p.default&&p.default.locals?p.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":e=>{"use strict";var t=[];function s(e){for(var s=-1,n=0;n<t.length;n++)if(t[n].identifier===e){s=n;break}return s}function n(e,n){for(var o={},i=[],a=0;a<e.length;a++){var l=e[a],c=n.base?l[0]+n.base:l[0],d=o[c]||0,u="".concat(c," ").concat(d);o[c]=d+1;var h=s(u),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(f);else{var m=r(f,n);n.byIndex=a,t.splice(a,0,{identifier:u,updater:m,references:1})}i.push(u)}return i}function r(e,t){var s=t.domAPI(t);s.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,r){var o=n(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var a=s(o[i]);t[a].references--}for(var l=n(e,r),c=0;c<o.length;c++){var d=s(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=l}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":e=>{"use strict";var t={};e.exports=function(e,s){var n=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(s)}},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(e,t,s)=>{"use strict";e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var n="";s.supports&&(n+="@supports (".concat(s.supports,") {")),s.media&&(n+="@media ".concat(s.media," {"));var r=void 0!==s.layer;r&&(n+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),n+=s.css,r&&(n+="}"),s.media&&(n+="}"),s.supports&&(n+="}");var o=s.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},"./src/i18n lazy recursive ^\\.\\/.*\\/LC_MESSAGES\\/converse\\.po$ referencedExports: default":(e,t,s)=>{var n={"./af/LC_MESSAGES/converse.po":["./src/i18n/af/LC_MESSAGES/converse.po","locales/af-LC_MESSAGES-converse-po"],"./ar/LC_MESSAGES/converse.po":["./src/i18n/ar/LC_MESSAGES/converse.po","locales/ar-LC_MESSAGES-converse-po"],"./bg/LC_MESSAGES/converse.po":["./src/i18n/bg/LC_MESSAGES/converse.po","locales/bg-LC_MESSAGES-converse-po"],"./ca/LC_MESSAGES/converse.po":["./src/i18n/ca/LC_MESSAGES/converse.po","locales/ca-LC_MESSAGES-converse-po"],"./cs/LC_MESSAGES/converse.po":["./src/i18n/cs/LC_MESSAGES/converse.po","locales/cs-LC_MESSAGES-converse-po"],"./da/LC_MESSAGES/converse.po":["./src/i18n/da/LC_MESSAGES/converse.po","locales/da-LC_MESSAGES-converse-po"],"./de/LC_MESSAGES/converse.po":["./src/i18n/de/LC_MESSAGES/converse.po","locales/de-LC_MESSAGES-converse-po"],"./el/LC_MESSAGES/converse.po":["./src/i18n/el/LC_MESSAGES/converse.po","locales/el-LC_MESSAGES-converse-po"],"./eo/LC_MESSAGES/converse.po":["./src/i18n/eo/LC_MESSAGES/converse.po","locales/eo-LC_MESSAGES-converse-po"],"./es/LC_MESSAGES/converse.po":["./src/i18n/es/LC_MESSAGES/converse.po","locales/es-LC_MESSAGES-converse-po"],"./eu/LC_MESSAGES/converse.po":["./src/i18n/eu/LC_MESSAGES/converse.po","locales/eu-LC_MESSAGES-converse-po"],"./fa/LC_MESSAGES/converse.po":["./src/i18n/fa/LC_MESSAGES/converse.po","locales/fa-LC_MESSAGES-converse-po"],"./fi/LC_MESSAGES/converse.po":["./src/i18n/fi/LC_MESSAGES/converse.po","locales/fi-LC_MESSAGES-converse-po"],"./fr/LC_MESSAGES/converse.po":["./src/i18n/fr/LC_MESSAGES/converse.po","locales/fr-LC_MESSAGES-converse-po"],"./gl/LC_MESSAGES/converse.po":["./src/i18n/gl/LC_MESSAGES/converse.po","locales/gl-LC_MESSAGES-converse-po"],"./he/LC_MESSAGES/converse.po":["./src/i18n/he/LC_MESSAGES/converse.po","locales/he-LC_MESSAGES-converse-po"],"./hi/LC_MESSAGES/converse.po":["./src/i18n/hi/LC_MESSAGES/converse.po","locales/hi-LC_MESSAGES-converse-po"],"./hu/LC_MESSAGES/converse.po":["./src/i18n/hu/LC_MESSAGES/converse.po","locales/hu-LC_MESSAGES-converse-po"],"./id/LC_MESSAGES/converse.po":["./src/i18n/id/LC_MESSAGES/converse.po","locales/id-LC_MESSAGES-converse-po"],"./it/LC_MESSAGES/converse.po":["./src/i18n/it/LC_MESSAGES/converse.po","locales/it-LC_MESSAGES-converse-po"],"./ja/LC_MESSAGES/converse.po":["./src/i18n/ja/LC_MESSAGES/converse.po","locales/ja-LC_MESSAGES-converse-po"],"./lt/LC_MESSAGES/converse.po":["./src/i18n/lt/LC_MESSAGES/converse.po","locales/lt-LC_MESSAGES-converse-po"],"./mr/LC_MESSAGES/converse.po":["./src/i18n/mr/LC_MESSAGES/converse.po","locales/mr-LC_MESSAGES-converse-po"],"./nb/LC_MESSAGES/converse.po":["./src/i18n/nb/LC_MESSAGES/converse.po","locales/nb-LC_MESSAGES-converse-po"],"./nl/LC_MESSAGES/converse.po":["./src/i18n/nl/LC_MESSAGES/converse.po","locales/nl-LC_MESSAGES-converse-po"],"./nl_BE/LC_MESSAGES/converse.po":["./src/i18n/nl_BE/LC_MESSAGES/converse.po","locales/nl_BE-LC_MESSAGES-converse-po"],"./oc/LC_MESSAGES/converse.po":["./src/i18n/oc/LC_MESSAGES/converse.po","locales/oc-LC_MESSAGES-converse-po"],"./pl/LC_MESSAGES/converse.po":["./src/i18n/pl/LC_MESSAGES/converse.po","locales/pl-LC_MESSAGES-converse-po"],"./pt/LC_MESSAGES/converse.po":["./src/i18n/pt/LC_MESSAGES/converse.po","locales/pt-LC_MESSAGES-converse-po"],"./pt_BR/LC_MESSAGES/converse.po":["./src/i18n/pt_BR/LC_MESSAGES/converse.po","locales/pt_BR-LC_MESSAGES-converse-po"],"./ro/LC_MESSAGES/converse.po":["./src/i18n/ro/LC_MESSAGES/converse.po","locales/ro-LC_MESSAGES-converse-po"],"./ru/LC_MESSAGES/converse.po":["./src/i18n/ru/LC_MESSAGES/converse.po","locales/ru-LC_MESSAGES-converse-po"],"./si/LC_MESSAGES/converse.po":["./src/i18n/si/LC_MESSAGES/converse.po","locales/si-LC_MESSAGES-converse-po"],"./sq/LC_MESSAGES/converse.po":["./src/i18n/sq/LC_MESSAGES/converse.po","locales/sq-LC_MESSAGES-converse-po"],"./sv/LC_MESSAGES/converse.po":["./src/i18n/sv/LC_MESSAGES/converse.po","locales/sv-LC_MESSAGES-converse-po"],"./th/LC_MESSAGES/converse.po":["./src/i18n/th/LC_MESSAGES/converse.po","locales/th-LC_MESSAGES-converse-po"],"./tr/LC_MESSAGES/converse.po":["./src/i18n/tr/LC_MESSAGES/converse.po","locales/tr-LC_MESSAGES-converse-po"],"./ug/LC_MESSAGES/converse.po":["./src/i18n/ug/LC_MESSAGES/converse.po","locales/ug-LC_MESSAGES-converse-po"],"./uk/LC_MESSAGES/converse.po":["./src/i18n/uk/LC_MESSAGES/converse.po","locales/uk-LC_MESSAGES-converse-po"],"./vi/LC_MESSAGES/converse.po":["./src/i18n/vi/LC_MESSAGES/converse.po","locales/vi-LC_MESSAGES-converse-po"],"./zh_CN/LC_MESSAGES/converse.po":["./src/i18n/zh_CN/LC_MESSAGES/converse.po","locales/zh_CN-LC_MESSAGES-converse-po"],"./zh_TW/LC_MESSAGES/converse.po":["./src/i18n/zh_TW/LC_MESSAGES/converse.po","locales/zh_TW-LC_MESSAGES-converse-po"]};function r(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return s.e(t[1]).then((()=>s.t(r,19)))}r.keys=()=>Object.keys(n),r.id="./src/i18n lazy recursive ^\\.\\/.*\\/LC_MESSAGES\\/converse\\.po$ referencedExports: default",e.exports=r},"./node_modules/@babel/runtime/helpers/asyncToGenerator.js":e=>{function t(e,t,s,n,r,o,i){try{var a=e[o](i),l=a.value}catch(e){return void s(e)}a.done?t(l):Promise.resolve(l).then(n,r)}e.exports=function(e){return function(){var s=this,n=arguments;return new Promise((function(r,o){var i=e.apply(s,n);function a(e){t(i,r,o,a,l,"next",e)}function l(e){t(i,r,o,a,l,"throw",e)}a(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/defineProperty.js":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/helpers/toPropertyKey.js");e.exports=function(e,t,s){return(t=n(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e},e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/interopRequireDefault.js":e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/helpers/typeof.js").default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},s=Object.prototype,o=s.hasOwnProperty,i=Object.defineProperty||function(e,t,s){e[t]=s.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag";function u(e,t,s){return Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,s){return e[t]=s}}function h(e,t,s,n){var r=t&&t.prototype instanceof p?t:p,o=Object.create(r.prototype),a=new T(n||[]);return i(o,"_invoke",{value:x(e,s,a)}),o}function f(e,t,s){try{return{type:"normal",arg:e.call(t,s)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var m={};function p(){}function g(){}function _(){}var v={};u(v,l,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(I([])));b&&b!==s&&o.call(b,l)&&(v=b);var j=_.prototype=p.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function s(r,i,a,l){var c=f(e[r],e,i);if("throw"!==c.type){var d=c.arg,u=d.value;return u&&"object"==n(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){s("next",e,a,l)}),(function(e){s("throw",e,a,l)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return s("throw",e,a,l)}))}l(c.arg)}var r;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,r){s(e,n,t,r)}))}return r=r?r.then(o,o):o()}})}function x(e,t,s){var n="suspendedStart";return function(r,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw o;return k()}for(s.method=r,s.arg=o;;){var i=s.delegate;if(i){var a=E(i,s);if(a){if(a===m)continue;return a}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===n)throw n="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);n="executing";var l=f(e,t,s);if("normal"===l.type){if(n=s.done?"completed":"suspendedYield",l.arg===m)continue;return{value:l.arg,done:s.done}}"throw"===l.type&&(n="completed",s.method="throw",s.arg=l.arg)}}}function E(e,t){var s=t.method,n=e.iterator[s];if(void 0===n)return t.delegate=null,"throw"===s&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==s&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+s+"' method")),m;var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(e){if(e){var t=e[l];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,n=function t(){for(;++s<e.length;)if(o.call(e,s))return t.value=e[s],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return g.prototype=_,i(j,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,d,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,d,"GeneratorFunction")),e.prototype=Object.create(j),e},t.awrap=function(e){return{__await:e}},w(S.prototype),u(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,s,n,r,o){void 0===o&&(o=Promise);var i=new S(h(e,s,n,r),o);return t.isGeneratorFunction(s)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(j),u(j,d,"Generator"),u(j,l,(function(){return this})),u(j,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),s=[];for(var n in t)s.push(n);return s.reverse(),function e(){for(;s.length;){var n=s.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function s(s,n){return i.type="throw",i.arg=e,t.next=s,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],i=r.completion;if("root"===r.tryLoc)return s("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(a&&l){if(this.prev<r.catchLoc)return s(r.catchLoc,!0);if(this.prev<r.finallyLoc)return s(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return s(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return s(r.finallyLoc)}}}},abrupt:function(e,t){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),C(s),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===e){var n=s.completion;if("throw"===n.type){var r=n.arg;C(s)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,s){return this.delegate={iterator:I(e),resultName:t,nextLoc:s},"next"===this.method&&(this.arg=void 0),m}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/toPrimitive.js":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/helpers/typeof.js").default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/toPropertyKey.js":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/helpers/typeof.js").default,r=s("./node_modules/@babel/runtime/helpers/toPrimitive.js");e.exports=function(e){var t=r(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/helpers/typeof.js":e=>{function t(s){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(s)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},"./node_modules/@babel/runtime/regenerator/index.js":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},"./node_modules/@lit/reactive-element/development/css-tag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CSSResult:()=>a,adoptStyles:()=>d,css:()=>c,getCompatibleStyle:()=>u,supportsAdoptingStyleSheets:()=>r,unsafeCSS:()=>l});const n=window,r=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,o=Symbol(),i=new WeakMap;class a{constructor(e,t,s){if(this._$cssResult$=!0,s!==o)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this._strings=t}get styleSheet(){let e=this._styleSheet;const t=this._strings;if(r&&void 0===e){const s=void 0!==t&&1===t.length;s&&(e=i.get(t)),void 0===e&&((this._styleSheet=e=new CSSStyleSheet).replaceSync(this.cssText),s&&i.set(t,e))}return e}toString(){return this.cssText}}const l=e=>new a("string"==typeof e?e:String(e),void 0,o),c=(e,...t)=>{const s=1===e.length?e[0]:t.reduce(((t,s,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.`)})(s)+e[n+1]),e[0]);return new a(s,e,o)},d=(e,t)=>{r?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const s=document.createElement("style"),r=n.litNonce;void 0!==r&&s.setAttribute("nonce",r),s.textContent=t.cssText,e.appendChild(s)}))},u=r?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const s of e.cssRules)t+=s.cssText;return l(t)})(e):e},"./node_modules/@lit/reactive-element/development/reactive-element.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CSSResult:()=>i.CSSResult,ReactiveElement:()=>y,adoptStyles:()=>i.adoptStyles,css:()=>i.css,defaultConverter:()=>p,getCompatibleStyle:()=>i.getCompatibleStyle,notEqual:()=>g,supportsAdoptingStyleSheets:()=>i.supportsAdoptingStyleSheets,unsafeCSS:()=>i.unsafeCSS});var n,r,o,i=s("./node_modules/@lit/reactive-element/development/css-tag.js");const a=window;let l,c;const d=a.trustedTypes,u=d?d.emptyScript:"",h=a.reactiveElementPolyfillSupportDevMode;{const e=null!==(n=a.litIssuedWarnings)&&void 0!==n?n:a.litIssuedWarnings=new Set;c=(t,s)=>{s+=` See https://lit.dev/msg/${t} for more information.`,e.has(s)||(console.warn(s),e.add(s))},c("dev-mode","Lit is in dev mode. Not recommended for production!"),(null===(r=a.ShadyDOM)||void 0===r?void 0:r.inUse)&&void 0===h&&c("polyfill-support-missing","Shadow DOM is being polyfilled via `ShadyDOM` but the `polyfill-support` module has not been loaded."),l=e=>({then:(t,s)=>{c("request-update-promise",`The \`requestUpdate\` method should no longer return a Promise but does so on \`${e}\`. Use \`updateComplete\` instead.`),void 0!==t&&t(!1)}})}const f=e=>{a.emitLitDebugLogEvents&&a.dispatchEvent(new CustomEvent("lit-debug",{detail:e}))},m=(e,t)=>e,p={toAttribute(e,t){switch(t){case Boolean:e=e?u:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let s=e;switch(t){case Boolean:s=null!==e;break;case Number:s=null===e?null:Number(e);break;case Object:case Array:try{s=JSON.parse(e)}catch(e){s=null}}return s}},g=(e,t)=>t!==e&&(t==t||e==e),_={attribute:!0,type:String,converter:p,reflect:!1,hasChanged:g},v="finalized";class y extends HTMLElement{constructor(){super(),this.__instanceProperties=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this.__reflectingProperty=null,this._initialize()}static addInitializer(e){var t;this.finalize(),(null!==(t=this._initializers)&&void 0!==t?t:this._initializers=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,s)=>{const n=this.__attributeNameForProperty(s,t);void 0!==n&&(this.__attributeToPropertyMap.set(n,s),e.push(n))})),e}static createProperty(e,t=_){var s;if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():`__${e}`,r=this.getPropertyDescriptor(e,n,t);void 0!==r&&(Object.defineProperty(this.prototype,e,r),this.hasOwnProperty("__reactivePropertyKeys")||(this.__reactivePropertyKeys=new Set(null!==(s=this.__reactivePropertyKeys)&&void 0!==s?s:[])),this.__reactivePropertyKeys.add(e))}}static getPropertyDescriptor(e,t,s){return{get(){return this[t]},set(n){const r=this[e];this[t]=n,this.requestUpdate(e,r,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||_}static finalize(){if(this.hasOwnProperty(v))return!1;this[v]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e._initializers&&(this._initializers=[...e._initializers]),this.elementProperties=new Map(e.elementProperties),this.__attributeToPropertyMap=new Map,this.hasOwnProperty(m("properties"))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const s of t)this.createProperty(s,e[s])}this.elementStyles=this.finalizeStyles(this.styles);{const e=(e,t=!1)=>{this.prototype.hasOwnProperty(e)&&c(t?"renamed-api":"removed-api",`\`${e}\` is implemented on class ${this.name}. It has been ${t?"renamed":"removed"} in this version of LitElement.`)};e("initialize"),e("requestUpdateInternal"),e("_getUpdateComplete",!0)}return!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const e of s)t.unshift((0,i.getCompatibleStyle)(e))}else void 0!==e&&t.push((0,i.getCompatibleStyle)(e));return t}static __attributeNameForProperty(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}_initialize(){var e;this.__updatePromise=new Promise((e=>this.enableUpdating=e)),this._$changedProperties=new Map,this.__saveInstanceProperties(),this.requestUpdate(),null===(e=this.constructor._initializers)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,s;(null!==(t=this.__controllers)&&void 0!==t?t:this.__controllers=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(s=e.hostConnected)||void 0===s||s.call(e))}removeController(e){var t;null===(t=this.__controllers)||void 0===t||t.splice(this.__controllers.indexOf(e)>>>0,1)}__saveInstanceProperties(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this.__instanceProperties.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return(0,i.adoptStyles)(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this.__controllers)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this.__controllers)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,s){this._$attributeToProperty(e,s)}__propertyToAttribute(e,t,s=_){var n;const r=this.constructor.__attributeNameForProperty(e,s);if(void 0!==r&&!0===s.reflect){const o=(void 0!==(null===(n=s.converter)||void 0===n?void 0:n.toAttribute)?s.converter:p).toAttribute(t,s.type);this.constructor.enabledWarnings.indexOf("migration")>=0&&void 0===o&&c("undefined-attribute-value",`The attribute value for the ${e} property is undefined on element ${this.localName}. The attribute will be removed, but in the previous version of \`ReactiveElement\`, the attribute would not have changed.`),this.__reflectingProperty=e,null==o?this.removeAttribute(r):this.setAttribute(r,o),this.__reflectingProperty=null}}_$attributeToProperty(e,t){var s;const n=this.constructor,r=n.__attributeToPropertyMap.get(e);if(void 0!==r&&this.__reflectingProperty!==r){const e=n.getPropertyOptions(r),o="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(s=e.converter)||void 0===s?void 0:s.fromAttribute)?e.converter:p;this.__reflectingProperty=r,this[r]=o.fromAttribute(t,e.type),this.__reflectingProperty=null}}requestUpdate(e,t,s){let n=!0;if(void 0!==e){((s=s||this.constructor.getPropertyOptions(e)).hasChanged||g)(this[e],t)?(this._$changedProperties.has(e)||this._$changedProperties.set(e,t),!0===s.reflect&&this.__reflectingProperty!==e&&(void 0===this.__reflectingProperties&&(this.__reflectingProperties=new Map),this.__reflectingProperties.set(e,s))):n=!1}return!this.isUpdatePending&&n&&(this.__updatePromise=this.__enqueueUpdate()),l(this.localName)}async __enqueueUpdate(){this.isUpdatePending=!0;try{await this.__updatePromise}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e,t;if(!this.isUpdatePending)return;if(null==f||f({kind:"update"}),!this.hasUpdated){const t=[];if(null===(e=this.constructor.__reactivePropertyKeys)||void 0===e||e.forEach((e=>{var s;this.hasOwnProperty(e)&&!(null===(s=this.__instanceProperties)||void 0===s?void 0:s.has(e))&&t.push(e)})),t.length)throw new Error(`The following properties on element ${this.localName} will not trigger updates as expected because they are set using class fields: ${t.join(", ")}. Native class fields and some compiled output will overwrite accessors used for detecting changes. See https://lit.dev/msg/class-field-shadowing for more information.`)}this.__instanceProperties&&(this.__instanceProperties.forEach(((e,t)=>this[t]=e)),this.__instanceProperties=void 0);let s=!1;const n=this._$changedProperties;try{s=this.shouldUpdate(n),s?(this.willUpdate(n),null===(t=this.__controllers)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this.__markUpdated()}catch(e){throw s=!1,this.__markUpdated(),e}s&&this._$didUpdate(n)}willUpdate(e){}_$didUpdate(e){var t;null===(t=this.__controllers)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e),this.isUpdatePending&&this.constructor.enabledWarnings.indexOf("change-in-update")>=0&&c("change-in-update",`Element ${this.localName} scheduled an update (generally because a property was set) after an update completed, causing a new update to be scheduled. This is inefficient and should be avoided unless the next update can only be scheduled as a side effect of the previous update.`)}__markUpdated(){this._$changedProperties=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this.__updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this.__reflectingProperties&&(this.__reflectingProperties.forEach(((e,t)=>this.__propertyToAttribute(t,this[t],e))),this.__reflectingProperties=void 0),this.__markUpdated()}updated(e){}firstUpdated(e){}}y[v]=!0,y.elementProperties=new Map,y.elementStyles=[],y.shadowRootOptions={mode:"open"},null==h||h({ReactiveElement:y});{y.enabledWarnings=["change-in-update"];const e=function(e){e.hasOwnProperty(m("enabledWarnings"))||(e.enabledWarnings=e.enabledWarnings.slice())};y.enableWarning=function(t){e(this),this.enabledWarnings.indexOf(t)<0&&this.enabledWarnings.push(t)},y.disableWarning=function(t){e(this);const s=this.enabledWarnings.indexOf(t);s>=0&&this.enabledWarnings.splice(s,1)}}(null!==(o=a.reactiveElementVersions)&&void 0!==o?o:a.reactiveElementVersions=[]).push("1.6.2"),a.reactiveElementVersions.length>1&&c("multiple-versions","Multiple versions of Lit loaded. Loading multiple versions is not recommended.")},"./node_modules/lit-html/development/async-directive.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AsyncDirective:()=>u,Directive:()=>r.Directive,PartType:()=>r.PartType,directive:()=>r.directive});var n=s("./node_modules/lit-html/development/directive-helpers.js"),r=s("./node_modules/lit-html/development/directive.js");const o=(e,t)=>{var s,n;const r=e._$disconnectableChildren;if(void 0===r)return!1;for(const e of r)null===(n=(s=e)._$notifyDirectiveConnectionChanged)||void 0===n||n.call(s,t,!1),o(e,t);return!0},i=e=>{let t,s;do{if(void 0===(t=e._$parent))break;s=t._$disconnectableChildren,s.delete(e),e=t}while(0===(null==s?void 0:s.size))},a=e=>{for(let t;t=e._$parent;e=t){let s=t._$disconnectableChildren;if(void 0===s)t._$disconnectableChildren=s=new Set;else if(s.has(e))break;s.add(e),d(t)}};function l(e){void 0!==this._$disconnectableChildren?(i(this),this._$parent=e,a(this)):this._$parent=e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this._$committedValue,r=this._$disconnectableChildren;if(void 0!==r&&0!==r.size)if(t)if(Array.isArray(n))for(let e=s;e<n.length;e++)o(n[e],!1),i(n[e]);else null!=n&&(o(n,!1),i(n));else o(this,e)}const d=e=>{var t,s,n,o;e.type==r.PartType.CHILD&&(null!==(t=(n=e)._$notifyConnectionChanged)&&void 0!==t||(n._$notifyConnectionChanged=c),null!==(s=(o=e)._$reparentDisconnectables)&&void 0!==s||(o._$reparentDisconnectables=l))};class u extends r.Directive{constructor(){super(...arguments),this._$disconnectableChildren=void 0}_$initialize(e,t,s){super._$initialize(e,t,s),a(this),this.isConnected=e._$isConnected}_$notifyDirectiveConnectionChanged(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var s,n;e!==this.isConnected&&(this.isConnected=e,e?null===(s=this.reconnected)||void 0===s||s.call(this):null===(n=this.disconnected)||void 0===n||n.call(this)),t&&(o(this,e),i(this))}setValue(e){if((0,n.isSingleExpression)(this.__part))this.__part._$setValue(e,this);else{if(void 0===this.__attributeIndex)throw new Error("Expected this.__attributeIndex to be a number");const t=[...this.__part._$committedValue];t[this.__attributeIndex]=e,this.__part._$setValue(t,this,0)}}disconnected(){}reconnected(){}}},"./node_modules/lit-html/development/directive-helpers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{TemplateResultType:()=>c,clearPart:()=>j,getCommittedValue:()=>y,getDirectiveClass:()=>h,insertPart:()=>p,isDirectiveResult:()=>u,isPrimitive:()=>l,isSingleExpression:()=>f,isTemplateResult:()=>d,removePart:()=>b,setChildPartValue:()=>g,setCommittedValue:()=>v});var n,r,o=s("./node_modules/lit-html/development/lit-html.js");const{_ChildPart:i}=o._$LH,a=(null===(n=window.ShadyDOM)||void 0===n?void 0:n.inUse)&&!0===(null===(r=window.ShadyDOM)||void 0===r?void 0:r.noPatch)?window.ShadyDOM.wrap:e=>e,l=e=>null===e||"object"!=typeof e&&"function"!=typeof e,c={HTML:1,SVG:2},d=(e,t)=>void 0===t?void 0!==(null==e?void 0:e._$litType$):(null==e?void 0:e._$litType$)===t,u=e=>void 0!==(null==e?void 0:e._$litDirective$),h=e=>null==e?void 0:e._$litDirective$,f=e=>void 0===e.strings,m=()=>document.createComment(""),p=(e,t,s)=>{var n;const r=a(e._$startNode).parentNode,o=void 0===t?e._$endNode:t._$startNode;if(void 0===s){const t=a(r).insertBefore(m(),o),n=a(r).insertBefore(m(),o);s=new i(t,n,e,e.options)}else{const t=a(s._$endNode).nextSibling,i=s._$parent,l=i!==e;if(l){let t;null===(n=s._$reparentDisconnectables)||void 0===n||n.call(s,e),s._$parent=e,void 0!==s._$notifyConnectionChanged&&(t=e._$isConnected)!==i._$isConnected&&s._$notifyConnectionChanged(t)}if(t!==o||l){let e=s._$startNode;for(;e!==t;){const t=a(e).nextSibling;a(r).insertBefore(e,o),e=t}}}return s},g=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return e._$setValue(t,s),e},_={},v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;return e._$committedValue=t},y=e=>e._$committedValue,b=e=>{var t;null===(t=e._$notifyConnectionChanged)||void 0===t||t.call(e,!1,!0);let s=e._$startNode;const n=a(e._$endNode).nextSibling;for(;s!==n;){const e=a(s).nextSibling;a(s).remove(),s=e}},j=e=>{e._$clear()}},"./node_modules/lit-html/development/directive.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Directive:()=>o,PartType:()=>n,directive:()=>r});const n={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},r=e=>function(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return{_$litDirective$:e,values:s}};class o{constructor(e){}get _$isConnected(){return this._$parent._$isConnected}_$initialize(e,t,s){this.__part=e,this._$parent=t,this.__attributeIndex=s}_$resolve(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}},"./node_modules/lit-html/development/directives/private-async-helpers.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Pauser:()=>o,PseudoWeakRef:()=>r,forAwaitOf:()=>n});const n=async(e,t)=>{for await(const s of e)if(!1===await t(s))return};class r{constructor(e){this._ref=e}disconnect(){this._ref=void 0}reconnect(e){this._ref=e}deref(){return this._ref}}class o{constructor(){this._promise=void 0,this._resolve=void 0}get(){return this._promise}pause(){var e;null!==(e=this._promise)&&void 0!==e||(this._promise=new Promise((e=>this._resolve=e)))}resume(){var e;null===(e=this._resolve)||void 0===e||e.call(this),this._promise=this._resolve=void 0}}},"./node_modules/lit-html/development/directives/repeat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{repeat:()=>l});var n=s("./node_modules/lit-html/development/lit-html.js"),r=s("./node_modules/lit-html/development/directive.js"),o=s("./node_modules/lit-html/development/directive-helpers.js");const i=(e,t,s)=>{const n=new Map;for(let r=t;r<=s;r++)n.set(e[r],r);return n};class a extends r.Directive{constructor(e){if(super(e),e.type!==r.PartType.CHILD)throw new Error("repeat() can only be used in text expressions")}_getValuesAndKeys(e,t,s){let n;void 0===s?s=t:void 0!==t&&(n=t);const r=[],o=[];let i=0;for(const t of e)r[i]=n?n(t,i):i,o[i]=s(t,i),i++;return{values:o,keys:r}}render(e,t,s){return this._getValuesAndKeys(e,t,s).values}update(e,t){let[s,r,a]=t;var l;const c=(0,o.getCommittedValue)(e),{values:d,keys:u}=this._getValuesAndKeys(s,r,a);if(!Array.isArray(c))return this._itemKeys=u,d;const h=null!==(l=this._itemKeys)&&void 0!==l?l:this._itemKeys=[],f=[];let m,p,g=0,_=c.length-1,v=0,y=d.length-1;for(;g<=_&&v<=y;)if(null===c[g])g++;else if(null===c[_])_--;else if(h[g]===u[v])f[v]=(0,o.setChildPartValue)(c[g],d[v]),g++,v++;else if(h[_]===u[y])f[y]=(0,o.setChildPartValue)(c[_],d[y]),_--,y--;else if(h[g]===u[y])f[y]=(0,o.setChildPartValue)(c[g],d[y]),(0,o.insertPart)(e,f[y+1],c[g]),g++,y--;else if(h[_]===u[v])f[v]=(0,o.setChildPartValue)(c[_],d[v]),(0,o.insertPart)(e,c[g],c[_]),_--,v++;else if(void 0===m&&(m=i(u,v,y),p=i(h,g,_)),m.has(h[g]))if(m.has(h[_])){const t=p.get(u[v]),s=void 0!==t?c[t]:null;if(null===s){const t=(0,o.insertPart)(e,c[g]);(0,o.setChildPartValue)(t,d[v]),f[v]=t}else f[v]=(0,o.setChildPartValue)(s,d[v]),(0,o.insertPart)(e,c[g],s),c[t]=null;v++}else(0,o.removePart)(c[_]),_--;else(0,o.removePart)(c[g]),g++;for(;v<=y;){const t=(0,o.insertPart)(e,f[y+1]);(0,o.setChildPartValue)(t,d[v]),f[v++]=t}for(;g<=_;){const e=c[g++];null!==e&&(0,o.removePart)(e)}return this._itemKeys=u,(0,o.setCommittedValue)(e,f),n.noChange}}const l=(0,r.directive)(a)},"./node_modules/lit-html/development/directives/unsafe-html.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{UnsafeHTMLDirective:()=>o,unsafeHTML:()=>i});var n=s("./node_modules/lit-html/development/lit-html.js"),r=s("./node_modules/lit-html/development/directive.js");class o extends r.Directive{constructor(e){if(super(e),this._value=n.nothing,e.type!==r.PartType.CHILD)throw new Error(`${this.constructor.directiveName}() can only be used in child bindings`)}render(e){if(e===n.nothing||null==e)return this._templateResult=void 0,this._value=e;if(e===n.noChange)return e;if("string"!=typeof e)throw new Error(`${this.constructor.directiveName}() called with a non-string value`);if(e===this._value)return this._templateResult;this._value=e;const t=[e];return t.raw=t,this._templateResult={_$litType$:this.constructor.resultType,strings:t,values:[]}}}o.directiveName="unsafeHTML",o.resultType=1;const i=(0,r.directive)(o)},"./node_modules/lit-html/development/directives/until.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{UntilDirective:()=>c,until:()=>d});var n=s("./node_modules/lit-html/development/lit-html.js"),r=s("./node_modules/lit-html/development/directive-helpers.js"),o=s("./node_modules/lit-html/development/async-directive.js"),i=s("./node_modules/lit-html/development/directives/private-async-helpers.js");const a=e=>!(0,r.isPrimitive)(e)&&"function"==typeof e.then,l=1073741823;class c extends o.AsyncDirective{constructor(){super(...arguments),this.__lastRenderedIndex=l,this.__values=[],this.__weakThis=new i.PseudoWeakRef(this),this.__pauser=new i.Pauser}render(){for(var e,t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return null!==(e=s.find((e=>!a(e))))&&void 0!==e?e:n.noChange}update(e,t){const s=this.__values;let r=s.length;this.__values=t;const o=this.__weakThis,i=this.__pauser;this.isConnected||this.disconnected();for(let e=0;e<t.length&&!(e>this.__lastRenderedIndex);e++){const n=t[e];if(!a(n))return this.__lastRenderedIndex=e,n;e<r&&n===s[e]||(this.__lastRenderedIndex=l,r=0,Promise.resolve(n).then((async e=>{for(;i.get();)await i.get();const t=o.deref();if(void 0!==t){const s=t.__values.indexOf(n);s>-1&&s<t.__lastRenderedIndex&&(t.__lastRenderedIndex=s,t.setValue(e))}})))}return n.noChange}disconnected(){this.__weakThis.disconnect(),this.__pauser.pause()}reconnected(){this.__weakThis.reconnect(this),this.__pauser.resume()}}const d=(0,o.directive)(c)},"./node_modules/lit-html/development/is-server.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{isServer:()=>n});const n=!1},"./node_modules/lit-html/development/lit-html.js":(e,t,s)=>{"use strict";var n,r,o,i;s.r(t),s.d(t,{_$LH:()=>te,html:()=>P,noChange:()=>z,nothing:()=>F,render:()=>ne,svg:()=>L});const a=window,l=e=>{a.emitLitDebugLogEvents&&a.dispatchEvent(new CustomEvent("lit-debug",{detail:e}))};let c,d=0;null!==(n=a.litIssuedWarnings)&&void 0!==n||(a.litIssuedWarnings=new Set),c=(e,t)=>{t+=e?` See https://lit.dev/msg/${e} for more information.`:"",a.litIssuedWarnings.has(t)||(console.warn(t),a.litIssuedWarnings.add(t))},c("dev-mode","Lit is in dev mode. Not recommended for production!");const u=(null===(r=a.ShadyDOM)||void 0===r?void 0:r.inUse)&&!0===(null===(o=a.ShadyDOM)||void 0===o?void 0:o.noPatch)?a.ShadyDOM.wrap:e=>e,h=a.trustedTypes,f=h?h.createPolicy("lit-html",{createHTML:e=>e}):void 0,m=e=>e,p=(e,t,s)=>m,g=e=>{if(q!==p)throw new Error("Attempted to overwrite existing lit-html security policy. setSanitizeDOMValueFactory should be called at most once.");q=e},_=()=>{q=p},v=(e,t,s)=>q(e,t,s),y="$lit$",b=`lit$${String(Math.random()).slice(9)}$`,j="?"+b,w=`<${j}>`,S=document,x=()=>S.createComment(""),E=e=>null===e||"object"!=typeof e&&"function"!=typeof e,A=Array.isArray,C=e=>A(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),T="[ \t\n\f\r]",I=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,k=/-->/g,N=/>/g,O=new RegExp(`>|${T}(?:([^\\s"'>=/]+)(${T}*=${T}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),M=/'/g,$=/"/g,R=/^(?:script|style|textarea|title)$/i,D=e=>function(t){t.some((e=>void 0===e))&&console.warn("Some template strings are undefined.\nThis is probably caused by illegal octal escape sequences.");for(var s=arguments.length,n=new Array(s>1?s-1:0),r=1;r<s;r++)n[r-1]=arguments[r];return{_$litType$:e,strings:t,values:n}},P=D(1),L=D(2),z=Symbol.for("lit-noChange"),F=Symbol.for("lit-nothing"),U=new WeakMap,B=S.createTreeWalker(S,129,null,!1);let q=p;const H=(e,t)=>{const s=e.length-1,n=[];let r,o=2===t?"<svg>":"",i=I;for(let t=0;t<s;t++){const s=e[t];let a,l,c=-1,d=0;for(;d<s.length&&(i.lastIndex=d,l=i.exec(s),null!==l);)if(d=i.lastIndex,i===I){if("!--"===l[1])i=k;else if(void 0!==l[1])i=N;else if(void 0!==l[2])R.test(l[2])&&(r=new RegExp(`</${l[2]}`,"g")),i=O;else if(void 0!==l[3])throw new Error("Bindings in tag names are not supported. Please use static templates instead. See https://lit.dev/docs/templates/expressions/#static-expressions")}else i===O?">"===l[0]?(i=null!=r?r:I,c=-1):void 0===l[1]?c=-2:(c=i.lastIndex-l[2].length,a=l[1],i=void 0===l[3]?O:'"'===l[3]?$:M):i===$||i===M?i=O:i===k||i===N?i=I:(i=O,r=void 0);console.assert(-1===c||i===O||i===M||i===$,"unexpected parse state B");const u=i===O&&e[t+1].startsWith("/>")?" ":"";o+=i===I?s+w:c>=0?(n.push(a),s.slice(0,c)+y+s.slice(c)+b+u):s+b+(-2===c?(n.push(void 0),t):u)}const a=o+(e[s]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw")){let e="invalid template strings array";throw e="\n          Internal Error: expected template strings to be an array\n          with a 'raw' field. Faking a template strings array by\n          calling html or svg like an ordinary function is effectively\n          the same as calling unsafeHtml and can lead to major security\n          issues, e.g. opening your code up to XSS attacks.\n\n          If you're using the html or svg tagged template functions normally\n          and still seeing this error, please file a bug at\n          https://github.com/lit/lit/issues/new?template=bug_report.md\n          and include information about your build tooling, if any.\n        ".trim().replace(/\n */g,"\n"),new Error(e)}return[void 0!==f?f.createHTML(a):a,n]};class G{constructor(e,t){let s,{strings:n,_$litType$:r}=e;this.parts=[];let o=0,i=0;const a=n.length-1,d=this.parts,[u,f]=H(n,r);if(this.el=G.createElement(u,t),B.currentNode=this.el.content,2===r){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(s=B.nextNode())&&d.length<a;){if(1===s.nodeType){{const e=s.localName;if(/^(?:textarea|template)$/i.test(e)&&s.innerHTML.includes(b)){const t=`Expressions are not supported inside \`${e}\` elements. See https://lit.dev/msg/expression-in-${e} for more information.`;if("template"===e)throw new Error(t);c("",t)}}if(s.hasAttributes()){const e=[];for(const t of s.getAttributeNames())if(t.endsWith(y)||t.startsWith(b)){const n=f[i++];if(e.push(t),void 0!==n){const e=s.getAttribute(n.toLowerCase()+y).split(b),t=/([.?@])?(.*)/.exec(n);d.push({type:1,index:o,name:t[2],strings:e,ctor:"."===t[1]?Y:"?"===t[1]?X:"@"===t[1]?Z:Q})}else d.push({type:6,index:o})}for(const t of e)s.removeAttribute(t)}if(R.test(s.tagName)){const e=s.textContent.split(b),t=e.length-1;if(t>0){s.textContent=h?h.emptyScript:"";for(let n=0;n<t;n++)s.append(e[n],x()),B.nextNode(),d.push({type:2,index:++o});s.append(e[t],x())}}}else if(8===s.nodeType){if(s.data===j)d.push({type:2,index:o});else{let e=-1;for(;-1!==(e=s.data.indexOf(b,e+1));)d.push({type:7,index:o}),e+=b.length-1}}o++}null==l||l({kind:"template prep",template:this,clonableTemplate:this.el,parts:this.parts,strings:n})}static createElement(e,t){const s=S.createElement("template");return s.innerHTML=e,s}}function W(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3?arguments[3]:void 0;var r,o,i,a;if(t===z)return t;let l=void 0!==n?null===(r=s.__directives)||void 0===r?void 0:r[n]:s.__directive;const c=E(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(o=null==l?void 0:l._$notifyDirectiveConnectionChanged)||void 0===o||o.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$initialize(e,s,n)),void 0!==n?(null!==(i=(a=s).__directives)&&void 0!==i?i:a.__directives=[])[n]=l:s.__directive=l),void 0!==l&&(t=W(e,l._$resolve(e,t.values),l,n)),t}class V{constructor(e,t){this._$parts=[],this._$disconnectableChildren=void 0,this._$template=e,this._$parent=t}get parentNode(){return this._$parent.parentNode}get _$isConnected(){return this._$parent._$isConnected}_clone(e){var t;const{el:{content:s},parts:n}=this._$template,r=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:S).importNode(s,!0);B.currentNode=r;let o=B.nextNode(),i=0,a=0,l=n[0];for(;void 0!==l;){if(i===l.index){let t;2===l.type?t=new J(o,o.nextSibling,this,e):1===l.type?t=new l.ctor(o,l.name,l.strings,this,e):6===l.type&&(t=new ee(o,this,e)),this._$parts.push(t),l=n[++a]}i!==(null==l?void 0:l.index)&&(o=B.nextNode(),i++)}return B.currentNode=S,r}_update(e){let t=0;for(const s of this._$parts)void 0!==s&&(null==l||l({kind:"set part",part:s,value:e[t],valueIndex:t,values:e,templateInstance:this}),void 0!==s.strings?(s._$setValue(e,s,t),t+=s.strings.length-2):s._$setValue(e[t])),t++}}class J{constructor(e,t,s,n){var r;this.type=2,this._$committedValue=F,this._$disconnectableChildren=void 0,this._$startNode=e,this._$endNode=t,this._$parent=s,this.options=n,this.__isConnected=null===(r=null==n?void 0:n.isConnected)||void 0===r||r,this._textSanitizer=void 0}get _$isConnected(){var e,t;return null!==(t=null===(e=this._$parent)||void 0===e?void 0:e._$isConnected)&&void 0!==t?t:this.__isConnected}get parentNode(){let e=u(this._$startNode).parentNode;const t=this._$parent;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$startNode}get endNode(){return this._$endNode}_$setValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;var s;if(null===this.parentNode)throw new Error("This `ChildPart` has no `parentNode` and therefore cannot accept a value. This likely means the element containing the part was manipulated in an unsupported way outside of Lit's control such that the part's marker nodes were ejected from DOM. For example, setting the element's `innerHTML` or `textContent` can do this.");if(e=W(this,e,t),E(e))e===F||null==e||""===e?(this._$committedValue!==F&&(null==l||l({kind:"commit nothing to child",start:this._$startNode,end:this._$endNode,parent:this._$parent,options:this.options}),this._$clear()),this._$committedValue=F):e!==this._$committedValue&&e!==z&&this._commitText(e);else if(void 0!==e._$litType$)this._commitTemplateResult(e);else if(void 0!==e.nodeType){if((null===(s=this.options)||void 0===s?void 0:s.host)===e)return this._commitText("[probable mistake: rendered a template's host in itself (commonly caused by writing ${this} in a template]"),void console.warn("Attempted to render the template host",e,"inside itself. This is almost always a mistake, and in dev mode ","we render some warning text. In production however, we'll ","render it, which will usually result in an error, and sometimes ","in the element disappearing from the DOM.");this._commitNode(e)}else C(e)?this._commitIterable(e):this._commitText(e)}_insert(e){return u(u(this._$startNode).parentNode).insertBefore(e,this._$endNode)}_commitNode(e){var t;if(this._$committedValue!==e){if(this._$clear(),q!==p){const e=null===(t=this._$startNode.parentNode)||void 0===t?void 0:t.nodeName;if("STYLE"===e||"SCRIPT"===e){let t="Forbidden";throw t="STYLE"===e?"Lit does not support binding inside style nodes. This is a security risk, as style injection attacks can exfiltrate data and spoof UIs. Consider instead using css`...` literals to compose styles, and make do dynamic styling with css custom properties, ::parts, <slot>s, and by mutating the DOM rather than stylesheets.":"Lit does not support binding inside script nodes. This is a security risk, as it could allow arbitrary code execution.",new Error(t)}}null==l||l({kind:"commit node",start:this._$startNode,parent:this._$parent,value:e,options:this.options}),this._$committedValue=this._insert(e)}}_commitText(e){if(this._$committedValue!==F&&E(this._$committedValue)){const t=u(this._$startNode).nextSibling;void 0===this._textSanitizer&&(this._textSanitizer=v(t,"data","property")),e=this._textSanitizer(e),null==l||l({kind:"commit text",node:t,value:e,options:this.options}),t.data=e}else{const t=S.createTextNode("");this._commitNode(t),void 0===this._textSanitizer&&(this._textSanitizer=v(t,"data","property")),e=this._textSanitizer(e),null==l||l({kind:"commit text",node:t,value:e,options:this.options}),t.data=e}this._$committedValue=e}_commitTemplateResult(e){var t;const{values:s,_$litType$:n}=e,r="number"==typeof n?this._$getTemplate(e):(void 0===n.el&&(n.el=G.createElement(n.h,this.options)),n);if((null===(t=this._$committedValue)||void 0===t?void 0:t._$template)===r)null==l||l({kind:"template updating",template:r,instance:this._$committedValue,parts:this._$committedValue._$parts,options:this.options,values:s}),this._$committedValue._update(s);else{const e=new V(r,this),t=e._clone(this.options);null==l||l({kind:"template instantiated",template:r,instance:e,parts:e._$parts,options:this.options,fragment:t,values:s}),e._update(s),null==l||l({kind:"template instantiated and updated",template:r,instance:e,parts:e._$parts,options:this.options,fragment:t,values:s}),this._commitNode(t),this._$committedValue=e}}_$getTemplate(e){let t=U.get(e.strings);return void 0===t&&U.set(e.strings,t=new G(e)),t}_commitIterable(e){A(this._$committedValue)||(this._$committedValue=[],this._$clear());const t=this._$committedValue;let s,n=0;for(const r of e)n===t.length?t.push(s=new J(this._insert(x()),this._insert(x()),this,this.options)):s=t[n],s._$setValue(r),n++;n<t.length&&(this._$clear(s&&u(s._$endNode).nextSibling,n),t.length=n)}_$clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u(this._$startNode).nextSibling,t=arguments.length>1?arguments[1]:void 0;var s;for(null===(s=this._$notifyConnectionChanged)||void 0===s||s.call(this,!1,!0,t);e&&e!==this._$endNode;){const t=u(e).nextSibling;u(e).remove(),e=t}}setConnected(e){var t;if(void 0!==this._$parent)throw new Error("part.setConnected() may only be called on a RootPart returned from render().");this.__isConnected=e,null===(t=this._$notifyConnectionChanged)||void 0===t||t.call(this,e)}}class Q{constructor(e,t,s,n,r){this.type=1,this._$committedValue=F,this._$disconnectableChildren=void 0,this.element=e,this.name=t,this._$parent=n,this.options=r,s.length>2||""!==s[0]||""!==s[1]?(this._$committedValue=new Array(s.length-1).fill(new String),this.strings=s):this._$committedValue=F,this._sanitizer=void 0}get tagName(){return this.element.tagName}get _$isConnected(){return this._$parent._$isConnected}_$setValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const r=this.strings;let o=!1;if(void 0===r)e=W(this,e,t,0),o=!E(e)||e!==this._$committedValue&&e!==z,o&&(this._$committedValue=e);else{const n=e;let i,a;for(e=r[0],i=0;i<r.length-1;i++)a=W(this,n[s+i],t,i),a===z&&(a=this._$committedValue[i]),o||(o=!E(a)||a!==this._$committedValue[i]),a===F?e=F:e!==F&&(e+=(null!=a?a:"")+r[i+1]),this._$committedValue[i]=a}o&&!n&&this._commitValue(e)}_commitValue(e){e===F?u(this.element).removeAttribute(this.name):(void 0===this._sanitizer&&(this._sanitizer=q(this.element,this.name,"attribute")),e=this._sanitizer(null!=e?e:""),null==l||l({kind:"commit attribute",element:this.element,name:this.name,value:e,options:this.options}),u(this.element).setAttribute(this.name,null!=e?e:""))}}class Y extends Q{constructor(){super(...arguments),this.type=3}_commitValue(e){void 0===this._sanitizer&&(this._sanitizer=q(this.element,this.name,"property")),e=this._sanitizer(e),null==l||l({kind:"commit property",element:this.element,name:this.name,value:e,options:this.options}),this.element[this.name]=e===F?void 0:e}}const K=h?h.emptyScript:"";class X extends Q{constructor(){super(...arguments),this.type=4}_commitValue(e){null==l||l({kind:"commit boolean attribute",element:this.element,name:this.name,value:!(!e||e===F),options:this.options}),e&&e!==F?u(this.element).setAttribute(this.name,K):u(this.element).removeAttribute(this.name)}}class Z extends Q{constructor(e,t,s,n,r){if(super(e,t,s,n,r),this.type=5,void 0!==this.strings)throw new Error(`A \`<${e.localName}>\` has a \`@${t}=...\` listener with invalid content. Event listeners in templates must have exactly one expression and no surrounding text.`)}_$setValue(e){var t;if((e=null!==(t=W(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0))&&void 0!==t?t:F)===z)return;const s=this._$committedValue,n=e===F&&s!==F||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,r=e!==F&&(s===F||n);null==l||l({kind:"commit event listener",element:this.element,name:this.name,value:e,options:this.options,removeListener:n,addListener:r,oldListener:s}),n&&this.element.removeEventListener(this.name,this,s),r&&this.element.addEventListener(this.name,this,e),this._$committedValue=e}handleEvent(e){var t,s;"function"==typeof this._$committedValue?this._$committedValue.call(null!==(s=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==s?s:this.element,e):this._$committedValue.handleEvent(e)}}class ee{constructor(e,t,s){this.element=e,this.type=6,this._$disconnectableChildren=void 0,this._$parent=t,this.options=s}get _$isConnected(){return this._$parent._$isConnected}_$setValue(e){null==l||l({kind:"commit to element binding",element:this.element,value:e,options:this.options}),W(this,e)}}const te={_boundAttributeSuffix:y,_marker:b,_markerMatch:j,_HTML_RESULT:1,_getTemplateHtml:H,_TemplateInstance:V,_isIterable:C,_resolveDirective:W,_ChildPart:J,_AttributePart:Q,_BooleanAttributePart:X,_EventPart:Z,_PropertyPart:Y,_ElementPart:ee},se=a.litHtmlPolyfillSupportDevMode;null==se||se(G,J),(null!==(i=a.litHtmlVersions)&&void 0!==i?i:a.litHtmlVersions=[]).push("2.7.4"),a.litHtmlVersions.length>1&&c("multiple-versions","Multiple versions of Lit loaded. Loading multiple versions is not recommended.");const ne=(e,t,s)=>{var n,r;if(null==t)throw new TypeError(`The container to render into may not be ${t}`);const o=d++,i=null!==(n=null==s?void 0:s.renderBefore)&&void 0!==n?n:t;let a=i._$litPart$;if(null==l||l({kind:"begin render",id:o,value:e,container:t,options:s,part:a}),void 0===a){const e=null!==(r=null==s?void 0:s.renderBefore)&&void 0!==r?r:null;i._$litPart$=a=new J(t.insertBefore(x(),e),e,void 0,null!=s?s:{})}return a._$setValue(e),null==l||l({kind:"end render",id:o,value:e,container:t,options:s,part:a}),a};ne.setSanitizer=g,ne.createSanitizer=v,ne._testOnlyClearSanitizerFactoryDoNotCallOrElse=_},"./node_modules/filesize/dist/filesize.esm.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{filesize:()=>E,partial:()=>A});const n="array",r="bit",o="bits",i="byte",a="bytes",l="",c="exponent",d="function",u="iec",h="Invalid number",f="Invalid rounding method",m="jedec",p="object",g=".",_="round",v="s",y="kbit",b="kB",j=" ",w="string",S="0",x={symbol:{iec:{bits:["bit","Kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["bit","Kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},fullform:{iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]}};function E(e,{bits:t=!1,pad:s=!1,base:E=-1,round:A=2,locale:C=l,localeOptions:T={},separator:I=l,spacer:k=j,symbols:N={},standard:O=l,output:M=w,fullform:$=!1,fullforms:R=[],exponent:D=-1,roundingMethod:P=_,precision:L=0}={}){let z=D,F=Number(e),U=[],B=0,q=l;-1===E&&0===O.length?(E=10,O=m):-1===E&&O.length>0?E=(O=O===u?u:m)===u?2:10:O=10===(E=2===E?2:10)||O===m?m:u;const H=10===E?1e3:1024,G=!0===$,W=F<0,V=Math[P];if("bigint"!=typeof e&&isNaN(e))throw new TypeError(h);if(typeof V!==d)throw new TypeError(f);if(W&&(F=-F),(-1===z||isNaN(z))&&(z=Math.floor(Math.log(F)/Math.log(H)),z<0&&(z=0)),z>8&&(L>0&&(L+=8-z),z=8),M===c)return z;if(0===F)U[0]=0,q=U[1]=x.symbol[O][t?o:a][z];else{B=F/(2===E?Math.pow(2,10*z):Math.pow(1e3,z)),t&&(B*=8,B>=H&&z<8&&(B/=H,z++));const e=Math.pow(10,z>0?A:0);U[0]=V(B*e)/e,U[0]===H&&z<8&&-1===D&&(U[0]=1,z++),q=U[1]=10===E&&1===z?t?y:b:x.symbol[O][t?o:a][z]}if(W&&(U[0]=-U[0]),L>0&&(U[0]=U[0].toPrecision(L)),U[1]=N[U[1]]||U[1],!0===C?U[0]=U[0].toLocaleString():C.length>0?U[0]=U[0].toLocaleString(C,T):I.length>0&&(U[0]=U[0].toString().replace(g,I)),s&&!1===Number.isInteger(U[0])&&A>0){const e=I||g,t=U[0].toString().split(e),s=t[1]||l,n=s.length,r=A-n;U[0]=`${t[0]}${e}${s.padEnd(n+r,S)}`}return G&&(U[1]=R[z]?R[z]:x.fullform[O][z]+(t?r:i)+(1===U[0]?l:v)),M===n?U:M===p?{value:U[0],symbol:U[1],exponent:z,unit:q}:U.join(k)}function A({bits:e=!1,pad:t=!1,base:s=-1,round:n=2,locale:r=l,localeOptions:o={},separator:i=l,spacer:a=j,symbols:c={},standard:d=l,output:u=w,fullform:h=!1,fullforms:f=[],exponent:m=-1,roundingMethod:p=_,precision:g=0}={}){return l=>E(l,{bits:e,pad:t,base:s,round:n,locale:r,localeOptions:o,separator:i,spacer:a,symbols:c,standard:d,output:u,fullform:h,fullforms:f,exponent:m,roundingMethod:p,precision:g})}},"./node_modules/lit-element/development/lit-element.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CSSResult:()=>i.CSSResult,LitElement:()=>d,ReactiveElement:()=>i.ReactiveElement,UpdatingElement:()=>l,_$LE:()=>h,_$LH:()=>a._$LH,adoptStyles:()=>i.adoptStyles,css:()=>i.css,defaultConverter:()=>i.defaultConverter,getCompatibleStyle:()=>i.getCompatibleStyle,html:()=>a.html,noChange:()=>a.noChange,notEqual:()=>i.notEqual,nothing:()=>a.nothing,render:()=>a.render,supportsAdoptingStyleSheets:()=>i.supportsAdoptingStyleSheets,svg:()=>a.svg,unsafeCSS:()=>i.unsafeCSS});var n,r,o,i=s("./node_modules/@lit/reactive-element/development/reactive-element.js"),a=s("./node_modules/lit-html/development/lit-html.js");const l=i.ReactiveElement;let c;{const e=null!==(n=globalThis.litIssuedWarnings)&&void 0!==n?n:globalThis.litIssuedWarnings=new Set;c=(t,s)=>{s+=` See https://lit.dev/msg/${t} for more information.`,e.has(s)||(console.warn(s),e.add(s))}}class d extends i.ReactiveElement{constructor(){super(...arguments),this.renderOptions={host:this},this.__childPart=void 0}createRenderRoot(){var e,t;const s=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=s.firstChild),s}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this.__childPart=(0,a.render)(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this.__childPart)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this.__childPart)||void 0===e||e.setConnected(!1)}render(){return a.noChange}}d.finalized=!0,d._$litElement$=!0,null===(r=globalThis.litElementHydrateSupport)||void 0===r||r.call(globalThis,{LitElement:d});const u=globalThis.litElementPolyfillSupportDevMode;null==u||u({LitElement:d}),d.finalize=function(){if(!i.ReactiveElement.finalize.call(this))return!1;const e=(e,t,s=!1)=>{if(e.hasOwnProperty(t)){const n=("function"==typeof e?e:e.constructor).name;c(s?"renamed-api":"removed-api",`\`${t}\` is implemented on class ${n}. It has been ${s?"renamed":"removed"} in this version of LitElement.`)}};return e(this,"render"),e(this,"getStyles",!0),e(this.prototype,"adoptStyles"),!0};const h={_$attributeToProperty:(e,t,s)=>{e._$attributeToProperty(t,s)},_$changedProperties:e=>e._$changedProperties};(null!==(o=globalThis.litElementVersions)&&void 0!==o?o:globalThis.litElementVersions=[]).push("3.3.2"),globalThis.litElementVersions.length>1&&c("multiple-versions","Multiple versions of Lit loaded. Loading multiple versions is not recommended.")},"./node_modules/lit/async-directive.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{AsyncDirective:()=>n.AsyncDirective,Directive:()=>n.Directive,PartType:()=>n.PartType,directive:()=>n.directive});var n=s("./node_modules/lit-html/development/async-directive.js")},"./node_modules/lit/directive.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{Directive:()=>n.Directive,PartType:()=>n.PartType,directive:()=>n.directive});var n=s("./node_modules/lit-html/development/directive.js")},"./node_modules/lit/directives/repeat.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{repeat:()=>n.repeat});var n=s("./node_modules/lit-html/development/directives/repeat.js")},"./node_modules/lit/directives/unsafe-html.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{UnsafeHTMLDirective:()=>n.UnsafeHTMLDirective,unsafeHTML:()=>n.unsafeHTML});var n=s("./node_modules/lit-html/development/directives/unsafe-html.js")},"./node_modules/lit/directives/until.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{UntilDirective:()=>n.UntilDirective,until:()=>n.until});var n=s("./node_modules/lit-html/development/directives/until.js")},"./node_modules/lit/html.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{_$LH:()=>n._$LH,html:()=>n.html,noChange:()=>n.noChange,nothing:()=>n.nothing,render:()=>n.render,svg:()=>n.svg});var n=s("./node_modules/lit-html/development/lit-html.js")},"./node_modules/lit/index.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{CSSResult:()=>n.CSSResult,LitElement:()=>n.LitElement,ReactiveElement:()=>n.ReactiveElement,UpdatingElement:()=>n.UpdatingElement,_$LE:()=>n._$LE,_$LH:()=>n._$LH,adoptStyles:()=>n.adoptStyles,css:()=>n.css,defaultConverter:()=>n.defaultConverter,getCompatibleStyle:()=>n.getCompatibleStyle,html:()=>n.html,isServer:()=>r.isServer,noChange:()=>n.noChange,notEqual:()=>n.notEqual,nothing:()=>n.nothing,render:()=>n.render,supportsAdoptingStyleSheets:()=>n.supportsAdoptingStyleSheets,svg:()=>n.svg,unsafeCSS:()=>n.unsafeCSS});s("./node_modules/@lit/reactive-element/development/reactive-element.js"),s("./node_modules/lit-html/development/lit-html.js");var n=s("./node_modules/lit-element/development/lit-element.js"),r=s("./node_modules/lit-html/development/is-server.js")},"./node_modules/lodash-es/_DataView.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getNative.js"),r=s("./node_modules/lodash-es/_root.js");const o=(0,n.default)(r.default,"DataView")},"./node_modules/lodash-es/_Hash.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_hashClear.js"),r=s("./node_modules/lodash-es/_hashDelete.js"),o=s("./node_modules/lodash-es/_hashGet.js"),i=s("./node_modules/lodash-es/_hashHas.js"),a=s("./node_modules/lodash-es/_hashSet.js");function l(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n.default,l.prototype.delete=r.default,l.prototype.get=o.default,l.prototype.has=i.default,l.prototype.set=a.default;const c=l},"./node_modules/lodash-es/_ListCache.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_listCacheClear.js"),r=s("./node_modules/lodash-es/_listCacheDelete.js"),o=s("./node_modules/lodash-es/_listCacheGet.js"),i=s("./node_modules/lodash-es/_listCacheHas.js"),a=s("./node_modules/lodash-es/_listCacheSet.js");function l(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n.default,l.prototype.delete=r.default,l.prototype.get=o.default,l.prototype.has=i.default,l.prototype.set=a.default;const c=l},"./node_modules/lodash-es/_Map.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getNative.js"),r=s("./node_modules/lodash-es/_root.js");const o=(0,n.default)(r.default,"Map")},"./node_modules/lodash-es/_MapCache.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_mapCacheClear.js"),r=s("./node_modules/lodash-es/_mapCacheDelete.js"),o=s("./node_modules/lodash-es/_mapCacheGet.js"),i=s("./node_modules/lodash-es/_mapCacheHas.js"),a=s("./node_modules/lodash-es/_mapCacheSet.js");function l(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n.default,l.prototype.delete=r.default,l.prototype.get=o.default,l.prototype.has=i.default,l.prototype.set=a.default;const c=l},"./node_modules/lodash-es/_Promise.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getNative.js"),r=s("./node_modules/lodash-es/_root.js");const o=(0,n.default)(r.default,"Promise")},"./node_modules/lodash-es/_Set.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getNative.js"),r=s("./node_modules/lodash-es/_root.js");const o=(0,n.default)(r.default,"Set")},"./node_modules/lodash-es/_SetCache.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_MapCache.js"),r=s("./node_modules/lodash-es/_setCacheAdd.js"),o=s("./node_modules/lodash-es/_setCacheHas.js");function i(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new n.default;++t<s;)this.add(e[t])}i.prototype.add=i.prototype.push=r.default,i.prototype.has=o.default;const a=i},"./node_modules/lodash-es/_Stack.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/_ListCache.js"),r=s("./node_modules/lodash-es/_stackClear.js"),o=s("./node_modules/lodash-es/_stackDelete.js"),i=s("./node_modules/lodash-es/_stackGet.js"),a=s("./node_modules/lodash-es/_stackHas.js"),l=s("./node_modules/lodash-es/_stackSet.js");function c(e){var t=this.__data__=new n.default(e);this.size=t.size}c.prototype.clear=r.default,c.prototype.delete=o.default,c.prototype.get=i.default,c.prototype.has=a.default,c.prototype.set=l.default;const d=c},"./node_modules/lodash-es/_Symbol.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=s("./node_modules/lodash-es/_root.js").default.Symbol},"./node_modules/lodash-es/_Uint8Array.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=s("./node_modules/lodash-es/_root.js").default.Uint8Array},"./node_modules/lodash-es/_WeakMap.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getNative.js"),r=s("./node_modules/lodash-es/_root.js");const o=(0,n.default)(r.default,"WeakMap")},"./node_modules/lodash-es/_apply.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){switch(s.length){case 0:return e.call(t);case 1:return e.call(t,s[0]);case 2:return e.call(t,s[0],s[1]);case 3:return e.call(t,s[0],s[1],s[2])}return e.apply(t,s)}},"./node_modules/lodash-es/_arrayAggregator.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s,n){for(var r=-1,o=null==e?0:e.length;++r<o;){var i=e[r];t(n,i,s(i),e)}return n}},"./node_modules/lodash-es/_arrayEach.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n&&!1!==t(e[s],s,e););return e}},"./node_modules/lodash-es/_arrayEvery.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(!t(e[s],s,e))return!1;return!0}},"./node_modules/lodash-es/_arrayFilter.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=null==e?0:e.length,r=0,o=[];++s<n;){var i=e[s];t(i,s,e)&&(o[r++]=i)}return o}},"./node_modules/lodash-es/_arrayIncludes.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseIndexOf.js");const r=function(e,t){return!!(null==e?0:e.length)&&(0,n.default)(e,t,0)>-1}},"./node_modules/lodash-es/_arrayIncludesWith.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){for(var n=-1,r=null==e?0:e.length;++n<r;)if(s(t,e[n]))return!0;return!1}},"./node_modules/lodash-es/_arrayLikeKeys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/_baseTimes.js"),r=s("./node_modules/lodash-es/isArguments.js"),o=s("./node_modules/lodash-es/isArray.js"),i=s("./node_modules/lodash-es/isBuffer.js"),a=s("./node_modules/lodash-es/_isIndex.js"),l=s("./node_modules/lodash-es/isTypedArray.js"),c=Object.prototype.hasOwnProperty;const d=function(e,t){var s=(0,o.default)(e),d=!s&&(0,r.default)(e),u=!s&&!d&&(0,i.default)(e),h=!s&&!d&&!u&&(0,l.default)(e),f=s||d||u||h,m=f?(0,n.default)(e.length,String):[],p=m.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||u&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||(0,a.default)(g,p))||m.push(g);return m}},"./node_modules/lodash-es/_arrayMap.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=null==e?0:e.length,r=Array(n);++s<n;)r[s]=t(e[s],s,e);return r}},"./node_modules/lodash-es/_arrayPush.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=t.length,r=e.length;++s<n;)e[r+s]=t[s];return e}},"./node_modules/lodash-es/_arraySome.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=null==e?0:e.length;++s<n;)if(t(e[s],s,e))return!0;return!1}},"./node_modules/lodash-es/_assignMergeValue.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseAssignValue.js"),r=s("./node_modules/lodash-es/eq.js");const o=function(e,t,s){(void 0!==s&&!(0,r.default)(e[t],s)||void 0===s&&!(t in e))&&(0,n.default)(e,t,s)}},"./node_modules/lodash-es/_assignValue.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseAssignValue.js"),r=s("./node_modules/lodash-es/eq.js"),o=Object.prototype.hasOwnProperty;const i=function(e,t,s){var i=e[t];o.call(e,t)&&(0,r.default)(i,s)&&(void 0!==s||t in e)||(0,n.default)(e,t,s)}},"./node_modules/lodash-es/_assocIndexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/eq.js");const r=function(e,t){for(var s=e.length;s--;)if((0,n.default)(e[s][0],t))return s;return-1}},"./node_modules/lodash-es/_baseAggregator.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseEach.js");const r=function(e,t,s,r){return(0,n.default)(e,(function(e,n,o){t(r,e,s(e),o)})),r}},"./node_modules/lodash-es/_baseAssign.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/keys.js");const o=function(e,t){return e&&(0,n.default)(t,(0,r.default)(t),e)}},"./node_modules/lodash-es/_baseAssignIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/keysIn.js");const o=function(e,t){return e&&(0,n.default)(t,(0,r.default)(t),e)}},"./node_modules/lodash-es/_baseAssignValue.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_defineProperty.js");const r=function(e,t,s){"__proto__"==t&&n.default?(0,n.default)(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}},"./node_modules/lodash-es/_baseClone.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>I});var n=s("./node_modules/lodash-es/_Stack.js"),r=s("./node_modules/lodash-es/_arrayEach.js"),o=s("./node_modules/lodash-es/_assignValue.js"),i=s("./node_modules/lodash-es/_baseAssign.js"),a=s("./node_modules/lodash-es/_baseAssignIn.js"),l=s("./node_modules/lodash-es/_cloneBuffer.js"),c=s("./node_modules/lodash-es/_copyArray.js"),d=s("./node_modules/lodash-es/_copySymbols.js"),u=s("./node_modules/lodash-es/_copySymbolsIn.js"),h=s("./node_modules/lodash-es/_getAllKeys.js"),f=s("./node_modules/lodash-es/_getAllKeysIn.js"),m=s("./node_modules/lodash-es/_getTag.js"),p=s("./node_modules/lodash-es/_initCloneArray.js"),g=s("./node_modules/lodash-es/_initCloneByTag.js"),_=s("./node_modules/lodash-es/_initCloneObject.js"),v=s("./node_modules/lodash-es/isArray.js"),y=s("./node_modules/lodash-es/isBuffer.js"),b=s("./node_modules/lodash-es/isMap.js"),j=s("./node_modules/lodash-es/isObject.js"),w=s("./node_modules/lodash-es/isSet.js"),S=s("./node_modules/lodash-es/keys.js"),x=s("./node_modules/lodash-es/keysIn.js"),E="[object Arguments]",A="[object Function]",C="[object Object]",T={};T[E]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[C]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[A]=T["[object WeakMap]"]=!1;const I=function e(t,s,I,k,N,O){var M,$=1&s,R=2&s,D=4&s;if(I&&(M=N?I(t,k,N,O):I(t)),void 0!==M)return M;if(!(0,j.default)(t))return t;var P=(0,v.default)(t);if(P){if(M=(0,p.default)(t),!$)return(0,c.default)(t,M)}else{var L=(0,m.default)(t),z=L==A||"[object GeneratorFunction]"==L;if((0,y.default)(t))return(0,l.default)(t,$);if(L==C||L==E||z&&!N){if(M=R||z?{}:(0,_.default)(t),!$)return R?(0,u.default)(t,(0,a.default)(M,t)):(0,d.default)(t,(0,i.default)(M,t))}else{if(!T[L])return N?t:{};M=(0,g.default)(t,L,$)}}O||(O=new n.default);var F=O.get(t);if(F)return F;O.set(t,M),(0,w.default)(t)?t.forEach((function(n){M.add(e(n,s,I,n,t,O))})):(0,b.default)(t)&&t.forEach((function(n,r){M.set(r,e(n,s,I,r,t,O))}));var U=D?R?f.default:h.default:R?x.default:S.default,B=P?void 0:U(t);return(0,r.default)(B||t,(function(n,r){B&&(n=t[r=n]),(0,o.default)(M,r,e(n,s,I,r,t,O))})),M}},"./node_modules/lodash-es/_baseCreate.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/isObject.js"),r=Object.create;const o=function(){function e(){}return function(t){if(!(0,n.default)(t))return{};if(r)return r(t);e.prototype=t;var s=new e;return e.prototype=void 0,s}}()},"./node_modules/lodash-es/_baseDelay.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,s)}),t)}},"./node_modules/lodash-es/_baseDifference.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_SetCache.js"),r=s("./node_modules/lodash-es/_arrayIncludes.js"),o=s("./node_modules/lodash-es/_arrayIncludesWith.js"),i=s("./node_modules/lodash-es/_arrayMap.js"),a=s("./node_modules/lodash-es/_baseUnary.js"),l=s("./node_modules/lodash-es/_cacheHas.js");const c=function(e,t,s,c){var d=-1,u=r.default,h=!0,f=e.length,m=[],p=t.length;if(!f)return m;s&&(t=(0,i.default)(t,(0,a.default)(s))),c?(u=o.default,h=!1):t.length>=200&&(u=l.default,h=!1,t=new n.default(t));e:for(;++d<f;){var g=e[d],_=null==s?g:s(g);if(g=c||0!==g?g:0,h&&_==_){for(var v=p;v--;)if(t[v]===_)continue e;m.push(g)}else u(t,_,c)||m.push(g)}return m}},"./node_modules/lodash-es/_baseEach.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseForOwn.js");const r=(0,s("./node_modules/lodash-es/_createBaseEach.js").default)(n.default)},"./node_modules/lodash-es/_baseEvery.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseEach.js");const r=function(e,t){var s=!0;return(0,n.default)(e,(function(e,n,r){return s=!!t(e,n,r)})),s}},"./node_modules/lodash-es/_baseFindIndex.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s,n){for(var r=e.length,o=s+(n?1:-1);n?o--:++o<r;)if(t(e[o],o,e))return o;return-1}},"./node_modules/lodash-es/_baseFlatten.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_arrayPush.js"),r=s("./node_modules/lodash-es/_isFlattenable.js");const o=function e(t,s,o,i,a){var l=-1,c=t.length;for(o||(o=r.default),a||(a=[]);++l<c;){var d=t[l];s>0&&o(d)?s>1?e(d,s-1,o,i,a):(0,n.default)(a,d):i||(a[a.length]=d)}return a}},"./node_modules/lodash-es/_baseFor.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_createBaseFor.js").default)()},"./node_modules/lodash-es/_baseForOwn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseFor.js"),r=s("./node_modules/lodash-es/keys.js");const o=function(e,t){return e&&(0,n.default)(e,t,r.default)}},"./node_modules/lodash-es/_baseGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_castPath.js"),r=s("./node_modules/lodash-es/_toKey.js");const o=function(e,t){for(var s=0,o=(t=(0,n.default)(t,e)).length;null!=e&&s<o;)e=e[(0,r.default)(t[s++])];return s&&s==o?e:void 0}},"./node_modules/lodash-es/_baseGetAllKeys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_arrayPush.js"),r=s("./node_modules/lodash-es/isArray.js");const o=function(e,t,s){var o=t(e);return(0,r.default)(e)?o:(0,n.default)(o,s(e))}},"./node_modules/lodash-es/_baseGetTag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_Symbol.js"),r=s("./node_modules/lodash-es/_getRawTag.js"),o=s("./node_modules/lodash-es/_objectToString.js"),i=n.default?n.default.toStringTag:void 0;const a=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?(0,r.default)(e):(0,o.default)(e)}},"./node_modules/lodash-es/_baseHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Object.prototype.hasOwnProperty;const r=function(e,t){return null!=e&&n.call(e,t)}},"./node_modules/lodash-es/_baseHasIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return null!=e&&t in Object(e)}},"./node_modules/lodash-es/_baseIndexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseFindIndex.js"),r=s("./node_modules/lodash-es/_baseIsNaN.js"),o=s("./node_modules/lodash-es/_strictIndexOf.js");const i=function(e,t,s){return t==t?(0,o.default)(e,t,s):(0,n.default)(e,r.default,s)}},"./node_modules/lodash-es/_baseInverter.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseForOwn.js");const r=function(e,t,s,r){return(0,n.default)(e,(function(e,n,o){t(r,s(e),n,o)})),r}},"./node_modules/lodash-es/_baseIsArguments.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return(0,r.default)(e)&&"[object Arguments]"==(0,n.default)(e)}},"./node_modules/lodash-es/_baseIsEqual.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseIsEqualDeep.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function e(t,s,o,i,a){return t===s||(null==t||null==s||!(0,r.default)(t)&&!(0,r.default)(s)?t!=t&&s!=s:(0,n.default)(t,s,o,i,e,a))}},"./node_modules/lodash-es/_baseIsEqualDeep.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s("./node_modules/lodash-es/_Stack.js"),r=s("./node_modules/lodash-es/_equalArrays.js"),o=s("./node_modules/lodash-es/_equalByTag.js"),i=s("./node_modules/lodash-es/_equalObjects.js"),a=s("./node_modules/lodash-es/_getTag.js"),l=s("./node_modules/lodash-es/isArray.js"),c=s("./node_modules/lodash-es/isBuffer.js"),d=s("./node_modules/lodash-es/isTypedArray.js"),u="[object Arguments]",h="[object Array]",f="[object Object]",m=Object.prototype.hasOwnProperty;const p=function(e,t,s,p,g,_){var v=(0,l.default)(e),y=(0,l.default)(t),b=v?h:(0,a.default)(e),j=y?h:(0,a.default)(t),w=(b=b==u?f:b)==f,S=(j=j==u?f:j)==f,x=b==j;if(x&&(0,c.default)(e)){if(!(0,c.default)(t))return!1;v=!0,w=!1}if(x&&!w)return _||(_=new n.default),v||(0,d.default)(e)?(0,r.default)(e,t,s,p,g,_):(0,o.default)(e,t,b,s,p,g,_);if(!(1&s)){var E=w&&m.call(e,"__wrapped__"),A=S&&m.call(t,"__wrapped__");if(E||A){var C=E?e.value():e,T=A?t.value():t;return _||(_=new n.default),g(C,T,s,p,_)}}return!!x&&(_||(_=new n.default),(0,i.default)(e,t,s,p,g,_))}},"./node_modules/lodash-es/_baseIsMap.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getTag.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return(0,r.default)(e)&&"[object Map]"==(0,n.default)(e)}},"./node_modules/lodash-es/_baseIsMatch.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_Stack.js"),r=s("./node_modules/lodash-es/_baseIsEqual.js");const o=function(e,t,s,o){var i=s.length,a=i,l=!o;if(null==e)return!a;for(e=Object(e);i--;){var c=s[i];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<a;){var d=(c=s[i])[0],u=e[d],h=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var f=new n.default;if(o)var m=o(u,h,d,e,t,f);if(!(void 0===m?(0,r.default)(h,u,3,o,f):m))return!1}}return!0}},"./node_modules/lodash-es/_baseIsNaN.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return e!=e}},"./node_modules/lodash-es/_baseIsNative.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s("./node_modules/lodash-es/isFunction.js"),r=s("./node_modules/lodash-es/_isMasked.js"),o=s("./node_modules/lodash-es/isObject.js"),i=s("./node_modules/lodash-es/_toSource.js"),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,d=l.toString,u=c.hasOwnProperty,h=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const f=function(e){return!(!(0,o.default)(e)||(0,r.default)(e))&&((0,n.default)(e)?h:a).test((0,i.default)(e))}},"./node_modules/lodash-es/_baseIsRegExp.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return(0,r.default)(e)&&"[object RegExp]"==(0,n.default)(e)}},"./node_modules/lodash-es/_baseIsSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getTag.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return(0,r.default)(e)&&"[object Set]"==(0,n.default)(e)}},"./node_modules/lodash-es/_baseIsTypedArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isLength.js"),o=s("./node_modules/lodash-es/isObjectLike.js"),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;const a=function(e){return(0,o.default)(e)&&(0,r.default)(e.length)&&!!i[(0,n.default)(e)]}},"./node_modules/lodash-es/_baseIteratee.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_baseMatches.js"),r=s("./node_modules/lodash-es/_baseMatchesProperty.js"),o=s("./node_modules/lodash-es/identity.js"),i=s("./node_modules/lodash-es/isArray.js"),a=s("./node_modules/lodash-es/property.js");const l=function(e){return"function"==typeof e?e:null==e?o.default:"object"==typeof e?(0,i.default)(e)?(0,r.default)(e[0],e[1]):(0,n.default)(e):(0,a.default)(e)}},"./node_modules/lodash-es/_baseKeys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_isPrototype.js"),r=s("./node_modules/lodash-es/_nativeKeys.js"),o=Object.prototype.hasOwnProperty;const i=function(e){if(!(0,n.default)(e))return(0,r.default)(e);var t=[];for(var s in Object(e))o.call(e,s)&&"constructor"!=s&&t.push(s);return t}},"./node_modules/lodash-es/_baseKeysIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/isObject.js"),r=s("./node_modules/lodash-es/_isPrototype.js"),o=s("./node_modules/lodash-es/_nativeKeysIn.js"),i=Object.prototype.hasOwnProperty;const a=function(e){if(!(0,n.default)(e))return(0,o.default)(e);var t=(0,r.default)(e),s=[];for(var a in e)("constructor"!=a||!t&&i.call(e,a))&&s.push(a);return s}},"./node_modules/lodash-es/_baseMap.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseEach.js"),r=s("./node_modules/lodash-es/isArrayLike.js");const o=function(e,t){var s=-1,o=(0,r.default)(e)?Array(e.length):[];return(0,n.default)(e,(function(e,n,r){o[++s]=t(e,n,r)})),o}},"./node_modules/lodash-es/_baseMatches.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseIsMatch.js"),r=s("./node_modules/lodash-es/_getMatchData.js"),o=s("./node_modules/lodash-es/_matchesStrictComparable.js");const i=function(e){var t=(0,r.default)(e);return 1==t.length&&t[0][2]?(0,o.default)(t[0][0],t[0][1]):function(s){return s===e||(0,n.default)(s,e,t)}}},"./node_modules/lodash-es/_baseMatchesProperty.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/_baseIsEqual.js"),r=s("./node_modules/lodash-es/get.js"),o=s("./node_modules/lodash-es/hasIn.js"),i=s("./node_modules/lodash-es/_isKey.js"),a=s("./node_modules/lodash-es/_isStrictComparable.js"),l=s("./node_modules/lodash-es/_matchesStrictComparable.js"),c=s("./node_modules/lodash-es/_toKey.js");const d=function(e,t){return(0,i.default)(e)&&(0,a.default)(t)?(0,l.default)((0,c.default)(e),t):function(s){var i=(0,r.default)(s,e);return void 0===i&&i===t?(0,o.default)(s,e):(0,n.default)(t,i,3)}}},"./node_modules/lodash-es/_baseMerge.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/_Stack.js"),r=s("./node_modules/lodash-es/_assignMergeValue.js"),o=s("./node_modules/lodash-es/_baseFor.js"),i=s("./node_modules/lodash-es/_baseMergeDeep.js"),a=s("./node_modules/lodash-es/isObject.js"),l=s("./node_modules/lodash-es/keysIn.js"),c=s("./node_modules/lodash-es/_safeGet.js");const d=function e(t,s,d,u,h){t!==s&&(0,o.default)(s,(function(o,l){if(h||(h=new n.default),(0,a.default)(o))(0,i.default)(t,s,l,d,e,u,h);else{var f=u?u((0,c.default)(t,l),o,l+"",t,s,h):void 0;void 0===f&&(f=o),(0,r.default)(t,l,f)}}),l.default)}},"./node_modules/lodash-es/_baseMergeDeep.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var n=s("./node_modules/lodash-es/_assignMergeValue.js"),r=s("./node_modules/lodash-es/_cloneBuffer.js"),o=s("./node_modules/lodash-es/_cloneTypedArray.js"),i=s("./node_modules/lodash-es/_copyArray.js"),a=s("./node_modules/lodash-es/_initCloneObject.js"),l=s("./node_modules/lodash-es/isArguments.js"),c=s("./node_modules/lodash-es/isArray.js"),d=s("./node_modules/lodash-es/isArrayLikeObject.js"),u=s("./node_modules/lodash-es/isBuffer.js"),h=s("./node_modules/lodash-es/isFunction.js"),f=s("./node_modules/lodash-es/isObject.js"),m=s("./node_modules/lodash-es/isPlainObject.js"),p=s("./node_modules/lodash-es/isTypedArray.js"),g=s("./node_modules/lodash-es/_safeGet.js"),_=s("./node_modules/lodash-es/toPlainObject.js");const v=function(e,t,s,v,y,b,j){var w=(0,g.default)(e,s),S=(0,g.default)(t,s),x=j.get(S);if(x)(0,n.default)(e,s,x);else{var E=b?b(w,S,s+"",e,t,j):void 0,A=void 0===E;if(A){var C=(0,c.default)(S),T=!C&&(0,u.default)(S),I=!C&&!T&&(0,p.default)(S);E=S,C||T||I?(0,c.default)(w)?E=w:(0,d.default)(w)?E=(0,i.default)(w):T?(A=!1,E=(0,r.default)(S,!0)):I?(A=!1,E=(0,o.default)(S,!0)):E=[]:(0,m.default)(S)||(0,l.default)(S)?(E=w,(0,l.default)(w)?E=(0,_.default)(w):(0,f.default)(w)&&!(0,h.default)(w)||(E=(0,a.default)(S))):A=!1}A&&(j.set(S,E),y(E,S,v,b,j),j.delete(S)),(0,n.default)(e,s,E)}}},"./node_modules/lodash-es/_baseOrderBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s("./node_modules/lodash-es/_arrayMap.js"),r=s("./node_modules/lodash-es/_baseGet.js"),o=s("./node_modules/lodash-es/_baseIteratee.js"),i=s("./node_modules/lodash-es/_baseMap.js"),a=s("./node_modules/lodash-es/_baseSortBy.js"),l=s("./node_modules/lodash-es/_baseUnary.js"),c=s("./node_modules/lodash-es/_compareMultiple.js"),d=s("./node_modules/lodash-es/identity.js"),u=s("./node_modules/lodash-es/isArray.js");const h=function(e,t,s){t=t.length?(0,n.default)(t,(function(e){return(0,u.default)(e)?function(t){return(0,r.default)(t,1===e.length?e[0]:e)}:e})):[d.default];var h=-1;t=(0,n.default)(t,(0,l.default)(o.default));var f=(0,i.default)(e,(function(e,s,r){return{criteria:(0,n.default)(t,(function(t){return t(e)})),index:++h,value:e}}));return(0,a.default)(f,(function(e,t){return(0,c.default)(e,t,s)}))}},"./node_modules/lodash-es/_basePick.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_basePickBy.js"),r=s("./node_modules/lodash-es/hasIn.js");const o=function(e,t){return(0,n.default)(e,t,(function(t,s){return(0,r.default)(e,s)}))}},"./node_modules/lodash-es/_basePickBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseGet.js"),r=s("./node_modules/lodash-es/_baseSet.js"),o=s("./node_modules/lodash-es/_castPath.js");const i=function(e,t,s){for(var i=-1,a=t.length,l={};++i<a;){var c=t[i],d=(0,n.default)(e,c);s(d,c)&&(0,r.default)(l,(0,o.default)(c,e),d)}return l}},"./node_modules/lodash-es/_baseProperty.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return function(t){return null==t?void 0:t[e]}}},"./node_modules/lodash-es/_basePropertyDeep.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseGet.js");const r=function(e){return function(t){return(0,n.default)(t,e)}}},"./node_modules/lodash-es/_basePropertyOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return function(t){return null==e?void 0:e[t]}}},"./node_modules/lodash-es/_baseRange.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=Math.ceil,r=Math.max;const o=function(e,t,s,o){for(var i=-1,a=r(n((t-e)/(s||1)),0),l=Array(a);a--;)l[o?a:++i]=e,e+=s;return l}},"./node_modules/lodash-es/_baseRest.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/identity.js"),r=s("./node_modules/lodash-es/_overRest.js"),o=s("./node_modules/lodash-es/_setToString.js");const i=function(e,t){return(0,o.default)((0,r.default)(e,t,n.default),e+"")}},"./node_modules/lodash-es/_baseSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_assignValue.js"),r=s("./node_modules/lodash-es/_castPath.js"),o=s("./node_modules/lodash-es/_isIndex.js"),i=s("./node_modules/lodash-es/isObject.js"),a=s("./node_modules/lodash-es/_toKey.js");const l=function(e,t,s,l){if(!(0,i.default)(e))return e;for(var c=-1,d=(t=(0,r.default)(t,e)).length,u=d-1,h=e;null!=h&&++c<d;){var f=(0,a.default)(t[c]),m=s;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(c!=u){var p=h[f];void 0===(m=l?l(p,f,h):void 0)&&(m=(0,i.default)(p)?p:(0,o.default)(t[c+1])?[]:{})}(0,n.default)(h,f,m),h=h[f]}return e}},"./node_modules/lodash-es/_baseSetToString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/constant.js"),r=s("./node_modules/lodash-es/_defineProperty.js"),o=s("./node_modules/lodash-es/identity.js");const i=r.default?function(e,t){return(0,r.default)(e,"toString",{configurable:!0,enumerable:!1,value:(0,n.default)(t),writable:!0})}:o.default},"./node_modules/lodash-es/_baseSlice.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(s=s>r?r:s)<0&&(s+=r),r=t>s?0:s-t>>>0,t>>>=0;for(var o=Array(r);++n<r;)o[n]=e[n+t];return o}},"./node_modules/lodash-es/_baseSome.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseEach.js");const r=function(e,t){var s;return(0,n.default)(e,(function(e,n,r){return!(s=t(e,n,r))})),!!s}},"./node_modules/lodash-es/_baseSortBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){var s=e.length;for(e.sort(t);s--;)e[s]=e[s].value;return e}},"./node_modules/lodash-es/_baseTimes.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){for(var s=-1,n=Array(e);++s<e;)n[s]=t(s);return n}},"./node_modules/lodash-es/_baseToString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_Symbol.js"),r=s("./node_modules/lodash-es/_arrayMap.js"),o=s("./node_modules/lodash-es/isArray.js"),i=s("./node_modules/lodash-es/isSymbol.js"),a=n.default?n.default.prototype:void 0,l=a?a.toString:void 0;const c=function e(t){if("string"==typeof t)return t;if((0,o.default)(t))return(0,r.default)(t,e)+"";if((0,i.default)(t))return l?l.call(t):"";var s=t+"";return"0"==s&&1/t==-Infinity?"-0":s}},"./node_modules/lodash-es/_baseTrim.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_trimmedEndIndex.js"),r=/^\s+/;const o=function(e){return e?e.slice(0,(0,n.default)(e)+1).replace(r,""):e}},"./node_modules/lodash-es/_baseUnary.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return function(t){return e(t)}}},"./node_modules/lodash-es/_baseUnset.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_castPath.js"),r=s("./node_modules/lodash-es/last.js"),o=s("./node_modules/lodash-es/_parent.js"),i=s("./node_modules/lodash-es/_toKey.js");const a=function(e,t){return t=(0,n.default)(t,e),null==(e=(0,o.default)(e,t))||delete e[(0,i.default)((0,r.default)(t))]}},"./node_modules/lodash-es/_cacheHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return e.has(t)}},"./node_modules/lodash-es/_castPath.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/isArray.js"),r=s("./node_modules/lodash-es/_isKey.js"),o=s("./node_modules/lodash-es/_stringToPath.js"),i=s("./node_modules/lodash-es/toString.js");const a=function(e,t){return(0,n.default)(e)?e:(0,r.default)(e,t)?[e]:(0,o.default)((0,i.default)(e))}},"./node_modules/lodash-es/_cloneArrayBuffer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_Uint8Array.js");const r=function(e){var t=new e.constructor(e.byteLength);return new n.default(t).set(new n.default(e)),t}},"./node_modules/lodash-es/_cloneBuffer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_root.js"),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=r&&"object"==typeof module&&module&&!module.nodeType&&module,i=o&&o.exports===r?n.default.Buffer:void 0,a=i?i.allocUnsafe:void 0;const l=function(e,t){if(t)return e.slice();var s=e.length,n=a?a(s):new e.constructor(s);return e.copy(n),n}},"./node_modules/lodash-es/_cloneDataView.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_cloneArrayBuffer.js");const r=function(e,t){var s=t?(0,n.default)(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}},"./node_modules/lodash-es/_cloneRegExp.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=/\w*$/;const r=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},"./node_modules/lodash-es/_cloneSymbol.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_Symbol.js"),r=n.default?n.default.prototype:void 0,o=r?r.valueOf:void 0;const i=function(e){return o?Object(o.call(e)):{}}},"./node_modules/lodash-es/_cloneTypedArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_cloneArrayBuffer.js");const r=function(e,t){var s=t?(0,n.default)(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}},"./node_modules/lodash-es/_compareAscending.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/isSymbol.js");const r=function(e,t){if(e!==t){var s=void 0!==e,r=null===e,o=e==e,i=(0,n.default)(e),a=void 0!==t,l=null===t,c=t==t,d=(0,n.default)(t);if(!l&&!d&&!i&&e>t||i&&a&&c&&!l&&!d||r&&a&&c||!s&&c||!o)return 1;if(!r&&!i&&!d&&e<t||d&&s&&o&&!r&&!i||l&&s&&o||!a&&o||!c)return-1}return 0}},"./node_modules/lodash-es/_compareMultiple.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_compareAscending.js");const r=function(e,t,s){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,l=s.length;++r<a;){var c=(0,n.default)(o[r],i[r]);if(c)return r>=l?c:c*("desc"==s[r]?-1:1)}return e.index-t.index}},"./node_modules/lodash-es/_copyArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){var s=-1,n=e.length;for(t||(t=Array(n));++s<n;)t[s]=e[s];return t}},"./node_modules/lodash-es/_copyObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_assignValue.js"),r=s("./node_modules/lodash-es/_baseAssignValue.js");const o=function(e,t,s,o){var i=!s;s||(s={});for(var a=-1,l=t.length;++a<l;){var c=t[a],d=o?o(s[c],e[c],c,s,e):void 0;void 0===d&&(d=e[c]),i?(0,r.default)(s,c,d):(0,n.default)(s,c,d)}return s}},"./node_modules/lodash-es/_copySymbols.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/_getSymbols.js");const o=function(e,t){return(0,n.default)(e,(0,r.default)(e),t)}},"./node_modules/lodash-es/_copySymbolsIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/_getSymbolsIn.js");const o=function(e,t){return(0,n.default)(e,(0,r.default)(e),t)}},"./node_modules/lodash-es/_coreJsData.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=s("./node_modules/lodash-es/_root.js").default["__core-js_shared__"]},"./node_modules/lodash-es/_createAggregator.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_arrayAggregator.js"),r=s("./node_modules/lodash-es/_baseAggregator.js"),o=s("./node_modules/lodash-es/_baseIteratee.js"),i=s("./node_modules/lodash-es/isArray.js");const a=function(e,t){return function(s,a){var l=(0,i.default)(s)?n.default:r.default,c=t?t():{};return l(s,e,(0,o.default)(a,2),c)}}},"./node_modules/lodash-es/_createAssigner.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseRest.js"),r=s("./node_modules/lodash-es/_isIterateeCall.js");const o=function(e){return(0,n.default)((function(t,s){var n=-1,o=s.length,i=o>1?s[o-1]:void 0,a=o>2?s[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&(0,r.default)(s[0],s[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var l=s[n];l&&e(t,l,n,i)}return t}))}},"./node_modules/lodash-es/_createBaseEach.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/isArrayLike.js");const r=function(e,t){return function(s,r){if(null==s)return s;if(!(0,n.default)(s))return e(s,r);for(var o=s.length,i=t?o:-1,a=Object(s);(t?i--:++i<o)&&!1!==r(a[i],i,a););return s}}},"./node_modules/lodash-es/_createBaseFor.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return function(t,s,n){for(var r=-1,o=Object(t),i=n(t),a=i.length;a--;){var l=i[e?a:++r];if(!1===s(o[l],l,o))break}return t}}},"./node_modules/lodash-es/_createInverter.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseInverter.js");const r=function(e,t){return function(s,r){return(0,n.default)(s,e,t(r),{})}}},"./node_modules/lodash-es/_createRange.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseRange.js"),r=s("./node_modules/lodash-es/_isIterateeCall.js"),o=s("./node_modules/lodash-es/toFinite.js");const i=function(e){return function(t,s,i){return i&&"number"!=typeof i&&(0,r.default)(t,s,i)&&(s=i=void 0),t=(0,o.default)(t),void 0===s?(s=t,t=0):s=(0,o.default)(s),i=void 0===i?t<s?1:-1:(0,o.default)(i),(0,n.default)(t,s,i,e)}}},"./node_modules/lodash-es/_customOmitClone.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/isPlainObject.js");const r=function(e){return(0,n.default)(e)?void 0:e}},"./node_modules/lodash-es/_defineProperty.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_getNative.js");const r=function(){try{var e=(0,n.default)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}()},"./node_modules/lodash-es/_equalArrays.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_SetCache.js"),r=s("./node_modules/lodash-es/_arraySome.js"),o=s("./node_modules/lodash-es/_cacheHas.js");const i=function(e,t,s,i,a,l){var c=1&s,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var h=l.get(e),f=l.get(t);if(h&&f)return h==t&&f==e;var m=-1,p=!0,g=2&s?new n.default:void 0;for(l.set(e,t),l.set(t,e);++m<d;){var _=e[m],v=t[m];if(i)var y=c?i(v,_,m,t,e,l):i(_,v,m,e,t,l);if(void 0!==y){if(y)continue;p=!1;break}if(g){if(!(0,r.default)(t,(function(e,t){if(!(0,o.default)(g,t)&&(_===e||a(_,e,s,i,l)))return g.push(t)}))){p=!1;break}}else if(_!==v&&!a(_,v,s,i,l)){p=!1;break}}return l.delete(e),l.delete(t),p}},"./node_modules/lodash-es/_equalByTag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/_Symbol.js"),r=s("./node_modules/lodash-es/_Uint8Array.js"),o=s("./node_modules/lodash-es/eq.js"),i=s("./node_modules/lodash-es/_equalArrays.js"),a=s("./node_modules/lodash-es/_mapToArray.js"),l=s("./node_modules/lodash-es/_setToArray.js"),c=n.default?n.default.prototype:void 0,d=c?c.valueOf:void 0;const u=function(e,t,s,n,c,u,h){switch(s){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new r.default(e),new r.default(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,o.default)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a.default;case"[object Set]":var m=1&n;if(f||(f=l.default),e.size!=t.size&&!m)return!1;var p=h.get(e);if(p)return p==t;n|=2,h.set(e,t);var g=(0,i.default)(f(e),f(t),n,c,u,h);return h.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},"./node_modules/lodash-es/_equalObjects.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_getAllKeys.js"),r=Object.prototype.hasOwnProperty;const o=function(e,t,s,o,i,a){var l=1&s,c=(0,n.default)(e),d=c.length;if(d!=(0,n.default)(t).length&&!l)return!1;for(var u=d;u--;){var h=c[u];if(!(l?h in t:r.call(t,h)))return!1}var f=a.get(e),m=a.get(t);if(f&&m)return f==t&&m==e;var p=!0;a.set(e,t),a.set(t,e);for(var g=l;++u<d;){var _=e[h=c[u]],v=t[h];if(o)var y=l?o(v,_,h,t,e,a):o(_,v,h,e,t,a);if(!(void 0===y?_===v||i(_,v,s,o,a):y)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var b=e.constructor,j=t.constructor;b==j||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof j&&j instanceof j||(p=!1)}return a.delete(e),a.delete(t),p}},"./node_modules/lodash-es/_escapeHtmlChar.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_basePropertyOf.js").default)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})},"./node_modules/lodash-es/_flatRest.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/flatten.js"),r=s("./node_modules/lodash-es/_overRest.js"),o=s("./node_modules/lodash-es/_setToString.js");const i=function(e){return(0,o.default)((0,r.default)(e,void 0,n.default),e+"")}},"./node_modules/lodash-es/_freeGlobal.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n="object"==typeof global&&global&&global.Object===Object&&global},"./node_modules/lodash-es/_getAllKeys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseGetAllKeys.js"),r=s("./node_modules/lodash-es/_getSymbols.js"),o=s("./node_modules/lodash-es/keys.js");const i=function(e){return(0,n.default)(e,o.default,r.default)}},"./node_modules/lodash-es/_getAllKeysIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseGetAllKeys.js"),r=s("./node_modules/lodash-es/_getSymbolsIn.js"),o=s("./node_modules/lodash-es/keysIn.js");const i=function(e){return(0,n.default)(e,o.default,r.default)}},"./node_modules/lodash-es/_getMapData.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_isKeyable.js");const r=function(e,t){var s=e.__data__;return(0,n.default)(t)?s["string"==typeof t?"string":"hash"]:s.map}},"./node_modules/lodash-es/_getMatchData.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_isStrictComparable.js"),r=s("./node_modules/lodash-es/keys.js");const o=function(e){for(var t=(0,r.default)(e),s=t.length;s--;){var o=t[s],i=e[o];t[s]=[o,i,(0,n.default)(i)]}return t}},"./node_modules/lodash-es/_getNative.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseIsNative.js"),r=s("./node_modules/lodash-es/_getValue.js");const o=function(e,t){var s=(0,r.default)(e,t);return(0,n.default)(s)?s:void 0}},"./node_modules/lodash-es/_getPrototype.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_overArg.js").default)(Object.getPrototypeOf,Object)},"./node_modules/lodash-es/_getRawTag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_Symbol.js"),r=Object.prototype,o=r.hasOwnProperty,i=r.toString,a=n.default?n.default.toStringTag:void 0;const l=function(e){var t=o.call(e,a),s=e[a];try{e[a]=void 0;var n=!0}catch(e){}var r=i.call(e);return n&&(t?e[a]=s:delete e[a]),r}},"./node_modules/lodash-es/_getSymbols.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_arrayFilter.js"),r=s("./node_modules/lodash-es/stubArray.js"),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols;const a=i?function(e){return null==e?[]:(e=Object(e),(0,n.default)(i(e),(function(t){return o.call(e,t)})))}:r.default},"./node_modules/lodash-es/_getSymbolsIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_arrayPush.js"),r=s("./node_modules/lodash-es/_getPrototype.js"),o=s("./node_modules/lodash-es/_getSymbols.js"),i=s("./node_modules/lodash-es/stubArray.js");const a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,n.default)(t,(0,o.default)(e)),e=(0,r.default)(e);return t}:i.default},"./node_modules/lodash-es/_getTag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var n=s("./node_modules/lodash-es/_DataView.js"),r=s("./node_modules/lodash-es/_Map.js"),o=s("./node_modules/lodash-es/_Promise.js"),i=s("./node_modules/lodash-es/_Set.js"),a=s("./node_modules/lodash-es/_WeakMap.js"),l=s("./node_modules/lodash-es/_baseGetTag.js"),c=s("./node_modules/lodash-es/_toSource.js"),d="[object Map]",u="[object Promise]",h="[object Set]",f="[object WeakMap]",m="[object DataView]",p=(0,c.default)(n.default),g=(0,c.default)(r.default),_=(0,c.default)(o.default),v=(0,c.default)(i.default),y=(0,c.default)(a.default),b=l.default;(n.default&&b(new n.default(new ArrayBuffer(1)))!=m||r.default&&b(new r.default)!=d||o.default&&b(o.default.resolve())!=u||i.default&&b(new i.default)!=h||a.default&&b(new a.default)!=f)&&(b=function(e){var t=(0,l.default)(e),s="[object Object]"==t?e.constructor:void 0,n=s?(0,c.default)(s):"";if(n)switch(n){case p:return m;case g:return d;case _:return u;case v:return h;case y:return f}return t});const j=b},"./node_modules/lodash-es/_getValue.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return null==e?void 0:e[t]}},"./node_modules/lodash-es/_hasPath.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_castPath.js"),r=s("./node_modules/lodash-es/isArguments.js"),o=s("./node_modules/lodash-es/isArray.js"),i=s("./node_modules/lodash-es/_isIndex.js"),a=s("./node_modules/lodash-es/isLength.js"),l=s("./node_modules/lodash-es/_toKey.js");const c=function(e,t,s){for(var c=-1,d=(t=(0,n.default)(t,e)).length,u=!1;++c<d;){var h=(0,l.default)(t[c]);if(!(u=null!=e&&s(e,h)))break;e=e[h]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&(0,a.default)(d)&&(0,i.default)(h,d)&&((0,o.default)(e)||(0,r.default)(e))}},"./node_modules/lodash-es/_hashClear.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_nativeCreate.js");const r=function(){this.__data__=n.default?(0,n.default)(null):{},this.size=0}},"./node_modules/lodash-es/_hashDelete.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"./node_modules/lodash-es/_hashGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_nativeCreate.js"),r=Object.prototype.hasOwnProperty;const o=function(e){var t=this.__data__;if(n.default){var s=t[e];return"__lodash_hash_undefined__"===s?void 0:s}return r.call(t,e)?t[e]:void 0}},"./node_modules/lodash-es/_hashHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_nativeCreate.js"),r=Object.prototype.hasOwnProperty;const o=function(e){var t=this.__data__;return n.default?void 0!==t[e]:r.call(t,e)}},"./node_modules/lodash-es/_hashSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_nativeCreate.js");const r=function(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=n.default&&void 0===t?"__lodash_hash_undefined__":t,this}},"./node_modules/lodash-es/_initCloneArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Object.prototype.hasOwnProperty;const r=function(e){var t=e.length,s=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(s.index=e.index,s.input=e.input),s}},"./node_modules/lodash-es/_initCloneByTag.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_cloneArrayBuffer.js"),r=s("./node_modules/lodash-es/_cloneDataView.js"),o=s("./node_modules/lodash-es/_cloneRegExp.js"),i=s("./node_modules/lodash-es/_cloneSymbol.js"),a=s("./node_modules/lodash-es/_cloneTypedArray.js");const l=function(e,t,s){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return(0,n.default)(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return(0,r.default)(e,s);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return(0,a.default)(e,s);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return(0,o.default)(e);case"[object Symbol]":return(0,i.default)(e)}}},"./node_modules/lodash-es/_initCloneObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseCreate.js"),r=s("./node_modules/lodash-es/_getPrototype.js"),o=s("./node_modules/lodash-es/_isPrototype.js");const i=function(e){return"function"!=typeof e.constructor||(0,o.default)(e)?{}:(0,n.default)((0,r.default)(e))}},"./node_modules/lodash-es/_isFlattenable.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_Symbol.js"),r=s("./node_modules/lodash-es/isArguments.js"),o=s("./node_modules/lodash-es/isArray.js"),i=n.default?n.default.isConcatSpreadable:void 0;const a=function(e){return(0,o.default)(e)||(0,r.default)(e)||!!(i&&e&&e[i])}},"./node_modules/lodash-es/_isIndex.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=/^(?:0|[1-9]\d*)$/;const r=function(e,t){var s=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==s||"symbol"!=s&&n.test(e))&&e>-1&&e%1==0&&e<t}},"./node_modules/lodash-es/_isIterateeCall.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/eq.js"),r=s("./node_modules/lodash-es/isArrayLike.js"),o=s("./node_modules/lodash-es/_isIndex.js"),i=s("./node_modules/lodash-es/isObject.js");const a=function(e,t,s){if(!(0,i.default)(s))return!1;var a=typeof t;return!!("number"==a?(0,r.default)(s)&&(0,o.default)(t,s.length):"string"==a&&t in s)&&(0,n.default)(s[t],e)}},"./node_modules/lodash-es/_isKey.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/isArray.js"),r=s("./node_modules/lodash-es/isSymbol.js"),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;const a=function(e,t){if((0,n.default)(e))return!1;var s=typeof e;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=e&&!(0,r.default)(e))||(i.test(e)||!o.test(e)||null!=t&&e in Object(t))}},"./node_modules/lodash-es/_isKeyable.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"./node_modules/lodash-es/_isMasked.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n,r=s("./node_modules/lodash-es/_coreJsData.js"),o=(n=/[^.]+$/.exec(r.default&&r.default.keys&&r.default.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";const i=function(e){return!!o&&o in e}},"./node_modules/lodash-es/_isPrototype.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Object.prototype;const r=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},"./node_modules/lodash-es/_isStrictComparable.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/isObject.js");const r=function(e){return e==e&&!(0,n.default)(e)}},"./node_modules/lodash-es/_listCacheClear.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){this.__data__=[],this.size=0}},"./node_modules/lodash-es/_listCacheDelete.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_assocIndexOf.js"),r=Array.prototype.splice;const o=function(e){var t=this.__data__,s=(0,n.default)(t,e);return!(s<0)&&(s==t.length-1?t.pop():r.call(t,s,1),--this.size,!0)}},"./node_modules/lodash-es/_listCacheGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_assocIndexOf.js");const r=function(e){var t=this.__data__,s=(0,n.default)(t,e);return s<0?void 0:t[s][1]}},"./node_modules/lodash-es/_listCacheHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_assocIndexOf.js");const r=function(e){return(0,n.default)(this.__data__,e)>-1}},"./node_modules/lodash-es/_listCacheSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_assocIndexOf.js");const r=function(e,t){var s=this.__data__,r=(0,n.default)(s,e);return r<0?(++this.size,s.push([e,t])):s[r][1]=t,this}},"./node_modules/lodash-es/_mapCacheClear.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_Hash.js"),r=s("./node_modules/lodash-es/_ListCache.js"),o=s("./node_modules/lodash-es/_Map.js");const i=function(){this.size=0,this.__data__={hash:new n.default,map:new(o.default||r.default),string:new n.default}}},"./node_modules/lodash-es/_mapCacheDelete.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_getMapData.js");const r=function(e){var t=(0,n.default)(this,e).delete(e);return this.size-=t?1:0,t}},"./node_modules/lodash-es/_mapCacheGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_getMapData.js");const r=function(e){return(0,n.default)(this,e).get(e)}},"./node_modules/lodash-es/_mapCacheHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_getMapData.js");const r=function(e){return(0,n.default)(this,e).has(e)}},"./node_modules/lodash-es/_mapCacheSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_getMapData.js");const r=function(e,t){var s=(0,n.default)(this,e),r=s.size;return s.set(e,t),this.size+=s.size==r?0:1,this}},"./node_modules/lodash-es/_mapToArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e,n){s[++t]=[n,e]})),s}},"./node_modules/lodash-es/_matchesStrictComparable.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return function(s){return null!=s&&(s[e]===t&&(void 0!==t||e in Object(s)))}}},"./node_modules/lodash-es/_memoizeCapped.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/memoize.js");const r=function(e){var t=(0,n.default)(e,(function(e){return 500===s.size&&s.clear(),e})),s=t.cache;return t}},"./node_modules/lodash-es/_nativeCreate.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_getNative.js").default)(Object,"create")},"./node_modules/lodash-es/_nativeKeys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_overArg.js").default)(Object.keys,Object)},"./node_modules/lodash-es/_nativeKeysIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=[];if(null!=e)for(var s in Object(e))t.push(s);return t}},"./node_modules/lodash-es/_nodeUtil.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_freeGlobal.js"),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=r&&"object"==typeof module&&module&&!module.nodeType&&module,i=o&&o.exports===r&&n.default.process;const a=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}()},"./node_modules/lodash-es/_objectToString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Object.prototype.toString;const r=function(e){return n.call(e)}},"./node_modules/lodash-es/_overArg.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return function(s){return e(t(s))}}},"./node_modules/lodash-es/_overRest.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_apply.js"),r=Math.max;const o=function(e,t,s){return t=r(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,a=r(o.length-t,0),l=Array(a);++i<a;)l[i]=o[t+i];i=-1;for(var c=Array(t+1);++i<t;)c[i]=o[i];return c[t]=s(l),(0,n.default)(e,this,c)}}},"./node_modules/lodash-es/_parent.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseGet.js"),r=s("./node_modules/lodash-es/_baseSlice.js");const o=function(e,t){return t.length<2?e:(0,n.default)(e,(0,r.default)(t,0,-1))}},"./node_modules/lodash-es/_root.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_freeGlobal.js"),r="object"==typeof self&&self&&self.Object===Object&&self;const o=n.default||r||Function("return this")()},"./node_modules/lodash-es/_safeGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},"./node_modules/lodash-es/_setCacheAdd.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},"./node_modules/lodash-es/_setCacheHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return this.__data__.has(e)}},"./node_modules/lodash-es/_setToArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s}},"./node_modules/lodash-es/_setToString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseSetToString.js");const r=(0,s("./node_modules/lodash-es/_shortOut.js").default)(n.default)},"./node_modules/lodash-es/_shortOut.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Date.now;const r=function(e){var t=0,s=0;return function(){var r=n(),o=16-(r-s);if(s=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"./node_modules/lodash-es/_stackClear.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_ListCache.js");const r=function(){this.__data__=new n.default,this.size=0}},"./node_modules/lodash-es/_stackDelete.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}},"./node_modules/lodash-es/_stackGet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return this.__data__.get(e)}},"./node_modules/lodash-es/_stackHas.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return this.__data__.has(e)}},"./node_modules/lodash-es/_stackSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_ListCache.js"),r=s("./node_modules/lodash-es/_Map.js"),o=s("./node_modules/lodash-es/_MapCache.js");const i=function(e,t){var s=this.__data__;if(s instanceof n.default){var i=s.__data__;if(!r.default||i.length<199)return i.push([e,t]),this.size=++s.size,this;s=this.__data__=new o.default(i)}return s.set(e,t),this.size=s.size,this}},"./node_modules/lodash-es/_strictIndexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){for(var n=s-1,r=e.length;++n<r;)if(e[n]===t)return n;return-1}},"./node_modules/lodash-es/_strictLastIndexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t,s){for(var n=s+1;n--;)if(e[n]===t)return n;return n}},"./node_modules/lodash-es/_stringToPath.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_memoizeCapped.js"),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g;const i=(0,n.default)((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(r,(function(e,s,n,r){t.push(n?r.replace(o,"$1"):s||e)})),t}))},"./node_modules/lodash-es/_toKey.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/isSymbol.js");const r=function(e){if("string"==typeof e||(0,n.default)(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},"./node_modules/lodash-es/_toSource.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=Function.prototype.toString;const r=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"./node_modules/lodash-es/_trimmedEndIndex.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=/\s/;const r=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},"./node_modules/lodash-es/assignIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/_createAssigner.js"),o=s("./node_modules/lodash-es/keysIn.js");const i=(0,r.default)((function(e,t){(0,n.default)(t,(0,o.default)(t),e)}))},"./node_modules/lodash-es/before.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/toInteger.js");const r=function(e,t){var s;if("function"!=typeof t)throw new TypeError("Expected a function");return e=(0,n.default)(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=void 0),s}}},"./node_modules/lodash-es/clone.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseClone.js");const r=function(e){return(0,n.default)(e,4)}},"./node_modules/lodash-es/cloneDeep.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseClone.js");const r=function(e){return(0,n.default)(e,5)}},"./node_modules/lodash-es/constant.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return function(){return e}}},"./node_modules/lodash-es/countBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseAssignValue.js"),r=s("./node_modules/lodash-es/_createAggregator.js"),o=Object.prototype.hasOwnProperty;const i=(0,r.default)((function(e,t,s){o.call(e,s)?++e[s]:(0,n.default)(e,s,1)}))},"./node_modules/lodash-es/create.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseAssign.js"),r=s("./node_modules/lodash-es/_baseCreate.js");const o=function(e,t){var s=(0,r.default)(e);return null==t?s:(0,n.default)(s,t)}},"./node_modules/lodash-es/debounce.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/isObject.js"),r=s("./node_modules/lodash-es/now.js"),o=s("./node_modules/lodash-es/toNumber.js"),i=Math.max,a=Math.min;const l=function(e,t,s){var l,c,d,u,h,f,m=0,p=!1,g=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var s=l,n=c;return l=c=void 0,m=t,u=e.apply(n,s)}function y(e){var s=e-f;return void 0===f||s>=t||s<0||g&&e-m>=d}function b(){var e=(0,r.default)();if(y(e))return j(e);h=setTimeout(b,function(e){var s=t-(e-f);return g?a(s,d-(e-m)):s}(e))}function j(e){return h=void 0,_&&l?v(e):(l=c=void 0,u)}function w(){var e=(0,r.default)(),s=y(e);if(l=arguments,c=this,f=e,s){if(void 0===h)return function(e){return m=e,h=setTimeout(b,t),p?v(e):u}(f);if(g)return clearTimeout(h),h=setTimeout(b,t),v(f)}return void 0===h&&(h=setTimeout(b,t)),u}return t=(0,o.default)(t)||0,(0,n.default)(s)&&(p=!!s.leading,d=(g="maxWait"in s)?i((0,o.default)(s.maxWait)||0,t):d,_="trailing"in s?!!s.trailing:_),w.cancel=function(){void 0!==h&&clearTimeout(h),m=0,l=f=c=h=void 0},w.flush=function(){return void 0===h?u:j((0,r.default)())},w}},"./node_modules/lodash-es/defaults.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_baseRest.js"),r=s("./node_modules/lodash-es/eq.js"),o=s("./node_modules/lodash-es/_isIterateeCall.js"),i=s("./node_modules/lodash-es/keysIn.js"),a=Object.prototype,l=a.hasOwnProperty;const c=(0,n.default)((function(e,t){e=Object(e);var s=-1,n=t.length,c=n>2?t[2]:void 0;for(c&&(0,o.default)(t[0],t[1],c)&&(n=1);++s<n;)for(var d=t[s],u=(0,i.default)(d),h=-1,f=u.length;++h<f;){var m=u[h],p=e[m];(void 0===p||(0,r.default)(p,a[m])&&!l.call(e,m))&&(e[m]=d[m])}return e}))},"./node_modules/lodash-es/defer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseDelay.js");const r=(0,s("./node_modules/lodash-es/_baseRest.js").default)((function(e,t){return(0,n.default)(e,1,t)}))},"./node_modules/lodash-es/difference.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseDifference.js"),r=s("./node_modules/lodash-es/_baseFlatten.js"),o=s("./node_modules/lodash-es/_baseRest.js"),i=s("./node_modules/lodash-es/isArrayLikeObject.js");const a=(0,o.default)((function(e,t){return(0,i.default)(e)?(0,n.default)(e,(0,r.default)(t,1,i.default,!0)):[]}))},"./node_modules/lodash-es/eq.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e,t){return e===t||e!=e&&t!=t}},"./node_modules/lodash-es/escape.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_escapeHtmlChar.js"),r=s("./node_modules/lodash-es/toString.js"),o=/[&<>"']/g,i=RegExp(o.source);const a=function(e){return(e=(0,r.default)(e))&&i.test(e)?e.replace(o,n.default):e}},"./node_modules/lodash-es/every.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_arrayEvery.js"),r=s("./node_modules/lodash-es/_baseEvery.js"),o=s("./node_modules/lodash-es/_baseIteratee.js"),i=s("./node_modules/lodash-es/isArray.js"),a=s("./node_modules/lodash-es/_isIterateeCall.js");const l=function(e,t,s){var l=(0,i.default)(e)?n.default:r.default;return s&&(0,a.default)(e,t,s)&&(t=void 0),l(e,(0,o.default)(t,3))}},"./node_modules/lodash-es/findIndex.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseFindIndex.js"),r=s("./node_modules/lodash-es/_baseIteratee.js"),o=s("./node_modules/lodash-es/toInteger.js"),i=Math.max;const a=function(e,t,s){var a=null==e?0:e.length;if(!a)return-1;var l=null==s?0:(0,o.default)(s);return l<0&&(l=i(a+l,0)),(0,n.default)(e,(0,r.default)(t,3),l)}},"./node_modules/lodash-es/findLastIndex.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_baseFindIndex.js"),r=s("./node_modules/lodash-es/_baseIteratee.js"),o=s("./node_modules/lodash-es/toInteger.js"),i=Math.max,a=Math.min;const l=function(e,t,s){var l=null==e?0:e.length;if(!l)return-1;var c=l-1;return void 0!==s&&(c=(0,o.default)(s),c=s<0?i(l+c,0):a(c,l-1)),(0,n.default)(e,(0,r.default)(t,3),c,!0)}},"./node_modules/lodash-es/flatten.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseFlatten.js");const r=function(e){return(null==e?0:e.length)?(0,n.default)(e,1):[]}},"./node_modules/lodash-es/get.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseGet.js");const r=function(e,t,s){var r=null==e?void 0:(0,n.default)(e,t);return void 0===r?s:r}},"./node_modules/lodash-es/groupBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseAssignValue.js"),r=s("./node_modules/lodash-es/_createAggregator.js"),o=Object.prototype.hasOwnProperty;const i=(0,r.default)((function(e,t,s){o.call(e,s)?e[s].push(t):(0,n.default)(e,s,[t])}))},"./node_modules/lodash-es/has.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseHas.js"),r=s("./node_modules/lodash-es/_hasPath.js");const o=function(e,t){return null!=e&&(0,r.default)(e,t,n.default)}},"./node_modules/lodash-es/hasIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseHasIn.js"),r=s("./node_modules/lodash-es/_hasPath.js");const o=function(e,t){return null!=e&&(0,r.default)(e,t,n.default)}},"./node_modules/lodash-es/identity.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return e}},"./node_modules/lodash-es/indexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseIndexOf.js"),r=s("./node_modules/lodash-es/toInteger.js"),o=Math.max;const i=function(e,t,s){var i=null==e?0:e.length;if(!i)return-1;var a=null==s?0:(0,r.default)(s);return a<0&&(a=o(i+a,0)),(0,n.default)(e,t,a)}},"./node_modules/lodash-es/invert.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/constant.js"),r=s("./node_modules/lodash-es/_createInverter.js"),o=s("./node_modules/lodash-es/identity.js"),i=Object.prototype.toString;const a=(0,r.default)((function(e,t,s){null!=t&&"function"!=typeof t.toString&&(t=i.call(t)),e[t]=s}),(0,n.default)(o.default))},"./node_modules/lodash-es/isArguments.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_baseIsArguments.js"),r=s("./node_modules/lodash-es/isObjectLike.js"),o=Object.prototype,i=o.hasOwnProperty,a=o.propertyIsEnumerable;const l=(0,n.default)(function(){return arguments}())?n.default:function(e){return(0,r.default)(e)&&i.call(e,"callee")&&!a.call(e,"callee")}},"./node_modules/lodash-es/isArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=Array.isArray},"./node_modules/lodash-es/isArrayLike.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/isFunction.js"),r=s("./node_modules/lodash-es/isLength.js");const o=function(e){return null!=e&&(0,r.default)(e.length)&&!(0,n.default)(e)}},"./node_modules/lodash-es/isArrayLikeObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/isArrayLike.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return(0,r.default)(e)&&(0,n.default)(e)}},"./node_modules/lodash-es/isBuffer.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_root.js"),r=s("./node_modules/lodash-es/stubFalse.js"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof module&&module&&!module.nodeType&&module,a=i&&i.exports===o?n.default.Buffer:void 0;const l=(a?a.isBuffer:void 0)||r.default},"./node_modules/lodash-es/isEmpty.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var n=s("./node_modules/lodash-es/_baseKeys.js"),r=s("./node_modules/lodash-es/_getTag.js"),o=s("./node_modules/lodash-es/isArguments.js"),i=s("./node_modules/lodash-es/isArray.js"),a=s("./node_modules/lodash-es/isArrayLike.js"),l=s("./node_modules/lodash-es/isBuffer.js"),c=s("./node_modules/lodash-es/_isPrototype.js"),d=s("./node_modules/lodash-es/isTypedArray.js"),u=Object.prototype.hasOwnProperty;const h=function(e){if(null==e)return!0;if((0,a.default)(e)&&((0,i.default)(e)||"string"==typeof e||"function"==typeof e.splice||(0,l.default)(e)||(0,d.default)(e)||(0,o.default)(e)))return!e.length;var t=(0,r.default)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,c.default)(e))return!(0,n.default)(e).length;for(var s in e)if(u.call(e,s))return!1;return!0}},"./node_modules/lodash-es/isEqual.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseIsEqual.js");const r=function(e,t){return(0,n.default)(e,t)}},"./node_modules/lodash-es/isFunction.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isObject.js");const o=function(e){if(!(0,r.default)(e))return!1;var t=(0,n.default)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"./node_modules/lodash-es/isLength.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"./node_modules/lodash-es/isMap.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseIsMap.js"),r=s("./node_modules/lodash-es/_baseUnary.js"),o=s("./node_modules/lodash-es/_nodeUtil.js"),i=o.default&&o.default.isMap;const a=i?(0,r.default)(i):n.default},"./node_modules/lodash-es/isMatch.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseIsMatch.js"),r=s("./node_modules/lodash-es/_getMatchData.js");const o=function(e,t){return e===t||(0,n.default)(e,t,(0,r.default)(t))}},"./node_modules/lodash-es/isObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"./node_modules/lodash-es/isObjectLike.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){return null!=e&&"object"==typeof e}},"./node_modules/lodash-es/isPlainObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/_getPrototype.js"),o=s("./node_modules/lodash-es/isObjectLike.js"),i=Function.prototype,a=Object.prototype,l=i.toString,c=a.hasOwnProperty,d=l.call(Object);const u=function(e){if(!(0,o.default)(e)||"[object Object]"!=(0,n.default)(e))return!1;var t=(0,r.default)(e);if(null===t)return!0;var s=c.call(t,"constructor")&&t.constructor;return"function"==typeof s&&s instanceof s&&l.call(s)==d}},"./node_modules/lodash-es/isRegExp.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseIsRegExp.js"),r=s("./node_modules/lodash-es/_baseUnary.js"),o=s("./node_modules/lodash-es/_nodeUtil.js"),i=o.default&&o.default.isRegExp;const a=i?(0,r.default)(i):n.default},"./node_modules/lodash-es/isSet.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseIsSet.js"),r=s("./node_modules/lodash-es/_baseUnary.js"),o=s("./node_modules/lodash-es/_nodeUtil.js"),i=o.default&&o.default.isSet;const a=i?(0,r.default)(i):n.default},"./node_modules/lodash-es/isString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isArray.js"),o=s("./node_modules/lodash-es/isObjectLike.js");const i=function(e){return"string"==typeof e||!(0,r.default)(e)&&(0,o.default)(e)&&"[object String]"==(0,n.default)(e)}},"./node_modules/lodash-es/isSymbol.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseGetTag.js"),r=s("./node_modules/lodash-es/isObjectLike.js");const o=function(e){return"symbol"==typeof e||(0,r.default)(e)&&"[object Symbol]"==(0,n.default)(e)}},"./node_modules/lodash-es/isTypedArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseIsTypedArray.js"),r=s("./node_modules/lodash-es/_baseUnary.js"),o=s("./node_modules/lodash-es/_nodeUtil.js"),i=o.default&&o.default.isTypedArray;const a=i?(0,r.default)(i):n.default},"./node_modules/lodash-es/iteratee.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_baseClone.js"),r=s("./node_modules/lodash-es/_baseIteratee.js");const o=function(e){return(0,r.default)("function"==typeof e?e:(0,n.default)(e,1))}},"./node_modules/lodash-es/keyBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseAssignValue.js");const r=(0,s("./node_modules/lodash-es/_createAggregator.js").default)((function(e,t,s){(0,n.default)(e,s,t)}))},"./node_modules/lodash-es/keys.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_arrayLikeKeys.js"),r=s("./node_modules/lodash-es/_baseKeys.js"),o=s("./node_modules/lodash-es/isArrayLike.js");const i=function(e){return(0,o.default)(e)?(0,n.default)(e):(0,r.default)(e)}},"./node_modules/lodash-es/keysIn.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_arrayLikeKeys.js"),r=s("./node_modules/lodash-es/_baseKeysIn.js"),o=s("./node_modules/lodash-es/isArrayLike.js");const i=function(e){return(0,o.default)(e)?(0,n.default)(e,!0):(0,r.default)(e)}},"./node_modules/lodash-es/last.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},"./node_modules/lodash-es/lastIndexOf.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var n=s("./node_modules/lodash-es/_baseFindIndex.js"),r=s("./node_modules/lodash-es/_baseIsNaN.js"),o=s("./node_modules/lodash-es/_strictLastIndexOf.js"),i=s("./node_modules/lodash-es/toInteger.js"),a=Math.max,l=Math.min;const c=function(e,t,s){var c=null==e?0:e.length;if(!c)return-1;var d=c;return void 0!==s&&(d=(d=(0,i.default)(s))<0?a(c+d,0):l(d,c-1)),t==t?(0,o.default)(e,t,d):(0,n.default)(e,r.default,d,!0)}},"./node_modules/lodash-es/memoize.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_MapCache.js");function r(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var s=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=s.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return s.cache=o.set(r,i)||o,i};return s.cache=new(r.Cache||n.default),s}r.Cache=n.default;const o=r},"./node_modules/lodash-es/merge.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseMerge.js");const r=(0,s("./node_modules/lodash-es/_createAssigner.js").default)((function(e,t,s){(0,n.default)(e,t,s)}))},"./node_modules/lodash-es/mergeWith.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseMerge.js");const r=(0,s("./node_modules/lodash-es/_createAssigner.js").default)((function(e,t,s,r){(0,n.default)(e,t,s,r)}))},"./node_modules/lodash-es/now.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_root.js");const r=function(){return n.default.Date.now()}},"./node_modules/lodash-es/omit.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var n=s("./node_modules/lodash-es/_arrayMap.js"),r=s("./node_modules/lodash-es/_baseClone.js"),o=s("./node_modules/lodash-es/_baseUnset.js"),i=s("./node_modules/lodash-es/_castPath.js"),a=s("./node_modules/lodash-es/_copyObject.js"),l=s("./node_modules/lodash-es/_customOmitClone.js"),c=s("./node_modules/lodash-es/_flatRest.js"),d=s("./node_modules/lodash-es/_getAllKeysIn.js");const u=(0,c.default)((function(e,t){var s={};if(null==e)return s;var c=!1;t=(0,n.default)(t,(function(t){return t=(0,i.default)(t,e),c||(c=t.length>1),t})),(0,a.default)(e,(0,d.default)(e),s),c&&(s=(0,r.default)(s,7,l.default));for(var u=t.length;u--;)(0,o.default)(s,t[u]);return s}))},"./node_modules/lodash-es/once.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/before.js");const r=function(e){return(0,n.default)(2,e)}},"./node_modules/lodash-es/pick.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_basePick.js");const r=(0,s("./node_modules/lodash-es/_flatRest.js").default)((function(e,t){return null==e?{}:(0,n.default)(e,t)}))},"./node_modules/lodash-es/property.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseProperty.js"),r=s("./node_modules/lodash-es/_basePropertyDeep.js"),o=s("./node_modules/lodash-es/_isKey.js"),i=s("./node_modules/lodash-es/_toKey.js");const a=function(e){return(0,o.default)(e)?(0,n.default)((0,i.default)(e)):(0,r.default)(e)}},"./node_modules/lodash-es/range.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=(0,s("./node_modules/lodash-es/_createRange.js").default)()},"./node_modules/lodash-es/result.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s("./node_modules/lodash-es/_castPath.js"),r=s("./node_modules/lodash-es/isFunction.js"),o=s("./node_modules/lodash-es/_toKey.js");const i=function(e,t,s){var i=-1,a=(t=(0,n.default)(t,e)).length;for(a||(a=1,e=void 0);++i<a;){var l=null==e?void 0:e[(0,o.default)(t[i])];void 0===l&&(i=a,l=s),e=(0,r.default)(l)?l.call(e):l}return e}},"./node_modules/lodash-es/some.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s("./node_modules/lodash-es/_arraySome.js"),r=s("./node_modules/lodash-es/_baseIteratee.js"),o=s("./node_modules/lodash-es/_baseSome.js"),i=s("./node_modules/lodash-es/isArray.js"),a=s("./node_modules/lodash-es/_isIterateeCall.js");const l=function(e,t,s){var l=(0,i.default)(e)?n.default:o.default;return s&&(0,a.default)(e,t,s)&&(t=void 0),l(e,(0,r.default)(t,3))}},"./node_modules/lodash-es/sortBy.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var n=s("./node_modules/lodash-es/_baseFlatten.js"),r=s("./node_modules/lodash-es/_baseOrderBy.js"),o=s("./node_modules/lodash-es/_baseRest.js"),i=s("./node_modules/lodash-es/_isIterateeCall.js");const a=(0,o.default)((function(e,t){if(null==e)return[];var s=t.length;return s>1&&(0,i.default)(e,t[0],t[1])?t=[]:s>2&&(0,i.default)(t[0],t[1],t[2])&&(t=[t[0]]),(0,r.default)(e,(0,n.default)(t,1),[])}))},"./node_modules/lodash-es/stubArray.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){return[]}},"./node_modules/lodash-es/stubFalse.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});const n=function(){return!1}},"./node_modules/lodash-es/toFinite.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/toNumber.js"),r=1/0;const o=function(e){return e?(e=(0,n.default)(e))===r||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},"./node_modules/lodash-es/toInteger.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/toFinite.js");const r=function(e){var t=(0,n.default)(e),s=t%1;return t==t?s?t-s:t:0}},"./node_modules/lodash-es/toNumber.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s("./node_modules/lodash-es/_baseTrim.js"),r=s("./node_modules/lodash-es/isObject.js"),o=s("./node_modules/lodash-es/isSymbol.js"),i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;const d=function(e){if("number"==typeof e)return e;if((0,o.default)(e))return NaN;if((0,r.default)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,r.default)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=(0,n.default)(e);var s=a.test(e);return s||l.test(e)?c(e.slice(2),s?2:8):i.test(e)?NaN:+e}},"./node_modules/lodash-es/toPlainObject.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/_copyObject.js"),r=s("./node_modules/lodash-es/keysIn.js");const o=function(e){return(0,n.default)(e,(0,r.default)(e))}},"./node_modules/lodash-es/toString.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var n=s("./node_modules/lodash-es/_baseToString.js");const r=function(e){return null==e?"":(0,n.default)(e)}},"./node_modules/lodash-es/uniqueId.js":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s("./node_modules/lodash-es/toString.js"),r=0;const o=function(e){var t=++r;return(0,n.default)(e)+t}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var s=o[e]={id:e,loaded:!1,exports:{}};return r[e].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=r,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(s,n){if(1&n&&(s=this(s)),8&n)return s;if("object"==typeof s&&s){if(4&n&&s.__esModule)return s;if(16&n&&"function"==typeof s.then)return s}var r=Object.create(null);i.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&s;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>s[e]));return o.default=()=>s,i.d(r,o),r},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,s)=>(i.f[s](e,t),t)),[])),i.u=e=>e+".js",i.miniCssF=e=>{},i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s={},n="converse.js:",i.l=(e,t,r,o)=>{if(s[e])s[e].push(t);else{var a,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==n+r){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",n+r),a.src=e),s[e]=[t];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var r=s[e];if(delete s[e],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.p="/dist/",(()=>{var e={"converse.min":0};i.f.j=(t,s)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)s.push(n[2]);else{var r=new Promise(((s,r)=>n=e[t]=[s,r]));s.push(n[2]=r);var o=i.p+i.u(t),a=new Error;i.l(o,(s=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,n[1](a)}}),"chunk-"+t,t)}};var t=(t,s)=>{var n,r,[o,a,l]=s,c=0;if(o.some((t=>0!==e[t]))){for(n in a)i.o(a,n)&&(i.m[n]=a[n]);if(l)l(i)}for(t&&t(s);c<o.length;c++)r=o[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0},s=self.webpackChunkconverse_js=self.webpackChunkconverse_js||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.nc=void 0;var a={};(()=>{"use strict";i.r(a),i.d(a,{default:()=>n});const e={},t={plugins:{add(t,s){if(void 0!==e[t])throw new TypeError(`Error: plugin with name "${t}" has already been registered!`);e[t]=s}},initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.load(e).initialize(e)},load(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.assets_path&&(i.p=s.assets_path),i("./src/index.js"),Object.keys(e).forEach((s=>t.plugins.add(s,e[s]))),t}};window.converse=t;const s=new CustomEvent("converse-loaded",{detail:{converse:t}});window.dispatchEvent(s);const n=t})()})();
//# sourceMappingURL=converse.min.js.map